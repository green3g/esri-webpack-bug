(function(){(this||window).webpackJsonp.registerAbsMids({"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/urlUtils":405,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedFeatureSet":427,"esri/core/pbf":594,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/pbf":594,"esri/layers/graphics/OptimizedGeometry":597,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedGeometry":597,"esri/layers/graphics/OptimizedFeature":607,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedFeature":607,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/query":626,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/pbfQueryUtils":627,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/pbfFeatureServiceParser":628,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/queryAttachments":639,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/QueryTask":649,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/queryRelatedRecords":650,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/controllers/AutoController2D":817})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{405:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var o=t[n];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){r[n]=[];for(var i=0;i<o.length;i++)r[n][i]=e(o[i])}else"object"==typeof o?o.toJSON&&(r[n]=JSON.stringify(o)):r[n]=o}return r}}.apply(null,n))||(e.exports=o)},427:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1}}();t.default=r}.apply(null,n))||(e.exports=o)},594:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){return function(){function e(e,t,r,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=r||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.getMessage=function(){var t=this._getLength(),r=this._pos,n=new e(this._data,this._dataView,r,r+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var o=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*o,o*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*o}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){var n="",o="";r=Math.min(this._end,r);for(var i=t;i<r;++i){var s=e[i];128&s?o+="%"+s.toString(16):(n+=decodeURIComponent(o)+String.fromCharCode(s),o="")}return o.length&&(n+=decodeURIComponent(o)),n},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e}()}.apply(null,n))||(e.exports=o)},597:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.lengths=e,this.coords=t}}();t.default=r}.apply(null,n))||(e.exports=o)},607:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t,r,n){void 0===e&&(e=null),void 0===t&&(t={}),this.geometry=e,this.attributes=t,r&&(this.centroid=r),null!=n&&(this.objectId=n)}}();t.default=r}.apply(null,n))||(e.exports=o)},626:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(345),r(351),r(350),r(420),r(625),r(627),r(405)],void 0===(o=function(e,t,r,n,o,i,s,a,u){function p(e,t){var r=e.geometry,n=e.toJSON(),o=n;if(r&&(o.geometry=JSON.stringify(r),o.geometryType=i.getJsonType(r),o.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(o.objectIds=n.objectIds.join(",")),n.orderByFields&&(o.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete o.outFields:-1!==n.outFields.indexOf("*")?o.outFields="*":o.outFields=n.outFields.join(","),n.outSR?o.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(o.outSR=o.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(o.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(o.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(o.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(o.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var s=n.timeExtent;o.time=[null!=s.startTime?s.startTime:"null",null!=s.endTime?s.endTime:"null"],delete n.timeExtent}return o}function c(e,t,i,a,c){void 0===a&&(a={});var l="string"==typeof e?o.urlToObject(e):e,d=t.geometry?[t.geometry]:[];return a.responseType="pbf"===i?"array-buffer":"json",s.normalizeCentralMeridian(d,null,a).then(function(e){var o=e&&e[0];o&&((t=t.clone()).geometry=o);var s=u.mapParameters(r({},l.query,{f:i},c,p(t,c)));return n(l.path+"/query",r({},a,{query:s}))})}Object.defineProperty(t,"__esModule",{value:!0});var l="Layer does not support extent calculation.";t.queryToQueryStringParameters=p,t.executeQuery=function(e,t,r){return c(e,t,"json",r)},t.executeQueryPBF=function(e,t,r){return c(e,t,"pbf",r).then(function(e){var t=a.parsePBFFeatureQuery(e.data),r=e;return r.data=t,r})},t.executeQueryForIds=function(e,t,r){return c(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return c(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return c(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(l);if(t.hasOwnProperty("count"))throw new Error(l);return e})}}.apply(null,n))||(e.exports=o)},627:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(342),r(343),r(427),r(628)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=n.getLogger("esri.tasks.operations.pbfQueryUtils");t.parsePBFFeatureQuery=function(e){try{var t=i.parseFeatureQuery(e).queryResult.featureResult;if(t&&t.features&&t.features.length&&t.objectIdFieldName)for(var n=t.objectIdFieldName,a=0,u=t.features;a<u.length;a++){var p=u[a];p.attributes&&(p.objectId=p.attributes[n])}return t}catch(e){var c=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return s.error(c),new o.default}}}.apply(null,n))||(e.exports=o)},628:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(594),r(607),r(427),r(597)],void 0===(o=function(e,t,r,n,o,i){function s(e){return e>=x.length?null:x[e]}function a(e){return e>=w.length?null:w[e]}function u(e){return e>=F.length?null:F[e]}function p(e){return e>=S.length?null:S[e]}function c(e){for(var t=new i.default,r=t.coords;e.next();)switch(e.tag()){case 3:for(var n=e.getUInt32(),o=e.pos()+n,s=0;e.pos()<o;)r[s++]=e.getSInt64();break;case 1:case 2:default:e.skip()}return t}function l(e){for(var t=new i.default,r=t.coords,n=t.lengths;e.next();)switch(e.tag()){case 2:for(var o=e.getUInt32(),s=e.pos()+o;e.pos()<s;)n.push(e.getUInt32());break;case 3:for(var a=e.getUInt32(),u=(s=e.pos()+a,0);e.pos()<s;)r[u++]=e.getSInt64();break;case 1:default:e.skip()}return t}function d(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function h(e){for(var t={type:s(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=s(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=a(e.getEnum());break;case 5:case 6:default:e.skip()}return t}function y(e,t){for(var r=new n.default,o=0;e.next();)switch(e.tag()){case 1:var i=e.getMessage(),s=t[o++].name;r.attributes[s]=d(i);break;case 2:r.geometry=l(e.getMessage());break;case 4:r.centroid=c(e.getMessage());break;default:e.skip()}return r}function f(e){for(var t=[0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 3:case 4:t.push(e.getDouble());break;default:e.skip()}return t}function g(e){for(var t=[0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 3:case 4:t.push(e.getDouble());break;default:e.skip()}return t}function m(e){for(var t={originPosition:u(0)};e.next();)switch(e.tag()){case 1:t.originPosition=u(e.getEnum());break;case 2:t.scale=f(e.getMessage());break;case 3:t.translate=g(e.getMessage());break;default:e.skip()}return t}function b(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function _(e){for(var t={};e.next();)switch(e.tag()){case 1:t.wkid=e.getUInt32();break;case 5:t.wkt=e.getString();break;case 2:case 3:case 4:default:e.skip()}return t}function v(e){var t=new o.default;for(t.geometryType=p(0);e.next();)switch(e.tag()){case 1:t.objectIdFieldName=e.getString();break;case 3:t.globalIdFieldName=e.getString();break;case 4:t.geohashFieldName=e.getString();break;case 5:t.geometryProperties=b(e.getMessage());break;case 7:t.geometryType=p(e.getEnum());break;case 8:t.spatialReference=_(e.getMessage());break;case 10:t.hasZ=e.getBool();break;case 11:t.hasM=e.getBool();break;case 12:var r=e.getMessage();t.transform=m(r);break;case 9:var n=e.getBool();t.exceededTransferLimit=n;break;case 13:var i=e.getMessage();t.fields.push(h(i));break;case 15:var s=e.getMessage();t.features.push(y(s,t.fields));break;case 2:case 6:default:e.skip()}return t}function k(e){for(var t={};e.next();)switch(e.tag()){case 1:t.featureResult=v(e.getMessage());break;default:e.skip()}return t}Object.defineProperty(t,"__esModule",{value:!0});var x=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],w=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],S=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],F=["upperLeft","lowerLeft"];t.parseFeatureQuery=function(e){for(var t=new r(new Uint8Array(e),new DataView(e)),n={};t.next();)switch(t.tag()){case 2:n.queryResult=k(t.getMessage());break;default:t.skip()}return n}}.apply(null,n))||(e.exports=o)},639:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(345),r(351),r(350),r(405)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0}),t.processAttachmentQueryResult=function(e,t,n){for(var i={},s=0,a=e;s<a.length;s++)for(var u=a[s],p=u.parentObjectId,c=0,l=u.attachmentInfos;c<l.length;c++){var d=l[c],h=d.id,y=o.addProxy(t+"/"+p+"/attachments/"+h+(n?"?token="+n:"")),f=r({},d,{parentObjectId:p,url:y});i[p]?i[p].push(f):i[p]=[f]}return i},t.executeAttachmentQuery=function(e,t,o){var s={query:i.mapParameters(r({},e.query,{f:"json"},function(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}(t)))};return o&&(s=r({},o,s)),n(e.path+"/queryAttachments",s)}}.apply(null,n))||(e.exports=o)},649:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(338),r(336),r(387),r(345),r(365),r(337),r(743),r(626),r(639),r(650),r(444),r(394),r(418),r(447)],void 0===(o=function(e,t,r,n,o,i,s,a,u,p,c,l,d,h,y,f){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.source=null,r}return r(t,e),t.prototype.execute=function(e,t){return this.executeJSON(e,t).then(function(e){return h.fromJSON(e)})},t.prototype.executeJSON=function(e,t){return p.executeQuery(this.parsedUrl,this._normalizeQuery(e),i({},this.requestOptions,t)).then(function(e){return e.data})},t.prototype.executeForCount=function(e,t){return p.executeQueryForCount(this.parsedUrl,this._normalizeQuery(e),i({},this.requestOptions,t)).then(function(e){return e.data.count})},t.prototype.executeForExtent=function(e,t){return p.executeQueryForExtent(this.parsedUrl,this._normalizeQuery(e),i({},this.requestOptions,t)).then(function(e){return{count:e.data.count,extent:s.Extent.fromJSON(e.data.extent)}})},t.prototype.executeForIds=function(e,t){return p.executeQueryForIds(this.parsedUrl,this._normalizeQuery(e),i({},this.requestOptions,t)).then(function(e){return e.data.objectIds})},t.prototype.executeRelationshipQuery=function(e,t){return(this.gdbVersion||this.source)&&(e=e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source})),l.executeRelationshipQuery(this.parsedUrl,e,i({},this.requestOptions,t)).then(function(e){var t=e.data,r={};return Object.keys(t).forEach(function(e){return r[e]=h.fromJSON(t[e])}),r})},t.prototype.executeAttachmentQuery=function(e,t){var r=this,n=t&&t.query&&t.query.token;return c.executeAttachmentQuery(this.parsedUrl,e,i({},this.requestOptions,t)).then(function(e){return c.processAttachmentQueryResult(e.data.attachmentGroups,r.parsedUrl.path,n)})},t.prototype._normalizeQuery=function(e){return this.gdbVersion||this.source?e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source}):e},n([a.property()],t.prototype,"gdbVersion",void 0),n([a.property()],t.prototype,"source",void 0),n([o(0,a.cast(y))],t.prototype,"execute",null),n([o(0,a.cast(y))],t.prototype,"executeJSON",null),n([o(0,a.cast(y))],t.prototype,"executeForCount",null),n([o(0,a.cast(y))],t.prototype,"executeForExtent",null),n([o(0,a.cast(y))],t.prototype,"executeForIds",null),n([o(0,a.cast(f))],t.prototype,"executeRelationshipQuery",null),n([o(0,a.cast(d))],t.prototype,"executeAttachmentQuery",null),n([a.subclass("esri.tasks.QueryTask")],t)}(a.declared(u))}.apply(null,n))||(e.exports=o)},650:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(345),r(351),r(405)],void 0===(o=function(e,t,r,n,o){function i(e){var t=e.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.outFields&&(t.outFields=t.outFields.join(",")),t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.source&&(t.layer=JSON.stringify({source:t.source}),delete t.source),t}Object.defineProperty(t,"__esModule",{value:!0}),t.toQueryStringParameters=i,t.executeRelationshipQuery=function(e,t,s){var a={query:o.mapParameters(r({},e.query,{f:"json"},i(t)))};return s&&(a=r({},s,a)),n(e.path+"/queryRelatedRecords",a).then(function(e){for(var t=e.data,r=t.geometryType,n=t.spatialReference,o={},i=0,s=t.relatedRecordGroups;i<s.length;i++){var a=s[i],u={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:n,features:a.relatedRecords};if(null!=a.objectId)o[a.objectId]=u;else for(var p in a)a.hasOwnProperty(p)&&"relatedRecords"!==p&&(o[a[p]]=u)}return e.data=o,e})}}.apply(null,n))||(e.exports=o)},817:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(338),r(336),r(384),r(346),r(358),r(342),r(624),r(340),r(337),r(649),r(1463)],void 0===(o=function(e,t,n,o,i,s,a,u,p,c,l,d,h){var y;return function(e){e[e.Snapshot=0]="Snapshot",e[e.OnDemand=1]="OnDemand"}(y||(y={})),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maxPointCountForAuto=4e3,t.maxRecordCountForAuto=2e3,t.maxVertexCountForAuto=25e4,t}return n(t,e),t.prototype.initialize=function(){var e=this,t=this.layer.when(function(){e._verifyCapabilities()}).then(function(){return e._figureOutMode().then(function(t){return e._createController(t)})}).then(function(t){return e._set("activeController",t)});this.addResolvingPromise(t)},t.prototype.destroy=function(){this.activeController&&(this.activeController.destroy(),this._set("activeController",null))},Object.defineProperty(t.prototype,"countThresholdForAuto",{get:function(){var e,t=this.layer.geometryType;return"polyline"===t||"polygon"===t||"multipoint"===t?e=this.maxRecordCountForAuto:"point"===t&&(e=this.maxPointCountForAuto),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!1===this.isFulfilled()||!0===this.get("activeController.updating")},enumerable:!0,configurable:!0}),t.prototype._figureOutMode=function(){return this._isStatisticsSupported()?this._checkByStatistics():this._checkByCount()},t.prototype._isStatisticsSupported=function(){if(!this.layer.capabilities.query.supportsStatistics)return!1;var e=this.layer.parsedUrl;return e&&/(https?:)?\/\/services.*\.arcgis\.com/i.test(e.path)},t.prototype._checkByStatistics=function(){var e=this,t=this.layer,r=t.parsedUrl.path,n=t.createQuery();return n.outStatistics=[new h({statisticType:"exceedslimit",maxPointCount:this.maxPointCountForAuto,maxRecordCount:this.maxRecordCountForAuto,maxVertexCount:this.maxVertexCountForAuto,outStatisticFieldName:"exceedslimit"})],new d({url:r+"/query"}).execute(n).then(function(t){var r=t&&t.features&&t.features[0];if(0===(r&&r.attributes&&r.attributes.exceedslimit)){var n=e.layer,o=n.maxRecordCount;if(n.get("capabilities.query.supportsPagination")||o>=e.countThresholdForAuto)return y.Snapshot}return y.OnDemand})},t.prototype._checkByCount=function(){var e=this,t=this.layer;return t.queryFeatureCount().then(function(r){return r<=e.countThresholdForAuto&&r<=t.maxRecordCount?y.Snapshot:y.OnDemand})},t.prototype._createController=function(e){var t=this;return(e===y.OnDemand?c.create(function(e){return r.e(82).then(function(){var t=[r(2405)];e.apply(null,t)}.bind(this)).catch(r.oe)}):c.create(function(e){return r.e(18).then(function(){var t=[r(791)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return new e({layer:t.layer,layerView:t.layerView,graphics:t.graphics})}).catch(function(t){throw new Error("Module path not found for controller type: "+(e===y.Snapshot?"snapshot":"on demand"))})},t.prototype._verifyCapabilities=function(){if(!this.layer.get("capabilities.operations.supportsQuery"))throw new u("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:this.layer})},o([l.property()],t.prototype,"activeController",void 0),o([l.property({dependsOn:["layer.geometryType"]})],t.prototype,"countThresholdForAuto",null),o([l.property({type:a.ofType(i)})],t.prototype,"graphics",void 0),o([l.property()],t.prototype,"layer",void 0),o([l.property()],t.prototype,"layerView",void 0),o([l.property({dependsOn:["activeController.updating"]})],t.prototype,"updating",null),o([l.aliasOf("activeController.update")],t.prototype,"update",void 0),o([l.subclass("esri.layers.graphics.controllers.AutoController2D")],t)}(l.declared(s,p))}.apply(null,n))||(e.exports=o)}}]);