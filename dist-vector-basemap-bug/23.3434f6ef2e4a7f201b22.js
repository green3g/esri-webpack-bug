(function(){(this||window).webpackJsonp.registerAbsMids({"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/FeatureLayer":331,"esri/core/screenUtils":354,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/screenUtils":354,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/Renderer":370,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/Symbol":371,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Domain":374,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/utils":378,"esri/core/workers/RemoteClient":389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/RemoteClient":389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/FeatureSet":392,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Field":395,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/domains":399,"esri/symbols/SimpleLineSymbol":402,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleLineSymbol":402,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/SimpleRenderer":412,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/ClassBreaksRenderer":414,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/HeatmapRenderer":415,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/UniqueValueRenderer":416,"esri/renderers/support/jsonUtils":423,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/jsonUtils":423,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/LegendOptions":424,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ScaleRangeLayer":426,"esri/layers/support/LabelClass":427,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/LabelClass":427,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/commonProperties":429,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ArcGISService":436,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers":437,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/RefreshableLayer":438,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/AttachmentQuery":440,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/RelationshipQuery":444,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/requireUtils":446,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/fieldUtils":447,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/labelUtils":451,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureReduction":455,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/FillSymbol":457,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/MarkerSymbol":458,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/layerSourceUtils":459,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/support/urlUtils":586,"@dojo/framework/shim/Set":587,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureTemplate":588,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/LineSymbol":592,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/CodedValueDomain":597,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/InheritedDomain":598,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/RangeDomain":599,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/fieldType":600,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workers":607,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/Connection":608,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerOwner":609,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workerFactory":610,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/loaderConfig":611,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerFallback":612,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/geometry/support/graphicsUtils":613,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/typeUtils":615,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/diffUtils":621,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/support/styleUtils":634,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/styleUtils":635,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers":637,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/AuthoringInfo":641,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/AuthoringInfoVisualVariable":642,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/ClassBreakInfo":643,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/HeatmapColorStop":644,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/UniqueValueInfo":645,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/types":646,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureProcessing":652,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureReductionSelection":661,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/LabelExpressionInfo":662,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/string":663,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/labelingInfo":664,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/sources/MemorySource":671,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/accessorSupport/typescript":674,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/typescript":675,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureIndex":676,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureType":677,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Relationship":678,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/PictureMarkerSymbol":701,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleFillSymbol":702,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/SceneLayer":795,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/SceneService":1070,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/RangeInfo":1507})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[23,14,25,48,49,50,51,102],{1070:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(350),r(341),r(343),r(428),r(339),r(349),r(336),r(363),r(625),r(362),r(398),r(436),r(433),r(432),r(394)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c,d,y,f,h,m,v,g){var b=s.getLogger("esri.layers.mixins.SceneService");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blendMode=null,t.spatialReference=null,t.fullExtent=null,t.heightModelInfo=null,t.version={major:Number.NaN,minor:Number.NaN,versionString:""},t.copyright=null,t.sublayerTitleMode="item-title",t.title=null,t.layerId=null,t}return r(t,e),t.prototype.readSpatialReference=function(e,t){return this._readSpatialReference(t)},t.prototype._readSpatialReference=function(e){if(null!=e.spatialReference)return y.fromJSON(e.spatialReference);var t=e.store,r=t.indexCRS||t.geographicCRS,n=r&&parseInt(r.substring(r.lastIndexOf("/")+1,r.length),10);return null!=n?new y(n):null},t.prototype.readFullExtent=function(e,t){var r=t.store,n=this._readSpatialReference(t);return null==n||null==r||null==r.extent?null:new c({xmin:r.extent[0],ymin:r.extent[1],xmax:r.extent[2],ymax:r.extent[3],spatialReference:n})},t.prototype.readVersion=function(e,t){var r=t.store,n=null!=r.version?r.version.toString():"",o={major:Number.NaN,minor:Number.NaN,versionString:n},i=n.split(".");return i.length>=2&&(o.major=parseInt(i[0],10),o.minor=parseInt(i[1],10)),o},t.prototype.readTitlePortalItem=function(e,t){return"item-title"!==this.sublayerTitleMode?void 0:e},t.prototype.readTitleService=function(e,t){var r=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return g.titleFromUrlAndName(this.url,t.name);var n=t.name||g.parse(this.url).title;return"item-title-and-service-name"===this.sublayerTitleMode&&r&&(n=r+" - "+n),g.cleanTitle(n)},t.prototype.readLayerId=function(e,t){return t.id},Object.defineProperty(t.prototype,"url",{set:function(e){var t=g.sanitizeUrlWithLayerId(this,e,b);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)},enumerable:!0,configurable:!0}),t.prototype.writeUrl=function(e,t){g.writeUrlWithLayerId(this,e,"layers",t)},Object.defineProperty(t.prototype,"parsedUrl",{get:function(){var e=this._get("url");if(!e)return null;var t=u.urlToObject(e);return null!=this.layerId&&g.match.test(t.path)&&(t.path=t.path+"/layers/"+this.layerId),t},enumerable:!0,configurable:!0}),t.prototype.readRootNode=function(e,t){return t.store.rootNode},t.prototype._verifyRootNodeAndUpdateExtent=function(){var e=this;return this._fetchRootNode().then(function(t){return e._updateExtentFromRootNode(t)})},t.prototype._updateExtentFromRootNode=function(e){if(null!=this.fullExtent&&!this.fullExtent.hasZ&&null!=e&&Array.isArray(e.mbs)&&4===e.mbs.length){var t=e.mbs[2],r=e.mbs[3];this.fullExtent.zmin=t-r,this.fullExtent.zmax=t+r}},t.prototype._fetchRootNode=function(){if(!this.rootNode)return l.resolve();var e=u.join(this.parsedUrl.path,this.rootNode);return o(e,{query:{f:"json"},responseType:"json"}).then(function(e){return e.data}).catch(function(t){throw new i("sceneservice:root-node-missing","Root node missing.",{error:t,url:e})})},t.prototype._fetchService=function(){var e=this;return(null==this.layerId&&/SceneServer\/*$/i.test(this.url)?this._fetchFirstLayerId().then(function(t){null!=t&&(e.layerId=t)}):l.resolve()).then(function(){return e._fetchServiceLayer()})},t.prototype._fetchFirstLayerId=function(){return o(this.url,{query:{f:"json"},responseType:"json"}).then(function(e){if(e.data&&Array.isArray(e.data.layers)&&e.data.layers.length>0)return e.data.layers[0].id})},t.prototype._fetchServiceLayer=function(){var e=this;return o(this.parsedUrl.path,{query:{f:"json"},responseType:"json"}).then(function(t){t.ssl&&(e.url=e.url.replace(/^http:/i,"https:"));var r=t.data;e.read(r,{origin:"service",url:e.parsedUrl}),e._validateLayer(r)})},t.prototype._validateLayer=function(e){},n([p.shared({id:{json:{origins:{service:{read:!1},"portal-item":{read:!1}}}}})],t.prototype,"properties",void 0),n([p.property({type:y})],t.prototype,"spatialReference",void 0),n([p.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readSpatialReference",null),n([p.property({type:c})],t.prototype,"fullExtent",void 0),n([p.reader("fullExtent",["store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readFullExtent",null),n([p.property({readOnly:!0,type:d})],t.prototype,"heightModelInfo",void 0),n([p.property({readOnly:!0})],t.prototype,"version",void 0),n([p.reader("version",["store.version"])],t.prototype,"readVersion",null),n([p.property({type:String,json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),n([p.property({type:String})],t.prototype,"sublayerTitleMode",void 0),n([p.property({type:String})],t.prototype,"title",void 0),n([p.reader("portal-item","title")],t.prototype,"readTitlePortalItem",null),n([p.reader("service","title",["name"])],t.prototype,"readTitleService",null),n([p.property({type:Number})],t.prototype,"layerId",void 0),n([p.reader("service","layerId",["id"])],t.prototype,"readLayerId",null),n([p.property()],t.prototype,"url",null),n([p.writer("url")],t.prototype,"writeUrl",null),n([p.property({dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),n([p.property()],t.prototype,"store",void 0),n([p.property({type:String})],t.prototype,"rootNode",void 0),n([p.reader("rootNode",["store.rootNode"])],t.prototype,"readRootNode",null),n([p.subclass("esri.layers.mixins.SceneService")],t)}(p.declared(f,h,a,m,v))}.apply(null,n))||(e.exports=o)},1507:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=null,t.field=null,t.currentRangeExtent=null,t.fullRangeExtent=null,t.type="rangeInfo",t}return r(t,e),n([i.property({type:String,json:{read:!0,write:!0}})],t.prototype,"name",void 0),n([i.property({type:String,json:{read:!0,write:!0}})],t.prototype,"field",void 0),n([i.property({type:[Number],json:{read:!0,write:!0}})],t.prototype,"currentRangeExtent",void 0),n([i.property({type:[Number],json:{read:!0,write:!0}})],t.prototype,"fullRangeExtent",void 0),n([i.property({type:String,readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),n([i.subclass("esri.layers.support.RangeInfo")],t)}(i.declared(o));t.RangeInfo=s,t.default=s}.apply(null,n))||(e.exports=o)},331:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(388),r(383),r(669),r(637),r(350),r(431),r(357),r(341),r(365),r(353),r(347),r(338),r(343),r(428),r(339),r(349),r(336),r(363),r(625),r(362),r(626),r(398),r(671),r(436),r(433),r(432),r(438),r(426),r(394),r(429),r(676),r(652),r(455),r(661),r(588),r(677),r(395),r(447),r(427),r(664),r(459),r(678),r(423),r(635),r(615),r(731),r(361),r(440),r(392),r(419),r(444)],void 0===(o=function(e,t,n,o,i,s,a,l,u,p,c,d,y,f,h,m,v,g,b,w,S,j,_,I,x,O,F,T,E,D,C,V,L,R,N,P,k,A,M,U,q,z,J,B,G,Q,W,H,Y,K,Z,$,X,ee,te,re){function ne(e){return e&&null!=e.applyEdits}function oe(e){return e&&ie(e)}function ie(e){return e&&e.isInstanceOf&&e.isInstanceOf(d)}function se(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}var ae=m({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),le="FeatureLayer",ue=g.getLogger("esri.layers.FeatureLayer");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new f,r.featureReduction=null,r.capabilities=null,r.copyright=null,r.displayField=null,r.definitionExpression=null,r.dynamicDataSource=null,r.editFieldsInfo=null,r.elevationInfo=null,r.fields=null,r.fullExtent=null,r.gdbVersion=null,r.geometryType=null,r.hasM=void 0,r.hasZ=void 0,r.heightModelInfo=null,r.historicMoment=null,r.isTable=!1,r.labelsVisible=!0,r.labelingInfo=null,r.layerId=void 0,r.legendEnabled=!0,r.maxRecordCount=void 0,r.tileMaxRecordCount=void 0,r.minScale=0,r.maxScale=0,r.objectIdField=null,r.operationalLayerType="ArcGISFeatureLayer",r.popupEnabled=!0,r.popupTemplate=null,r.relationships=null,r.returnM=void 0,r.returnZ=void 0,r.screenSizePerspectiveEnabled=!0,r.serviceDefinitionExpression=null,r.spatialReference=x.WGS84,r.templates=null,r.timeInfo=null,r.title=null,r.sublayerTitleMode="item-title",r.trackIdField=null,r.type="feature",r.typeIdField=null,r.types=null,r.indexes=new(d.ofType(P.FeatureIndex)),r.userIsAdmin=!1,r.version=void 0,r.visible=!0,r}return o(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?n({url:e},t):e},t.prototype.load=function(){var e=this;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var t=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]}).always(function(){if(e.url&&null==e.layerId&&/FeatureServer|MapServer\/*$/i.test(e.url))return e._fetchFirstLayerId().then(function(t){null!=t&&(e.layerId=t)})}).then(function(){if(!e.url&&!e._hasMemorySource())throw new y("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return e.createGraphicsSource().then(function(t){return e._initLayerProperties(t)})});return this.addResolvingPromise(t),this.when()}this.addResolvingPromise(this.createGraphicsSource().then(function(t){return e._initLayerProperties(t)}))},Object.defineProperty(t.prototype,"allRenderers",{get:function(){return this._getAllRenderers(this.renderer)},enumerable:!0,configurable:!0}),t.prototype.readCapabilities=function(e,t){return t=t.layerDefinition||t,{data:this._readDataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}},Object.defineProperty(t.prototype,"hasAttachments",{get:function(){return ue.warn("FeatureLayer.hasAttachments is deprecated. Use FeatureLayer.capabilities.data.supportsAttachment instead."),this.hasService&&this._get("hasAttachments")||!1},enumerable:!0,configurable:!0}),t.prototype.readIsTable=function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type},Object.defineProperty(t.prototype,"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!0,configurable:!0}),t.prototype.readMinScale=function(e,t){return t.effectiveMinScale||e||0},t.prototype.readMaxScale=function(e,t){return t.effectiveMaxScale||e||0},t.prototype.readObjectIdFieldFromService=function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields)for(var r=0,n=t.fields;r<n.length;r++){var o=n[r];if("esriFieldTypeOID"===o.type)return o.name}},Object.defineProperty(t.prototype,"outFields",{get:function(){var e=this,t=this._userOutFields,r=this.requiredFields;return t=t&&t.slice(0),r=r&&r.slice(0),t?-1===t.indexOf("*")&&r.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}):t=r,-1!==t.indexOf("*")?t=["*"]:this.loaded&&(t=(t=(t=t.filter(function(t){var r=!!e.getField(t);return t&&!r&&ue.error("[outFields] Invalid field: ",t),r},this)).map(function(t){return e.getField(t).name},this)).filter(function(e,t,r){return r.indexOf(e)===t})),t},set:function(e){var t=this,r=this.requiredFields&&this.requiredFields.slice(0);e?-1===e.indexOf("*")&&r.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}):e=r,this.loaded&&(e=(e=e.filter(function(e){var r="*"===e||!!t.getField(e,t.fields);return e&&!r&&ue.error("[outFields] Invalid field: ",e),r},this)).map(function(e){return"*"===e?e:t.getField(e,t.fields).name},this)),this._userOutFields=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedUrl",{get:function(){var e=this.url?S.urlToObject(this.url):null;if(null!=e)if(null!=this.layerId)e.path=S.join(e.path,this.layerId.toString());else if(null!=this.dynamicDataSource){var t={source:Q.sourceToJSON(this.dynamicDataSource)};e.query={layer:JSON.stringify(t)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{set:function(e){var t=this._getAllRenderers(e);J.fixRendererFields(t,this.fields),this._set("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){var n,o,i=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(i)(n=H.read(i,t,r)||void 0)||ue.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r});else if(t.defaultSymbol)$.read(t.defaultSymbol,t,r),t.types&&t.types.length?(n=new u.UniqueValueRenderer({defaultSymbol:o,field:t.typeIdField}),t.types.forEach(function(e){i.addUniqueValueInfo(e.id,$.read(e.symbol,e,r))})):n=new u.SimpleRenderer({symbol:o});else if("Table"!==t.type){switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":o=new c.SimpleMarkerSymbol;break;case"esriGeometryPolyline":o=new c.SimpleLineSymbol;break;case"esriGeometryPolygon":o=new c.SimpleFillSymbol}n=o&&new u.SimpleRenderer({symbol:o})}return n},t.prototype.writeRenderer=function(e,t,r,n){H.writeTarget(e,t,r,n)},Object.defineProperty(t.prototype,"requiredFields",{get:function(){var e=this.timeInfo,t=[],r=[],n=[this.objectIdField,this.typeIdField,this.editFieldsInfo&&this.editFieldsInfo.creatorField,this.editFieldsInfo&&this.editFieldsInfo.creationDateField,this.editFieldsInfo&&this.editFieldsInfo.editorField,this.editFieldsInfo&&this.editFieldsInfo.editDateField,e&&e.startTimeField,e&&e.endTimeField,this.trackIdField];this.allRenderers.forEach(function(e){t=t.concat(e.requiredFields)}),this.labelingInfo&&this.labelingInfo.length&&this.labelingInfo.forEach(function(e){r=r.concat(e.requiredFields)}),r=r.map(function(e){return e.replace(/['"]+/g,"")}),n=(n=n.concat(t)).concat(r);var o=this.elevationInfo&&this.elevationInfo.featureExpressionInfo;return o&&(n=n.concat(o.requiredFields)),this.popupTemplate&&(n=n.concat(this.popupTemplate.requiredFields)),n.filter(function(e,t,r){return!!e&&r.indexOf(e)===t&&"function"!=typeof e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{set:function(e){var t=this._get("source");t!==e&&(oe(t)&&this._resetMemorySource(t),oe(e)&&this._initMemorySource(e),this._set("source",e))},enumerable:!0,configurable:!0}),t.prototype.castSource=function(e){return e?Array.isArray(e)||ie(e)?new T.default({layer:this,items:e}):e:null},t.prototype.readSource=function(e,t){var r=ee.fromJSON(t.featureSet);return new T.default({layer:this,items:r&&r.features||[]})},t.prototype.readTemplates=function(e,t){var r=t.editFieldsInfo,n=r&&r.creatorField,o=r&&r.editorField;return e=e&&e.map(function(e){return U.fromJSON(e)}),this._fixTemplates(e,n),this._fixTemplates(e,o),e},t.prototype.readTitle=function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,n=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var o=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?R.titleFromUrlAndName(this.url,r):r;var i=r||this.url&&R.parse(this.url).title;if(!i)return;return"item-title-and-service-name"===this.sublayerTitleMode&&o&&(i=o+" - "+i),R.cleanTitle(i)}if("item-title"===this.sublayerTitleMode&&n)return n},t.prototype.readTitleFromWebMap=function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name},t.prototype.readTypeIdField=function(e,t){if(e=(t=t.layerDefinition||t).typeIdField){var r=this.getField(e,t.fields);r&&(e=r.name)}return e},t.prototype.readTypes=function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var n=t.editFieldsInfo,o=n&&n.creatorField,i=n&&n.editorField;return e&&e.map(function(e){return e=q.fromJSON(e),r._fixTemplates(e.templates,o),r._fixTemplates(e.templates,i),e})},Object.defineProperty(t.prototype,"url",{set:function(e){var t=R.sanitizeUrlWithLayerId(this,e,ue);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)},enumerable:!0,configurable:!0}),t.prototype.writeUrl=function(e,t,r,n){R.writeUrlWithLayerId(this,e,t)},t.prototype.readVersion=function(e,t){return(t=t.layerDefinition||t).currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3},t.prototype.readVisible=function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0},t.prototype.addAttachment=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"addAttachment"in r.source?r.source.addAttachment(e,t):w.reject(new y(le,"Layer source does not support addAttachment capability"))})},t.prototype.updateAttachment=function(e,t,r){var n=this;return this.load().then(function(){return n._checkAttachmentSupport(e)}).then(function(){return"updateAttachment"in n.source?n.source.updateAttachment(e,t,r):w.reject(new y(le,"Layer source does not support updateAttachment capability"))})},t.prototype.applyEdits=function(e){var t,r,n=this,o={edits:e,result:w.create(function(e,n){t=e,r=n})};return this.emit("apply-edits",o),this.load().then(function(){return ne(n.source)?n._processApplyEditsParams(e):w.reject(new y(le,"Layer source does not support applyEdits capability"))}).then(function(e){if(ne(n.source))return n.source.applyEdits(e).then(function(e){var r=function(e){return e.filter(function(e){return!e.error}).map(v.clone)},o={addedFeatures:r(e.addFeatureResults),updatedFeatures:r(e.updateFeatureResults),deletedFeatures:r(e.deleteFeatureResults)};return(o.addedFeatures.length||o.updatedFeatures.length||o.deletedFeatures.length)&&n.emit("edits",o),t(o),e})}).catch(function(e){throw r(e),e})},t.prototype.on=function(e,t){return this.inherited(arguments)},t.prototype.createGraphicsSource=function(){var e=this;return this._hasMemorySource()?(this.emit("graphics-source-create",{graphicsSource:this.source}),this.source.load()):w.create(function(e){return r.e(85).then(function(){var t=[r(810)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(t){return new t.default({layer:e}).load()}).then(function(t){return e.emit("graphics-source-create",{graphicsSource:t}),t})},t.prototype.createGraphicsController=function(e){var t=this,o=e.layerView,i=d.ofType(a),s=this.source,l=oe(s),u=n({},e.options,{layer:this,layerView:o,graphics:l?s:new i});return(l?w.create(function(e){return r.e(47).then(function(){var t=[r(789)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"2d"===o.view.type?w.create(function(e){return r.e(84).then(function(){var t=[r(811)];e.apply(null,t)}.bind(this)).catch(r.oe)}):w.create(function(e){return r.e(18).then(function(){var t=[r(778)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return new e(u)}).then(function(e){return t.emit("graphics-controller-create",{graphicsController:e}),e.when()})},t.prototype.createQuery=function(){var e=new te,t=this.get("capabilities.data");return e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=this.outFields,e.where=this.definitionExpression||"1=1",e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e},t.prototype.deleteAttachments=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"deleteAttachments"in r.source?r.source.deleteAttachments(e,t):w.reject(new y(le,"Layer source does not support deleteAttachments capability"))})},t.prototype.getFeatureType=function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var n=e.attributes?e.attributes[t]:void 0;if(null==n)return null;var o=null;return r.some(function(e){var t=e.id;return null!=t&&(t.toString()===n.toString()&&(o=e),!!o)}),o},t.prototype.getFieldDomain=function(e,t){var r,n=this,o=!1,i=t&&t.feature,s=i&&i.attributes,a=this.typeIdField&&s&&s[this.typeIdField];return null!=a&&this.types&&(o=this.types.some(function(t){return t.id==a&&((r=t.domains&&t.domains[e])&&"inherited"===r.type&&(r=n._getLayerDomain(e)),!0)})),o||r||(r=this._getLayerDomain(e)),r},t.prototype.getField=function(e,t){var r=this.processing?this.fields.concat(this.processing.fields):this.fields;return J.getField(e,t||r)},t.prototype.graphicChanged=function(e){this.emit("graphic-update",e)},t.prototype.queryAttachments=function(e){var t=this;return this.load().then(function(){if(!t.get("capabilities.data.supportsAttachment"))return w.reject(new y(le,"this layer doesn't support attachments"));var r=e.attachmentTypes,n=e.objectIds,o=e.globalIds,i=e.num,s=e.size,a=e.start,l=e.definitionExpression;if(!t.get("capabilities.query.supportsAttachments")){var u=n&&n.length>1,p=r&&r.length,c=o&&o.length,d=s&&s.length;if(u||p||c||d||i||a||l)return w.reject(new y(le,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e))}return n&&n.length||l?"queryAttachments"in t.source?t.source.queryAttachments(e):w.reject(new y(le,"Layer source does not support queryAttachments capability",e)):w.reject(new y(le,"objectIds or definitionExpression are required to perform attachment query",e))})},t.prototype.queryFeatures=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatures(e||r.createQuery(),t)}).then(function(e){if(e&&e.features)for(var t=0,n=e.features;t<n.length;t++){var o=n[t];o.layer=o.sourceLayer=r}return e})},t.prototype.queryFeaturesJSON=function(e,t){var r=this;return this.load().then(function(){if(!r.source.queryFeaturesJSON)return w.reject(new y(le,"Layer source does not support queryFeaturesJSON capability"))}).then(function(){return r.source.queryFeaturesJSON(e||r.createQuery(),t)})},t.prototype.queryObjectIds=function(e,t){var r=this;return this.load().then(function(){return r.source.queryObjectIds?r.source.queryObjectIds(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryObjectIds capability"))})},t.prototype.queryFeatureCount=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatureCount?r.source.queryFeatureCount(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryFeatureCount capability"))})},t.prototype.queryExtent=function(e,t){var r=this;return this.load().then(function(){return r.source.queryExtent?r.source.queryExtent(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryExtent capability"))})},t.prototype.queryRelatedFeatures=function(e){var t=this;return this.load().then(function(){return"queryRelatedFeatures"in t.source?t.source.queryRelatedFeatures(e):w.reject(new y(le,"Layer source does not support queryRelatedFeatures capability"))})},t.prototype.read=function(e,t){var r=e.featureCollection;if(r){var n=r.layers;n&&1===n.length&&(this.inherited(arguments,[n[0],t]),null!=r.showLegend&&this.inherited(arguments,[{showLegend:r.showLegend},t]))}return this.inherited(arguments,[e,t]),this},t.prototype.write=function(e,t){if(t&&"web-scene"===t.origin&&t.messages){if(!this.url)return t.messages.push(new y("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' require a url to a service to be written to web scenes",{layer:this})),null;if(this.isTable)return t.messages.push(new y("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes",{layer:this})),null}return this.inherited(arguments)},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return h("esri-featurelayer-webgl")&&h("esri-webgl")?w.create(function(e){return r.e(32).then(function(){var t=[r(790)];e.apply(null,t)}.bind(this)).catch(r.oe)}):w.create(function(e){return Promise.all([r.e(9),r.e(15),r.e(38)]).then(function(){var t=[r(791)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return w.create(function(e){return Promise.all([r.e(4),r.e(6),r.e(8),r.e(7),r.e(60)]).then(function(){var t=[r(812)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._checkAttachmentSupport=function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:w.reject(new y(le,"feature is missing the identifying attribute "+r)):w.reject(new y(le,"'attributes' are required on a feature to query attachments")):w.reject(new y(le,"A feature is required to add/delete/update attachments")):w.reject(new y(le,"this layer doesn't support attachments"))},t.prototype._getLayerDomain=function(e){if(!this.fields)return null;var t=null;return this.fields.some(function(r){return r.name===e&&(t=r.domain),!!t}),t},t.prototype._fetchFirstLayerId=function(){return p(this.url,{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;if(t&&Array.isArray(t.layers)&&t.layers.length>0)return t.layers[0].id})},t.prototype._initLayerProperties=function(e){return this._set("source",e),e.layerDefinition&&this.read(e.layerDefinition,{origin:"service",url:this.parsedUrl}),this._verifySource(),this._verifyFields(),J.fixRendererFields(this._getAllRenderers(this.renderer),this.fields),Y.loadStyleRenderer(this,{origin:"service"})},t.prototype._getAllRenderers=function(e){if(!e)return[];var t=[];return[e,e.trackRenderer,e.observationRenderer,e.latestObservationRenderer].forEach(function(e){e&&(t.push(e),e.rendererInfos&&e.rendererInfos.forEach(function(e){e.renderer&&t.push(e.renderer)}))}),t},t.prototype._verifyFields=function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(function(e){return"geometry"===e.type})||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")},t.prototype._fixTemplates=function(e,t){e&&e.forEach(function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]})},t.prototype._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new y("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else{if(this.isTable)throw new y("feature-layer:source-type-not-supported","The table feature service type is not yet supported",{sourceType:"Table"});if(!this.url)throw new y("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}},t.prototype._initMemorySource=function(e){var t=this;e.forEach(function(e){e.layer=t,e.sourceLayer=t}),this._handles.add([e.on("after-add",function(e){e.item.layer=t,e.item.sourceLayer=t}),e.on("after-remove",function(e){e.item.layer=null,e.item.sourceLayer=null})],"fl-source")},t.prototype._resetMemorySource=function(e){e.forEach(function(e){e.layer=null,e.sourceLayer=null}),this._handles.remove("fl-source")},t.prototype._hasMemorySource=function(){return!(this.url||!this.source)},t.prototype._readDataCapabilities=function(e){return{supportsAttachment:se(e,"hasAttachments",!1),supportsM:se(e,"hasM",!1),supportsZ:se(e,"hasZ",!1)}},t.prototype._readOperationsCapabilities=function(e,t){var r=e?e.toLowerCase().split(",").map(function(e){return e.trim()}):[],n=-1!==r.indexOf("editing"),o=n&&-1!==r.indexOf("create"),i=n&&-1!==r.indexOf("delete"),s=n&&-1!==r.indexOf("update");return n&&!(o||i||s)&&(o=i=s=!0),{supportsCalculate:se(t,"supportsCalculate",!1),supportsTruncate:se(t,"supportsTruncate",!1),supportsValidateSql:se(t,"supportsValidateSql",!1),supportsAdd:o,supportsDelete:i,supportsEditing:n,supportsQuery:-1!==r.indexOf("query"),supportsResizeAttachments:se(t,"supportsAttachmentsResizing",!1),supportsUpdate:s}},t.prototype._readQueryCapabilities=function(e){var t=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,o=(e.supportedQueryFormats||"").split(",").reduce(function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e},new Set);return{supportsAttachments:se(t,"supportsQueryAttachments",!1),supportsStatistics:se(t,"supportsStatistics",e.supportsStatistics),supportsCentroid:se(t,"supportsReturningGeometryCentroid",!1),supportsDistance:se(t,"supportsQueryWithDistance",!1),supportsDistinct:se(t,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:se(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:se(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:se(t,"supportsHavingClause",!1),supportsOrderBy:se(t,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:se(t,"supportsPagination",!1),supportsQuantization:se(e,"supportsCoordinatesQuantization",!1),supportsResultType:se(t,"supportsQueryWithResultType",!1),supportsSqlExpression:se(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:se(e,"useStandardizedQueries",!1),supportsQueryByOthers:se(r,"allowOthersToQuery",!0),supportsHistoricMoment:se(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:o.has("pbf")}},t.prototype._readQueryRelatedCapabilities=function(e){var t=e.advancedQueryCapabilities,r=se(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:se(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}},t.prototype._readEditingCapabilities=function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:se(e,"allowGeometryUpdates",!0),supportsGlobalId:se(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:se(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:se(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:se(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:se(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:se(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:se(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:se(t,"allowOthersToUpdate",!0)}},t.prototype._processApplyEditsParams=function(e){var t="'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required",r="feature-layer:missing-parameters";if(!e)return w.reject(new y(r,t));if((e=n({},e)).addFeatures=e.addFeatures||[],e.updateFeatures=e.updateFeatures||[],e.deleteFeatures=e.deleteFeatures||[],e.addFeatures.length||e.updateFeatures.length||e.deleteFeatures.length){var o=function(e){var t=new a;return t.geometry=e.geometry,t.attributes=e.attributes,t};return e.addFeatures=e.addFeatures.map(o),e.updateFeatures=e.updateFeatures.map(o),this._normalizeGeometries(e)}return w.reject(new y(r,t))},t.prototype._normalizeGeometries=function(e){var t=e.addFeatures,r=e.updateFeatures,n=t.concat(r).map(function(e){return e.geometry});return O.normalizeCentralMeridian(n).then(function(n){var o=t.length,i=r.length;return n.slice(0,o).forEach(function(t,r){e.addFeatures[r].geometry=t}),n.slice(o,o+i).forEach(function(t,r){e.updateFeatures[r].geometry=t}),e})},i([j.property({types:{key:"type",base:A.default,typeMap:{selection:M.default}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],t.prototype,"featureReduction",void 0),i([j.property({readOnly:!0,dependsOn:["loaded","renderer","fields"]})],t.prototype,"allRenderers",null),i([j.property({readOnly:!0})],t.prototype,"capabilities",void 0),i([j.reader("service","capabilities",["advancedQueryCapabilities","archivingInfo","supportsStatistics","supportsAdvancedQueries","hasAttachments","hasM","hasZ","supportsAttachmentsResizing","supportsCalculate","supportsTruncate","supportsValidateSql","supportsCoordinatesQuantization","useStandardizedQueries","ownershipBasedAccessControlForFeatures","allowGeometryUpdates","supportsApplyEditsWithGlobalIds","supportsRollbackOnFailureParameter","allowUpdateWithoutMValues","supportsAttachmentsByUploadId","capabilities","supportedQueryFormats"])],t.prototype,"readCapabilities",null),i([j.property({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),i([j.property({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),i([j.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),i([j.property({readOnly:!0,json:{read:$.read}})],t.prototype,"defaultSymbol",void 0),i([j.property()],t.prototype,"dynamicDataSource",void 0),i([j.property({readOnly:!0})],t.prototype,"editFieldsInfo",void 0),i([j.property({type:Z,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],t.prototype,"elevationInfo",void 0),i([j.property({type:[z],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}})],t.prototype,"fields",void 0),i([j.property({type:_,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],t.prototype,"fullExtent",void 0),i([j.property()],t.prototype,"gdbVersion",void 0),i([j.property({json:{origins:{service:{read:ae.read}},read:{source:"layerDefinition.geometryType",reader:ae.read}}})],t.prototype,"geometryType",void 0),i([j.property({readOnly:!0,dependsOn:["loaded"],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasAttachments"}}})],t.prototype,"hasAttachments",null),i([j.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],t.prototype,"hasM",void 0),i([j.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],t.prototype,"hasZ",void 0),i([j.property({readOnly:!0,type:I})],t.prototype,"heightModelInfo",void 0),i([j.property({type:Date})],t.prototype,"historicMoment",void 0),i([j.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),i([j.property({readOnly:!0})],t.prototype,"isTable",void 0),i([j.reader("service","isTable",["type"]),j.reader("isTable",["layerDefinition.type"])],t.prototype,"readIsTable",null),i([j.property({dependsOn:["loaded","url","source"],readOnly:!0})],t.prototype,"hasService",null),i([j.property(N.labelsVisible)],t.prototype,"labelsVisible",void 0),i([j.property({type:[B],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:G.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:G.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",void 0),i([j.property({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],t.prototype,"layerId",void 0),i([j.property({type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),i([j.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.maxRecordCount"}}})],t.prototype,"maxRecordCount",void 0),i([j.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.tileMaxRecordCount"}}})],t.prototype,"tileMaxRecordCount",void 0),i([j.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],t.prototype,"minScale",void 0),i([j.reader("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),i([j.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],t.prototype,"maxScale",void 0),i([j.reader("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),i([j.property({type:String})],t.prototype,"objectIdField",void 0),i([j.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),j.reader("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),i([j.property()],t.prototype,"operationalLayerType",void 0),i([j.property({dependsOn:["requiredFields"]})],t.prototype,"outFields",null),i([j.property({readOnly:!0,dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),i([j.property(N.popupEnabled)],t.prototype,"popupEnabled",void 0),i([j.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),i([j.property({type:k})],t.prototype,"processing",void 0),i([j.property({type:[W],readOnly:!0})],t.prototype,"relationships",void 0),i([j.property({types:K.types,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",null),i([j.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),j.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],t.prototype,"readRenderer",null),i([j.writer("renderer")],t.prototype,"writeRenderer",null),i([j.property({readOnly:!0,dependsOn:["allRenderers","labelingInfo","elevationInfo.featureExpressionInfo","popupTemplate.requiredFields"]})],t.prototype,"requiredFields",null),i([j.property({type:Boolean})],t.prototype,"returnM",void 0),i([j.property({type:Boolean})],t.prototype,"returnZ",void 0),i([j.property(N.screenSizePerspectiveEnabled)],t.prototype,"screenSizePerspectiveEnabled",void 0),i([j.property()],t.prototype,"source",null),i([j.cast("source")],t.prototype,"castSource",null),i([j.reader("portal-item","source",["featureSet"]),j.reader("web-map","source",["featureSet"])],t.prototype,"readSource",null),i([j.property({readOnly:!0,json:{origins:{service:{read:{source:"definitionExpression"}}}}})],t.prototype,"serviceDefinitionExpression",void 0),i([j.property({type:x,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],t.prototype,"spatialReference",void 0),i([j.property({type:[U]})],t.prototype,"templates",void 0),i([j.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],t.prototype,"readTemplates",null),i([j.property()],t.prototype,"timeInfo",void 0),i([j.property()],t.prototype,"title",void 0),i([j.reader("service","title",["name"]),j.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],t.prototype,"readTitle",null),i([j.reader("web-map","title",["layerDefinition.name","title"])],t.prototype,"readTitleFromWebMap",null),i([j.property({type:String})],t.prototype,"sublayerTitleMode",void 0),i([j.property({type:String,readOnly:!0,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),i([j.property({json:{read:!1}})],t.prototype,"type",void 0),i([j.property({type:String,readOnly:!0})],t.prototype,"typeIdField",void 0),i([j.reader("service","typeIdField"),j.reader("typeIdField",["layerDefinition.typeIdField"])],t.prototype,"readTypeIdField",null),i([j.property({type:[q]})],t.prototype,"types",void 0),i([j.reader("service","types",["types"]),j.reader("types",["layerDefinition.types"])],t.prototype,"readTypes",null),i([j.property({type:d.ofType(P.FeatureIndex),readOnly:!0})],t.prototype,"indexes",void 0),i([j.property({type:String})],t.prototype,"url",null),i([j.writer("url")],t.prototype,"writeUrl",null),i([j.property({readOnly:!0})],t.prototype,"userIsAdmin",void 0),i([j.property({json:{origins:{"portal-item":{read:!1}}}})],t.prototype,"version",void 0),i([j.reader("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"]),j.reader("version",["layerDefinition.currentVersion","layerDefinition.capabilities","layerDefinition.drawingInfo","layerDefinition.hasAttachments","layerDefinition.htmlPopupType","layerDefinition.typeIdField","layerDefinition.types"])],t.prototype,"readVersion",null),i([j.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],t.prototype,"visible",void 0),i([j.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],t.prototype,"readVisible",null),i([s(0,j.cast(X))],t.prototype,"queryAttachments",null),i([s(0,j.cast(te))],t.prototype,"queryFeatures",null),i([s(0,j.cast(te))],t.prototype,"queryFeaturesJSON",null),i([s(0,j.cast(te))],t.prototype,"queryObjectIds",null),i([s(0,j.cast(te))],t.prototype,"queryFeatureCount",null),i([s(0,j.cast(te))],t.prototype,"queryExtent",null),i([s(0,j.cast(re))],t.prototype,"queryRelatedFeatures",null),i([j.subclass("esri.layers.FeatureLayer")],t)}(j.declared(F,D,C,L,V,E,b))}.apply(null,n))||(e.exports=o)},354:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){function r(e){return e?72*e/t.DPI:0}Object.defineProperty(t,"__esModule",{value:!0});var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,o="screenUtils.toPt: input not recognized!";t.DPI=96,t.pt2px=function(e){return e?e/72*t.DPI:0},t.px2pt=r,t.toPt=function(e){if("string"==typeof e){if(n.test(e)){var t=e.match(n),i=Number(t[1]),s=t[3]&&t[3].toLowerCase(),a="-"===e.charAt(0),l="px"===s?r(i):i;return a?-l:l}return console.warn(o),null}return e}}.apply(null,n))||(e.exports=o)},370:function(e,t,r){var n,o;n=[r(351),r(346),r(340),r(347),r(354),r(338),r(341),r(391),r(712),r(358),r(720),r(641)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c){var d="size",y=n({sizeInfo:d,colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),f=n({widthAndDepth:"width-and-depth"}),h=n({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),m=n({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap"},{ignoreUnknown:!0}),v=Math.PI,g=l.opacityToTransparency,b=l.transparencyToOpacity;return e([t,r],{declaredClass:"esri.renderers.Renderer",properties:{authoringInfo:{type:c,value:null,json:{write:!0}},requiredFields:{dependsOn:["visualVariables"],get:function(){var e=Object.create(null);return this.collectRequiredFields(e),Object.keys(e).sort()}},type:{type:m.apiValues,readOnly:!0,json:{type:m.jsonValues,read:!1,write:{writer:m.write,ignoreOrigin:!0}}},visualVariables:{json:{read:{source:["visualVariables","rotationType","rotationExpression"],reader:function(e,t){return this._readVariables(e,t)}},write:function(e,t,r,n){var o=[];e.forEach(function(e,t){e.type===d?o.push(this._writeSizeInfo(e,n,t)):"color"===e.type?o.push(this._writeColorInfo(e,n,t)):"opacity"===e.type?o.push(this._writeOpacityInfo(e,n,t)):"rotation"===e.type&&o.push(this._writeRotationInfo(e,n,t))},this),t.visualVariables=o}}}},constructor:function(){this._cache={}},_rotationRE:/^\[([^\]]+)\]$/i,_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_visualVariablesSetter:function(e){var t=this._cache;this.visualVariables&&this.visualVariables.forEach(function(e,r){t.hasOwnProperty(r)&&(t[r]=null)},this),e&&e.some(function(e){return!!e.target})&&e.sort(function(e,t){return e.target===t.target?0:e.target?1:-1}),e&&e.forEach(function(e,r){"color"===e.type?t[r]=this._processColorInfo(e):"opacity"===e.type?t[r]=this._processOpacityInfo(e):e.type===d?t[r]=this._processSizeInfo(e):"rotation"===e.type&&(t[r]=this._processRotationInfo(e))},this),this._set("visualVariables",e)},getSymbol:function(e,t){},getVisualVariableValues:function(e,t){var r,n=this.visualVariables;return n&&(r=n.map(function(r){var n,o=r.type,s=o+"Info";switch((t=i.mixin({},t))[s]=r,o){case d:n=this.getSize(e,t);break;case"color":n=this.getColor(e,t);break;case"opacity":n=this.getOpacity(e,t);break;case"rotation":n=this.getRotationAngle(e,t)}return{variable:r,value:n}},this).filter(function(e){return null!=e.value},this)),r},hasVisualVariables:function(e,t){return e?!!this.getVisualVariablesForType(e,t):!!(this.getVisualVariablesForType(d,t)||this.getVisualVariablesForType("color",t)||this.getVisualVariablesForType("opacity",t)||this.getVisualVariablesForType("rotation",t))},getVisualVariablesForType:function(e,t){var r,n=this.visualVariables;return n&&(r=n.filter(function(r){return r.type===e&&("string"==typeof t?r.target===t:!1!==t||!r.target)}))&&0===r.length&&(r=void 0),r},getSize:function(e,t){var r=this._getVarInfo(t&&t.sizeInfo,d),n=r.variable,o=this._cache[r.cacheKey],i=null;if(n){var s=n.minSize,a=n.maxSize,l="object"==typeof s&&s?this._getSize(e,s,o&&o.minSize,t):s,u="object"==typeof a&&a?this._getSize(e,a,o&&o.maxSize,t):a;i=this._getSize(e,n,o&&o.root,t,[l,u])}return i},getSizeRangeAtScale:function(e,t){var r,n=this._getVarInfo(e,d),o=this._cache[n.cacheKey],i={scale:t};if((e=n.variable)&&t){var s=e.minSize,a=e.maxSize,l="object"==typeof s&&s?this._getSize({},s,o&&o.minSize,i):s,u="object"==typeof a&&a?this._getSize({},a,o&&o.maxSize,i):a;if(null!=l||null!=u){if(l>u){var p=u;u=l,l=p}r={minSize:l,maxSize:u}}}return r},getColor:function(e,t){var r=this._getVarInfo(t&&t.colorInfo,"color");return this._getColorComponent(e,r.variable,this._cache[r.cacheKey],t,!1)},getOpacity:function(e,t){var r=this._getVarInfo(t&&t.opacityInfo,"opacity");return this._getColorComponent(e,r.variable,this._cache[r.cacheKey],t,!0)},getRotationAngle:function(e,t){var r=this._getVarInfo(t&&t.rotationInfo,"rotation"),n=r.variable,o=this._cache[r.cacheKey],i=n.axis||"heading",s="heading"===i&&"arithmetic"===n.rotationType?90:0,l="heading"===i&&"arithmetic"===n.rotationType?-1:1,u=n.field,p=o&&o.compiledFunc,c=e.attributes,d=0;return(u||p)&&(p?d=a.executeFunction(p,a.createExecContext(e,a.getViewInfo(t))):"function"==typeof u?d=u.apply(this,arguments):c&&(d=c[u]||0),d="number"!=typeof d||isNaN(d)?null:s+l*d),d},collectRequiredFields:function(e){var t=[];this.visualVariables&&(t=t.concat(this.visualVariables)),t.forEach(function(t){t&&(t.field&&(e[t.field]=!0),t.normalizationField&&(e[t.normalizationField]=!0),t.valueExpression&&a.extractFieldNames(t.valueExpression).forEach(function(t){e[t]=!0}))})},_getVarInfo:function(e,t){var r;if(e&&e.type===t&&this.visualVariables)r=this.visualVariables.indexOf(e),e=this.visualVariables[r];else if(this.visualVariables){var n=this.getVisualVariablesForType(t);e=n&&n[0],r=this.visualVariables.indexOf(e)}return{variable:e,cacheKey:r}},_readSizeInfo:function(e){return e.axis&&(e.axis=f.fromJSON(e.axis)),e.valueUnit&&(e.valueUnit=h.fromJSON(e.valueUnit)),e},_readColorInfo:function(e){return e&&(e.colors&&e.colors.forEach(function(t,r){Array.isArray(t)?e.colors[r]=u.fromJSON(t):e.colors[r]=new u(t)}),e.stops&&e.stops.forEach(function(t,r){t.color&&Array.isArray(t.color)?e.stops[r].color=u.fromJSON(t.color):t.color&&(e.stops[r].color=new u(t.color))})),e},_readOpacityInfo:function(e){var t;return e&&((t=i.mixin({},e)).transparencyValues&&(t.opacityValues=t.transparencyValues.map(b),delete t.transparencyValues),t.stops&&(t.stops=t.stops.map(function(e){return(e=i.mixin({},e)).opacity=b(e.transparency),delete e.transparency,e}))),t},_readVariables:function(e,t){e&&(e=e.map(function(e){return(e=i.clone(e)).type=y.fromJSON(e.type),e.type===d?e=this._readSizeInfo(e):"color"===e.type?e=this._readColorInfo(e):"opacity"===e.type&&(e=this._readOpacityInfo(e)),e},this));var r=t.rotationType,n=t.rotationExpression;if(n){var o={type:"rotation",rotationType:r},s=n.match(this._rotationRE);s&&s[1]&&(o.field=s[1],e||(e=[]),e.push(o))}return e},_createCache:function(e){var t=e&&e.valueExpression,r=a.createSyntaxTree(t),n=a.createFunction(r),o=!(!e||!e.expression)||this._viewScaleRE.test(t);return{ipData:this._interpolateData(e),hasExpr:!!t,compiledFunc:n,isScaleDriven:o}},_processColorInfo:function(e){return e&&(e.colors&&e.colors.forEach(function(t,r){t instanceof u||(e.colors[r]=new u(t))}),e.stops&&e.stops.forEach(function(t,r){!t.color||t.color instanceof u||(e.stops[r].color=new u(t.color))}),this._sortStops(e.stops)),this._createCache(e)},_processOpacityInfo:function(e){return this._sortStops(e&&e.stops),this._createCache(e)},_processSizeInfo:function(e){return e.stops&&Array.isArray(e.stops)?e.stops=this._processSizeInfoStops(e.stops):(e.minSize=e.minSize&&this._processSizeInfoSize(e.minSize),e.maxSize=e.maxSize&&this._processSizeInfoSize(e.maxSize)),{root:this._createCache(e),minSize:this._createCache(e.minSize),maxSize:this._createCache(e.maxSize)}},_processSizeInfoSize:function(e){return"object"==typeof e?e.stops=this._processSizeInfoStops(e.stops):e=o.toPt(e),e},_processSizeInfoStops:function(e){return e&&Array.isArray(e)&&(e.forEach(function(e){e.size=o.toPt(e.size)}),this._sortStops(e)),e},_sortStops:function(e){e&&Array.isArray(e)&&e.sort(function(e,t){return e.value-t.value})},_processRotationInfo:function(e){return this._createCache(e)},_getSize:function(e,t,r,n,o){var i=e.attributes,s=t.field,l=t.stops,u=0,c=r&&r.hasExpr,d=r&&r.compiledFunc,y=r&&r.ipData,f=r&&r.isScaleDriven,h="number"==typeof e,m=h?e:null;if(s||f||c){var g,b=n&&n.scale,w=o?o[0]:t.minSize,S=o?o[1]:t.maxSize,j=t.minDataValue,_=t.maxDataValue,I=t.valueUnit||"unknown",x=t.valueRepresentation,O=t.scaleBy,F=t.normalizationField,T=i?parseFloat(i[F]):void 0,E=n&&n.shape;if(f?m=null==b?this._getAverageValue(t):b:"number"!=typeof m&&(c?m=a.executeFunction(d,a.createExecContext(e,a.getViewInfo(n))):"function"==typeof s?m=s.apply(this,arguments):i&&(m=i[s])),null==m||F&&!h&&(isNaN(T)||0===T))return null;if(isNaN(T)||h||(m/=T),l){var D,C=this._lookupData(m,y),V=C[0],L=C[1];V===L?u=l[V].size:u=(D=l[V].size)+(l[L].size-D)*C[2]}else if(null!=w&&null!=S&&null!=j&&null!=_)if(m<=j)u=w;else if(m>=_)u=S;else if(g=(m-j)/(_-j),"area"===O&&E){var R="circle"===E,N=R?v*Math.pow(w/2,2):w*w,P=N+g*((R?v*Math.pow(S/2,2):S*S)-N);u=R?2*Math.sqrt(P/v):Math.sqrt(P)}else u=w+g*(S-w);else if("unknown"===I)null!=w&&null!=j?(w&&j?(g=m/j,u="circle"===E?2*Math.sqrt(g*Math.pow(w/2,2)):"square"===E||"diamond"===E||"image"===E?Math.sqrt(g*Math.pow(w,2)):g*w):u=m+(w||j),u=u<w?w:u,null!=S&&u>S&&(u=S)):u=m;else{var k=(n&&n.resolution?n.resolution:1)*p.meterIn[I];"area"===x?(u=Math.sqrt(m/v)/k,u*=2):(u=m/k,"radius"!==x&&"distance"!==x||(u*=2)),null!=w&&u<w&&(u=w),null!=S&&u>S&&(u=S)}}else t&&null==(u=l&&l[0]&&l[0].size)&&(u=t.minSize);return isNaN(u)?0:u},_getAverageValue:function(e){var t,r,n=e.stops;return n?(t=n[0].value,r=n[n.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2},_getColorComponent:function(e,t,r,n,o){var i,s=e.attributes,l=t&&t.field,u="number"==typeof e,p=u?e:null,c=r&&r.hasExpr,d=r&&r.compiledFunc,y=r&&r.ipData;if(l||c){var f=t.normalizationField,h=s&&f?parseFloat(s[f]):void 0;"number"!=typeof p&&(c?p=a.executeFunction(d,a.createExecContext(e,a.getViewInfo(n))):"function"==typeof l?p=l.apply(this,arguments):s&&(p=s[l])),null==p||f&&!u&&(isNaN(h)||0===h)||(isNaN(h)||u||(p/=h),i=o?this._getOpacity(p,t,y):this._getColor(p,t,y,n&&n.color))}else if(t){var m=t.stops;o?null==(i=m&&m[0]&&m[0].opacity)&&(i=t.opacityValues&&t.opacityValues[0]):i=m&&m[0]&&m[0].color||t.colors&&t.colors[0]}return i},_interpolateData:function(e){var t;if(e)if(e.colors||e.opacityValues){var r,n=(e.colors||e.opacityValues).length,o=e.minDataValue,i=(e.maxDataValue-o)/(n-1);for(t=[],r=0;r<n;r++)t[r]=o+r*i}else e.stops&&(t=e.stops.map(function(e){return e.value||0}));return t},_getOpacity:function(e,t,r){var n,o=this._lookupData(e,r);if(t=t||this.opacityInfo,o){var i,s=o[0],a=o[1];s===a?n=this._getOpacValue(t,s):n=(i=this._getOpacValue(t,s))+(this._getOpacValue(t,a)-i)*o[2]}return n},_getOpacValue:function(e,t){return e.opacityValues?e.opacityValues[t]:e.stops[t].opacity},_getColor:function(e,t,r,n){var o=this._lookupData(e,r);if(t=t||this.colorInfo,o){var i=o[0],s=o[1];return n=n||new u,i===s?n.setColor(this._getColorObj(t,i)):u.blendColors(this._getColorObj(t,i),this._getColorObj(t,s),o[2],n),n}},_getColorObj:function(e,t){return e.colors?e.colors[t]:e.stops[t].color},_lookupData:function(e,t){var r;if(t){var n=0,o=t.length-1;t.some(function(t,r){return e<t?(o=r,!0):(n=r,!1)}),r=[n,o,(e-t[n])/(t[o]-t[n])]}return r},_processForContext:function(e,t,r){if(t&&"web-scene"===t.origin){var n=null!=e.expression,o=null!=e.valueExpressionTitle&&"rotation"===e.type;t.messages&&(n&&t.messages.push(new s("property:unsupported",e.type+"VisualVariable.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".expression",context:t})),o&&t.messages.push(new s("property:unsupported",e.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".valueExpressionTitle",context:t}))),n&&delete e.expression,o&&delete e.valueExpressionTitle}else e.type===d&&this._convertExpressionToArcade(e)},_writeRotationInfo:function(e,t,r){return e&&(e=i.mixin({},e),this._processForContext(e,t,"visualVariables["+r+"]"),e.type=y.toJSON(e.type),e=i.fixJson(e,!0)),e},_convertExpressionToArcade:function(e){e&&e.expression&&(e.valueExpression="$view.scale")},_writeSizeInfo:function(e,t,r){if(e){e=i.mixin({},e),this._processForContext(e,t,"string"==typeof r?r:"visualVariables["+r+"]");var n=e.minSize,o=e.maxSize;n&&(e.minSize="number"==typeof n?n:this._writeSizeInfo(n,t,"visualVariables["+r+"].minSize")),o&&(e.maxSize="number"==typeof o?o:this._writeSizeInfo(o,t,"visualVariables["+r+"].maxSize"));var s=e.legendOptions,a=e.type,l=e.axis;e.type=y.toJSON(a),l&&(e.axis=f.toJSON(l)),s&&(e.legendOptions=i.mixin({},s),(s=s.customValues)&&(e.legendOptions.customValues=s.slice(0))),e.stops&&(e.stops=e.stops.map(function(e){return null===(e=i.mixin({},e)).label&&delete e.label,e})),e=i.fixJson(e,!0)}return e},_writeColorInfo:function(e,t,r){return e&&(e=i.mixin({},e),this._processForContext(e,t,"visualVariables["+r+"]"),e.type=y.toJSON(e.type),e.colors&&(e.colors=e.colors.map(function(e){return u.toJSON(e)})),e.stops&&(e.stops=e.stops.map(function(e){return(e=i.mixin({},e)).color&&(e.color=u.toJSON(e.color)),null==e.value&&(e.value=0),null===e.label&&delete e.label,e})),e.legendOptions&&(e.legendOptions=i.mixin({},e.legendOptions)),e=i.fixJson(e,!0)),e},_writeOpacityInfo:function(e,t,r){var n;return e&&(n=i.mixin({},e),this._processForContext(n,t,"visualVariables["+r+"]"),n.type=y.toJSON(n.type),n.opacityValues&&(n.transparencyValues=n.opacityValues.map(g),delete n.opacityValues),n.stops&&(n.stops=n.stops.map(function(e){return(e=i.mixin({},e)).transparency=g(e.opacity),delete e.opacity,null===e.label&&delete e.label,e})),n.legendOptions&&(n.legendOptions=i.mixin({},n.legendOptions)),n=i.fixJson(n,!0)),n}})}.apply(null,n))||(e.exports=o)},371:function(e,t,r){var n,o;n=[r(347),r(340),r(358)],void 0===(o=function(e,t,r){var n=e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),o=0;return t.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:function(){this.id="sym"+o++},properties:{type:{type:String,value:null,json:{read:n.read,write:{ignoreOrigin:!0,writer:n.write}}},color:{type:r,value:new r([0,0,0,1]),json:{read:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e},write:{allowNull:!0}}}}})}.apply(null,n))||(e.exports=o)},374:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336)],void 0===(o=function(e,t,r,n,o,i,s){var a=i({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.type=null,r}return r(t,e),n([s.property({json:{write:!0}})],t.prototype,"name",void 0),n([s.property({json:{read:a.read,write:a.write}})],t.prototype,"type",void 0),n([s.subclass("esri.layers.support.Domain")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},378:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(355)],void 0===(o=function(e,t,r){function n(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}function o(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.CONFIGURE=1]="CONFIGURE",e[e.CONFIGURED=2]="CONFIGURED",e[e.OPEN=3]="OPEN",e[e.OPENED=4]="OPENED",e[e.RESPONSE=5]="RESPONSE",e[e.INVOKE=6]="INVOKE",e[e.CANCEL=7]="CANCEL",e[e.CLOSE=8]="CLOSE",e[e.OPEN_PORT=9]="OPEN_PORT"}(t.MessageType||(t.MessageType={}));var i=0;t.newJobId=function(){return i++},t.isTranferableResult=n,t.toInvokeError=function(e){return e?e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details,stack:e.stack}):null},t.postMessage=function(e,t,i,s){2===arguments.length||void 0===i&&void 0===s?e.postMessage(t):(r("esri-workers-arraybuffer-transfer")||(s?(s=s.filter(function(e){return!o(e)})).length||(s=null):n(i)&&i.transferList&&(i.transferList=i.transferList.filter(function(e){return!o(e)}),i.transferList.length||(i.transferList=null))),s?(t.data=i,e.postMessage(t,s)):n(i)?(t.data=i.result,i.transferList?e.postMessage(t,i.transferList):e.postMessage(t)):(t.data=i,e.postMessage(t)))},t.receiveMessage=function(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}}.apply(null,n))||(e.exports=o)},389:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(341),r(339),r(378)],void 0===(o=function(e,t,r,n,o){function i(e,t){e.delete(t)}var s=o.MessageType.CLOSE,a=o.MessageType.CANCEL,l=o.MessageType.INVOKE,u=o.MessageType.RESPONSE,p=o.MessageType.OPEN_PORT,c=function(){function e(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e){e.type===o.MessageType.CANCEL?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))},e.prototype.clear=function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null},e.prototype._process=function(){this._timer=null;for(var e=0,t=this._invokeMessages;e<t.length;e++){var r=t[e];this._cancelledJobIds.has(r.jobId)||this._invoke(r)}this._cancelledJobIds.clear(),this._invokeMessages.length=0},e}();return function(){function e(e,t,r){this._outJobs=new Map,this._inJobs=new Map,this._queue=new c(this._onInvoke.bind(this)),this._onMessage=this._onMessage.bind(this),this._client=t,this._port=e,this._port.addEventListener("message",this._onMessage),this._port.start(),this._channel=r}return e.connect=function(t){var r,n=new MessageChannel;return(r="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t).remoteClient=new e(n.port1,r,n),n.port2},e.prototype.close=function(){this._post({type:s}),this._close()},e.prototype.isBusy=function(){return this._outJobs.size>0},e.prototype.invoke=function(e,t,s){var u=this;if(!this._port)return n.reject(new r("remote-client:port-closed","Can't invoke(), port is closed"));var p=o.newJobId(),c=function(){i(u._outJobs,p),u._post({type:a,jobId:p})};return n.create(function(r,n){var o={resolve:r,reject:n,cancel:c};u._outJobs.set(p,o),u._post({type:l,jobId:p,methodName:e},t,s)},c)},e.prototype.openPort=function(){var e=this,t=o.newJobId(),r=function(){i(e._outJobs,t),e._post({type:a,jobId:t})};return n.create(function(n,o){var i={resolve:n,reject:o,cancel:r};e._outJobs.set(t,i),e._post({type:p,jobId:t})},r)},e.prototype._close=function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(function(e){e.cancel()}),this._inJobs.clear(),this._outJobs.clear(),this._queue.clear(),this._port=this._client=null},e.prototype._onMessage=function(e){var t=o.receiveMessage(e);if(t)switch(t.type){case u:this._onResponse(t);break;case l:this._queue.push(t);break;case a:this._onCancel(t);break;case s:this._close();break;case p:this._onOpenPort(t)}},e.prototype._onCancel=function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);this._queue.push(e),n&&(i(t,r),n.cancel())},e.prototype._onInvoke=function(e){var t,r=this,s=e.methodName,a=e.jobId,l=e.data,p=this._inJobs,c=this._client,d=c[s];try{if(!d&&s&&-1!==s.indexOf("."))for(var y=s.split("."),f=0;f<y.length-1;f++)d=(c=c[y[f]])[y[f+1]];if("function"!=typeof d)throw new TypeError(s+" is not a function");t=d.call(c,l,this)}catch(e){return void this._post({type:u,jobId:a,error:o.toInvokeError(e)})}n.isThenable(t)?(p.set(a,t),t.then(function(e){p.has(a)&&(i(p,a),r._post({type:u,jobId:a},e))}).catch(function(e){p.has(a)&&(i(p,a),e&&"cancel"===e.dojoType||r._post({type:u,jobId:a,error:o.toInvokeError(e||{message:"Error encountered at method "+s})}))})):this._post({type:u,jobId:a},t)},e.prototype._onOpenPort=function(t){var r=new MessageChannel;new e(r.port1,this._client),this._post({type:u,jobId:t.jobId},r.port2,[r.port2])},e.prototype._onResponse=function(e){var t=e.jobId,n=e.error,o=e.data,s=this._outJobs;if(s.has(t)){var a=s.get(t);i(s,t),n?a.reject(r.fromJSON(JSON.parse(n))):a.resolve(o)}},e.prototype._post=function(e,t,r){return o.postMessage(this._port,e,t,r)},e}()}.apply(null,n))||(e.exports=o)},392:function(e,t,r){var n,o;n=[r(347),r(340),r(338),r(383),r(395),r(362),r(613),r(422)],void 0===(o=function(e,t,r,n,o,i,s,a){var l=e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"});return t.createSubclass({declaredClass:"esri.tasks.support.FeatureSet",getDefaults:function(){return r.mixin(this.inherited(arguments),{features:[]})},properties:{displayFieldName:null,exceededTransferLimit:null,features:{value:null,json:{read:function(e,t){for(var r=i.fromJSON(t.spatialReference),o=[],s=0;s<e.length;s++){var a=e[s],l=n.fromJSON(a),u=a.geometry&&a.geometry.spatialReference;l.geometry&&!u&&(l.geometry.spatialReference=r),o.push(l)}return t.transform&&this._hydrate(t.transform,t.geometryType,o),o}}},fields:{value:null,type:[o]},geometryType:{value:null,json:{read:l.read}},spatialReference:{type:i}},toJSON:function(e){var t={hasZ:this.hasZ,hasM:this.hasM};return this.displayFieldName&&(t.displayFieldName=this.displayFieldName),this.fields&&(t.fields=this.fields.map(function(e){return e.toJSON()})),this.spatialReference?t.spatialReference=this.spatialReference.toJSON():this.features[0]&&this.features[0].geometry&&(t.spatialReference=this.features[0].geometry.spatialReference.toJSON()),this.features[0]&&(this.features[0].geometry&&(t.geometryType=a.getJsonType(this.features[0].geometry)),t.features=s._encodeGraphics(this.features,e)),t.exceededTransferLimit=this.exceededTransferLimit,t.transform=this.transform,r.fixJson(t)},quantize:function(e){var t,r,n=e.translate[0],o=e.translate[1],i=e.scale[0],s=e.scale[1],a=this.features,l=function(e,t,r){var n,o,i,s,a,l,u,p=[];for(n=0,o=e.length;n<o;n++)i=e[n],n>0?(l=t(i[0]),u=r(i[1]),l===s&&u===a||(p.push([l-s,u-a]),s=l,a=u)):(s=t(i[0]),a=r(i[1]),p.push([s,a]));return p.length>0?p:null},u=function(e,t,r){return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){var n,o,i,s,a,u;for(u=[],n=0,o=(i=e.rings||e.paths).length;n<o;n++)s=i[n],(a=l(s,t,r))&&u.push(a);return u.length>0?(e.rings?e.rings=u:e.paths=u,e):null}:"multipoint"===e?function(e){var n;return(n=l(e.points,t,r)).length>0?(e.points=n,e):null}:"extent"===e?function(e){return e}:void 0}(this.geometryType,function(e){return Math.round((e-n)/i)},function(e){return Math.round((o-e)/s)});for(t=0,r=a.length;t<r;t++)u(a[t].geometry)||(a.splice(t,1),t--,r--);return this.transform=e,this},_hydrate:function(e,t,r){if(e){var n,o,i=e.translate[0],s=e.translate[1],a=e.scale[0],l=e.scale[1],u=function(e,t,r){return"esriGeometryPoint"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"esriGeometryPolyline"===e||"esriGeometryPolygon"===e?function(e){var n,o,i,s,a,l,u,p,c=e.rings||e.paths;for(n=0,o=c.length;n<o;n++)for(i=0,s=(a=c[n]).length;i<s;i++)l=a[i],i>0?(u+=l[0],p+=l[1]):(u=l[0],p=l[1]),l[0]=t(u),l[1]=r(p)}:"esriGeometryEnvelope"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"esriGeometryMultipoint"===e?function(e){var n,o,i,s,a,l=e.points;for(n=0,o=l.length;n<o;n++)i=l[n],n>0?(s+=i[0],a+=i[1]):(s=i[0],a=i[1]),i[0]=t(s),i[1]=r(a)}:void 0}(t,function(e){return e*a+i},function(e){return s-e*l});for(n=0,o=r.length;n<o;n++)r[n].geometry&&u(r[n].geometry)}}})}.apply(null,n))||(e.exports=o)},395:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(345),r(335),r(340),r(336),r(399),r(600)],void 0===(o=function(e,t,r,n,o,i,s,a){return function(e){function t(t){var r=e.call(this)||this;return r.alias=null,r.defaultValue=void 0,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({alias:this.alias,defaultValue:this.defaultValue,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type})},n([i.property({type:String,json:{write:!0}})],t.prototype,"alias",void 0),n([i.property({json:{write:{allowNull:!0}}})],t.prototype,"defaultValue",void 0),n([i.property({types:s.types,json:{read:{reader:s.fromJSON},write:!0}})],t.prototype,"domain",void 0),n([i.property({type:Boolean,json:{write:!0}})],t.prototype,"editable",void 0),n([i.property({type:Number,json:{write:!0}})],t.prototype,"length",void 0),n([i.property({type:String,json:{write:!0}})],t.prototype,"name",void 0),n([i.property({type:Boolean,json:{write:!0}})],t.prototype,"nullable",void 0),n([i.property({type:String,json:{read:a.kebabDict.read,write:a.kebabDict.write}})],t.prototype,"type",void 0),o=n([i.subclass("esri.layers.support.Field")],t)}(i.declared(o))}.apply(null,n))||(e.exports=o)},399:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(597),r(374),r(598),r(599)],void 0===(o=function(e,t,r,n,o,i){function s(e,t){switch(e.type){case"range":var r="range"in e?e.range[0]:e.minValue,n="range"in e?e.range[1]:e.maxValue;if(+t<r||+t>n)return a.VALUE_OUT_OF_RANGE;break;case"coded-value":case"codedValue":if(null==e.codedValues||e.codedValues.every(function(e){return null==e||e.code!==t}))return a.INVALID_CODED_VALUE}return null}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.CodedValueDomain=r,t.DomainBase=n,t.InheritedDomain=o,t.RangeDomain=i,function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(a=t.DomainValidationError||(t.DomainValidationError={})),t.isValidDomainValue=function(e,t){return null===s(e,t)},t.validateDomainValue=s,t.types={key:"type",base:t.DomainBase,typeMap:{range:t.RangeDomain,"coded-value":t.CodedValueDomain}},t.getDomainRange=function(e){if(e&&"range"===e.type)return{min:"range"in e?e.range[0]:e.minValue,max:"range"in e?e.range[1]:e.maxValue}},t.fromJSON=function(e){return e&&e.type?"range"===e.type?t.RangeDomain.fromJSON(e):"codedValue"===e.type?t.CodedValueDomain.fromJSON(e):null:null}}.apply(null,n))||(e.exports=o)},402:function(e,t,r){var n,o;n=[r(351),r(338),r(354),r(592)],void 0===(o=function(e,t,r,n){var o={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},i={color:[0,0,0,1],style:o.STYLE_SOLID,width:.75,cap:o.CAP_ROUND,join:o.JOIN_ROUND,miterLimit:7.5},s=e(n,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line",style:{value:o.STYLE_SOLID,json:{read:function(e,r){return t.valueOf(this._jsonStyles,e)||void 0},write:function(e,t){t.style=this._jsonStyles[e]}}},cap:{value:o.CAP_ROUND,json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}},join:{value:o.JOIN_ROUND,json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}},miterLimit:{value:7.5,cast:r.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash","short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash","long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return t.mixin(this.inherited(arguments),i)},normalizeCtorArgs:function(e,t,n,o,i,s){if(e&&"string"!=typeof e)return e;var a={};return null!=e&&(a.style=e),null!=t&&(a.color=t),null!=n&&(a.width=r.toPt(n)),null!=o&&(a.cap=o),null!=i&&(a.join=i),null!=s&&(a.miterLimit=r.toPt(s)),a},clone:function(){return new s({color:t.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});return t.mixin(s,o),s.defaultProps=i,s}.apply(null,n))||(e.exports=o)},412:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(338),r(336),r(370),r(361),r(375)],void 0===(o=function(e,t,r,n,o,i,s,a,l){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.symbol=null,t.type="simple",t}var s;return r(t,e),s=t,t.prototype.writeSymbolWebScene=function(e,t,r,n){a.writeTarget(e,t,r,n)},t.prototype.writeSymbol=function(e,t,r,n){a.writeTarget(e,t,r,n)},t.prototype.readSymbol=function(e,t,r){return a.read(e,t,r)},t.prototype.getSymbol=function(e,t){return this.symbol},t.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]},t.prototype.clone=function(){return new s({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:o.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},n([i.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([i.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([i.property({types:l.rendererTypes})],t.prototype,"symbol",void 0),n([i.writer("web-scene","symbol",{symbol:{types:l.rendererTypes3D}})],t.prototype,"writeSymbolWebScene",null),n([i.writer("symbol")],t.prototype,"writeSymbol",null),n([i.reader("symbol")],t.prototype,"readSymbol",null),n([i.enumeration.serializable()({simple:"simple"})],t.prototype,"type",void 0),s=n([i.subclass("esri.renderers.SimpleRenderer")],t)}(i.declared(s))}.apply(null,n))||(e.exports=o)},414:function(e,t,r){var n,o;n=[r(351),r(338),r(347),r(341),r(343),r(360),r(391),r(371),r(739),r(361),r(375),r(370),r(424),r(643)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c,d,y){var f=o.getLogger("esri.renderers.ClassBreaksRenderer");d=d.LegendOptions,y=y.ClassBreakInfo;var h=r({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),m=i.ensureType(y),v=e(c,{declaredClass:"esri.renderers.ClassBreaksRenderer",properties:{backgroundFillSymbol:{types:{base:a,key:"type",typeMap:{"simple-fill":p.types.typeMap["simple-fill"],"picture-fill":p.types.typeMap["picture-fill"],"polygon-3d":p.types.typeMap["polygon-3d"]}},value:null,json:{origins:{"web-scene":{read:u.read,write:{target:{backgroundFillSymbol:{type:l}},writer:u.writeTarget}}},read:u.read,write:u.writeTarget}},classBreakInfos:{type:[y],json:{read:function(e,t,r){if(Array.isArray(e)){var n=t.minValue;return e.map(function(e){var t=new y;return t.read(e,r),null==t.minValue&&(t.minValue=n),null==t.maxValue&&(t.maxValue=t.minValue),n=t.maxValue,t})}},write:function(e,t,r,n){e=e.map(function(e){return e.write({},n)}),this._areClassBreaksConsecutive()&&e.forEach(function(e){delete e.classMinValue}),t[r]=e}}},minValue:{type:Number,readOnly:!0,dependsOn:["classBreakInfos"],get:function(){return this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}},defaultLabel:{type:String,value:null,json:{write:!0}},defaultSymbol:{types:p.rendererTypes,value:null,json:{origins:{"web-scene":{read:u.read,write:{target:{defaultSymbol:{types:p.rendererTypes3D}},writer:u.writeTarget}}},read:u.read,write:u.writeTarget}},valueExpression:{type:String,value:null,json:{write:!0}},valueExpressionTitle:{type:String,value:null,json:{write:!0}},compiledFunc:{dependsOn:["valueExpression"],get:function(){return s.createFunction(this.valueExpression)}},legendOptions:{type:d,value:null,json:{write:!0}},field:{value:null,cast:function(e){return null==e?e:"function"==typeof e?e:i.ensureString(e)},json:{type:String,write:function(e,t,r,o){"string"==typeof e?t[r]=e:o&&o.messages?o.messages.push(new n("property:unsupported","ClassBreaksRenderer.field set to a function cannot be written to JSON")):f.error(".field: cannot write field to JSON since it's not a string value")}}},isMaxInclusive:!0,normalizationField:{type:String,value:null,json:{write:!0}},normalizationTotal:{type:Number,value:null,json:{write:!0}},normalizationType:{type:h.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],get:function(){var e=this._get("normalizationType"),t=!!this.normalizationField,r=null!=this.normalizationTotal;return t||r?(e=t?"field":r&&"percent-of-total",t&&r&&console.warn("warning: both normalizationField and normalizationTotal are set!")):"field"!==e&&"percent-of-total"!==e||(e=null),e},json:{type:h.jsonValues,read:h.read,write:h.write}},requiredFields:{dependsOn:["field","normalizationField","valueExpression"]},type:{type:["class-breaks"],value:"class-breaks",json:{type:["classBreaks"]}}},constructor:function(){this.classBreakInfos=[]},addClassBreakInfo:function(e,r,n){var o;o="number"==typeof e?new y({minValue:e,maxValue:r,symbol:n}):m(t.clone(e)),this.classBreakInfos.push(o),1===this.classBreakInfos.length&&this.notifyChange("minValue")},removeClassBreakInfo:function(e,t){var r,n,o=this.classBreakInfos.length;for(n=0;n<o;n++)if((r=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue])[0]==e&&r[1]==t){this.classBreakInfos.splice(n,1);break}},getBreakIndex:function(e,t){var r,n,o,i=this.field,a=this.classBreakInfos,l=e.attributes,u=a.length,p=this.isMaxInclusive;if(this.valueExpression)r=s.executeFunction(this.compiledFunc,s.createExecContext(e,s.getViewInfo(t)));else if("function"==typeof i)r=i(e);else{r=parseFloat(l[i]);var c,d,y=this.normalizationType;if(y)if(c=parseFloat(this.normalizationTotal),d=parseFloat(l[this.normalizationField]),"log"===y)r=Math.log(r)*Math.LOG10E;else if("percent-of-total"!==y||isNaN(c)){if("field"===y&&!isNaN(d)){if(isNaN(r)||isNaN(d))return-1;r/=d}}else r=r/c*100}if(null!=r&&!isNaN(r)&&"number"==typeof r)for(n=0;n<u;n++)if((o=[a[n].minValue,a[n].maxValue])[0]<=r&&(p?r<=o[1]:r<o[1]))return n;return-1},getClassBreakInfo:function(e,t){var r=this.getBreakIndex(e,t);return-1!==r?this.classBreakInfos[r]:null},getSymbol:function(e,t){var r=this.getBreakIndex(e,t);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol},getSymbols:function(){var e=[];return this.classBreakInfos.forEach(function(t){t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e},clone:function(){return new v({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:t.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:t.clone(this.visualVariables),legendOptions:t.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},collectRequiredFields:function(e){this.inherited(arguments),[this.field,this.normalizationField].forEach(function(t){t&&(e[t]=!0)}),this.valueExpression&&s.extractFieldNames(this.valueExpression).forEach(function(t){e[t]=!0})},_areClassBreaksConsecutive:function(){for(var e=this.classBreakInfos,t=1;t<e.length;t++)if(e[t-1].maxValue!==e[t].minValue)return!1;return!0}});return v}.apply(null,n))||(e.exports=o)},415:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(358),r(338),r(336),r(370),r(644)],void 0===(o=function(e,t,r,n,o,i,s,a,l){return function(e){function t(t){var r=e.call(this)||this;return r.blurRadius=10,r.colorStops=[new l.HeatmapColorStop({ratio:0,color:new o("rgba(255, 140, 0, 0)")}),new l.HeatmapColorStop({ratio:.75,color:new o("rgba(255, 140, 0, 1)")}),new l.HeatmapColorStop({ratio:.9,color:new o("rgba(255, 0,   0, 1)")})],r.field=null,r.fieldOffset=0,r.maxPixelIntensity=100,r.minPixelIntensity=0,r.type="heatmap",r}var a;return r(t,e),a=t,t.prototype.clone=function(){return new a({blurRadius:this.blurRadius,colorStops:i.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})},n([s.property({type:Number,json:{write:!0}})],t.prototype,"blurRadius",void 0),n([s.property({type:[l.HeatmapColorStop],json:{write:!0}})],t.prototype,"colorStops",void 0),n([s.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([s.property({type:Number,json:{write:{overridePolicy:function(e,t,r){return{enabled:null==r}}}}})],t.prototype,"fieldOffset",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"maxPixelIntensity",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"minPixelIntensity",void 0),n([s.property({dependsOn:["field"],readOnly:!0})],t.prototype,"requiredFields",void 0),n([s.enumeration.serializable()({heatmap:"heatmap"})],t.prototype,"type",void 0),a=n([s.subclass("esri.renderers.HeatmapRenderer")],t)}(s.declared(a))}.apply(null,n))||(e.exports=o)},416:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(388),r(431),r(379),r(341),r(338),r(343),r(349),r(336),r(360),r(411),r(370),r(621),r(424),r(645),r(391),r(361),r(634),r(375)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c,d,y,f,h,m,v,g,b,w,S){var j=u.getLogger("esri.renderers.UniqueValueRenderer"),_=d.ensureType(v.default);return function(e){function t(t){var r=e.call(this)||this;return r._valueInfoMap={},r._isDefaultSymbolDerived=!1,r.type="unique-value",r.backgroundFillSymbol=null,r.field=null,r.field2=null,r.field3=null,r.valueExpression=null,r.valueExpressionTitle=null,r.legendOptions=null,r.defaultLabel=null,r.fieldDelimiter=null,r.portal=null,r.styleOrigin=null,r.diff={uniqueValueInfos:function(e,t){if(e||t){if(!e||!t)return{type:"complete",oldValue:e,newValue:t};for(var r=!1,n={type:"collection",added:[],removed:[],changed:[],unchanged:[]},o=0;o<t.length;o++)!function(o){var i=s.find(e,function(e){return e.value===t[o].value});i?h.diff(i,t[o])?(n.changed.push({type:"complete",oldValue:i,newValue:t[o]}),r=!0):(n.unchanged.push({oldValue:i,newValue:t[o]}),r=!0):(n.added.push(t[o]),r=!0)}(o);for(o=0;o<e.length;o++)!function(o){s.find(t,function(t){return t.value===e[o].value})||(n.removed.push(e[o]),r=!0)}(o);return r?n:void 0}}},r._set("uniqueValueInfos",[]),r}var u;return r(t,e),u=t,t.prototype.writeBackgroundFillSymbolWebScene=function(e,t,r,n){b.writeTarget(e,t,r,n)},t.prototype.castField=function(e){return null==e?e:"function"==typeof e?e:d.ensureString(e)},t.prototype.writeField=function(e,t,r,n){"string"==typeof e?t[r]=e:n&&n.messages?n.messages.push(new a("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):j.error(".field: cannot write field to JSON since it's not a string value")},Object.defineProperty(t.prototype,"compiledFunc",{get:function(){return g.createFunction(this.valueExpression)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSymbol",{set:function(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)},enumerable:!0,configurable:!0}),t.prototype.readDefaultSymbol=function(e,t,r){return b.read(e,t,r)},t.prototype.writeDefaultSymbolWebScene=function(e,t,r,n){this._isDefaultSymbolDerived||b.writeTarget(e,t,r,n)},t.prototype.writeDefaultSymbol=function(e,t,r,n){this._isDefaultSymbolDerived||b.writeTarget(e,t,r,n)},t.prototype.readPortal=function(e,t,r){return r.portal||y.getDefault()},t.prototype.readStyleOrigin=function(e,t,r){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){var n=p.read(t.styleUrl,r);return Object.freeze({styleUrl:n})}},t.prototype.writeStyleOrigin=function(e,t,r,n){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=p.write(e.styleUrl,n),p.isAbsolute(t.styleUrl)&&(t.styleUrl=p.normalize(t.styleUrl)))},Object.defineProperty(t.prototype,"uniqueValueInfos",{set:function(e){this.styleOrigin?j.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap())},enumerable:!0,configurable:!0}),t.prototype.addUniqueValueInfo=function(e,t){var r;this.styleOrigin?j.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(r="object"==typeof e?_(e):new v.default({value:e,symbol:t}),this.uniqueValueInfos.push(r),this._valueInfoMap[r.value]=r)},t.prototype.removeUniqueValueInfo=function(e){if(this.styleOrigin)j.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var t=0;t<this.uniqueValueInfos.length;t++)if(this.uniqueValueInfos[t].value===e+""){delete this._valueInfoMap[e],this.uniqueValueInfos.splice(t,1);break}},t.prototype.getUniqueValueInfo=function(e,t){var r,n=this.field,o=e.attributes;if(this.valueExpression)r=g.executeFunction(this.compiledFunc,g.createExecContext(e,g.getViewInfo(t)));else if("function"!=typeof n&&this.field2){var i=this.field2,s=this.field3,a=[];n&&a.push(o[n]),i&&a.push(o[i]),s&&a.push(o[s]),r=a.join(this.fieldDelimiter||"")}else"function"==typeof n?r=n(e):n&&(r=o[n]);return this._valueInfoMap[r+""]},t.prototype.getSymbol=function(e,t){var r=this.getUniqueValueInfo(e,t);return r&&r.symbol||this.defaultSymbol},t.prototype.getSymbols=function(){for(var e=[],t=0,r=this.uniqueValueInfos;t<r.length;t++){var n=r[t];n.symbol&&e.push(n.symbol)}return this.defaultSymbol&&e.push(this.defaultSymbol),e},t.prototype.clone=function(){var e=new u({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:l.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:l.clone(this.visualVariables),legendOptions:l.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:l.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);var t=l.clone(this.uniqueValueInfos);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(l.clone(this.styleOrigin))),Object.freeze(t)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e},t.prototype.collectRequiredFields=function(e){this.inherited(arguments),[this.field,this.field2,this.field3].forEach(function(t){t&&"string"==typeof t&&(e[t]=!0)}),this.valueExpression&&g.extractFieldNames(this.valueExpression).forEach(function(t){e[t]=!0})},t.prototype.populateFromStyle=function(){var e=this;return w.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(t){var r=[];return e._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(function(n){var o=new i.WebStyleSymbol({styleUrl:t.styleUrl,styleName:t.styleName,portal:e.portal,name:n.name});e.defaultSymbol||n.name!==t.data.defaultItem||(e.defaultSymbol=o,e._isDefaultSymbolDerived=!0);var s=new v.default({value:n.name,symbol:o});r.push(s),e._valueInfoMap[n.name]=s}),e._set("uniqueValueInfos",Object.freeze(r)),!e.defaultSymbol&&e.uniqueValueInfos.length&&(e.defaultSymbol=e.uniqueValueInfos[0].symbol,e._isDefaultSymbolDerived=!0),e})},t.prototype._updateValueInfoMap=function(){var e=this;this._valueInfoMap={},this.uniqueValueInfos.forEach(function(t){return e._valueInfoMap[t.value+""]=t})},t.fromPortalStyle=function(e,t){var r=new u(t&&t.properties);r._set("styleOrigin",Object.freeze({styleName:e})),r._set("portal",t&&t.portal||y.getDefault());var n=r.populateFromStyle();return n.catch(function(t){j.error("#fromPortalStyle('"+e+"'[, ...])","Failed to create unique value renderer from style name",t)}),n},t.fromStyleUrl=function(e,t){var r=new u(t&&t.properties);r._set("styleOrigin",Object.freeze({styleUrl:e}));var n=r.populateFromStyle();return n.catch(function(t){j.error("#fromStyleUrl('"+e+"'[, ...])","Failed to create unique value renderer from style URL",t)}),n},n([c.enumeration.serializable()({uniqueValue:"unique-value"})],t.prototype,"type",void 0),n([c.property({types:{base:i.BaseSymbol,key:"type",typeMap:{"simple-fill":S.rendererTypes.typeMap["simple-fill"],"picture-fill":S.rendererTypes.typeMap["picture-fill"],"polygon-3d":S.rendererTypes.typeMap["polygon-3d"]}},json:{read:b.read,write:b.writeTarget}})],t.prototype,"backgroundFillSymbol",void 0),n([c.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:i.PolygonSymbol3D}})],t.prototype,"writeBackgroundFillSymbolWebScene",null),n([c.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],t.prototype,"field",void 0),n([c.cast("field")],t.prototype,"castField",null),n([c.writer("field")],t.prototype,"writeField",null),n([c.property({type:String,json:{write:!0}})],t.prototype,"field2",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"field3",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"valueExpression",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"valueExpressionTitle",void 0),n([c.property({dependsOn:["valueExpression"]})],t.prototype,"compiledFunc",null),n([c.property({type:m.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"defaultLabel",void 0),n([c.property({types:S.rendererTypes})],t.prototype,"defaultSymbol",null),n([c.reader("defaultSymbol")],t.prototype,"readDefaultSymbol",null),n([c.writer("web-scene","defaultSymbol",{defaultSymbol:{types:S.rendererTypes3D}})],t.prototype,"writeDefaultSymbolWebScene",null),n([c.writer("defaultSymbol")],t.prototype,"writeDefaultSymbol",null),n([c.property({type:String,json:{write:!0}})],t.prototype,"fieldDelimiter",void 0),n([c.property({type:y,readOnly:!0})],t.prototype,"portal",void 0),n([c.reader("portal",["styleName"])],t.prototype,"readPortal",null),n([c.property({readOnly:!0})],t.prototype,"styleOrigin",void 0),n([c.reader("styleOrigin",["styleName","styleUrl"])],t.prototype,"readStyleOrigin",null),n([c.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],t.prototype,"writeStyleOrigin",null),n([c.property({type:[v.default],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],t.prototype,"uniqueValueInfos",null),n([c.property({dependsOn:["field","field2","field3","valueExpression"],readOnly:!0})],t.prototype,"requiredFields",void 0),n([o(1,c.cast(S.ensureType))],t.prototype,"addUniqueValueInfo",null),u=n([c.subclass("esri.renderers.UniqueValueRenderer")],t)}(c.declared(f))}.apply(null,n))||(e.exports=o)},423:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(341),r(405),r(442),r(414),r(415),r(412),r(416)],void 0===(o=function(e,t,r,n,o,i,s,a,l){function u(e,t,r){if(!e)return null;if(e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type)return r&&r.messages&&r.messages.push(new o("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null;var n=function(e){return e&&c[e.type]||null}(e);if(n){var i=new n;return i.read(e,r),i}return r&&r.messages&&e&&r.messages.push(new o("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:r})),null}function p(e,t,n){return e?n&&"web-scene"===n.origin&&"heatmap"===e.type?(n.messages&&n.messages.push(new r("renderer:unsupported","Renderer of type '"+e.declaredClass+"' are not supported in scenes.",{renderer:e,context:n})),null):e.write(t,n):null}Object.defineProperty(t,"__esModule",{value:!0});var c={simple:a,uniqueValue:l,classBreaks:i,heatmap:s};t.read=u,t.writeTarget=function(e,t,r,o){var i=p(e,{},o);i&&n.setDeepValue(r,i,t)},t.write=p,t.fromJSON=function(e,t){return u(e,0,t)}}.apply(null,n))||(e.exports=o)},424:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({title:this.title})},n([i.property({type:String,json:{write:!0}})],t.prototype,"title",void 0),o=n([i.subclass("esri.renderers.support.LegendOptions")],t)}(i.declared(o));t.LegendOptions=s,t.default=s}.apply(null,n))||(e.exports=o)},426:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(336)],void 0===(o=function(e,t,r,n,o,i){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minScale=0,t.maxScale=0,t}return r(t,e),n([i.property({type:Number,json:{write:!0}})],t.prototype,"minScale",void 0),n([i.property({type:Number,json:{write:!0}})],t.prototype,"maxScale",void 0),n([i.subclass("esri.layers.mixins.ScaleRangeLayer")],t)}(i.declared(o))}.apply(null,n))||(e.exports=o)},427:function(e,t,r){var n,o;n=[r(766),r(340),r(338),r(347),r(692),r(662),r(451),r(646),r(391),r(711),r(361),r(375)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c){function d(e){var t=l.createSyntaxTree(e),r=t&&t.body&&t.body[0]&&t.body[0].body&&t.body[0].body.body;if(!r||1!==r.length)return null;var n="ExpressionStatement"===r[0].type&&r[0].expression;if(!n||"MemberExpression"!==n.type)return null;var o=n.object;if(!o||"Identifier"!==o.type||"$feature"!==o.name)return null;var i=n.property;if(!i)return null;switch(i.type){case"Literal":return i.value;case"Identifier":return i.name}return null}function y(e){return!e||"service"!==e.origin&&(!e.layer||!a.isOfType(e.layer,"map-image"))}var f=n({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0}),h=new u,m=t.createSubclass({declaredClass:"esri.layers.support.LabelClass",properties:{name:{type:String,value:null,json:{write:!0}},labelExpression:{type:String,value:null,json:{read:function(e,t,r,n){var o=t.labelExpressionInfo;if(!o||!o.value&&!o.expression)return e},write:{allowNull:!0,writer:function(e,t,r,n){if(this.labelExpressionInfo&&y(n))if(null!=this.labelExpressionInfo.value)e=this._templateStringToSql(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var o=d(this.labelExpressionInfo.expression);o&&(e="["+o+"]")}null!=e&&(t[r]=e)}}}},labelExpressionInfo:{value:null,type:i,json:{write:{overridePolicy:function(e,t,r){return y(r)?{allowNull:!0}:{enabled:!1}},writer:function(e,t,r,n){if(null==e&&null!=this.labelExpression&&y(n))e=new i({expression:this.getLabelExpressionArcade()});else if(!e)return;var o=e.toJSON(n);o.expression&&(t[r]=o)}}}},labelPlacement:{type:f.apiValues,value:null,json:{type:f.jsonValues,read:f.read,write:f.write}},maxScale:{type:Number,value:0,json:{write:function(e,t){(e||this.minScale)&&(t.maxScale=e)}}},minScale:{type:Number,value:0,json:{write:function(e,t){(e||this.maxScale)&&(t.minScale=e)}}},requiredFields:{readOnly:!0,dependsOn:["labelExpression","labelExpressionInfo","where"],get:function(){var e=Object.create(null);return this._collectRequiredFields(e),Object.keys(e)}},symbol:{value:null,types:c.labelTypes,json:{origins:{"web-scene":{read:p.read,write:{target:{symbol:{types:c.labelTypes3D}},writer:p.writeTarget}}},read:p.read,write:p.writeTarget}},useCodedValues:{type:Boolean,value:null,json:{write:!0}},where:{type:String,value:null,json:{write:!0}}},getLabelExpression:function(){var e={expression:"",type:"none"};return this.labelExpressionInfo?this.labelExpressionInfo.value?(e.expression=this.labelExpressionInfo.value,e.type="conventional"):this.labelExpressionInfo.expression&&(e.expression=this.labelExpressionInfo.expression,e.type="arcade"):null!=this.labelExpression&&(e.expression=this._sqlToTemplateString(this.labelExpression),e.type="conventional"),e},getLabelExpressionArcade:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return s.convertTemplatedStringToArcade(e.expression);case"arcade":return e.expression}return null},getOptions:function(e){var t={spatialReference:e},r=this.labelExpressionInfo;if(r){var n=r.expression;n&&!r.value&&(t.hasArcadeExpression=!0,t.compiledArcadeFunc=l.createFunction(n))}return t},getLabelExpressionSingleField:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return function(e){var t=e.match(v);return t&&t[1].trim()||null}(e.expression);case"arcade":return d(e.expression)}return null},clone:function(){return new m({labelExpression:this.labelExpression,labelExpressionInfo:r.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:this.symbol.clone(),where:this.where,useCodedValues:this.useCodedValues})},_collectRequiredFields:function(e){this._collectLabelExpressionRequiredFields(this.getLabelExpression(),e),this._collectWhereRequiredFields(this.where,e)},_sqlToTemplateString:function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")},_templateStringToSql:function(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")},_collectWhereRequiredFields:function(e,t){if(null!=e){var r=e.split(" ");3===r.length&&(t[r[0]]=!0),7===r.length&&(t[r[0]]=!0,t[r[4]]=!0)}},_collectLabelExpressionRequiredFields:function(e,t){if("arcade"===e.type)l.extractFieldNames(e.expression).forEach(function(e){t[e]=!0});else{var r=e.expression.match(/{[^}]*}/g);r&&r.forEach(function(e){t[e.slice(1,-1)]=!0})}}});m.evaluateWhere=function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var n=e.split(" ");if(3===n.length)return r(t[n[0]],n[1],n[2]);if(7===n.length){var o=r(t[n[0]],n[1],n[2]),i=n[3],s=r(t[n[4]],n[5],n[6]);switch(i){case"AND":return o&&s;case"OR":return o||s}}return!1}catch(t){console.log("Error.: can't parse = "+e)}},m.buildLabelText=function(e,t,r,n){var o="";if(n&&n.hasArcadeExpression){if(n.compiledArcadeFunc){h.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:r});var i={vars:{$feature:h},spatialReference:n.spatialReference},s=l.executeFunction(n.compiledArcadeFunc,i);null!=s&&(o=s.toString())}}else{var a=t&&t.attributes||{};o=e.replace(/{[^}]*}/g,function(e){return m.formatField(e.slice(1,-1),e,a,r,n)})}return o},m.formatField=function(t,n,i,s,a){var l,u,p=n,c=t.toLowerCase();for(l=0;l<s.length;l++)if(s[l].name.toLowerCase()===c){p=i[s[l].name];var d=s[l].domain;if(d&&"object"==typeof d){if("codedValue"==d.type)for(u=0;u<d.codedValues.length;u++)d.codedValues[u].code==p&&(p=d.codedValues[u].name);else"range"==d.type&&d.minValue<=p&&p<=d.maxValue&&(p=d.name);return null==p?"":p}var y=s[l].type;if("date"==y){var f=e.fromJSON(a&&a.dateFormat||"shortDate"),h="DateFormat"+e.getFormat(f);h&&(p=r.substitute({myKey:p},"{myKey:"+h+"}"))}else"integer"!=y&&"small-integer"!=y&&"long"!=y&&"double"!=y||a&&a.numberFormat&&a.numberFormat.digitSeparator&&a.numberFormat.places&&(p=o.format(p,{places:a.numberFormat.places}))}return null==p?"":p};var v=/^\s*\{([^}]+)\}\s*$/i;return m}.apply(null,n))||(e.exports=o)},429:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(461),r(406),r(619)],void 0===(o=function(e,t,r,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.screenSizePerspectiveEnabled={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader:function(e,t){return null==t.screenSizePerspective&&"defaults"===this.originOf("screenSizePerspectiveEnabled")?void n.getProperties(this).store.set("screenSizePerspectiveEnabled",!1,r.OriginId.DEFAULTS):t.screenSizePerspective}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer:function(e,t,r,n){"defaults"===this.originOf("screenSizePerspectiveEnabled")&&e?t[r]=e:o.willPropertyWrite(this,"screenSizePerspectiveEnabled",{},n)&&(t[r]=e)}}}}}},t.popupEnabled={type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",writer:function(e,t,r){t[r]=!e}}}},t.labelsVisible={type:Boolean,json:{read:{source:"showLabels"},write:{target:"showLabels"}}}}.apply(null,n))||(e.exports=o)},436:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(343),r(428),r(336),r(394)],void 0===(o=function(e,t,r,n,o,i,s,a){var l=o.getLogger("esri.layers.mixins.ArcGISService");return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"title",{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=a.parse(this.url);if(e&&e.title)return e.title}return this._get("title")||""},set:function(e){this._set("title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{set:function(e){this._set("url",a.sanitizeUrl(e,l))},enumerable:!0,configurable:!0}),n([s.property({dependsOn:["url"]})],t.prototype,"title",null),n([s.property({type:String})],t.prototype,"url",null),n([s.subclass("esri.layers.mixins.ArcGISService")],t)}(s.declared(i))}.apply(null,n))||(e.exports=o)},437:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(607)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r)}.apply(null,n))||(e.exports=o)},438:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(336)],void 0===(o=function(e,t,r,n,o,i){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshInterval=0,t}return r(t,e),t.prototype.refresh=function(){this.emit("refresh")},n([i.property({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0}})],t.prototype,"refreshInterval",void 0),n([i.subclass("esri.layers.mixins.RefreshableLayer")],t)}(i.declared(o))}.apply(null,n))||(e.exports=o)},440:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(338),r(336)],void 0===(o=function(e,t,r,n,o,i,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.definitionExpression=null,r.globalIds=null,r.num=null,r.objectIds=null,r.size=null,r.start=null,r}var o;return r(t,e),o=t,t.prototype.writeStart=function(e,t,r){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new o(i.clone({attachmentTypes:this.attachmentTypes,definitionExpression:this.definitionExpression,globalIds:this.globalIds,num:this.num,objectIds:this.objectIds,size:this.size,start:this.start}))},n([s.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),n([s.property({type:String,json:{write:!0}})],t.prototype,"definitionExpression",void 0),n([s.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),n([s.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),n([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),n([s.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),n([s.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),n([s.writer("start"),s.writer("num")],t.prototype,"writeStart",null),o=n([s.subclass("esri.tasks.support.AttachmentQuery")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},444:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(364),r(340),r(338),r(336)],void 0===(o=function(e,t,r,n,o,i,s,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.definitionExpression=null,r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r}var i;return r(t,e),i=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new i(s.clone({definitionExpression:this.definitionExpression,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source}))},n([a.property({type:String,json:{write:!0}})],t.prototype,"definitionExpression",void 0),n([a.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),n([a.property({type:Date})],t.prototype,"historicMoment",void 0),n([a.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),n([a.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),n([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),n([a.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),n([a.property({type:o.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),n([a.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),n([a.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),n([a.property({json:{write:!0}})],t.prototype,"source",void 0),i=n([a.subclass("esri.tasks.support.RelationshipQuery")],t)}(a.declared(i))}.apply(null,n))||(e.exports=o)},446:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(339)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.when=function e(t,n){return Array.isArray(n)?r.create(function(e){t(n,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(t)})}):e(t,[n]).then(function(e){return e[0]})},t.getAbsMid=function(e,t,r){return t.toAbsMid?t.toAbsMid(e):r.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,n))||(e.exports=o)},447:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(587),r(405),r(399)],void 0===(o=function(e,t,r,n,o){function i(e,t,r){if(e)for(var o=0,i=e;o<i.length;o++){var a=i[o],l=n.getDeepValue(a,t),u=l&&"function"!=typeof l&&s(l,r);u&&n.setDeepValue(a,u.name,t)}}function s(e,t){if("string"!=typeof e)return null;if(null!=t){e=e.toLowerCase();for(var r=0,n=t;r<n.length;r++){var o=n[r];if(o&&o.name.toLowerCase()===e)return o}}return null}function a(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function l(e){return null===e||a(e)}function u(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function p(e){return null===e||u(e)}function c(e){return null!=e&&"string"==typeof e}function d(e){return null===e||c(e)}function y(e){return!0}function f(e,t){var r;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":r=e.nullable?p:u;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=e.nullable?l:a;break;case"string":case"esriFieldTypeString":r=e.nullable?d:c;break;default:r=y}return 1===arguments.length?r:r(t)}function h(e){return null!=e&&S.has(e.type)}function m(e,t){return e.nullable&&null===t?null:h(e)&&!v(e.type,t)?b.OUT_OF_RANGE:f(e,t)?e.domain?o.validateDomainValue(e.domain,t):null:w.INVALID_TYPE}function v(e,t){var r=g(e);return!!r&&t>=r.min&&t<=r.max}function g(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return{min:-32768,max:32767};case"esriFieldTypeInteger":case"integer":return{min:-2147483648,max:2147483647};case"esriFieldTypeSingle":case"single":return{min:-3.4e38,max:1.2e38};case"esriFieldTypeDouble":case"double":var t=Number.MAX_VALUE;return{min:-Number.MAX_VALUE,max:t}}}Object.defineProperty(t,"__esModule",{value:!0}),t.fixRendererFields=function(e,r){if(null!=e&&null!=r)for(var n=0,o=Array.isArray(e)?e:[e];n<o.length;n++){var s=o[n];if(i(t.rendererFields,s,r),s.visualVariables)for(var a=0,l=s.visualVariables;a<l.length;a++){var u=l[a];i(t.visualVariableFields,u,r)}}},t.getField=s,t.getFieldDefaultValue=function(e){var t=e.defaultValue;return void 0!==t&&f(e,t)?t:e.nullable?null:void 0},t.isValueMatchingFieldType=f,t.rendererFields=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],t.visualVariableFields=["field","normalizationField"],t.numericTypes=["integer","small-integer","single","double"];var b,w,S=new r.default(t.numericTypes.concat(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));t.isNumericField=h,t.isStringField=function(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)},t.isDateField=function(e){return null!=e&&("date"===e.type||"esriFieldTypeDate"===e.type)},t.isValidFieldValue=function(e,t){return null===m(e,t)},(b=t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",(w=t.TypeValidationError||(t.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type",t.validateFieldValue=m,t.isNumberInRange=v,t.getFieldRange=function(e){var t=o.getDomainRange(e.domain);return t||(h(e)?g(e.type):void 0)},t.validationErrorToString=function(e,t,r){switch(e){case o.DomainValidationError.INVALID_CODED_VALUE:return"Value "+r+" is not in the coded domain - field: "+t.name+", domain: "+JSON.stringify(t.domain);case o.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+r+" is out of the range of valid values - field: "+t.name+", domain: "+JSON.stringify(t.domain);case w.INVALID_TYPE:return"Value "+r+" is not a valid value for the field type - field: "+t.name+", type: "+t.type+", nullable: "+t.nullable;case b.OUT_OF_RANGE:var n=g(t.type),i=n.min,s=n.max;return"Value "+r+" is out of range for the number type - field: "+t.name+", type: "+t.type+", value range is "+i+" to "+s}}}.apply(null,n))||(e.exports=o)},451:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(663)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n="__begin__",o="__end__",i=new RegExp(n,"ig"),s=new RegExp(o,"ig"),a=new RegExp("^"+n,"i"),l=new RegExp(o+"$","i"),u='"',p=u+" + ",c=" + "+u;t.convertTemplatedStringToArcade=function(e){var t;return e?(t=r.replace(e,function(e,t){return n+'$feature["'+t+'"]'+o}),t=a.test(t)?t.replace(a,""):u+t,t=(t=l.test(t)?t.replace(l,""):t+u).replace(i,p).replace(s,c)):t='""',t}}.apply(null,n))||(e.exports=o)},455:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=null,t}return r(t,e),n([i.property({type:String,readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),n([i.subclass("esri.layers.support.FeatureReduction")],t)}(i.declared(o));t.FeatureReduction=s,t.default=s}.apply(null,n))||(e.exports=o)},457:function(e,t,r){var n,o;n=[r(371),r(402)],void 0===(o=function(e,t){return e.createSubclass({declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:t,json:{read:{default:null},write:!0}},type:null}})}.apply(null,n))||(e.exports=o)},458:function(e,t,r){var n,o;n=[r(351),r(354),r(371)],void 0===(o=function(e,t,r){return e(r,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(e){return e&&-1*e},write:function(e,t){t.angle=e&&-1*e}}},type:{},xoffset:{value:0,cast:t.toPt,json:{write:!0}},yoffset:{value:0,cast:t.toPt,json:{write:!0}},size:{value:9,cast:function(e){return"auto"===e?e:t.toPt(e)},json:{write:!0}}}})}.apply(null,n))||(e.exports=o)},459:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(347),r(338)],void 0===(o=function(e,t,r,n){function o(e){return null!=e&&e.hasOwnProperty("mapLayerId")}function i(e){return null!=e&&e.hasOwnProperty("dataSource")}function s(e){return e?(o(e)&&(e.type=t.MAPLAYER),i(e)&&(e.type=t.DATALAYER,e.dataSource.type||function(e){e.workspaceId?e.gdbVersion?e.type="table":e.query||e.oidFields?e.type="query-table":e.type="raster":e.leftTableKey&&e.rightTableKey&&e.leftTableSource&&e.rightTableSource&&(e.type="join-table",e.leftTableSource=s(e.leftTableSource),e.rightTableSource=s(e.rightTableSource))}(e.dataSource)),e):e}function a(e){var r={};return e.type===t.MAPLAYER?(r.mapLayerId=e.mapLayerId,e.gdbVersion&&(r.gdbVersion=e.gdbVersion)):e.type===t.DATALAYER&&(e.fields&&(r.fields=e.fields),r.dataSource=function(e){var t;switch(e.type){case"table":t={dataSourceName:e.dataSourceName,workspaceId:e.workspaceId,gdbVersion:e.gdbVersion};break;case"query-table":t={geometryType:u.toJSON(e.geometryType),workspaceId:e.workspaceId,query:e.query,oidFields:e.oidFields,spatialReference:e.spatialReference};break;case"join-table":t={leftTableSource:a(e.leftTableSource),rightTableSource:a(e.rightTableSource),leftTableKey:e.leftTableKey,rightTableKey:e.rightTableKey,joinType:d.toJSON(e.joinType)};break;case"raster":t={workspaceId:e.workspaceId,dataSourceName:e.dataSourceName}}return t.type=c.toJSON(e.type),n.fixJson(t)}(e.dataSource)),r.type=p.toJSON(e.type),n.fixJson(r)}function l(e){var r={};return p.fromJSON(e.type)===t.MAPLAYER?(r.mapLayerId=e.mapLayerId,e.gdbVersion&&(r.gdbVersion=e.gdbVersion)):p.fromJSON(e.type)===t.DATALAYER&&(e.fields&&(r.fields=e.fields),r.dataSource=function(e){var t;switch(e.type){case"table":t={dataSourceName:e.dataSourceName,workspaceId:e.workspaceId,gdbVersion:e.gdbVersion};break;case"queryTable":t={geometryType:u.fromJSON(e.geometryType),workspaceId:e.workspaceId,query:e.query,oidFields:e.oidFields,spatialReference:e.spatialReference};break;case"joinTable":t={leftTableSource:l(e.leftTableSource),rightTableSource:l(e.rightTableSource),leftTableKey:e.leftTableKey,rightTableKey:e.rightTableKey,joinType:d.fromJSON(e.joinType)};break;case"raster":t={workspaceId:e.workspaceId,dataSourceName:e.dataSourceName}}return t.type=c.fromJSON(e.type),n.fixJson(t)}(e.dataSource)),r.type=p.fromJSON(e.type),n.fixJson(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.MAPLAYER="map-layer",t.DATALAYER="data-layer";var u=r({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),p=r({mapLayer:t.MAPLAYER,dataLayer:t.DATALAYER}),c=r({joinTable:"join-table",queryTable:"query-table"}),d=r({esriLeftOuterJoin:"left-outer-join",esriLeftInnerJoin:"left-inner-join"});t.isMapLayerSource=o,t.isDataLayerSource=i,t.castSource=s,t.sourceToJSON=a,t.sourceFromJSON=l}.apply(null,n))||(e.exports=o)},586:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(349)],void 0===(o=function(e,t,r){function n(e,t,n){return t.imageData?r.makeData({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):o(t.url,n)}function o(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!r.isAbsolute(e)&&t.layer.parsedUrl?r.join(t.layer.parsedUrl.path,"images",e):r.read(e,t)}function i(e,t,n,o){if(r.isDataProtocol(e)){var i=r.dataComponents(e);t.contentType=i.mediaType,t.imageData=i.data,n&&n.imageData===t.imageData&&n.url&&(t.url=s(n.url,o))}else t.url=s(e,o)}function s(e,t){return r.write(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.readImageDataOrUrl=n,t.read=o,t.writeImageDataAndUrl=i,t.write=s,t.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:n},write:{writer:function(e,t,r,n){i(e,t,this.source,n)}}}},t.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(e,t,r){var n={};return t.imageData&&(n.imageData=t.imageData),t.contentType&&(n.contentType=t.contentType),t.url&&(n.url=o(t.url,r)),n}}}}}.apply(null,n))||(e.exports=o)},587:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(653),i=r(450),s=r(654),a=r(614);r(660),t.Set=i.default.Set,a.default("es6-set")||(t.Set=((n=function(){function e(e){if(this._setData=[],this[Symbol.toStringTag]="Set",e)if(s.isArrayLike(e))for(var t=0;t<e.length;t++)this.add(e[t]);else try{for(var r=o.__values(e),n=r.next();!n.done;n=r.next()){var i=n.value;this.add(i)}}catch(e){a={error:e}}finally{try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(a)throw a.error}}var a,l}return e.prototype.add=function(e){return this.has(e)?this:(this._setData.push(e),this)},e.prototype.clear=function(){this._setData.length=0},e.prototype.delete=function(e){var t=this._setData.indexOf(e);return-1!==t&&(this._setData.splice(t,1),!0)},e.prototype.entries=function(){return new s.ShimIterator(this._setData.map(function(e){return[e,e]}))},e.prototype.forEach=function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()},e.prototype.has=function(e){return this._setData.indexOf(e)>-1},e.prototype.keys=function(){return new s.ShimIterator(this._setData)},Object.defineProperty(e.prototype,"size",{get:function(){return this._setData.length},enumerable:!0,configurable:!0}),e.prototype.values=function(){return new s.ShimIterator(this._setData)},e.prototype[Symbol.iterator]=function(){return new s.ShimIterator(this._setData)},e}())[Symbol.species]=n,n)),t.default=t.Set},588:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(338),r(336)],void 0===(o=function(e,t,r,n,o,i,s,a){var l=i({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return r(t,e),t.prototype.writeDrawingTool=function(e,t){t.drawingTool=l.toJSON(e)},t.prototype.writePrototype=function(e,t){t.prototype=s.fixJson(s.clone(e),!0)},t.prototype.writeThumbnail=function(e,t){t.thumbnail=s.fixJson(s.clone(e))},n([a.property({json:{write:!0}})],t.prototype,"name",void 0),n([a.property({json:{write:!0}})],t.prototype,"description",void 0),n([a.property({json:{read:l.read,write:l.write}})],t.prototype,"drawingTool",void 0),n([a.writer("drawingTool")],t.prototype,"writeDrawingTool",null),n([a.property({json:{write:!0}})],t.prototype,"prototype",void 0),n([a.writer("prototype")],t.prototype,"writePrototype",null),n([a.property({json:{write:!0}})],t.prototype,"thumbnail",void 0),n([a.writer("thumbnail")],t.prototype,"writeThumbnail",null),n([a.subclass("esri.layers.support.FeatureTemplate")],t)}(a.declared(o))}.apply(null,n))||(e.exports=o)},592:function(e,t,r){var n,o;n=[r(351),r(354),r(371)],void 0===(o=function(e,t,r){return e(r,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line",width:{value:.75,cast:t.toPt,json:{write:!0}}}})}.apply(null,n))||(e.exports=o)},597:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(338),r(336),r(374)],void 0===(o=function(e,t,r,n,o,i,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.codedValues=null,r.type="coded-value",r}var s;return r(t,e),s=t,t.prototype.writeCodedValues=function(e,t){var r=null;e&&(r=e.map(function(e){return o.fixJson(o.clone(e))})),t.codedValues=r},t.prototype.getName=function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some(function(e){return String(e.code)===r&&(t=e.name),!!t})}return t},t.prototype.clone=function(){return new s({codedValues:o.clone(this.codedValues),name:this.name})},n([i.property({json:{write:!0}})],t.prototype,"codedValues",void 0),n([i.writer("codedValues")],t.prototype,"writeCodedValues",null),n([i.enumeration.serializable()({codedValue:"coded-value"})],t.prototype,"type",void 0),s=n([i.subclass("esri.layers.support.CodedValueDomain")],t)}(i.declared(s))}.apply(null,n))||(e.exports=o)},598:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(374)],void 0===(o=function(e,t,r,n,o,i){return function(e){function t(t){var r=e.call(this,t)||this;return r.type="inherited",r}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i},n([o.enumeration.serializable()({inherited:"inherited"})],t.prototype,"type",void 0),i=n([o.subclass("esri.layers.support.InheritedDomain")],t)}(o.declared(i))}.apply(null,n))||(e.exports=o)},599:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(374)],void 0===(o=function(e,t,r,n,o,i){return function(e){function t(t){var r=e.call(this,t)||this;return r.maxValue=null,r.minValue=null,r.type="range",r}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({maxValue:this.maxValue,minValue:this.minValue,name:this.name})},n([o.property({json:{read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{target:"range",writer:function(e,t,r){t[r]=[this.minValue,e]}}}})],t.prototype,"maxValue",void 0),n([o.property({json:{read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue]}}}})],t.prototype,"minValue",void 0),n([o.enumeration.serializable()({range:"range"})],t.prototype,"type",void 0),i=n([o.subclass("esri.layers.support.RangeDomain")],t)}(o.declared(i))}.apply(null,n))||(e.exports=o)},600:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(347)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.kebabDict=r({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})}.apply(null,n))||(e.exports=o)},607:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(381),r(435),r(343),r(339),r(608),r(389),r(609)],void 0===(o=function(e,t,n,o,i,s,a,l,u){function p(){if(v)return v;for(var e=d+y,t=[],r=0;r<e;r++)!function(e){var r=u.create(e).then(function(t){return m[e]=t,t});t.push(r)}(r);return v=o(t).then(function(){})}Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=a,t.RemoteClient=l;var c=n("host-browser")?navigator.hardwareConcurrency:0;c||(c=n("safari")&&n("mac")||n("trident")?8:2);var d=n("esri-workers-debug")?1:Math.max(1,Math.ceil(c/2)),y=n("esri-workers-debug")?1:Math.max(1,Math.floor(c/2)),f=i.getLogger("esri.core.workers"),h=0,m=[];t.initialize=function(){p()},t.open=function(n,o,i){if(void 0===o&&(o={}),Array.isArray(n))return new t.Connection(n.map(function(e){return new t.RemoteClient(e,o.client)}));if("string"!=typeof n){f.warn("workers-open:signature-deprecated","DEPRECATED: workers.open() changed signature.");var a=n;n=o,o={client:a,strategy:i?"dedicated":"distributed"}}var l=o.strategy||"distributed";return"local"===l?s.create(function(o){Promise.resolve().then(function(){var r=[e(n,null,!1)];(function(e){o(t.RemoteClient.connect(e))}).apply(null,r)}).catch(r.oe)}).then(function(e){return new t.Connection([new t.RemoteClient(e,o.client)])}):p().then(function(){if("dedicated"===l){var e=d+h++;return h%=y,m[e].open(n).then(function(e){return new t.Connection([new t.RemoteClient(e,o.client)])})}return s.all(m.map(function(e){return e.open(n)})).then(function(e){return new t.Connection(e.map(function(e){return new t.RemoteClient(e,o.client)}))})})},t.terminate=function(){v&&(v.cancel(),v=null);for(var e=0;e<m.length;e++)m[e]&&m[e].terminate();m.length=0};var v=null}.apply(null,n))||(e.exports=o)},608:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(339)],void 0===(o=function(e,t,r){return function(){function e(e){this._clientIdx=0,this._clients=e}return e.prototype.broadcast=function(e,t){for(var r=[],n=0,o=this._clients;n<o.length;n++){var i=o[n];r.push(i.invoke(e,t))}return r},e.prototype.close=function(){for(var e=0,t=this._clients;e<t.length;e++)t[e].close();this._clients=[]},e.prototype.invoke=function(e,t,n,o){var i=o&&o.client;if(!this._clients||!this._clients.length)return r.reject(new Error("Connection closed"));null!=i&&-1!==this._clients.indexOf(i)||this._clients.some(function(e){return!e.isBusy()&&(i=e,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,i=this._clients[this._clientIdx]);var s=i.invoke(e,t,n);return o&&(o.client=i),s},e.prototype.openPorts=function(){return r.all(this._clients.map(function(e){return e.openPort()}))},e}()}.apply(null,n))||(e.exports=o)},609:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(620),r(341),r(343),r(339),r(378),r(610)],void 0===(o=function(e,t,r,n,o,i,s,a){function l(e,t){e.delete(t)}var u=o.getLogger("esri.core.workers"),p=s.MessageType.CANCEL,c=s.MessageType.INVOKE,d=s.MessageType.OPEN,y=s.MessageType.OPENED,f=s.MessageType.RESPONSE;return function(){function e(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",function(e){e.preventDefault(),u.error(e)})}return e.create=function(t){return a.createWorker().then(function(r){return new e(r,t)})},e.prototype.terminate=function(){this.worker.terminate()},e.prototype.open=function(e){var t=this,r=s.newJobId(),n=function(){l(t._outJobs,r),t._post({type:p,jobId:r})};return i.create(function(o,i){var s={resolve:o,reject:i,cancel:n};t._outJobs.set(r,s),t._post({type:d,jobId:r,modulePath:e})},n)},e.prototype._onMessage=function(e){var t=s.receiveMessage(e);if(t)switch(t.type){case y:case f:this._onResponse(t);break;case p:this._onCancel(t);break;case c:this._onInvoke(t)}},e.prototype._onCancel=function(e){var t=this._inJobs.get(e.jobId);t&&t.cancel()},e.prototype._onInvoke=function(e){var t,n=this,o=e.methodName,a=e.jobId,u=e.data,p=this._inJobs,c=r.workerMessages[o];try{if("function"!=typeof c)throw new TypeError(o+" is not a function");t=c.call(null,u)}catch(e){return void this._post({type:f,jobId:a,error:s.toInvokeError(e)})}i.isThenable(t)?(p.set(a,t),t.then(function(e){l(p,a),n._post({type:f,jobId:a},e)}).catch(function(e){l(p,a),e||(e={message:"Error encountered at method"+o}),e.dojoType&&"cancel"===e.dojoType||n._post({type:f,jobId:a,error:s.toInvokeError(e)})})):this._post({type:f,jobId:a},t)},e.prototype._onResponse=function(e){var t=e.jobId,r=e.error,o=e.data,i=this._outJobs.get(t);i&&(l(this._outJobs,t),r?i.reject(n.fromJSON(JSON.parse(r))):i.resolve(o))},e.prototype._post=function(e,t,r){return s.postMessage(this.worker,e,t,r)},e}()}.apply(null,n))||(e.exports=o)},610:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(344),r(356),r(124),r(350),r(353),r(343),r(339),r(349),r(611),r(378),r(612)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c,d){function y(e){return l.create(function(t){function r(o){var i=c.receiveMessage(o);if(i)switch(i.type){case S:f(e);break;case b:e.removeEventListener("message",r),e.removeEventListener("error",n),t(e)}}function n(t){t.preventDefault(),e.removeEventListener("message",r),e.removeEventListener("error",n),v.warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new d).addEventListener("message",r),e.addEventListener("error",n)}e.addEventListener("message",r),e.addEventListener("error",n)})}function f(e){var t,i=o.workers.loaderUrl||p.DEFAULT_LOADER_URL;if(null!=o.default){var a=r({},o);delete a.default,t=JSON.parse(JSON.stringify(a))}else t=JSON.parse(JSON.stringify(o));var l=o.workers.loaderConfig,u=p.default({baseUrl:l.baseUrl,locale:n.locale,has:r({"config-deferredInstrumentation":0,"dojo-test-sniff":0,"esri-secure-context":s("esri-secure-context"),"esri-workers-arraybuffer-transfer":s("esri-workers-arraybuffer-transfer"),"events-keypress-typed":0,"host-webworker":1},l.has),map:r({},l.map),paths:r({},l.paths),packages:l.packages||[]});e.postMessage({type:w,configure:{esriConfig:t,loaderUrl:i,loaderConfig:u}})}Object.defineProperty(t,"__esModule",{value:!0});var h=u.normalize(e.toUrl("./worker.js")),m=!u.hasSameOrigin(h,location.href),v=a.getLogger("esri.core.workers"),g=null;s.add("esri-workers-arraybuffer-transfer",!s("safari")||s("safari")>=12);var b=c.MessageType.CONFIGURED,w=c.MessageType.CONFIGURE,S=c.MessageType.HANDSHAKE;t.createWorker=function(){if(!s("esri-workers"))return y(new d);if(!m){var e=void 0;try{e=new Worker(h)}catch(t){v.warn("Failed to create Worker. Fallback to execute module in main thread",event),e=new d}return y(e)}return g||(g=i(h,{responseType:"text"})),g.then(function(e){return new Worker(URL.createObjectURL(new Blob([e.data],{type:"text/javascript"})))}).catch(function(e){return v.warn("Failed to create Worker. Fallback to execute module in main thread",e),new d}).then(function(e){return y(e)})}}.apply(null,n))||(e.exports=o)},611:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(344),r(355),r(349)],void 0===(o=function(e,t,r,n,o){function i(t){return o.removeQueryParameters(e.toUrl(t))}function s(e,t){for(var n=0,s=e;n<s.length;n++)if(s[n].name===t.name)return;var a=r({},t),l=i(a.name+"/x.js"),u=l.slice(0,l.length-5);a.location=o.makeAbsolute(u),e.push(a)}Object.defineProperty(t,"__esModule",{value:!0});var a=n("esri-built")?"dojo/dojo-lite.js":"dojo/dojo.js";t.DEFAULT_LOADER_URL=o.makeAbsolute(i(a)),t.DEFAULT_CONFIG={baseUrl:function(){var e=i("dojo/x.js");return o.makeAbsolute(e.slice(0,e.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette",main:"dist/maquette.umd"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}},t.default=function(e){var n={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:r({},e.has),map:r({},e.map),packages:e.packages&&e.packages.concat()||[],paths:r({},e.paths)};e.hasOwnProperty("async")||(n.async=!0),e.hasOwnProperty("isDebug")||(n.isDebug=!1),e.baseUrl||(n.baseUrl=t.DEFAULT_CONFIG.baseUrl),t.DEFAULT_CONFIG.packages.forEach(function(e){s(n.packages,e)});for(var o=n.map=n.map||{},i=0,a=Object.keys(t.DEFAULT_CONFIG.map);i<a.length;i++){var l=a[i];o[l]||(o[l]=t.DEFAULT_CONFIG.map[l])}return n}}.apply(null,n))||(e.exports=o)},612:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(355),r(453),r(378)],void 0===(o=function(e,t,n,o,i){var s=function(){return function(){var e=this,t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(r){e[r]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t[r].apply(t,e)}})}}(),a=o.MutationObserver||o.WebKitMutationObserver,l=function(){var e;if(o.process&&o.process.nextTick)e=function(e){o.process.nextTick(e)};else if(o.Promise)e=function(e){o.Promise.resolve().then(e)};else if(a){var t=[],r=document.createElement("div");new a(function(){for(;t.length>0;)t.shift()()}).observe(r,{attributes:!0}),e=function(e){t.push(e),r.setAttribute("queueStatus","1")}}return e}();return function(){function t(){this._dispatcher=new s,this._isInitialized=!1,this._workerPostMessage({type:i.MessageType.HANDSHAKE})}return t.prototype.terminate=function(){},Object.defineProperty(t.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)},enumerable:!0,configurable:!0}),t.prototype.postMessage=function(e,t){var r=this;l(function(){r._workerMessageHandler(new MessageEvent("message",{data:e}))})},t.prototype.dispatchEvent=function(e){return this._dispatcher.dispatchEvent(e)},t.prototype.addEventListener=function(e,t,r){this._dispatcher.addEventListener(e,t,r)},t.prototype.removeEventListener=function(e,t,r){this._dispatcher.removeEventListener(e,t,r)},t.prototype._workerPostMessage=function(e,t){var r=this;l(function(){r.dispatchEvent(new MessageEvent("message",{data:e}))})},t.prototype._workerMessageHandler=function(t){var o=this,s=i.receiveMessage(t);if(s){var a=s.jobId;switch(s.type){case i.MessageType.CONFIGURE:this._isInitialized||this._workerPostMessage({type:i.MessageType.CONFIGURED});break;case i.MessageType.OPEN:var l=s.modulePath;n("esri-webpack")?Promise.all([r.e(3),r.e(2),r.e(5),r.e(7),r.e(67)]).then(function(){var t=[r(389),r(752),r(753),r(735),r(716),r(754),r(682),e(l,null,!1)];(function(e,t,r,n,s,l,u,p){var c;switch(p){case"esri/views/vectorTiles/WorkerTileHandler":c=t;break;case"esri/views/2d/layers/features/Pipeline":c=r;break;case"esri/views/3d/layers/PointCloudWorker":c=n;break;case"esri/views/3d/layers/SceneLayerWorker":c=s;break;case"esri/layers/graphics/sources/support/CSVSourceWorker":c=l;break;case"esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker":c=u;break;default:c=p}var d=e.connect(c);o._workerPostMessage({type:i.MessageType.OPENED,jobId:a,data:d})}).apply(null,t)}).catch(r.oe):Promise.resolve().then(function(){var t=[r(389),e(l,null,!1)];(function(e,t){var r=e.connect(t);o._workerPostMessage({type:i.MessageType.OPENED,jobId:a,data:r})}).apply(null,t)}).catch(r.oe)}}},t}()}.apply(null,n))||(e.exports=o)},613:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(357),r(363)],void 0===(o=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.graphicsExtent=function(e){if(!e||!e.length)return null;var t=r.isCollection(e)?e.getItemAt(0).geometry:e[0].geometry,o=t.extent,i=t;null===o&&(o=new n(i.x,i.y,i.x,i.y,t.spatialReference));for(var s=1;s<e.length;s++){i=t=r.isCollection(e)?e.getItemAt(s).geometry:e[s].geometry;var a=t.extent;null===a&&(a=new n(i.x,i.y,i.x,i.y,t.spatialReference)),o=o.clone().union(a)}return o.width<0&&o.height<0?null:o},t.getGeometries=function(e){return e.map(function(e){return e.geometry})},t._encodeGraphics=function(e,t){var r=[];return e.forEach(function(e,n){var o=e.toJSON(),i={};if(o.geometry){var s=t&&t[n];i.geometry=s&&s.toJSON()||o.geometry}o.attributes&&(i.attributes=o.attributes),r[n]=i}),r}}.apply(null,n))||(e.exports=o)},615:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(414),r(415),r(370),r(412),r(416)],void 0===(o=function(e,t,r,n,o,i,s){Object.defineProperty(t,"__esModule",{value:!0}),t.types={key:"type",base:o,typeMap:{heatmap:n,simple:i,"unique-value":s,"class-breaks":r}}}.apply(null,n))||(e.exports=o)},621:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(346),r(357),r(406)],void 0===(o=function(e,t,r,n,o){function i(e){return e instanceof r}function s(e){return e instanceof n?Object.keys(e.items):i(e)?o.getProperties(e).keys():e?Object.keys(e):[]}function a(e,t){return e instanceof n?e.items[t]:e[t]}function l(e){return e?e.declaredClass:null}function u(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var n=s(e),o=s(t);if(0!==n.length||0!==o.length){if(!n.length||!o.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var c=o.filter(function(e){return-1===n.indexOf(e)}),d=n.filter(function(e){return-1===o.indexOf(e)}),y=n.filter(function(r){return o.indexOf(r)>-1&&a(e,r)!==a(t,r)}).concat(c,d).sort(),f=l(e);if(f&&p.indexOf(f)>-1&&y.length)return{type:"complete",oldValue:e,newValue:t};var h,m=i(e)&&i(t);for(var v in y){var g=y[v],b=a(e,g),w=a(t,g),S=void 0;(m||"function"!=typeof b&&"function"!=typeof w)&&b!==w&&(null==b&&null==w||(S=r&&r[g]&&"function"==typeof r[g]?r[g](b,w):"object"==typeof b&&"object"==typeof w&&l(b)===l(w)?u(b,w):{type:"complete",oldValue:b,newValue:w})&&((h=h||{type:"partial",diff:{}}).diff[g]=S))}return h}}Object.defineProperty(t,"__esModule",{value:!0});var p=["esri.Color","esri.portal.Portal"];t.diff=function(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&l(e)!==l(t)?{type:"complete",oldValue:e,newValue:t}:u(e,t)}}.apply(null,n))||(e.exports=o)},634:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(350),r(431),r(341),r(339),r(349),r(411),r(673),r(361),r(757),r(747)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c){function d(e,t){return t.load().then(function(){var r=new l({disableExtraQuery:!0,query:"owner:"+v+" AND type:"+g+' AND typekeywords:"'+e+'"'});return t.queryItems(r)}).then(function(t){var r=t.results,n=null,i=e.toLowerCase();if(r&&Array.isArray(r))for(var s=0,a=r;s<a.length;s++){var l=a[s];if(l.typeKeywords.some(function(e){return e.toLowerCase()===i})&&l.type===g&&l.owner===v){n=l;break}}if(n)return n.load();throw new o("symbolstyleutils:style-not-found","The style '"+e+"' could not be found",{styleName:e})})}function y(e,t){return e.styleUrl?function(e,t){return h(e).then(function(t){return{data:t.data,baseUrl:s.removeFile(e),styleUrl:e}})}(e.styleUrl):e.styleName?function(e,t){var r,n=t.portal||a.getDefault(),o=n.url+" - "+(n.user&&n.user.username)+" - "+e;return m[o]||(m[o]=d(e,n).then(function(e){return r=e,e.fetchData()}).then(function(t){return{data:t,baseUrl:r.itemUrl,styleName:e}})),m[o]}(e.styleName,t):i.reject(new o("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function f(e,t,r){for(var a=e.data,l={portal:r.portal,url:s.urlToObject(e.baseUrl),origin:"portal-item"},d=0,y=a.items;d<y.length;d++){var f=function(o){if(o.name!==t)return"continue";var i=s.read(o.webRef,l),a={portal:r.portal,url:s.urlToObject(s.removeFile(i)),origin:"portal-item"};return{value:h(i).then(function(i){var d=u.fromJSON(i.data,a);if(d&&d.isInstanceOf(n.BaseSymbol3D)){if(o.thumbnail)if(o.thumbnail.href){var y=s.read(o.thumbnail.href,l);d.thumbnail=new c.default({url:y})}else o.thumbnail.imageData&&(d.thumbnail=new c.default({url:"data:image/png;base64,"+o.thumbnail.imageData}));e.styleUrl?d.styleOrigin=new p({portal:r.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(d.styleOrigin=new p({portal:r.portal,styleName:e.styleName,name:t}))}return d})}}(y[d]);if("object"==typeof f)return f.value}return i.reject(new o("symbolstyleutils:symbol-name-not-found","The symbol name '"+t+"' could not be found",{symbolName:t}))}function h(e){var t={responseType:"json",query:{f:"json"}};return r(s.normalize(e),t)}Object.defineProperty(t,"__esModule",{value:!0});var m={};t.fetchStyle=y,t.resolveWebStyleSymbol=function(e,t){return e.name?y(e,t).then(function(r){return f(r,e.name,t)}):i.reject(new o("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))},t.fetchSymbolFromStyle=f,t.styleNameFromItem=function(e){for(var t=0,r=e.typeKeywords;t<r.length;t++){var n=r[t];if(/^Esri.*Style$/.test(n)&&"Esri Style"!==n)return n}};var v="esri_en",g="Style"}.apply(null,n))||(e.exports=o)},635:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(339),r(442)],void 0===(o=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadStyleRenderer=function(e,t){var o=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);return o&&"unique-value"===o.type&&o.styleOrigin?o.populateFromStyle().catch(function(r){t&&t.messages&&t.messages.push(new n("renderer:style-reference","Failed to create unique value renderer from style reference: "+r.message,{error:r,context:t})),e.clear("renderer",t.origin)}).then(function(){return null}):r.resolve(null)}}.apply(null,n))||(e.exports=o)},637:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(414),r(415),r(370),r(412),r(416),r(423)],void 0===(o=function(e,t,r,n,o,i,s,a){Object.defineProperty(t,"__esModule",{value:!0}),t.ClassBreaksRenderer=r,t.HeatmapRenderer=n,t.BaseRenderer=o,t.SimpleRenderer=i,t.UniqueValueRenderer=s,t.isRenderer=function(e){return e instanceof t.BaseRenderer},t.fromJSON=a.fromJSON}.apply(null,n))||(e.exports=o)},641:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(338),r(336),r(642)],void 0===(o=function(e,t,r,n,o,i,s,a,l){var u=i({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),p=i({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance"}),c=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];return function(e){function t(t){var r=e.call(this)||this;return r.lengthUnit=null,r.visualVariables=null,r}var o;return r(t,e),o=t,Object.defineProperty(t.prototype,"classificationMethod",{get:function(){var e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e},set:function(e){this._set("classificationMethod",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(e){this._set("fields",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},set:function(e){this._set("field1",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"field2",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(e){this._set("field2",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(e){this._set("focus",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(e){this._set("numClasses",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"standardDeviationInterval",{get:function(){var e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(e){this._set("standardDeviationInterval",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._get("type")},set:function(e){var t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new o({classificationMethod:this.classificationMethod,fields:this.fields&&this.fields.slice(0),field1:s.clone(this.field1),field2:s.clone(this.field2),focus:this.focus,numClasses:this.numClasses,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(e){return e.clone()})})},n([a.property({type:u.apiValues,value:null,dependsOn:["type"],json:{type:u.jsonValues,read:u.read,write:u.write}})],t.prototype,"classificationMethod",null),n([a.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"fields",null),n([a.property({value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"field1",null),n([a.property({value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"field2",null),n([a.property({type:String,value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"focus",null),n([a.property({type:Number,value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"numClasses",null),n([a.property({type:c,json:{type:c,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],t.prototype,"lengthUnit",void 0),n([a.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],t.prototype,"standardDeviationInterval",null),n([a.property({type:String,value:null,json:{type:p.jsonValues,read:p.read,write:p.write}})],t.prototype,"type",null),n([a.property({type:[l],json:{write:!0}})],t.prototype,"visualVariables",void 0),o=n([a.subclass("esri.renderers.support.AuthoringInfo")],t)}(a.declared(o))}.apply(null,n))||(e.exports=o)},642:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336),r(698)],void 0===(o=function(e,t,r,n,o,i,s,a){var l=i({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),u=i({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity"}),p={key:function(e){return"number"==typeof e?"number":"string"},typeMap:{number:Number,string:String},base:null},c=["high-to-low","above-and-below","centered-on","extremes"],d=["seconds","minutes","hours","days","months","years"];return function(e){function t(t){var r=e.call(this)||this;return r.endTime=null,r.field=null,r.maxSliderValue=null,r.minSliderValue=null,r.startTime=null,r.type=null,r.units=null,r}var o;return r(t,e),o=t,t.prototype.castEndTime=function(e){return"string"==typeof e||"number"==typeof e?e:null},t.prototype.castStartTime=function(e){return"string"==typeof e||"number"==typeof e?e:null},Object.defineProperty(t.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(e){this._set("style",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(e){this._set("theme",e)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new o({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})},n([s.property({types:p,json:{write:!0}})],t.prototype,"endTime",void 0),n([a.cast("endTime")],t.prototype,"castEndTime",null),n([s.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"maxSliderValue",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"minSliderValue",void 0),n([s.property({types:p,json:{write:!0}})],t.prototype,"startTime",void 0),n([a.cast("startTime")],t.prototype,"castStartTime",null),n([s.property({type:l.apiValues,value:null,dependsOn:["type"],json:{type:l.jsonValues,read:l.read,write:l.write}})],t.prototype,"style",null),n([s.property({type:c,value:null,dependsOn:["type"],json:{type:c,write:!0}})],t.prototype,"theme",null),n([s.property({type:u.apiValues,json:{type:u.jsonValues,read:u.read,write:u.write}})],t.prototype,"type",void 0),n([s.property({type:d,json:{type:d,write:!0}})],t.prototype,"units",void 0),o=n([s.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},643:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(361),r(375)],void 0===(o=function(e,t,r,n,o,i,s,a){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=null,t.maxValue=0,t.symbol=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})},n([i.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([i.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([i.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),n([i.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),n([i.property({types:a.rendererTypes,json:{origins:{"web-scene":{read:s.read,write:{target:{symbol:{types:a.rendererTypes3D}},writer:s.writeTarget}}},read:s.read,write:s.writeTarget}})],t.prototype,"symbol",void 0),o=n([i.subclass("esri.renderers.support.ClassBreakInfo")],t)}(i.declared(o));t.ClassBreakInfo=l,t.default=l}.apply(null,n))||(e.exports=o)},644:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(358),r(340),r(336)],void 0===(o=function(e,t,r,n,o,i,s){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var r=e.call(this)||this;return r.color=null,r.ratio=null,r}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({color:this.color,ratio:this.ratio})},n([s.property({type:o,json:{write:!0}})],t.prototype,"color",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"ratio",void 0),i=n([s.subclass("esri.renderers.support.HeatmapColorStop")],t)}(s.declared(i));t.HeatmapColorStop=a,t.default=a}.apply(null,n))||(e.exports=o)},645:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(361),r(375)],void 0===(o=function(e,t,r,n,o,i,s,a){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.symbol=null,t.value=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})},n([i.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([i.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([i.property({types:a.rendererTypes,json:{origins:{"web-scene":{read:s.read,write:{target:{symbol:{types:a.rendererTypes3D}},writer:s.writeTarget}}},read:s.read,write:s.writeTarget}})],t.prototype,"symbol",void 0),n([i.property({type:String,json:{write:!0}})],t.prototype,"value",void 0),o=n([i.subclass("esri.renderers.support.UniqueValueInfo")],t)}(i.declared(o));t.UniqueValueInfo=l,t.default=l}.apply(null,n))||(e.exports=o)},646:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isOfType=function(e,t){var r=e.constructor._meta;if(!r||!r.bases)return!1;var n=r.bases,o=Array.isArray(t);return n.some(function(e){var r=e.__accessorMetadata__;if(!r)return!1;var n=r.properties;if(!n||!n.type||!n.type.value)return!1;var i=n.type.value;return o?-1!==t.indexOf(i):i===t})}}.apply(null,n))||(e.exports=o)},652:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(338),r(336),r(395),r(447)],void 0===(o=function(e,t,r,n,o,i,s,a,l){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return r(t,e),o=t,t.fromWorker=function(e){if(!e)return null;var t=JSON.parse(e),r=new o;return r.fields=t.fields&&t.fields.map(function(e){return a.fromJSON(e)}),r.options=t.options,r.process=new(Function.bind.apply(Function,[void 0].concat(t.process.args,[t.process.body]))),r},Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new o(i.clone({fields:this.fields,options:this.options,process:this.process}))},t.prototype.getField=function(e){return l.getField(e,this.fields)},t.prototype.refresh=function(){this.notifyChange("version")},t.prototype.toWorker=function(){var e=this.process.toString();return JSON.stringify({fields:this.fields,options:this.options,process:{body:e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),args:e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g)}})},n([s.property({type:[a]})],t.prototype,"fields",void 0),n([s.property()],t.prototype,"options",void 0),n([s.property()],t.prototype,"process",void 0),n([s.property({readOnly:!0,dependsOn:["process","options","fields"]})],t.prototype,"version",null),o=n([s.subclass("esri.layers.support.FeatureProcessing")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},661:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(455)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="selection",t}return r(t,e),n([o.property()],t.prototype,"type",void 0),n([o.subclass("esri.layers.support.FeatureReductionSelection")],t)}(o.declared(i.default));t.FeatureReductionSelection=s,t.default=s}.apply(null,n))||(e.exports=o)},662:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(451)],void 0===(o=function(e,t,r,n,o,i,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.expression=null,t}var o;return r(t,e),o=t,t.prototype.readExpression=function(e,t){return t.value?s.convertTemplatedStringToArcade(t.value):e},t.prototype.writeExpression=function(e,t,r){null!=this.value&&(e=s.convertTemplatedStringToArcade(this.value)),t[r]=e},t.prototype.clone=function(){return new o({value:this.value,expression:this.expression})},n([i.property({json:{read:!1,write:!1}})],t.prototype,"value",void 0),n([i.property({json:{write:{allowNull:!0}}})],t.prototype,"expression",void 0),n([i.reader("expression",["expression","value"])],t.prototype,"readExpression",null),n([i.writer("expression")],t.prototype,"writeExpression",null),o=n([i.subclass("esri.layers.support.LabelExpressionInfo")],t)}(i.declared(o))}.apply(null,n))||(e.exports=o)},663:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(405)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.replace=function(e,t,n){return void 0===n&&(n=/\{([^\}]+)\}/g),e.replace(n,"function"==typeof t?t:function(e,n){return r.getDeepValue(n,t)})}}.apply(null,n))||(e.exports=o)},664:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(427)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=/\[([^\[\]]+)\]/gi;t.reader=function(e,t,o){var i=this;return e?e.map(function(e){var s=new r;if(s.read(e,o),s.labelExpression){var a=t.fields||t.layerDefinition&&t.layerDefinition.fields||i.fields;s.labelExpression=s.labelExpression.replace(n,function(e,t){return"["+function(e,t){if(!t)return e;for(var r=e.toLowerCase(),n=0;n<t.length;n++){var o=t[n].name;if(o.toLowerCase()===r)return o}return e}(t,a)+"]"})}return s}):null}}.apply(null,n))||(e.exports=o)},671:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(364),r(383),r(346),r(357),r(341),r(353),r(347),r(623),r(343),r(446),r(437),r(336),r(360),r(674),r(392),r.dj.m(e)],void 0===(o=function(e,t,r,n,o,i,s,a,l,u,p,c,d,y,f,h,m,v,g,b){function w(e){var t=e.geometry,r=e.attributes;return{geometry:t&&"mesh"!==t.type?t&&t.toJSON():null,attributes:r}}Object.defineProperty(t,"__esModule",{value:!0});var S=p({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),j=d.getLogger("esri.layers.graphics.sources.MemorySource"),_=function(t){function s(){return null!==t&&t.apply(this,arguments)||this}return r(s,t),s.prototype.load=function(){var t=this;return this.addResolvingPromise(f.open(y.getAbsMid("./support/MemorySourceWorker",e,b),{client:this,strategy:u("esri-workers-for-memory-layers")?"dedicated":"local"}).then(function(e){t._connection=e;var r=t.layer,n=r.fields,o=r.spatialReference,i=r.geometryType,s=r.objectIdField,a=r.hasM,l=r.hasZ;return e.invoke("load",{features:t.items.map(w),fields:n&&n.map(function(e){return e.toJSON()}),geometryType:S.toJSON(i),hasM:a,hasZ:l,objectIdField:s,spatialReference:o&&o.toJSON()}).then(function(e){e.featureErrors.length&&j.warn("Encountered "+e.featureErrors.length+" validation errors while loading features",e.featureErrors),t.layerDefinition=e.layerDefinition})})),this.when()},s.prototype.applyEdits=function(e){var t=this;return this.load().then(function(){return t._applyEdits(e)})},s.prototype.openPorts=function(){var e=this;return this.load().then(function(){return e._connection.openPorts()})},s.prototype.queryFeatures=function(e){return this.queryFeaturesJSON(e).then(function(e){return g.fromJSON(e)})},s.prototype.queryFeaturesJSON=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryFeatures",e?e.toJSON():null)})},s.prototype.queryFeatureCount=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null)})},s.prototype.queryObjectIds=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null)})},s.prototype.queryExtent=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryExtent",e?e.toJSON():null)}).then(function(e){return{count:e.count,extent:o.Extent.fromJSON(e.extent)}})},s.prototype._applyEdits=function(e){var t=this;if(!this._connection)throw new l("feature-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,n=[],o=[],i=[];if(e.addFeatures)for(var s=0,a=e.addFeatures;s<a.length;s++){var u=a[s];n.push(w(u))}if(e.deleteFeatures)for(var p=0,c=e.deleteFeatures;p<c.length;p++){var d=c[p];"objectId"in d&&null!=d.objectId?o.push(d.objectId):"attributes"in d&&null!=d.attributes[r]&&o.push(d.attributes[r])}if(e.updateFeatures)for(var y=0,f=e.updateFeatures;y<f.length;y++){u=f[y];i.push(w(u))}return this._connection.invoke("applyEdits",{adds:n,updates:i,deletes:o}).then(function(e){var r=e.fullExtent,n=e.featureEditResults;return t.fullExtent=r,t._createEditsResult(n)})},s.prototype._createEditsResult=function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[]}},s.prototype._createFeatureEditResult=function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new l("feature-layer-source:edit-failure",t.description,{code:t.code}):null}},n([v.shared({Type:i,ensureType:m.ensureType(i)})],s.prototype,"itemType",void 0),n([h.property({constructOnly:!0})],s.prototype,"layer",void 0),n([h.property()],s.prototype,"layerDefinition",void 0),n([h.subclass("esri.layers.graphics.sources.MemorySource")],s)}(h.declared(s,a,c));t.MemorySource=_,t.default=_}.apply(null,n))||(e.exports=o)},674:function(e,t,r){var n,o;n=[r(351),r(675),r(340),r(338)],void 0===(o=function(e,t,r,n){return{subclass:function(o,i){return function(i){var s=t.declareDefinition(i,o);a&&(s.instanceMembers.properties=function e(t,r){if(!t)return r;if(!r)return t;for(var n in r){var o=t[n],i=r[n];Array.isArray(i)&&Array.isArray(o)?t[n]=o.concat(i):t[n]="object"==typeof i&&"object"==typeof o?e(o,i):i}return t}(a,s.instanceMembers.properties));var a=s.instanceMembers.properties;if(a)for(var l in a){var u=a[l];u&&!u.reader&&u.type&&(u.type===Date?u.reader=function(e){return null!=e?new Date(e):null}:-1!==u.type._meta.bases.indexOf(r)&&(u.reader=function(e){return function(t){return e.fromJSON(t)}}(u.type)))}return n.mixin(e(s.bases,s.instanceMembers),s.classMembers)}},shared:t.shared,property:function(e){return function(t,r){var n=Object.getPrototypeOf(t),o=n&&n.properties;t.properties&&t.properties!==o||(t.properties={}),t.properties=t.properties||{},t.properties[r]=e||{}}}}}.apply(null,n))||(e.exports=o)},675:function(e,t,r){var n,o;n=[r(351),r(338)],void 0===(o=function(e,t){var r={declareDefinition:function(e,t){var r,n=[],o=Object.getPrototypeOf(e.prototype);if(o!==Object.prototype){var i=o.constructor;r=i.prototype,n.push(i)}t&&(n=n.concat(t));for(var s={},a=Object.getOwnPropertyNames(e.prototype),l=0;l<a.length;l++){var u=a[l];if("constructor"!==u){var p=u;"dojoConstructor"===u&&(p="constructor"),r&&e.prototype[u]===r[u]||(s[p]=e.prototype[u])}}a=Object.getOwnPropertyNames(e);var c=Object.getOwnPropertyNames(o.constructor),d={};for(l=0;l<a.length;l++)u=a[l],-1===c.indexOf(u)&&(d[u]=e[u]);return{bases:n,instanceMembers:s,classMembers:d}},subclass:function(n){return function(o){var i=r.declareDefinition(o,n);return t.mixin(e(i.bases,i.instanceMembers),i.classMembers)}},shared:function(e){return function(t,r){t[r]=e}}};return r}.apply(null,n))||(e.exports=o)},676:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(o=function(e,t,r,n,o,i){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){return e.call(this,t)||this}var o;return r(t,e),o=t,t.prototype.clone=function(){var e=this,t=e.name,r=e.fields,n=e.isAscending,i=e.isUnique,s=e.description;return new o({name:t,fields:r,isAscending:n,isUnique:i,description:s})},n([i.property({constructOnly:!0})],t.prototype,"name",void 0),n([i.property({constructOnly:!0})],t.prototype,"fields",void 0),n([i.property({constructOnly:!0})],t.prototype,"isAscending",void 0),n([i.property({constructOnly:!0})],t.prototype,"isUnique",void 0),n([i.property({constructOnly:!0})],t.prototype,"description",void 0),o=n([i.subclass("esri.layers.support.FeatureIndex")],t)}(i.declared(o));t.FeatureIndex=s,t.default=s}.apply(null,n))||(e.exports=o)},677:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(338),r(336),r(399),r(588)],void 0===(o=function(e,t,r,n,o,i,s,a,l){return function(e){function t(t){var r=e.call(this,t)||this;return r.id=null,r.name=null,r.domains=null,r.templates=null,r}return r(t,e),t.prototype.readDomains=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(n.type){case"range":t[r]=a.RangeDomain.fromJSON(n);break;case"codedValue":t[r]=a.CodedValueDomain.fromJSON(n);break;case"inherited":t[r]=a.InheritedDomain.fromJSON(n)}}return t},t.prototype.writeDomains=function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]&&e[n].toJSON());i.fixJson(r),t.domains=r},t.prototype.readTemplates=function(e){return e&&e.map(function(e){return new l(e)})},t.prototype.writeTemplates=function(e,t){t.templates=e&&e.map(function(e){return e.toJSON()})},n([s.property({json:{write:!0}})],t.prototype,"id",void 0),n([s.property({json:{write:!0}})],t.prototype,"name",void 0),n([s.property({json:{write:!0}})],t.prototype,"domains",void 0),n([s.reader("domains")],t.prototype,"readDomains",null),n([s.writer("domains")],t.prototype,"writeDomains",null),n([s.property({json:{write:!0}})],t.prototype,"templates",void 0),n([s.reader("templates")],t.prototype,"readTemplates",null),n([s.writer("templates")],t.prototype,"writeTemplates",null),n([s.subclass("esri.layers.support.FeatureType")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},678:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336)],void 0===(o=function(e,t,r,n,o,i,s){var a=i({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"});return function(e){function t(t){var r=e.call(this,t)||this;return r.cardinality=null,r.id=null,r.keyField=null,r.name=null,r.relatedTableId=null,r}return r(t,e),n([s.property({json:{read:a.read,write:a.write}})],t.prototype,"cardinality",void 0),n([s.property({json:{read:!0,write:!0}})],t.prototype,"id",void 0),n([s.property({json:{read:!0,write:!0}})],t.prototype,"keyField",void 0),n([s.property({json:{read:!0,write:!0}})],t.prototype,"name",void 0),n([s.property({json:{read:!0,write:!0}})],t.prototype,"relatedTableId",void 0),n([s.subclass("esri.layers.support.Relationship")],t)}(s.declared(o))}.apply(null,n))||(e.exports=o)},701:function(e,t,r){var n,o;n=[r(351),r(338),r(354),r(458),r(586)],void 0===(o=function(e,t,r,n,o){var i={width:12,height:12,angle:0,xoffset:0,yoffset:0},s=e(n,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker",url:o.urlPropertyDefinition,source:o.sourcePropertyDefinition,height:{json:{read:{source:["height","size"],reader:function(e,t){return t.size||e}},write:!0},cast:r.toPt},width:{json:{read:{source:["width","size"],reader:function(e,t){return t.size||e}},write:!0},cast:r.toPt},size:{json:{write:!1}}},getDefaults:function(){return t.mixin(this.inherited(arguments),i)},normalizeCtorArgs:function(e,t,n){if(e&&"string"!=typeof e&&null==e.imageData)return e;var o={};return e&&(o.url=e),null!=t&&(o.width=r.toPt(t)),null!=n&&(o.height=r.toPt(n)),o},clone:function(){var e=new s({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",t.clone(this.source)),e}});return s.defaultProps=i,s}.apply(null,n))||(e.exports=o)},702:function(e,t,r){var n,o;n=[r(351),r(338),r(457),r(402)],void 0===(o=function(e,t,r,n){var o={style:"solid",outline:new n,color:[0,0,0,.25]},i=e(r,{declaredClass:"esri.symbols.SimpleFillSymbol",properties:{color:{},type:"simple-fill",style:{value:"solid",type:String,json:{read:function(e){return t.valueOf(this._styles,e)||void 0},write:function(e,t){t.style=this._styles[e]}}}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal","backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return t.mixin(this.inherited(arguments),o)},normalizeCtorArgs:function(e,t,r){if(e&&"string"!=typeof e)return e;var n={};return e&&(n.style=e),t&&(n.outline=t),r&&(n.color=r),n},clone:function(){return new i({color:t.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}});return t.mixin(i,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"}),i.defaultProps=o,i}.apply(null,n))||(e.exports=o)},730:function(e,t,r){var n={"./af":463,"./af.js":463,"./ar":464,"./ar-dz":465,"./ar-dz.js":465,"./ar-kw":466,"./ar-kw.js":466,"./ar-ly":467,"./ar-ly.js":467,"./ar-ma":468,"./ar-ma.js":468,"./ar-sa":469,"./ar-sa.js":469,"./ar-tn":470,"./ar-tn.js":470,"./ar.js":464,"./az":471,"./az.js":471,"./be":472,"./be.js":472,"./bg":473,"./bg.js":473,"./bm":474,"./bm.js":474,"./bn":475,"./bn.js":475,"./bo":476,"./bo.js":476,"./br":477,"./br.js":477,"./bs":478,"./bs.js":478,"./ca":479,"./ca.js":479,"./cs":480,"./cs.js":480,"./cv":481,"./cv.js":481,"./cy":482,"./cy.js":482,"./da":483,"./da.js":483,"./de":484,"./de-at":485,"./de-at.js":485,"./de-ch":486,"./de-ch.js":486,"./de.js":484,"./dv":487,"./dv.js":487,"./el":488,"./el.js":488,"./en-au":489,"./en-au.js":489,"./en-ca":490,"./en-ca.js":490,"./en-gb":491,"./en-gb.js":491,"./en-ie":492,"./en-ie.js":492,"./en-il":493,"./en-il.js":493,"./en-nz":494,"./en-nz.js":494,"./eo":495,"./eo.js":495,"./es":496,"./es-do":497,"./es-do.js":497,"./es-us":498,"./es-us.js":498,"./es.js":496,"./et":499,"./et.js":499,"./eu":500,"./eu.js":500,"./fa":501,"./fa.js":501,"./fi":502,"./fi.js":502,"./fo":503,"./fo.js":503,"./fr":504,"./fr-ca":505,"./fr-ca.js":505,"./fr-ch":506,"./fr-ch.js":506,"./fr.js":504,"./fy":507,"./fy.js":507,"./gd":508,"./gd.js":508,"./gl":509,"./gl.js":509,"./gom-latn":510,"./gom-latn.js":510,"./gu":511,"./gu.js":511,"./he":512,"./he.js":512,"./hi":513,"./hi.js":513,"./hr":514,"./hr.js":514,"./hu":515,"./hu.js":515,"./hy-am":516,"./hy-am.js":516,"./id":517,"./id.js":517,"./is":518,"./is.js":518,"./it":519,"./it.js":519,"./ja":520,"./ja.js":520,"./jv":521,"./jv.js":521,"./ka":522,"./ka.js":522,"./kk":523,"./kk.js":523,"./km":524,"./km.js":524,"./kn":525,"./kn.js":525,"./ko":526,"./ko.js":526,"./ky":527,"./ky.js":527,"./lb":528,"./lb.js":528,"./lo":529,"./lo.js":529,"./lt":530,"./lt.js":530,"./lv":531,"./lv.js":531,"./me":532,"./me.js":532,"./mi":533,"./mi.js":533,"./mk":534,"./mk.js":534,"./ml":535,"./ml.js":535,"./mn":536,"./mn.js":536,"./mr":537,"./mr.js":537,"./ms":538,"./ms-my":539,"./ms-my.js":539,"./ms.js":538,"./mt":540,"./mt.js":540,"./my":541,"./my.js":541,"./nb":542,"./nb.js":542,"./ne":543,"./ne.js":543,"./nl":544,"./nl-be":545,"./nl-be.js":545,"./nl.js":544,"./nn":546,"./nn.js":546,"./pa-in":547,"./pa-in.js":547,"./pl":548,"./pl.js":548,"./pt":549,"./pt-br":550,"./pt-br.js":550,"./pt.js":549,"./ro":551,"./ro.js":551,"./ru":552,"./ru.js":552,"./sd":553,"./sd.js":553,"./se":554,"./se.js":554,"./si":555,"./si.js":555,"./sk":556,"./sk.js":556,"./sl":557,"./sl.js":557,"./sq":558,"./sq.js":558,"./sr":559,"./sr-cyrl":560,"./sr-cyrl.js":560,"./sr.js":559,"./ss":561,"./ss.js":561,"./sv":562,"./sv.js":562,"./sw":563,"./sw.js":563,"./ta":564,"./ta.js":564,"./te":565,"./te.js":565,"./tet":566,"./tet.js":566,"./tg":567,"./tg.js":567,"./th":568,"./th.js":568,"./tl-ph":569,"./tl-ph.js":569,"./tlh":570,"./tlh.js":570,"./tr":571,"./tr.js":571,"./tzl":572,"./tzl.js":572,"./tzm":573,"./tzm-latn":574,"./tzm-latn.js":574,"./tzm.js":573,"./ug-cn":575,"./ug-cn.js":575,"./uk":576,"./uk.js":576,"./ur":577,"./ur.js":577,"./uz":578,"./uz-latn":579,"./uz-latn.js":579,"./uz.js":578,"./vi":580,"./vi.js":580,"./x-pseudo":581,"./x-pseudo.js":581,"./yo":582,"./yo.js":582,"./zh-cn":583,"./zh-cn.js":583,"./zh-hk":584,"./zh-hk.js":584,"./zh-tw":585,"./zh-tw.js":585};function o(e){var t=i(e);return r(t)}function i(e){var t=n[e];if(!(t+1)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=730},795:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(435),r(669),r(350),r(341),r(343),r(339),r(349),r(336),r(461),r(406),r(331),r(398),r(1070),r(429),r(429),r(455),r(661),r(395),r(447),r(427),r(664),r(1507),r(713),r(423),r(635),r(615),r(731),r(419)],void 0===(o=function(e,t,n,o,i,s,a,l,u,p,c,d,y,f,h,m,v,g,b,w,S,j,_,I,x,O,F,T,E,D,C,V,L){function R(e,t,r){return e&&((e=E.read(e,t,r)||void 0)||P.error("Failed to create renderer",{rendererDefinition:e,layer:this,context:r})),e}var N=["3DObject","Point"],P=p.getLogger("esri.layers.SceneLayer"),k=function(e){function t(t,r){var n=e.call(this)||this;return n.featureReduction=null,n.rangeInfos=null,n.operationalLayerType="ArcGISSceneServiceLayer",n.type="scene",n.fields=[],n.definitionExpression=null,n.labelsVisible=!0,n.labelingInfo=null,n.legendEnabled=!0,n.cachedDrawingInfo={color:!1},n.popupEnabled=!0,n.popupTemplate=null,n.objectIdField=null,n.objectIdFilter=null,n._fieldUsageInfo={},n.screenSizePerspectiveEnabled=!0,n}return o(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?n({url:e},t):e},t.prototype.getField=function(e){return I.getField(e,this.fields)},Object.defineProperty(t.prototype,"elevationInfo",{set:function(e){this._set("elevationInfo",e),this.loaded&&this._validateElevationInfo()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryType",{get:function(){return M[this.profile]||"mesh"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{set:function(e){I.fixRendererFields(e,this.fields),this._set("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readCachedDrawingInfo=function(e,t){return null!=e&&"object"==typeof e||(e={}),null==e.color&&(e.color=!1),e},t.prototype.readObjectIdField=function(e,t){return!e&&t.fields&&t.fields.some(function(t){return"esriFieldTypeOID"===t.type&&(e=t.name),!!e}),e||void 0},t.prototype.readProfile=function(e,t){var r=t.store.profile;return null!=r&&A[r]?A[r]:(P.error("Unknown or missing profile",{profile:r,layer:this}),"mesh-pyramids")},t.prototype.readNormalReferenceFrame=function(e,t){return t.store.normalReferenceFrame},t.prototype.load=function(){var e=this,t=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return e._fetchService()}).then(function(){return s([e._verifyRootNodeAndUpdateExtent(),e._setCompanionFeatureLayer()])}).then(function(){return e._validateElevationInfo()}).then(function(){return e._applyCompanionOverrides()}).then(function(){return e._populateFieldUsageInfo()}).then(function(){return D.loadStyleRenderer(e,{origin:"service"})}).then(function(){return I.fixRendererFields(e.renderer,e.fields)});return this.addResolvingPromise(t),this.when()},t.prototype.createLayerView=function(e){var t=this;return(null==this.profile||"mesh-pyramids"===this.profile?c.create(function(e){return Promise.all([r.e(4),r.e(6),r.e(8),r.e(7),r.e(66)]).then(function(){var t=[r(1120)];e.apply(null,t)}.bind(this)).catch(r.oe)}):c.create(function(e){return Promise.all([r.e(4),r.e(6),r.e(8),r.e(7),r.e(57)]).then(function(){var t=[r(1654)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(r){return new r({view:e,layer:t})})},t.prototype.createQuery=function(){var e=new L;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e},t.prototype.queryExtent=function(e){var t=this;return this._getAssociatedLayerForQuery().then(function(r){return r.queryExtent(e||t.createQuery())})},t.prototype.queryFeatureCount=function(e){var t=this;return this._getAssociatedLayerForQuery().then(function(r){return r.queryFeatureCount(e||t.createQuery())})},t.prototype.queryFeatures=function(e){var t=this;return this._getAssociatedLayerForQuery().then(function(r){return r.queryFeatures(e||t.createQuery())}).then(function(e){if(e&&e.features)for(var r=0,n=e.features;r<n.length;r++){var o=n[r];o.layer=t,o.sourceLayer=t}return e})},t.prototype.queryFeaturesJSON=function(e){var t=this;return this._getAssociatedLayerForQuery().then(function(r){return r.queryFeaturesJSON(e||t.createQuery())})},t.prototype.queryObjectIds=function(e){var t=this;return this._getAssociatedLayerForQuery().then(function(r){return r.queryObjectIds(e||t.createQuery())})},t.prototype.getFieldUsageInfo=function(e){var t={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||t:(P.error("#getFieldUsageInfo()","Unavailable until layer is loaded"),t)},t.prototype._getAssociatedLayerForQuery=function(){var e=this;if(!this.loaded)return this.load().then(function(){return e._getAssociatedLayerForQuery()});var t=this.associatedLayer;return null!=t?c.resolve(t):c.reject(new u("scenelayer:query-not-available","SceneLayer queries are not available without associated feature layer"))},t.prototype.hasCachedStatistics=function(e){return null!=this.statisticsInfo&&this.statisticsInfo.some(function(t){return t.name===e})},t.prototype.queryCachedStatistics=function(e){if(!this.hasCachedStatistics(e))return c.reject(new u("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available"));for(var t=0,r=this.statisticsInfo;t<r.length;t++){var n=r[t];if(n.name===e){var o=d.join(this.parsedUrl.path,n.href);return l(o,{query:{f:"json"},responseType:"json"}).then(function(e){return e.data})}}},t.prototype.graphicChanged=function(e){this.emit("graphic-update",e)},t.prototype._validateLayer=function(e){if(e.layerType&&-1===N.indexOf(e.layerType))throw new u("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new u("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(this.version.major>1)throw new u("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});!function(e,t){var r=!1,n=!1;if(null==e)r=!0,n=!0;else{var o=t&&t.isGeographic;switch(e){case"east-north-up":case"earth-centered":r=!0,n=o;break;case"vertex-reference-frame":r=!0,n=!o;break;default:r=!1}}if(!r)throw new u("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!n)throw new u("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}(this.normalReferenceFrame,this.spatialReference)},t.prototype._populateFieldUsageInfo=function(){if(this._fieldUsageInfo={},this.fields)for(var e=this,t=0,r=this.fields;t<r.length;t++){!function(t){var r=!(!e.attributeStorageInfo||!e.attributeStorageInfo.some(function(e){return e.name===t.name})),n=!!(e.associatedLayer&&e.associatedLayer.fields&&e.associatedLayer.fields.some(function(e){return e&&t.name===e.name})),o={supportsLabelingInfo:r,supportsRenderer:r,supportsPopupTemplate:r||n,supportsLayerQuery:n};e._fieldUsageInfo[t.name]=o}(r[t])}},t.prototype._applyCompanionOverrides=function(){if(this.associatedLayer){if(this.associatedLayer.fields)for(var e=0,t=this.associatedLayer.fields;e<t.length;e++){var r=t[e];this.getField(r.name)||this.fields.push(r.clone())}for(var n=["popupTemplate","popupEnabled"],o=h.getProperties(this),i=0;i<n.length;i++){var s=n[i];this._buddyIsMoreImportant(s)&&(o.setDefaultOrigin(this.associatedLayer.originOf(s)),o.set(s,this.associatedLayer[s]),o.setDefaultOrigin("user"))}}},t.prototype._setCompanionFeatureLayer=function(){var e=this;return this._fetchCompanionFeatureLayer().then(function(t){e.associatedLayer=t})},t.prototype._fetchCompanionFeatureLayer=function(){var e=this;return-1===["mesh-pyramids","points"].indexOf(this.profile)?c.resolve(null):(this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):this._fetchCompanionFeatureLayerFromUrl()).then(function(e){return e.load()}).catch(function(t){return null==e.attributeStorageInfo?P.warn("Companion FeatureLayer could not be loaded and no binary attributes found. Popups will not work for this SceneLayer: "+e.title):P.info("Companion FeatureLayer could not be loaded. Falling back to binary attributes for Popups on this SceneLayer: "+e.title),null})},t.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(e){var t=this;return e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"}).then(function(e){var r=e.filter(function(e){return"Feature Service"===e.type})[0];return r?t._fetchCompanionFeatureLayerFromPortalItem(new T({id:r.id,portal:r.portal})):c.reject()}).catch(function(){return t._fetchCompanionFeatureLayerFromUrl()})},t.prototype._fetchCompanionFeatureLayerFromPortalItem=function(e){var t=this;return e.load().then(function(e){return t._findMatchingCompanionSublayerUrl(e.url)}).then(function(t){return c.resolve(new m({url:t,portalItem:e}))})},t.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(e){return c.resolve(new m({url:e}))})},t.prototype._findMatchingCompanionSublayerUrl=function(e){var t=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!t)return c.reject();null==e&&(e=t[1]+"/FeatureServer");var r=e.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),n={query:{f:"json"},responseType:"json"},o=t[1]+"/SceneServer",i=parseInt(t[2],10),a=l(o,n).catch(function(e){return{layers:null}}),u=l(r,n);return s([u,a]).then(function(e){var t=e[0],n=e[1],o=n.data&&n.data.layers,s=t.data&&t.data.layers;if(!Array.isArray(s))throw new Error("expected layers array");if(Array.isArray(o))for(var a=0;a<Math.min(o.length,s.length);a++){if(o[a].id===i)return r+"/"+s[a].id}else if(i<s.length)return r+"/"+s[i].id;throw new Error("could not find matching associated sublayer")})},t.prototype._buddyIsMoreImportant=function(e){if(!this.associatedLayer)return!1;var t=f.nameToId(this.originOf(e)),r=f.nameToId(this.associatedLayer.originOf(e));return null!=r&&r<=f.OriginId.SERVICE?null==t||t<f.OriginId.SERVICE:null!=r&&r<=f.OriginId.PORTAL_ITEM&&(null==t||t<f.OriginId.PORTAL_ITEM)},t.prototype._validateElevationInfo=function(){var e=this.elevationInfo;e&&("mesh-pyramids"===this.profile&&"absolute-height"!==e.mode&&P.warn(".elevationInfo=","Mesh scene layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&P.warn(".elevationInfo=","Scene layers do not support featureExpressionInfo"))},i([y.shared("esri.layers.SceneLayer")],t.prototype,"declaredClass",void 0),i([y.property({types:{key:"type",base:S.default,typeMap:{selection:j.default}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],t.prototype,"featureReduction",void 0),i([y.property({type:[F.default],json:{read:!1,origins:{"web-scene":{read:{source:"layerDefinition.rangeInfos"},write:{target:"layerDefinition.rangeInfos"}}}}})],t.prototype,"rangeInfos",void 0),i([y.property()],t.prototype,"associatedLayer",void 0),i([y.property()],t.prototype,"operationalLayerType",void 0),i([y.property({json:{read:!1},readOnly:!0})],t.prototype,"type",void 0),i([y.property({type:[_]})],t.prototype,"fields",void 0),i([y.property({readOnly:!0})],t.prototype,"attributeStorageInfo",void 0),i([y.property({readOnly:!0})],t.prototype,"statisticsInfo",void 0),i([y.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),i([y.property({value:null,type:V,json:{origins:{service:{read:{source:"elevationInfo"}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],t.prototype,"elevationInfo",null),i([y.property({type:String,dependsOn:["profile"]})],t.prototype,"geometryType",null),i([y.property(b.labelsVisible)],t.prototype,"labelsVisible",void 0),i([y.property({type:[x],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:O.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:O.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",void 0),i([y.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),i([y.property({types:C.types,json:{origins:{service:{read:{source:"drawingInfo.renderer",reader:R}}},read:{source:"layerDefinition.drawingInfo.renderer",reader:R},write:{target:"layerDefinition.drawingInfo.renderer"}},value:null})],t.prototype,"renderer",null),i([y.property({json:{read:!1}})],t.prototype,"cachedDrawingInfo",void 0),i([y.reader("service","cachedDrawingInfo")],t.prototype,"readCachedDrawingInfo",null),i([y.property(b.popupEnabled)],t.prototype,"popupEnabled",void 0),i([y.property({type:a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),i([y.property({type:String,json:{read:!1}})],t.prototype,"objectIdField",void 0),i([y.reader("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdField",null),i([y.property()],t.prototype,"objectIdFilter",void 0),i([y.property({type:String,json:{read:!1}})],t.prototype,"profile",void 0),i([y.reader("service","profile",["store.profile"])],t.prototype,"readProfile",null),i([y.property({readOnly:!0,type:String,json:{read:!1}})],t.prototype,"normalReferenceFrame",void 0),i([y.reader("service","normalReferenceFrame",["store.normalReferenceFrame"])],t.prototype,"readNormalReferenceFrame",null),i([y.property(w.screenSizePerspectiveEnabled)],t.prototype,"screenSizePerspectiveEnabled",void 0),i([y.subclass()],t)}(y.declared(v,g)),A={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},M={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return k}.apply(null,n))||(e.exports=o)}}]);