(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/tiling/enums":706,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/enums":706,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/QueueProcessor":793,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileQueue":863,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/Queue":864,"esri/core/HandleOwner":904,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/HandleOwner":904,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Canvas2DContainer":981,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapSource":982,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Bitmap":1034,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/viewStateUtils":1073,"esri/views/2d/tiling":1096,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling":1096,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapContainer":1105,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Tiled":1389,"esri/renderers/support/heatmapUtils":1429,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/heatmapUtils":1429,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/features/tileRenderers/BaseTileRenderer":1546,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapTile":1547,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/features/tileRenderers/HeatmapTileRenderer":2363,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/features/tileRenderers/support/HeatmapSource":2364,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/ObjectFactory":2365})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1034:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(715)],void 0===(n=function(e,t,i,r){var n=[0,0];return function(e){function t(t){var i=e.call(this)||this;return i.height=0,i.resolution=0,i.rotation=0,i._source=null,i._sourceHandle=null,i.width=0,i.x=0,i.y=0,i.source=t,i.requestRender=i.requestRender.bind(i),i}return i(t,e),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(e){this._sourceHandle&&(this._sourceHandle.remove(),this._sourceHandle=null),this._source=e,this._source&&(this._sourceHandle=this._source.on("update",this.requestRender)),this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.doRender=function(e){this.source&&this.source.ready&&this.renderCanvas2D(e)},t.prototype.renderCanvas2D=function(e){var t=this.source,i=e.context,r=e.state,o=r.resolution,s=r.rotation,a=this.resolution/o*r.pixelRatio;if(!(a<.05)){i.save();var u=r.toScreen(n,this.x,this.y),h=u[0],l=u[1];if(a>.99&&a<1.01?i.translate(Math.round(h),Math.round(l)):(i.translate(h,l),i.scale(a,a)),s){var c=s*Math.PI/180;i.rotate(c)}t.rotation&&(i.translate(.5*this.width,.5*this.height),i.rotate(-t.rotation*Math.PI/180),i.translate(.5*-this.width,.5*-this.height));var p=t.resolution||this.resolution,d=(this.x-t.x)/p,f=-(this.y-t.y)/p,y=(t.width||this.width)*(this.resolution/p),g=(t.height||this.height)*(this.resolution/p);i.clearRect(0,0,this.width,this.height),t.draw(i,Math.round(d),Math.round(f),Math.round(y),Math.round(g),0,0,this.width,this.height),i.restore()}},t}(r)}.apply(null,r))||(e.exports=n)},1073:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e){return e*r}Object.defineProperty(t,"__esModule",{value:!0});var r=Math.PI/180;t.snapToPixel=function(e,t,i){var r=i.resolution,n=i.size;return e[0]=r*(Math.round(t[0]/r)+n[0]%2*.5),e[1]=r*(Math.round(t[1]/r)+n[1]%2*.5),e},t.getOuterSize=function(e,t){var r=i(t.rotation),n=Math.abs(Math.cos(r)),o=Math.abs(Math.sin(r)),s=t.size,a=s[0],u=s[1];return e[0]=Math.round(u*o+a*n),e[1]=Math.round(u*n+a*o),e},t.getBBox=function(e,t,i,r){var n=t[0],o=t[1],s=r[0],a=r[1],u=.5*i;return e[0]=n-u*s,e[1]=o-u*a,e[2]=n+u*s,e[3]=o+u*a,e},t.bboxIntersects=function(e,t){var i=e[0],r=e[1],n=e[2],o=e[3],s=t[0],a=t[1],u=t[2],h=t[3];return!(i>u||n<s||r>h||o<a)}}.apply(null,r))||(e.exports=n)},1096:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(749),i(441),i(863),i(876)],void 0===(n=function(e,t,i,r,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.TileInfoView=i,t.TileKey=r,t.TileQueue=n,t.TileStrategy=o}.apply(null,r))||(e.exports=n)},1105:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(903),i(1073),i(696)],void 0===(n=function(e,t,i,r,n,o,s){var a=[0,0];return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenCanvas=null,t._childrenRenderParameters={context:null,pixelRatio:1,state:new n,stationary:!0},t}return i(t,e),t.prototype.attach=function(t){return this._childrenCanvas||(this._childrenCanvas=document.createElement("canvas"),this._childrenRenderParameters.context=this._childrenCanvas.getContext("2d")),e.prototype.attach.call(this,t)},t.prototype.detach=function(t){e.prototype.detach.call(this,t),this._childrenCanvas=null,this._childrenRenderParameters.context=null},t.prototype.doRender=function(t){this.visible&&e.prototype.doRender.call(this,t)},t.prototype.prepareChildrenRenderParameters=function(e){var t=this._childrenCanvas,i=this._childrenRenderParameters,r=e.state,n=r.pixelRatio,s=i.state;s.copy(r);var u=o.getOuterSize(a,r),h=u[0],l=u[1];return h*=n,l*=n,s.size=a,s.viewpoint.rotation=0,t.width!==h||t.height!==l?(t.width=h,t.height=l):i.context.clearRect(0,0,h,l),i.pixelRatio=e.pixelRatio,i},t.prototype.beforeRenderChildren=function(e,t){this.sortChildren(function(e,t){return t.resolution-e.resolution})},t.prototype.afterRenderChildren=function(e,t){var i=e.context,r=e.state,n=t.context,o=t.state;0===r.rotation?i.drawImage(n.canvas,0,0):(i.save(),i.translate(.5*r.width,.5*r.height),i.rotate(r.rotation*Math.PI/180),i.translate(.5*-r.width,.5*-r.height),i.drawImage(n.canvas,.5*(r.width-o.width),.5*(r.height-o.height)),i.restore())},t}(s)}.apply(null,r))||(e.exports=n)},1389:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(767),i(706)],void 0===(n=function(e,t,i,r,n){return function(e){var t=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.call(this)||this;return r.status=n.TileStatus.INITIALIZED,r}return i(t,e),t}(e);return r.EventedMixin(t)}}.apply(null,r))||(e.exports=n)},1429:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(453),i(359)],void 0===(n=function(e,t,i,r){function n(e,t,i,n,o){for(var s=new Uint32Array(e*e),a=("buffer"in t?t:new Float64Array(t)),u=("buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer)),h=u.length/(o-n),l=0;l<a.length;l++){var c=a[l],p=Math.floor((c-n)*h);s[l]=u[r.clamp(p,0,u.length-1)]}return s.buffer}function o(e){for(var t=Math.round(4.5*e),i=e*e,r=new Float64Array(2*t+1),n=0;n<=r.length;n++)r[n]=Math.exp(-Math.pow(n-t,2)/(2*i))/Math.sqrt(2*Math.PI)*(e/2);return r}function s(e,t){return"function"==typeof e?e:e?"string"==typeof t?function(t){return-1*+t[e]}:function(i){return+i[e]+t}:function(e){return 1}}Object.defineProperty(t,"__esModule",{value:!0}),t.generateGradient=function(){if(!("document"in i))return function(e){return null};var e=document.createElement("canvas"),t=e.getContext("2d");return e.height=512,e.width=1,function(i){for(var r=t.createLinearGradient(0,0,0,e.height),n=0,o=i.colorStops;n<o.length;n++){var s=o[n],a=s.ratio,u=s.color;r.addColorStop(a,"rgba("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")")}return t.fillStyle=r,t.fillRect(0,0,1,e.height),t.getImageData(0,0,1,e.height).data}}(),t.calculateHeatmapIntensityInfo=function(e,t,i,r){for(var n,a=t.blurRadius,u=t.fieldOffset,h=t.field,l=new Float64Array(i*r),c=o(a),p=Math.round(4.5*a),d=Number.NEGATIVE_INFINITY,f=s(h,u),y=0,g=e;y<g.length;y++)for(var _=g[y],v=_.geometry,m=_.attributes,w=v.x-p,x=v.y-p,b=Math.max(0,w),I=Math.max(0,x),P=Math.min(r,v.y+p),R=Math.min(i,v.x+p),C=+f(m),j=I;j<P;j++)for(var M=c[j-x],T=b;T<R;T++){var O=c[T-w];(n=l[j*i+T]+=M*O*C)>d&&(d=n)}return{matrix:l.buffer,max:d}},t.drawHeatmap=function(e,t,i,r,o,s){var a=e.getContext("2d");a.clearRect(0,0,t,t);var u=a.getImageData(0,0,t,t);return i&&r&&u.data.set(new Uint8ClampedArray(n(t,i,r,o,s))),a.putImageData(u,0,0),e},t.createHeatmapImageData=n,t.createKernel=o,t.createValueFunction=s}.apply(null,r))||(e.exports=n)},1546:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(904),i(336),i(706)],void 0===(n=function(e,t,i,r,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var i=e.call(this)||this;return i.tiles=new Map,i.layer=null,i}return i(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.highlightOptions=this.configuration=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("attach",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,i),i},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.status!==a.TileStatus.INITIALIZED}),!e},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},r([s.property()],t.prototype,"configuration",void 0),r([s.property()],t.prototype,"highlightOptions",void 0),r([s.property()],t.prototype,"layer",void 0),r([s.property()],t.prototype,"layerView",void 0),r([s.property()],t.prototype,"tileInfoView",void 0),r([s.property()],t.prototype,"updating",null),r([s.subclass()],t)}(s.declared(n,o));t.default=u}.apply(null,r))||(e.exports=n)},1547:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(413),i(1096),i(1034),i(1389),i(706)],void 0===(n=function(e,t,i,r,n,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){function t(t){var i=e.call(this,t)||this;return i.key=new o.TileKey(0,0,0,0),i}return i(t,e),t.prototype.acquire=function(e){},t.prototype.release=function(){this.key.set(0,0,0,0),this.status=u.TileStatus.INITIALIZED,this.source=null},t.pool=new n(t,!0),t}(a(s));t.default=h}.apply(null,r))||(e.exports=n)},2363:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(637),i(346),i(339),i(336),i(621),i(1429),i(1105),i(1547),i(981),i(1546),i(2364),i(706)],void 0===(n=function(e,t,i,r,n,o,s,a,u,h,l,c,p,d,f,y){Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){function t(t){var i=e.call(this)||this;return i._canvas=new p,i._bitmaps=new l,i._canvas.addChild(i._bitmaps),i}return i(t,e),Object.defineProperty(t.prototype,"gradient",{get:function(){return h.generateGradient(this.configuration.renderer)},enumerable:!0,configurable:!0}),t.prototype.createTile=function(e){var t=c.default.pool.acquire();return t.key.set(e),this.tileInfoView.getTileCoords(t,e),t.resolution=this.tileInfoView.getTileResolution(e),t.height=t.width=512,t},t.prototype.applyConfiguration=function(e){this.configuration=e;var t=e.renderer,i=t.minPixelIntensity,r=t.maxPixelIntensity,n=this.gradient;this.tiles.forEach(function(e){var t=e.source;t&&(t.minPixelIntensity=i,t.maxPixelIntensity=r,t.gradient=n)})},t.prototype.clear=function(){this.tiles.forEach(function(e){var t=e.source;t&&(t.intensities=null)})},t.prototype.getProcessorConfiguration=function(){var e=this.layer;return{type:"heatmap",renderer:e.renderer.toJSON(),definitionExpression:e.definitionExpression,outFields:e.outFields,gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime()}},t.prototype.hitTest=function(e,t){return s.resolve([])},t.prototype.highlight=function(e){return{remove:function(){}}},t.prototype.install=function(e){e.addChild(this._canvas)},t.prototype.uninstall=function(e){e.removeChild(this._canvas)},t.prototype.needsProcessorReconfiguration=function(e){var t=this.configuration;return this.wouldClear(e)||t.definitionExpression!==e.definitionExpression},t.prototype.wouldClear=function(e){var t=this.configuration;if(!t||t.outFields.join()!==e.outFields.join())return!0;var i=this.configuration&&n.fromJSON(this.configuration.renderer)||null,r=e&&n.fromJSON(e.renderer)||null,o=u.diff(i,r);if(!o)return!1;switch(o.type){case"complete":return!0;case"partial":for(var s in o.diff)if("colorStops"!==s&&"minPixelIntensity"!==s&&"maxPixelIntensity"!==s)return!0}return!1},t.prototype.disposeTile=function(e){e.source&&f.default.pool.release(e.source),this._bitmaps.removeChild(e),c.default.pool.release(e)},t.prototype.supportsRenderer=function(e){return e&&"heatmap"===e.type},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);if(t){var i=e.intensityInfo,r=this.configuration.renderer,n=r.minPixelIntensity,o=r.maxPixelIntensity;if(t.source)return t.source.minPixelIntensity=n,t.source.maxPixelIntensity=o,t.source.gradient=this.gradient,void(t.source.intensities=i&&i.matrix||null);var s=f.default.pool.acquire();s.intensities=i&&i.matrix||null,s.minPixelIntensity=n,s.maxPixelIntensity=o,s.gradient=this.gradient,t.source=s,t.source.x=t.x,t.source.y=t.y,t.status=y.TileStatus.READY,this._bitmaps.addChild(t),this.requestUpdate()}},t.prototype.onTileError=function(e){console.error(e)},r([a.property({readOnly:!0,dependsOn:["configuration"]})],t.prototype,"gradient",null),r([a.subclass()],t)}(a.declared(o,d.default));t.default=g}.apply(null,r))||(e.exports=n)},2364:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(2365),i(413),i(1429),i(982)],void 0===(n=function(e,t,i,r,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0});var u=new n.default(function(){var e=document.createElement("canvas");return e.width=e.height=512,e},function(e){e.width=e.height=512}),h=function(e){function t(){var t=e.call(this,u.acquire())||this;return t._invalidated=!0,t._gradient=null,t}return i(t,e),Object.defineProperty(t.prototype,"gradient",{get:function(){return this._gradient},set:function(e){this._gradient=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"intensities",{get:function(){return this._intensities},set:function(e){this._intensities=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minPixelIntensity",{get:function(){return this._minPixelIntensity},set:function(e){this._minPixelIntensity=e,this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPixelIntensity",{get:function(){return this._maxPixelIntensity},set:function(e){this._maxPixelIntensity=e,this.invalidate()},enumerable:!0,configurable:!0}),t.prototype.acquire=function(){this.data=u.acquire()},t.prototype.release=function(){u.release(this.data),this.data=null,this.intensities=null,this.gradient=null},t.prototype.draw=function(t,i,r,n,o,a,u,h,l){this._invalidated&&(this._invalidated=!1,s.drawHeatmap(this.data,512,this._intensities,this._gradient,this._minPixelIntensity,this._maxPixelIntensity)),e.prototype.draw.call(this,t,i,r,n,o,a,u,h,l)},t.prototype.invalidate=function(){this._invalidated=!0,this.emit("update",this)},t.pool=new o(t,!0),t}(a.default);t.default=h}.apply(null,r))||(e.exports=n)},2365:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r){void 0===i&&(i=1),void 0===r&&(r=0),this.acquireFunction=e,this.releaseFunction=t,this.growthSize=i,this._pool=new Array(r),this._set=new Set,this._initialSize=r;for(var n=0;n<r;n++)this._pool[n]=this.acquireFunction();this.growthSize=Math.max(i,1)}return e.prototype.acquire=function(){var e;if(0===this._pool.length)for(var t=this.growthSize,i=0;i<t;i++)this._pool[i]=this.acquireFunction();return function(e){return e&&e.acquire&&"function"==typeof e.acquire}(e=this._pool.shift())&&e.acquire(),this._set.delete(e),e},e.prototype.release=function(e){e&&!this._set.has(e)&&(this.releaseFunction?this.releaseFunction(e):function(e){return e&&e.release&&"function"==typeof e.release}(e)&&e.release(),this._pool.push(e),this._set.add(e))},e.prototype.prune=function(){if(!(this._pool.length<=this._initialSize))for(var e;this._initialSize>this._pool.length;)e=this._pool.shift(),this._set.delete(e),e.dispose&&"function"==typeof e.dispose&&e.dispose()},e}();t.default=i}.apply(null,r))||(e.exports=n)},706:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,r))||(e.exports=n)},793:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(380),i(864),i(462)],void 0===(n=function(e,t,i,r,n){return function(){function e(e){this._apiPromises=new Map,this._processingItems=new Map,this._isPaused=!1,this._scheduledNextHandle=null,this.concurrency=1,this.ordered=!1,e.concurrency&&(this.concurrency=e.concurrency),this.ordered=!!e.ordered,this._queue=new r(e.peeker?{peeker:e.peeker}:void 0),this.process=e.process}return Object.defineProperty(e.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._queue.clear();var e=[];this._processingItems.forEach(function(t){return e.push(t.resultPromise)}),this._processingItems.clear(),e.forEach(function(e){return e.cancel()}),e.length=0,this._apiPromises.forEach(function(t){return e.push(t)}),this._apiPromises.clear(),e.forEach(function(e){return e.cancel()}),this._cancelNext()},e.prototype.find=function(e,t){var i=this,r=void 0;return this._apiPromises.forEach(function(n,o){e.call(t,o)&&(r=i._apiPromises.get(o).promise)}),r},e.prototype.get=function(e){var t=this._apiPromises.get(e);return t&&t.promise||void 0},e.prototype.isOngoing=function(e){return this._processingItems.has(e)},e.prototype.has=function(e){return this._apiPromises.has(e)},e.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},e.prototype.push=function(e){var t=this;if(this._apiPromises.has(e))return this._apiPromises.get(e).promise;var r=new i(function(i){var r=t._processingItems.get(e);r?r.resultPromise.cancel(i):(t._remove(e),t._scheduleNext())});return this._add(e,r),this._scheduleNext(),r.promise},e.prototype.reset=function(){var e=[];this._processingItems.forEach(function(t){return e.push(t)}),this._processingItems.clear();for(var t=0,i=e;t<i.length;t++){var r=i[t];r.resultPromise.isFulfilled()?this._processReset(r):(r.isReset=!0,r.resultPromise.cancel())}},e.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())},e.prototype._scheduleNext=function(){var e=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=n.schedule(function(){e._scheduledNextHandle=null,e._next()}))},e.prototype._next=function(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())},e.prototype._processResult=function(e,t){this._remove(e.item),this._scheduleNext(),e.dfd.resolve(t)},e.prototype._processError=function(e,t){e.isReset?this._processReset(e):(this._remove(e.item),this._scheduleNext(),e.dfd.reject(t))},e.prototype._processReset=function(e){this._remove(e.item),this._add(e.item,e.dfd),this._scheduleNext()},e.prototype._processOrdered=function(e,t){var i=this,r=!1;if(e.isReset)this._processReset(e);else{e.result=t,this._itemsToProcess||(this._itemsToProcess=[]),this._processingItems.forEach(function(e){r||(e.result?i._itemsToProcess.push(e):r=!0)});for(var n=0,o=this._itemsToProcess;n<o.length;n++){var s=o[n];!1===s.result.ok?this._processError(s,s.result.error):this._processResult(s,s.result.value)}this._itemsToProcess.length=0}},e.prototype._process=function(e){var t=this;if(null!=e){var i=this._apiPromises.get(e),r=this.process(e);if(function(e){return e&&"function"==typeof e.then}(r)){var n={item:e,resultPromise:r,result:null,dfd:i,isReset:!1};this._processingItems.set(e,n),this.ordered?r.then(function(e){return t._processOrdered(n,{ok:!0,value:e})},function(e){return t._processOrdered(n,{ok:!1,error:e})}):r.then(function(e){return t._processResult(n,e)},function(e){return t._processError(n,e)})}else i.resolve(r),this._remove(e)}},e.prototype._add=function(e,t){this._apiPromises.set(e,t),this._queue.push(e)},e.prototype._remove=function(e){this._queue.remove(e),this._apiPromises.delete(e),this._processingItems.delete(e)},e.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},e}()}.apply(null,r))||(e.exports=n)},863:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(793),i(336),i(683)],void 0===(n=function(e,t,i,r,n,o,s,a){var u=new Set,h=[],l=new Map,c=[0,0];return function(e){function t(t){var i=e.call(this,t)||this;return i._keysToRequests=new Map,i.concurrency=6,i.process=null,i.strategy="scale-first",i.tileInfoView=null,i.tileServers=null,i}return i(t,e),t.prototype.initialize=function(){var e=this,t="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this),i=this,r=i.tileServers,n=i.concurrency,s=i.process;r&&r.length>0?this._queues=r.map(function(i){return new o({concurrency:n,process:function(t){var r=e._keysToRequests.get(t);return s(r,i)},peeker:t})}):this._queues=[new o({concurrency:n,process:function(t){var i=e._keysToRequests.get(t);return s(i)},peeker:t})]},Object.defineProperty(t.prototype,"length",{get:function(){return this._queues.reduce(function(e,t){return e+t.length},0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onGoingCount",{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.length>0||this.onGoingCount>0},enumerable:!0,configurable:!0}),t.prototype.clear=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].clear();this._keysToRequests.clear(),this.notifyChange("updating")},t.prototype.find=function(e,t){for(var i=this,r=0,n=this._queues;r<n.length;r++){var o=n[r].find(function(t){return e(i._keysToRequests.get(t).key)});if(o)return o}},t.prototype.getPromise=function(e){for(var t="string"==typeof e?e:e.id,i=0,r=this._queues;i<r.length;i++){var n=r[i].get(t);if(n)return n}},t.prototype.getRequest=function(e){var t="string"==typeof e?e:e.id;return this._keysToRequests.get(t)},t.prototype.has=function(e){return"string"==typeof e?this._keysToRequests.has(e):this._keysToRequests.has(e.id)},t.prototype.isOngoing=function(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queues.some(function(e){return e.isOngoing(t)})},t.prototype.pause=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].pause()},t.prototype.push=function(e){var t=this,i=e.key.id;if(this.has(i))return this.getPromise(i);var r=this._queues[e.key.row%this._queues.length].push(i),n=function(){t._keysToRequests.delete(i),t.notifyChange("updating")};return this._keysToRequests.set(i,e),r.then(n,n),this.notifyChange("updating"),r},t.prototype.reset=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].reset();this.notifyChange("updating")},t.prototype.resume=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].resume()},t.prototype._peekByScaleFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,n=0,o=e;n<o.length;n++){var s=o[n],a=this._keysToRequests.get(s),c=this.tileInfoView.getTileScale(a.key);l.has(c)||(l.set(c,[]),i=Math.max(c,i),r=Math.min(c,r)),l.get(c).push(a.key),u.add(c)}var p=this.state.scale;l.has(p)||(function(e,t){e.length=0,t.forEach(function(t){return e.push(t)})}(h,u),h.sort(),p=h.reduce(function(e,t,i,r){return Math.abs(t-p)<Math.abs(e-p)?t:e},h[0])),p=Math.min(p,i),p=Math.max(p,r);var d=l.get(p),f=t.getClosestInfoForScale(p),y=f.getColumnForX(this.state.center[0]),g=f.getRowForY(this.state.center[1]);return d.sort(function(e,t){var i=f.denormalizeCol(e.col,e.world),r=f.denormalizeCol(t.col,t.world);return Math.sqrt((y-i)*(y-i)+(g-e.row)*(g-e.row))-Math.sqrt((y-r)*(y-r)+(g-t.row)*(g-t.row))}),u.clear(),l.clear(),d[0].id},t.prototype._peekByCenterFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=this.state.center,r=Number.POSITIVE_INFINITY,n=null,o=0,s=e;o<s.length;o++){var u=s[o],h=this._keysToRequests.get(u);t.getTileCoords(c,h.key);var l=a.distance(c,i);l<r&&(r=l,n=h.key)}return n.id},r([s.property({constructOnly:!0})],t.prototype,"concurrency",void 0),r([s.property({constructOnly:!0})],t.prototype,"process",void 0),r([s.property()],t.prototype,"state",void 0),r([s.property({constructOnly:!0})],t.prototype,"strategy",void 0),r([s.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),r([s.property({constructOnly:!0})],t.prototype,"tileServers",void 0),r([s.property({readOnly:!0})],t.prototype,"updating",null),r([s.subclass()],t)}(s.declared(n))}.apply(null,r))||(e.exports=n)},864:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e){this._items=[],this._itemSet=new Set,this._peeker=function(e){return e[0]},this._length=0,e&&e.peeker&&(this._peeker=e.peeker)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._itemSet.clear(),this._items.length=0,this._length=0},e.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)},e.prototype.push=function(e){this.contains(e)||this._add(e)},e.prototype.contains=function(e){return this._length>0&&this._itemSet.has(e)},e.prototype.pop=function(){if(0!==this._length){var e=this.peek();return this._remove(e),e}},e.prototype.remove=function(e){this.contains(e)&&this._remove(e)},e.prototype._add=function(e){this._items.push(e),this._itemSet.add(e),this._length++},e.prototype._remove=function(e){this._itemSet.delete(e),this._items.splice(this._items.indexOf(e),1),this._length--},e}()}.apply(null,r))||(e.exports=n)},904:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(365),i(336)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){var t=e.call(this)||this;return t.handles=new o,t}return i(t,e),t.prototype.destroy=function(){this.handles.destroy()},r([s.property({readOnly:!0})],t.prototype,"handles",void 0),r([s.subclass("esri.core.HandleOwner")],t)}(s.declared(n))}.apply(null,r))||(e.exports=n)},981:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(339),i(903),i(696),i(710)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenRenderParameters={context:null,pixelRatio:1,state:new n,stationary:!0},t.hidpi=!1,t}return i(t,e),t.prototype.createElement=function(){var e=document.createElement("canvas");return e.setAttribute("class","esri-display-object"),e},t.prototype.setElement=function(e){this.element=e},t.prototype.takeScreenshot=function(e){var t=this._childrenRenderParameters.state,i={context:null,pixelRatio:e.pixelRatio,state:new n,stationary:!0};i.opacity=this._childrenRenderParameters.opacity,i.state.copy(t);var o,a=e.framebufferWidth,u=e.framebufferHeight,h=e.region,l=document.createElement("canvas");if(l.width=a,l.height=u,i.context=l.getContext("2d"),this.beforeRenderChildren(i,i),void 0!==e.rotation&&null!==e.rotation){var c=i.state,p=c.clone();p.viewpoint.rotation=e.rotation,i.state=p,this.renderChildren(i),i.state=c}else this.renderChildren(i);this.afterRenderChildren(i,i);try{o=i.context.getImageData(h.x,h.y,h.width,h.height)}catch(e){return r.reject(e)}return r.resolve(s.encodeResult(o,e,l,{flipY:!1,premultipliedAlpha:!1}))},t.prototype.doRender=function(t){var i=this.element,r=i.style;if(this.visible){var n=t.state,o=t.pixelRatio,s=n.width,a=n.height;i.width=s*(this.hidpi?o:1),i.height=a*(this.hidpi?o:1),r.display="block",r.opacity=""+Math.min(this.opacity,this.parent.opacity),r.width=s+"px",r.height=a+"px",e.prototype.doRender.call(this,t)}else r.display="none"},t.prototype.prepareChildrenRenderParameters=function(e){var t=this._childrenRenderParameters;return t.context=this.element.getContext("2d"),t.pixelRatio=e.pixelRatio,t.state.copy(e.state),t.state.pixelRatio=this.hidpi?e.pixelRatio:1,t.stationary=e.stationary,t},t.prototype.beforeRenderChildren=function(e,t){var i=t.context,r=t.state;if(i.save(),r.spatialReference.isWrappable){var n=r.width,o=r.height,s=r.rotation,a=r.pixelRatio,u=this.hidpi?a:1,h=s*Math.PI/180,l=Math.abs(Math.cos(h)),c=Math.abs(Math.sin(h)),p=Math.round(n*u*l+o*u*c),d=r.worldScreenWidth*u;if(d<p){var f=n*u*.5,y=o*u*.5;h&&(i.translate(f,y),i.rotate(h),i.translate(-f,-y)),i.beginPath(),i.rect(f-.5*d,y-.5*p,d,p),i.closePath(),h&&(i.translate(f,y),i.rotate(-h),i.translate(-f,-y)),i.clip("evenodd")}}},t.prototype.afterRenderChildren=function(e,t){t.context.restore()},t.prototype.renderChild=function(e,t){t.context.save(),e.processRender(t),t.context.restore()},t}(o)}.apply(null,r))||(e.exports=n)},982:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(413),i(1069)],void 0===(n=function(e,t,i,r,n){function o(e){return e&&"render"in e}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this)||this;return i._height=0,i.pixelRatio=1,i.resolution=0,i.rotation=0,i._width=0,i.x=0,i.y=0,i.data=t,i}return i(t,e),t.prototype.release=function(){this.data=null},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this._width=this._height=0,e&&(o(e)||(e instanceof HTMLImageElement?(this._width=e.naturalWidth,this._height=e.naturalHeight):e.width>0&&e.height>0&&(this._width=e.width,this._height=e.height)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return o(this._data)?this._data.height:this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){return o(this._data)?this._data.width>0&&this._data.height>0:this._width>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return o(this.data)?this._data.width:this._width},enumerable:!0,configurable:!0}),t.prototype.draw=function(e,t,i,r,n,s,a,u,h){this.ready&&(o(this._data)?this._data.render(e,t,i,r,n,s,a,u,h):function(e){return e&&!("render"in e)}(this._data)&&r&&n&&u&&h&&e.drawImage(this._data,t,i,r,n,s,a,u,h))},t.pool=new r(t,!0),t}(n.default);t.default=s}.apply(null,r))||(e.exports=n)}}]);