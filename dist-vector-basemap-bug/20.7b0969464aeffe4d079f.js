(function(){(this||window).webpackJsonp.registerAbsMids({"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/FeatureLayer":331,"esri/core/screenUtils":354,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/screenUtils":354,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/Renderer":370,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/Symbol":371,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Domain":374,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/watchUtils":377,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/utils":378,"esri/core/workers/RemoteClient":389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/RemoteClient":389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/FeatureSet":392,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Field":395,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/domains":399,"esri/symbols/SimpleLineSymbol":402,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleLineSymbol":402,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/urlUtils":403,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/PooledArray":407,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/SimpleRenderer":412,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/ClassBreaksRenderer":414,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/HeatmapRenderer":415,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/UniqueValueRenderer":416,"esri/renderers/support/jsonUtils":423,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/jsonUtils":423,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/LegendOptions":424,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedFeatureSet":425,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ScaleRangeLayer":426,"esri/layers/support/LabelClass":427,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/LabelClass":427,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/commonProperties":429,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ArcGISService":436,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers":437,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/RefreshableLayer":438,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/AttachmentQuery":440,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/support/RelationshipQuery":444,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/requireUtils":446,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/fieldUtils":447,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/labelUtils":451,"esri/layers/support/TileInfo":452,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/TileInfo":452,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureReduction":455,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/FillSymbol":457,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/MarkerSymbol":458,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/layerSourceUtils":459,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/support/urlUtils":586,"@dojo/framework/shim/Set":587,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureTemplate":588,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/LineSymbol":592,"esri/core/pbf":593,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/pbf":593,"esri/layers/graphics/OptimizedGeometry":595,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedGeometry":595,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/CodedValueDomain":597,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/InheritedDomain":598,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/RangeDomain":599,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/fieldType":600,"esri/layers/graphics/OptimizedFeature":603,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/OptimizedFeature":603,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workers":607,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/Connection":608,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerOwner":609,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workerFactory":610,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/loaderConfig":611,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerFallback":612,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/geometry/support/graphicsUtils":613,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/typeUtils":615,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/diffUtils":621,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/query":627,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/pbfQueryUtils":628,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/pbfFeatureServiceParser":629,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/support/styleUtils":634,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/styleUtils":635,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers":637,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/LOD":638,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/queryAttachments":639,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/AuthoringInfo":641,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/AuthoringInfoVisualVariable":642,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/ClassBreakInfo":643,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/HeatmapColorStop":644,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/renderers/support/UniqueValueInfo":645,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/types":646,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/QueryTask":647,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/tasks/operations/queryRelatedRecords":648,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureProcessing":652,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureReductionSelection":661,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/LabelExpressionInfo":662,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/string":663,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/labelingInfo":664,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/HeapSort":666,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/graphics/sources/MemorySource":671,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/accessorSupport/typescript":674,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/typescript":675,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureIndex":676,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/FeatureType":677,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Relationship":678,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/TileLayer":691,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ArcGISCachedService":695,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/PictureMarkerSymbol":701,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleFillSymbol":702,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/LRUMap":704,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/CollectionFlattener":721,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/TilemapCache":732,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/lazyLayerLoader":751,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/arcgisLayers":782,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/sublayerUtils":794,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Tilemap":803,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/ArcGISMapService":865,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/mixins/SublayersOwner":866,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/layers/support/Sublayer":867})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[20,14,25,37,48,49,50,51,71,96,102],{331:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(388),r(383),r(669),r(637),r(350),r(431),r(357),r(341),r(365),r(353),r(347),r(338),r(343),r(428),r(339),r(349),r(336),r(363),r(625),r(362),r(626),r(398),r(671),r(436),r(433),r(432),r(438),r(426),r(394),r(429),r(676),r(652),r(455),r(661),r(588),r(677),r(395),r(447),r(427),r(664),r(459),r(678),r(423),r(635),r(615),r(731),r(361),r(440),r(392),r(419),r(444)],void 0===(i=function(e,t,n,i,o,a,s,l,u,p,c,d,y,f,h,m,v,b,g,w,S,_,j,O,x,I,T,F,E,D,L,P,k,C,V,M,A,N,R,U,z,q,J,B,G,Q,W,H,Y,K,Z,$,X,ee,te,re){function ne(e){return e&&null!=e.applyEdits}function ie(e){return e&&oe(e)}function oe(e){return e&&e.isInstanceOf&&e.isInstanceOf(d)}function ae(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}var se=m({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),le="FeatureLayer",ue=b.getLogger("esri.layers.FeatureLayer");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new f,r.featureReduction=null,r.capabilities=null,r.copyright=null,r.displayField=null,r.definitionExpression=null,r.dynamicDataSource=null,r.editFieldsInfo=null,r.elevationInfo=null,r.fields=null,r.fullExtent=null,r.gdbVersion=null,r.geometryType=null,r.hasM=void 0,r.hasZ=void 0,r.heightModelInfo=null,r.historicMoment=null,r.isTable=!1,r.labelsVisible=!0,r.labelingInfo=null,r.layerId=void 0,r.legendEnabled=!0,r.maxRecordCount=void 0,r.tileMaxRecordCount=void 0,r.minScale=0,r.maxScale=0,r.objectIdField=null,r.operationalLayerType="ArcGISFeatureLayer",r.popupEnabled=!0,r.popupTemplate=null,r.relationships=null,r.returnM=void 0,r.returnZ=void 0,r.screenSizePerspectiveEnabled=!0,r.serviceDefinitionExpression=null,r.spatialReference=x.WGS84,r.templates=null,r.timeInfo=null,r.title=null,r.sublayerTitleMode="item-title",r.trackIdField=null,r.type="feature",r.typeIdField=null,r.types=null,r.indexes=new(d.ofType(M.FeatureIndex)),r.userIsAdmin=!1,r.version=void 0,r.visible=!0,r}return i(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?n({url:e},t):e},t.prototype.load=function(){var e=this;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var t=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]}).always(function(){if(e.url&&null==e.layerId&&/FeatureServer|MapServer\/*$/i.test(e.url))return e._fetchFirstLayerId().then(function(t){null!=t&&(e.layerId=t)})}).then(function(){if(!e.url&&!e._hasMemorySource())throw new y("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return e.createGraphicsSource().then(function(t){return e._initLayerProperties(t)})});return this.addResolvingPromise(t),this.when()}this.addResolvingPromise(this.createGraphicsSource().then(function(t){return e._initLayerProperties(t)}))},Object.defineProperty(t.prototype,"allRenderers",{get:function(){return this._getAllRenderers(this.renderer)},enumerable:!0,configurable:!0}),t.prototype.readCapabilities=function(e,t){return t=t.layerDefinition||t,{data:this._readDataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}},Object.defineProperty(t.prototype,"hasAttachments",{get:function(){return ue.warn("FeatureLayer.hasAttachments is deprecated. Use FeatureLayer.capabilities.data.supportsAttachment instead."),this.hasService&&this._get("hasAttachments")||!1},enumerable:!0,configurable:!0}),t.prototype.readIsTable=function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type},Object.defineProperty(t.prototype,"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!0,configurable:!0}),t.prototype.readMinScale=function(e,t){return t.effectiveMinScale||e||0},t.prototype.readMaxScale=function(e,t){return t.effectiveMaxScale||e||0},t.prototype.readObjectIdFieldFromService=function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields)for(var r=0,n=t.fields;r<n.length;r++){var i=n[r];if("esriFieldTypeOID"===i.type)return i.name}},Object.defineProperty(t.prototype,"outFields",{get:function(){var e=this,t=this._userOutFields,r=this.requiredFields;return t=t&&t.slice(0),r=r&&r.slice(0),t?-1===t.indexOf("*")&&r.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}):t=r,-1!==t.indexOf("*")?t=["*"]:this.loaded&&(t=(t=(t=t.filter(function(t){var r=!!e.getField(t);return t&&!r&&ue.error("[outFields] Invalid field: ",t),r},this)).map(function(t){return e.getField(t).name},this)).filter(function(e,t,r){return r.indexOf(e)===t})),t},set:function(e){var t=this,r=this.requiredFields&&this.requiredFields.slice(0);e?-1===e.indexOf("*")&&r.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}):e=r,this.loaded&&(e=(e=e.filter(function(e){var r="*"===e||!!t.getField(e,t.fields);return e&&!r&&ue.error("[outFields] Invalid field: ",e),r},this)).map(function(e){return"*"===e?e:t.getField(e,t.fields).name},this)),this._userOutFields=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedUrl",{get:function(){var e=this.url?S.urlToObject(this.url):null;if(null!=e)if(null!=this.layerId)e.path=S.join(e.path,this.layerId.toString());else if(null!=this.dynamicDataSource){var t={source:Q.sourceToJSON(this.dynamicDataSource)};e.query={layer:JSON.stringify(t)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{set:function(e){var t=this._getAllRenderers(e);J.fixRendererFields(t,this.fields),this._set("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){var n,i,o=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(o)(n=H.read(o,t,r)||void 0)||ue.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r});else if(t.defaultSymbol)$.read(t.defaultSymbol,t,r),t.types&&t.types.length?(n=new u.UniqueValueRenderer({defaultSymbol:i,field:t.typeIdField}),t.types.forEach(function(e){o.addUniqueValueInfo(e.id,$.read(e.symbol,e,r))})):n=new u.SimpleRenderer({symbol:i});else if("Table"!==t.type){switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":i=new c.SimpleMarkerSymbol;break;case"esriGeometryPolyline":i=new c.SimpleLineSymbol;break;case"esriGeometryPolygon":i=new c.SimpleFillSymbol}n=i&&new u.SimpleRenderer({symbol:i})}return n},t.prototype.writeRenderer=function(e,t,r,n){H.writeTarget(e,t,r,n)},Object.defineProperty(t.prototype,"requiredFields",{get:function(){var e=this.timeInfo,t=[],r=[],n=[this.objectIdField,this.typeIdField,this.editFieldsInfo&&this.editFieldsInfo.creatorField,this.editFieldsInfo&&this.editFieldsInfo.creationDateField,this.editFieldsInfo&&this.editFieldsInfo.editorField,this.editFieldsInfo&&this.editFieldsInfo.editDateField,e&&e.startTimeField,e&&e.endTimeField,this.trackIdField];this.allRenderers.forEach(function(e){t=t.concat(e.requiredFields)}),this.labelingInfo&&this.labelingInfo.length&&this.labelingInfo.forEach(function(e){r=r.concat(e.requiredFields)}),r=r.map(function(e){return e.replace(/['"]+/g,"")}),n=(n=n.concat(t)).concat(r);var i=this.elevationInfo&&this.elevationInfo.featureExpressionInfo;return i&&(n=n.concat(i.requiredFields)),this.popupTemplate&&(n=n.concat(this.popupTemplate.requiredFields)),n.filter(function(e,t,r){return!!e&&r.indexOf(e)===t&&"function"!=typeof e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{set:function(e){var t=this._get("source");t!==e&&(ie(t)&&this._resetMemorySource(t),ie(e)&&this._initMemorySource(e),this._set("source",e))},enumerable:!0,configurable:!0}),t.prototype.castSource=function(e){return e?Array.isArray(e)||oe(e)?new F.default({layer:this,items:e}):e:null},t.prototype.readSource=function(e,t){var r=ee.fromJSON(t.featureSet);return new F.default({layer:this,items:r&&r.features||[]})},t.prototype.readTemplates=function(e,t){var r=t.editFieldsInfo,n=r&&r.creatorField,i=r&&r.editorField;return e=e&&e.map(function(e){return U.fromJSON(e)}),this._fixTemplates(e,n),this._fixTemplates(e,i),e},t.prototype.readTitle=function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,n=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var i=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?C.titleFromUrlAndName(this.url,r):r;var o=r||this.url&&C.parse(this.url).title;if(!o)return;return"item-title-and-service-name"===this.sublayerTitleMode&&i&&(o=i+" - "+o),C.cleanTitle(o)}if("item-title"===this.sublayerTitleMode&&n)return n},t.prototype.readTitleFromWebMap=function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name},t.prototype.readTypeIdField=function(e,t){if(e=(t=t.layerDefinition||t).typeIdField){var r=this.getField(e,t.fields);r&&(e=r.name)}return e},t.prototype.readTypes=function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var n=t.editFieldsInfo,i=n&&n.creatorField,o=n&&n.editorField;return e&&e.map(function(e){return e=z.fromJSON(e),r._fixTemplates(e.templates,i),r._fixTemplates(e.templates,o),e})},Object.defineProperty(t.prototype,"url",{set:function(e){var t=C.sanitizeUrlWithLayerId(this,e,ue);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)},enumerable:!0,configurable:!0}),t.prototype.writeUrl=function(e,t,r,n){C.writeUrlWithLayerId(this,e,t)},t.prototype.readVersion=function(e,t){return(t=t.layerDefinition||t).currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3},t.prototype.readVisible=function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0},t.prototype.addAttachment=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"addAttachment"in r.source?r.source.addAttachment(e,t):w.reject(new y(le,"Layer source does not support addAttachment capability"))})},t.prototype.updateAttachment=function(e,t,r){var n=this;return this.load().then(function(){return n._checkAttachmentSupport(e)}).then(function(){return"updateAttachment"in n.source?n.source.updateAttachment(e,t,r):w.reject(new y(le,"Layer source does not support updateAttachment capability"))})},t.prototype.applyEdits=function(e){var t,r,n=this,i={edits:e,result:w.create(function(e,n){t=e,r=n})};return this.emit("apply-edits",i),this.load().then(function(){return ne(n.source)?n._processApplyEditsParams(e):w.reject(new y(le,"Layer source does not support applyEdits capability"))}).then(function(e){if(ne(n.source))return n.source.applyEdits(e).then(function(e){var r=function(e){return e.filter(function(e){return!e.error}).map(v.clone)},i={addedFeatures:r(e.addFeatureResults),updatedFeatures:r(e.updateFeatureResults),deletedFeatures:r(e.deleteFeatureResults)};return(i.addedFeatures.length||i.updatedFeatures.length||i.deletedFeatures.length)&&n.emit("edits",i),t(i),e})}).catch(function(e){throw r(e),e})},t.prototype.on=function(e,t){return this.inherited(arguments)},t.prototype.createGraphicsSource=function(){var e=this;return this._hasMemorySource()?(this.emit("graphics-source-create",{graphicsSource:this.source}),this.source.load()):w.create(function(e){return r.e(85).then(function(){var t=[r(810)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(t){return new t.default({layer:e}).load()}).then(function(t){return e.emit("graphics-source-create",{graphicsSource:t}),t})},t.prototype.createGraphicsController=function(e){var t=this,i=e.layerView,o=d.ofType(s),a=this.source,l=ie(a),u=n({},e.options,{layer:this,layerView:i,graphics:l?a:new o});return(l?w.create(function(e){return r.e(47).then(function(){var t=[r(789)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"2d"===i.view.type?w.create(function(e){return r.e(84).then(function(){var t=[r(811)];e.apply(null,t)}.bind(this)).catch(r.oe)}):w.create(function(e){return r.e(18).then(function(){var t=[r(778)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return new e(u)}).then(function(e){return t.emit("graphics-controller-create",{graphicsController:e}),e.when()})},t.prototype.createQuery=function(){var e=new te,t=this.get("capabilities.data");return e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=this.outFields,e.where=this.definitionExpression||"1=1",e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e},t.prototype.deleteAttachments=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"deleteAttachments"in r.source?r.source.deleteAttachments(e,t):w.reject(new y(le,"Layer source does not support deleteAttachments capability"))})},t.prototype.getFeatureType=function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var n=e.attributes?e.attributes[t]:void 0;if(null==n)return null;var i=null;return r.some(function(e){var t=e.id;return null!=t&&(t.toString()===n.toString()&&(i=e),!!i)}),i},t.prototype.getFieldDomain=function(e,t){var r,n=this,i=!1,o=t&&t.feature,a=o&&o.attributes,s=this.typeIdField&&a&&a[this.typeIdField];return null!=s&&this.types&&(i=this.types.some(function(t){return t.id==s&&((r=t.domains&&t.domains[e])&&"inherited"===r.type&&(r=n._getLayerDomain(e)),!0)})),i||r||(r=this._getLayerDomain(e)),r},t.prototype.getField=function(e,t){var r=this.processing?this.fields.concat(this.processing.fields):this.fields;return J.getField(e,t||r)},t.prototype.graphicChanged=function(e){this.emit("graphic-update",e)},t.prototype.queryAttachments=function(e){var t=this;return this.load().then(function(){if(!t.get("capabilities.data.supportsAttachment"))return w.reject(new y(le,"this layer doesn't support attachments"));var r=e.attachmentTypes,n=e.objectIds,i=e.globalIds,o=e.num,a=e.size,s=e.start,l=e.definitionExpression;if(!t.get("capabilities.query.supportsAttachments")){var u=n&&n.length>1,p=r&&r.length,c=i&&i.length,d=a&&a.length;if(u||p||c||d||o||s||l)return w.reject(new y(le,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e))}return n&&n.length||l?"queryAttachments"in t.source?t.source.queryAttachments(e):w.reject(new y(le,"Layer source does not support queryAttachments capability",e)):w.reject(new y(le,"objectIds or definitionExpression are required to perform attachment query",e))})},t.prototype.queryFeatures=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatures(e||r.createQuery(),t)}).then(function(e){if(e&&e.features)for(var t=0,n=e.features;t<n.length;t++){var i=n[t];i.layer=i.sourceLayer=r}return e})},t.prototype.queryFeaturesJSON=function(e,t){var r=this;return this.load().then(function(){if(!r.source.queryFeaturesJSON)return w.reject(new y(le,"Layer source does not support queryFeaturesJSON capability"))}).then(function(){return r.source.queryFeaturesJSON(e||r.createQuery(),t)})},t.prototype.queryObjectIds=function(e,t){var r=this;return this.load().then(function(){return r.source.queryObjectIds?r.source.queryObjectIds(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryObjectIds capability"))})},t.prototype.queryFeatureCount=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatureCount?r.source.queryFeatureCount(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryFeatureCount capability"))})},t.prototype.queryExtent=function(e,t){var r=this;return this.load().then(function(){return r.source.queryExtent?r.source.queryExtent(e||r.createQuery(),t):w.reject(new y(le,"Layer source does not support queryExtent capability"))})},t.prototype.queryRelatedFeatures=function(e){var t=this;return this.load().then(function(){return"queryRelatedFeatures"in t.source?t.source.queryRelatedFeatures(e):w.reject(new y(le,"Layer source does not support queryRelatedFeatures capability"))})},t.prototype.read=function(e,t){var r=e.featureCollection;if(r){var n=r.layers;n&&1===n.length&&(this.inherited(arguments,[n[0],t]),null!=r.showLegend&&this.inherited(arguments,[{showLegend:r.showLegend},t]))}return this.inherited(arguments,[e,t]),this},t.prototype.write=function(e,t){if(t&&"web-scene"===t.origin&&t.messages){if(!this.url)return t.messages.push(new y("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' require a url to a service to be written to web scenes",{layer:this})),null;if(this.isTable)return t.messages.push(new y("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes",{layer:this})),null}return this.inherited(arguments)},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return h("esri-featurelayer-webgl")&&h("esri-webgl")?w.create(function(e){return r.e(32).then(function(){var t=[r(790)];e.apply(null,t)}.bind(this)).catch(r.oe)}):w.create(function(e){return Promise.all([r.e(9),r.e(15),r.e(38)]).then(function(){var t=[r(791)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return w.create(function(e){return Promise.all([r.e(4),r.e(6),r.e(8),r.e(7),r.e(60)]).then(function(){var t=[r(812)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._checkAttachmentSupport=function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:w.reject(new y(le,"feature is missing the identifying attribute "+r)):w.reject(new y(le,"'attributes' are required on a feature to query attachments")):w.reject(new y(le,"A feature is required to add/delete/update attachments")):w.reject(new y(le,"this layer doesn't support attachments"))},t.prototype._getLayerDomain=function(e){if(!this.fields)return null;var t=null;return this.fields.some(function(r){return r.name===e&&(t=r.domain),!!t}),t},t.prototype._fetchFirstLayerId=function(){return p(this.url,{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;if(t&&Array.isArray(t.layers)&&t.layers.length>0)return t.layers[0].id})},t.prototype._initLayerProperties=function(e){return this._set("source",e),e.layerDefinition&&this.read(e.layerDefinition,{origin:"service",url:this.parsedUrl}),this._verifySource(),this._verifyFields(),J.fixRendererFields(this._getAllRenderers(this.renderer),this.fields),Y.loadStyleRenderer(this,{origin:"service"})},t.prototype._getAllRenderers=function(e){if(!e)return[];var t=[];return[e,e.trackRenderer,e.observationRenderer,e.latestObservationRenderer].forEach(function(e){e&&(t.push(e),e.rendererInfos&&e.rendererInfos.forEach(function(e){e.renderer&&t.push(e.renderer)}))}),t},t.prototype._verifyFields=function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(function(e){return"geometry"===e.type})||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")},t.prototype._fixTemplates=function(e,t){e&&e.forEach(function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]})},t.prototype._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new y("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else{if(this.isTable)throw new y("feature-layer:source-type-not-supported","The table feature service type is not yet supported",{sourceType:"Table"});if(!this.url)throw new y("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}},t.prototype._initMemorySource=function(e){var t=this;e.forEach(function(e){e.layer=t,e.sourceLayer=t}),this._handles.add([e.on("after-add",function(e){e.item.layer=t,e.item.sourceLayer=t}),e.on("after-remove",function(e){e.item.layer=null,e.item.sourceLayer=null})],"fl-source")},t.prototype._resetMemorySource=function(e){e.forEach(function(e){e.layer=null,e.sourceLayer=null}),this._handles.remove("fl-source")},t.prototype._hasMemorySource=function(){return!(this.url||!this.source)},t.prototype._readDataCapabilities=function(e){return{supportsAttachment:ae(e,"hasAttachments",!1),supportsM:ae(e,"hasM",!1),supportsZ:ae(e,"hasZ",!1)}},t.prototype._readOperationsCapabilities=function(e,t){var r=e?e.toLowerCase().split(",").map(function(e){return e.trim()}):[],n=-1!==r.indexOf("editing"),i=n&&-1!==r.indexOf("create"),o=n&&-1!==r.indexOf("delete"),a=n&&-1!==r.indexOf("update");return n&&!(i||o||a)&&(i=o=a=!0),{supportsCalculate:ae(t,"supportsCalculate",!1),supportsTruncate:ae(t,"supportsTruncate",!1),supportsValidateSql:ae(t,"supportsValidateSql",!1),supportsAdd:i,supportsDelete:o,supportsEditing:n,supportsQuery:-1!==r.indexOf("query"),supportsResizeAttachments:ae(t,"supportsAttachmentsResizing",!1),supportsUpdate:a}},t.prototype._readQueryCapabilities=function(e){var t=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,i=(e.supportedQueryFormats||"").split(",").reduce(function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e},new Set);return{supportsAttachments:ae(t,"supportsQueryAttachments",!1),supportsStatistics:ae(t,"supportsStatistics",e.supportsStatistics),supportsCentroid:ae(t,"supportsReturningGeometryCentroid",!1),supportsDistance:ae(t,"supportsQueryWithDistance",!1),supportsDistinct:ae(t,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:ae(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:ae(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:ae(t,"supportsHavingClause",!1),supportsOrderBy:ae(t,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:ae(t,"supportsPagination",!1),supportsQuantization:ae(e,"supportsCoordinatesQuantization",!1),supportsResultType:ae(t,"supportsQueryWithResultType",!1),supportsSqlExpression:ae(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:ae(e,"useStandardizedQueries",!1),supportsQueryByOthers:ae(r,"allowOthersToQuery",!0),supportsHistoricMoment:ae(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:i.has("pbf")}},t.prototype._readQueryRelatedCapabilities=function(e){var t=e.advancedQueryCapabilities,r=ae(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:ae(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}},t.prototype._readEditingCapabilities=function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:ae(e,"allowGeometryUpdates",!0),supportsGlobalId:ae(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:ae(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:ae(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:ae(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:ae(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:ae(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:ae(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:ae(t,"allowOthersToUpdate",!0)}},t.prototype._processApplyEditsParams=function(e){var t="'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required",r="feature-layer:missing-parameters";if(!e)return w.reject(new y(r,t));if((e=n({},e)).addFeatures=e.addFeatures||[],e.updateFeatures=e.updateFeatures||[],e.deleteFeatures=e.deleteFeatures||[],e.addFeatures.length||e.updateFeatures.length||e.deleteFeatures.length){var i=function(e){var t=new s;return t.geometry=e.geometry,t.attributes=e.attributes,t};return e.addFeatures=e.addFeatures.map(i),e.updateFeatures=e.updateFeatures.map(i),this._normalizeGeometries(e)}return w.reject(new y(r,t))},t.prototype._normalizeGeometries=function(e){var t=e.addFeatures,r=e.updateFeatures,n=t.concat(r).map(function(e){return e.geometry});return I.normalizeCentralMeridian(n).then(function(n){var i=t.length,o=r.length;return n.slice(0,i).forEach(function(t,r){e.addFeatures[r].geometry=t}),n.slice(i,i+o).forEach(function(t,r){e.updateFeatures[r].geometry=t}),e})},o([_.property({types:{key:"type",base:N.default,typeMap:{selection:R.default}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],t.prototype,"featureReduction",void 0),o([_.property({readOnly:!0,dependsOn:["loaded","renderer","fields"]})],t.prototype,"allRenderers",null),o([_.property({readOnly:!0})],t.prototype,"capabilities",void 0),o([_.reader("service","capabilities",["advancedQueryCapabilities","archivingInfo","supportsStatistics","supportsAdvancedQueries","hasAttachments","hasM","hasZ","supportsAttachmentsResizing","supportsCalculate","supportsTruncate","supportsValidateSql","supportsCoordinatesQuantization","useStandardizedQueries","ownershipBasedAccessControlForFeatures","allowGeometryUpdates","supportsApplyEditsWithGlobalIds","supportsRollbackOnFailureParameter","allowUpdateWithoutMValues","supportsAttachmentsByUploadId","capabilities","supportedQueryFormats"])],t.prototype,"readCapabilities",null),o([_.property({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),o([_.property({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),o([_.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),o([_.property({readOnly:!0,json:{read:$.read}})],t.prototype,"defaultSymbol",void 0),o([_.property()],t.prototype,"dynamicDataSource",void 0),o([_.property({readOnly:!0})],t.prototype,"editFieldsInfo",void 0),o([_.property({type:Z,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],t.prototype,"elevationInfo",void 0),o([_.property({type:[q],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}})],t.prototype,"fields",void 0),o([_.property({type:j,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],t.prototype,"fullExtent",void 0),o([_.property()],t.prototype,"gdbVersion",void 0),o([_.property({json:{origins:{service:{read:se.read}},read:{source:"layerDefinition.geometryType",reader:se.read}}})],t.prototype,"geometryType",void 0),o([_.property({readOnly:!0,dependsOn:["loaded"],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasAttachments"}}})],t.prototype,"hasAttachments",null),o([_.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],t.prototype,"hasM",void 0),o([_.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],t.prototype,"hasZ",void 0),o([_.property({readOnly:!0,type:O})],t.prototype,"heightModelInfo",void 0),o([_.property({type:Date})],t.prototype,"historicMoment",void 0),o([_.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),o([_.property({readOnly:!0})],t.prototype,"isTable",void 0),o([_.reader("service","isTable",["type"]),_.reader("isTable",["layerDefinition.type"])],t.prototype,"readIsTable",null),o([_.property({dependsOn:["loaded","url","source"],readOnly:!0})],t.prototype,"hasService",null),o([_.property(V.labelsVisible)],t.prototype,"labelsVisible",void 0),o([_.property({type:[B],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:G.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:G.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",void 0),o([_.property({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],t.prototype,"layerId",void 0),o([_.property({type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),o([_.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.maxRecordCount"}}})],t.prototype,"maxRecordCount",void 0),o([_.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.tileMaxRecordCount"}}})],t.prototype,"tileMaxRecordCount",void 0),o([_.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],t.prototype,"minScale",void 0),o([_.reader("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),o([_.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],t.prototype,"maxScale",void 0),o([_.reader("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),o([_.property({type:String})],t.prototype,"objectIdField",void 0),o([_.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),_.reader("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),o([_.property()],t.prototype,"operationalLayerType",void 0),o([_.property({dependsOn:["requiredFields"]})],t.prototype,"outFields",null),o([_.property({readOnly:!0,dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),o([_.property(V.popupEnabled)],t.prototype,"popupEnabled",void 0),o([_.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),o([_.property({type:A})],t.prototype,"processing",void 0),o([_.property({type:[W],readOnly:!0})],t.prototype,"relationships",void 0),o([_.property({types:K.types,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",null),o([_.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),_.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],t.prototype,"readRenderer",null),o([_.writer("renderer")],t.prototype,"writeRenderer",null),o([_.property({readOnly:!0,dependsOn:["allRenderers","labelingInfo","elevationInfo.featureExpressionInfo","popupTemplate.requiredFields"]})],t.prototype,"requiredFields",null),o([_.property({type:Boolean})],t.prototype,"returnM",void 0),o([_.property({type:Boolean})],t.prototype,"returnZ",void 0),o([_.property(V.screenSizePerspectiveEnabled)],t.prototype,"screenSizePerspectiveEnabled",void 0),o([_.property()],t.prototype,"source",null),o([_.cast("source")],t.prototype,"castSource",null),o([_.reader("portal-item","source",["featureSet"]),_.reader("web-map","source",["featureSet"])],t.prototype,"readSource",null),o([_.property({readOnly:!0,json:{origins:{service:{read:{source:"definitionExpression"}}}}})],t.prototype,"serviceDefinitionExpression",void 0),o([_.property({type:x,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],t.prototype,"spatialReference",void 0),o([_.property({type:[U]})],t.prototype,"templates",void 0),o([_.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],t.prototype,"readTemplates",null),o([_.property()],t.prototype,"timeInfo",void 0),o([_.property()],t.prototype,"title",void 0),o([_.reader("service","title",["name"]),_.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],t.prototype,"readTitle",null),o([_.reader("web-map","title",["layerDefinition.name","title"])],t.prototype,"readTitleFromWebMap",null),o([_.property({type:String})],t.prototype,"sublayerTitleMode",void 0),o([_.property({type:String,readOnly:!0,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),o([_.property({json:{read:!1}})],t.prototype,"type",void 0),o([_.property({type:String,readOnly:!0})],t.prototype,"typeIdField",void 0),o([_.reader("service","typeIdField"),_.reader("typeIdField",["layerDefinition.typeIdField"])],t.prototype,"readTypeIdField",null),o([_.property({type:[z]})],t.prototype,"types",void 0),o([_.reader("service","types",["types"]),_.reader("types",["layerDefinition.types"])],t.prototype,"readTypes",null),o([_.property({type:d.ofType(M.FeatureIndex),readOnly:!0})],t.prototype,"indexes",void 0),o([_.property({type:String})],t.prototype,"url",null),o([_.writer("url")],t.prototype,"writeUrl",null),o([_.property({readOnly:!0})],t.prototype,"userIsAdmin",void 0),o([_.property({json:{origins:{"portal-item":{read:!1}}}})],t.prototype,"version",void 0),o([_.reader("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"]),_.reader("version",["layerDefinition.currentVersion","layerDefinition.capabilities","layerDefinition.drawingInfo","layerDefinition.hasAttachments","layerDefinition.htmlPopupType","layerDefinition.typeIdField","layerDefinition.types"])],t.prototype,"readVersion",null),o([_.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],t.prototype,"visible",void 0),o([_.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],t.prototype,"readVisible",null),o([a(0,_.cast(X))],t.prototype,"queryAttachments",null),o([a(0,_.cast(te))],t.prototype,"queryFeatures",null),o([a(0,_.cast(te))],t.prototype,"queryFeaturesJSON",null),o([a(0,_.cast(te))],t.prototype,"queryObjectIds",null),o([a(0,_.cast(te))],t.prototype,"queryFeatureCount",null),o([a(0,_.cast(te))],t.prototype,"queryExtent",null),o([a(0,_.cast(re))],t.prototype,"queryRelatedFeatures",null),o([_.subclass("esri.layers.FeatureLayer")],t)}(_.declared(T,D,L,k,P,E,g))}.apply(null,n))||(e.exports=i)},354:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){return e?72*e/t.DPI:0}Object.defineProperty(t,"__esModule",{value:!0});var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,i="screenUtils.toPt: input not recognized!";t.DPI=96,t.pt2px=function(e){return e?e/72*t.DPI:0},t.px2pt=r,t.toPt=function(e){if("string"==typeof e){if(n.test(e)){var t=e.match(n),o=Number(t[1]),a=t[3]&&t[3].toLowerCase(),s="-"===e.charAt(0),l="px"===a?r(o):o;return s?-l:l}return console.warn(i),null}return e}}.apply(null,n))||(e.exports=i)},370:function(e,t,r){var n,i;n=[r(351),r(346),r(340),r(347),r(354),r(338),r(341),r(391),r(712),r(358),r(720),r(641)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){var d="size",y=n({sizeInfo:d,colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),f=n({widthAndDepth:"width-and-depth"}),h=n({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),m=n({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap"},{ignoreUnknown:!0}),v=Math.PI,b=l.opacityToTransparency,g=l.transparencyToOpacity;return e([t,r],{declaredClass:"esri.renderers.Renderer",properties:{authoringInfo:{type:c,value:null,json:{write:!0}},requiredFields:{dependsOn:["visualVariables"],get:function(){var e=Object.create(null);return this.collectRequiredFields(e),Object.keys(e).sort()}},type:{type:m.apiValues,readOnly:!0,json:{type:m.jsonValues,read:!1,write:{writer:m.write,ignoreOrigin:!0}}},visualVariables:{json:{read:{source:["visualVariables","rotationType","rotationExpression"],reader:function(e,t){return this._readVariables(e,t)}},write:function(e,t,r,n){var i=[];e.forEach(function(e,t){e.type===d?i.push(this._writeSizeInfo(e,n,t)):"color"===e.type?i.push(this._writeColorInfo(e,n,t)):"opacity"===e.type?i.push(this._writeOpacityInfo(e,n,t)):"rotation"===e.type&&i.push(this._writeRotationInfo(e,n,t))},this),t.visualVariables=i}}}},constructor:function(){this._cache={}},_rotationRE:/^\[([^\]]+)\]$/i,_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_visualVariablesSetter:function(e){var t=this._cache;this.visualVariables&&this.visualVariables.forEach(function(e,r){t.hasOwnProperty(r)&&(t[r]=null)},this),e&&e.some(function(e){return!!e.target})&&e.sort(function(e,t){return e.target===t.target?0:e.target?1:-1}),e&&e.forEach(function(e,r){"color"===e.type?t[r]=this._processColorInfo(e):"opacity"===e.type?t[r]=this._processOpacityInfo(e):e.type===d?t[r]=this._processSizeInfo(e):"rotation"===e.type&&(t[r]=this._processRotationInfo(e))},this),this._set("visualVariables",e)},getSymbol:function(e,t){},getVisualVariableValues:function(e,t){var r,n=this.visualVariables;return n&&(r=n.map(function(r){var n,i=r.type,a=i+"Info";switch((t=o.mixin({},t))[a]=r,i){case d:n=this.getSize(e,t);break;case"color":n=this.getColor(e,t);break;case"opacity":n=this.getOpacity(e,t);break;case"rotation":n=this.getRotationAngle(e,t)}return{variable:r,value:n}},this).filter(function(e){return null!=e.value},this)),r},hasVisualVariables:function(e,t){return e?!!this.getVisualVariablesForType(e,t):!!(this.getVisualVariablesForType(d,t)||this.getVisualVariablesForType("color",t)||this.getVisualVariablesForType("opacity",t)||this.getVisualVariablesForType("rotation",t))},getVisualVariablesForType:function(e,t){var r,n=this.visualVariables;return n&&(r=n.filter(function(r){return r.type===e&&("string"==typeof t?r.target===t:!1!==t||!r.target)}))&&0===r.length&&(r=void 0),r},getSize:function(e,t){var r=this._getVarInfo(t&&t.sizeInfo,d),n=r.variable,i=this._cache[r.cacheKey],o=null;if(n){var a=n.minSize,s=n.maxSize,l="object"==typeof a&&a?this._getSize(e,a,i&&i.minSize,t):a,u="object"==typeof s&&s?this._getSize(e,s,i&&i.maxSize,t):s;o=this._getSize(e,n,i&&i.root,t,[l,u])}return o},getSizeRangeAtScale:function(e,t){var r,n=this._getVarInfo(e,d),i=this._cache[n.cacheKey],o={scale:t};if((e=n.variable)&&t){var a=e.minSize,s=e.maxSize,l="object"==typeof a&&a?this._getSize({},a,i&&i.minSize,o):a,u="object"==typeof s&&s?this._getSize({},s,i&&i.maxSize,o):s;if(null!=l||null!=u){if(l>u){var p=u;u=l,l=p}r={minSize:l,maxSize:u}}}return r},getColor:function(e,t){var r=this._getVarInfo(t&&t.colorInfo,"color");return this._getColorComponent(e,r.variable,this._cache[r.cacheKey],t,!1)},getOpacity:function(e,t){var r=this._getVarInfo(t&&t.opacityInfo,"opacity");return this._getColorComponent(e,r.variable,this._cache[r.cacheKey],t,!0)},getRotationAngle:function(e,t){var r=this._getVarInfo(t&&t.rotationInfo,"rotation"),n=r.variable,i=this._cache[r.cacheKey],o=n.axis||"heading",a="heading"===o&&"arithmetic"===n.rotationType?90:0,l="heading"===o&&"arithmetic"===n.rotationType?-1:1,u=n.field,p=i&&i.compiledFunc,c=e.attributes,d=0;return(u||p)&&(p?d=s.executeFunction(p,s.createExecContext(e,s.getViewInfo(t))):"function"==typeof u?d=u.apply(this,arguments):c&&(d=c[u]||0),d="number"!=typeof d||isNaN(d)?null:a+l*d),d},collectRequiredFields:function(e){var t=[];this.visualVariables&&(t=t.concat(this.visualVariables)),t.forEach(function(t){t&&(t.field&&(e[t.field]=!0),t.normalizationField&&(e[t.normalizationField]=!0),t.valueExpression&&s.extractFieldNames(t.valueExpression).forEach(function(t){e[t]=!0}))})},_getVarInfo:function(e,t){var r;if(e&&e.type===t&&this.visualVariables)r=this.visualVariables.indexOf(e),e=this.visualVariables[r];else if(this.visualVariables){var n=this.getVisualVariablesForType(t);e=n&&n[0],r=this.visualVariables.indexOf(e)}return{variable:e,cacheKey:r}},_readSizeInfo:function(e){return e.axis&&(e.axis=f.fromJSON(e.axis)),e.valueUnit&&(e.valueUnit=h.fromJSON(e.valueUnit)),e},_readColorInfo:function(e){return e&&(e.colors&&e.colors.forEach(function(t,r){Array.isArray(t)?e.colors[r]=u.fromJSON(t):e.colors[r]=new u(t)}),e.stops&&e.stops.forEach(function(t,r){t.color&&Array.isArray(t.color)?e.stops[r].color=u.fromJSON(t.color):t.color&&(e.stops[r].color=new u(t.color))})),e},_readOpacityInfo:function(e){var t;return e&&((t=o.mixin({},e)).transparencyValues&&(t.opacityValues=t.transparencyValues.map(g),delete t.transparencyValues),t.stops&&(t.stops=t.stops.map(function(e){return(e=o.mixin({},e)).opacity=g(e.transparency),delete e.transparency,e}))),t},_readVariables:function(e,t){e&&(e=e.map(function(e){return(e=o.clone(e)).type=y.fromJSON(e.type),e.type===d?e=this._readSizeInfo(e):"color"===e.type?e=this._readColorInfo(e):"opacity"===e.type&&(e=this._readOpacityInfo(e)),e},this));var r=t.rotationType,n=t.rotationExpression;if(n){var i={type:"rotation",rotationType:r},a=n.match(this._rotationRE);a&&a[1]&&(i.field=a[1],e||(e=[]),e.push(i))}return e},_createCache:function(e){var t=e&&e.valueExpression,r=s.createSyntaxTree(t),n=s.createFunction(r),i=!(!e||!e.expression)||this._viewScaleRE.test(t);return{ipData:this._interpolateData(e),hasExpr:!!t,compiledFunc:n,isScaleDriven:i}},_processColorInfo:function(e){return e&&(e.colors&&e.colors.forEach(function(t,r){t instanceof u||(e.colors[r]=new u(t))}),e.stops&&e.stops.forEach(function(t,r){!t.color||t.color instanceof u||(e.stops[r].color=new u(t.color))}),this._sortStops(e.stops)),this._createCache(e)},_processOpacityInfo:function(e){return this._sortStops(e&&e.stops),this._createCache(e)},_processSizeInfo:function(e){return e.stops&&Array.isArray(e.stops)?e.stops=this._processSizeInfoStops(e.stops):(e.minSize=e.minSize&&this._processSizeInfoSize(e.minSize),e.maxSize=e.maxSize&&this._processSizeInfoSize(e.maxSize)),{root:this._createCache(e),minSize:this._createCache(e.minSize),maxSize:this._createCache(e.maxSize)}},_processSizeInfoSize:function(e){return"object"==typeof e?e.stops=this._processSizeInfoStops(e.stops):e=i.toPt(e),e},_processSizeInfoStops:function(e){return e&&Array.isArray(e)&&(e.forEach(function(e){e.size=i.toPt(e.size)}),this._sortStops(e)),e},_sortStops:function(e){e&&Array.isArray(e)&&e.sort(function(e,t){return e.value-t.value})},_processRotationInfo:function(e){return this._createCache(e)},_getSize:function(e,t,r,n,i){var o=e.attributes,a=t.field,l=t.stops,u=0,c=r&&r.hasExpr,d=r&&r.compiledFunc,y=r&&r.ipData,f=r&&r.isScaleDriven,h="number"==typeof e,m=h?e:null;if(a||f||c){var b,g=n&&n.scale,w=i?i[0]:t.minSize,S=i?i[1]:t.maxSize,_=t.minDataValue,j=t.maxDataValue,O=t.valueUnit||"unknown",x=t.valueRepresentation,I=t.scaleBy,T=t.normalizationField,F=o?parseFloat(o[T]):void 0,E=n&&n.shape;if(f?m=null==g?this._getAverageValue(t):g:"number"!=typeof m&&(c?m=s.executeFunction(d,s.createExecContext(e,s.getViewInfo(n))):"function"==typeof a?m=a.apply(this,arguments):o&&(m=o[a])),null==m||T&&!h&&(isNaN(F)||0===F))return null;if(isNaN(F)||h||(m/=F),l){var D,L=this._lookupData(m,y),P=L[0],k=L[1];P===k?u=l[P].size:u=(D=l[P].size)+(l[k].size-D)*L[2]}else if(null!=w&&null!=S&&null!=_&&null!=j)if(m<=_)u=w;else if(m>=j)u=S;else if(b=(m-_)/(j-_),"area"===I&&E){var C="circle"===E,V=C?v*Math.pow(w/2,2):w*w,M=V+b*((C?v*Math.pow(S/2,2):S*S)-V);u=C?2*Math.sqrt(M/v):Math.sqrt(M)}else u=w+b*(S-w);else if("unknown"===O)null!=w&&null!=_?(w&&_?(b=m/_,u="circle"===E?2*Math.sqrt(b*Math.pow(w/2,2)):"square"===E||"diamond"===E||"image"===E?Math.sqrt(b*Math.pow(w,2)):b*w):u=m+(w||_),u=u<w?w:u,null!=S&&u>S&&(u=S)):u=m;else{var A=(n&&n.resolution?n.resolution:1)*p.meterIn[O];"area"===x?(u=Math.sqrt(m/v)/A,u*=2):(u=m/A,"radius"!==x&&"distance"!==x||(u*=2)),null!=w&&u<w&&(u=w),null!=S&&u>S&&(u=S)}}else t&&null==(u=l&&l[0]&&l[0].size)&&(u=t.minSize);return isNaN(u)?0:u},_getAverageValue:function(e){var t,r,n=e.stops;return n?(t=n[0].value,r=n[n.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2},_getColorComponent:function(e,t,r,n,i){var o,a=e.attributes,l=t&&t.field,u="number"==typeof e,p=u?e:null,c=r&&r.hasExpr,d=r&&r.compiledFunc,y=r&&r.ipData;if(l||c){var f=t.normalizationField,h=a&&f?parseFloat(a[f]):void 0;"number"!=typeof p&&(c?p=s.executeFunction(d,s.createExecContext(e,s.getViewInfo(n))):"function"==typeof l?p=l.apply(this,arguments):a&&(p=a[l])),null==p||f&&!u&&(isNaN(h)||0===h)||(isNaN(h)||u||(p/=h),o=i?this._getOpacity(p,t,y):this._getColor(p,t,y,n&&n.color))}else if(t){var m=t.stops;i?null==(o=m&&m[0]&&m[0].opacity)&&(o=t.opacityValues&&t.opacityValues[0]):o=m&&m[0]&&m[0].color||t.colors&&t.colors[0]}return o},_interpolateData:function(e){var t;if(e)if(e.colors||e.opacityValues){var r,n=(e.colors||e.opacityValues).length,i=e.minDataValue,o=(e.maxDataValue-i)/(n-1);for(t=[],r=0;r<n;r++)t[r]=i+r*o}else e.stops&&(t=e.stops.map(function(e){return e.value||0}));return t},_getOpacity:function(e,t,r){var n,i=this._lookupData(e,r);if(t=t||this.opacityInfo,i){var o,a=i[0],s=i[1];a===s?n=this._getOpacValue(t,a):n=(o=this._getOpacValue(t,a))+(this._getOpacValue(t,s)-o)*i[2]}return n},_getOpacValue:function(e,t){return e.opacityValues?e.opacityValues[t]:e.stops[t].opacity},_getColor:function(e,t,r,n){var i=this._lookupData(e,r);if(t=t||this.colorInfo,i){var o=i[0],a=i[1];return n=n||new u,o===a?n.setColor(this._getColorObj(t,o)):u.blendColors(this._getColorObj(t,o),this._getColorObj(t,a),i[2],n),n}},_getColorObj:function(e,t){return e.colors?e.colors[t]:e.stops[t].color},_lookupData:function(e,t){var r;if(t){var n=0,i=t.length-1;t.some(function(t,r){return e<t?(i=r,!0):(n=r,!1)}),r=[n,i,(e-t[n])/(t[i]-t[n])]}return r},_processForContext:function(e,t,r){if(t&&"web-scene"===t.origin){var n=null!=e.expression,i=null!=e.valueExpressionTitle&&"rotation"===e.type;t.messages&&(n&&t.messages.push(new a("property:unsupported",e.type+"VisualVariable.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".expression",context:t})),i&&t.messages.push(new a("property:unsupported",e.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".valueExpressionTitle",context:t}))),n&&delete e.expression,i&&delete e.valueExpressionTitle}else e.type===d&&this._convertExpressionToArcade(e)},_writeRotationInfo:function(e,t,r){return e&&(e=o.mixin({},e),this._processForContext(e,t,"visualVariables["+r+"]"),e.type=y.toJSON(e.type),e=o.fixJson(e,!0)),e},_convertExpressionToArcade:function(e){e&&e.expression&&(e.valueExpression="$view.scale")},_writeSizeInfo:function(e,t,r){if(e){e=o.mixin({},e),this._processForContext(e,t,"string"==typeof r?r:"visualVariables["+r+"]");var n=e.minSize,i=e.maxSize;n&&(e.minSize="number"==typeof n?n:this._writeSizeInfo(n,t,"visualVariables["+r+"].minSize")),i&&(e.maxSize="number"==typeof i?i:this._writeSizeInfo(i,t,"visualVariables["+r+"].maxSize"));var a=e.legendOptions,s=e.type,l=e.axis;e.type=y.toJSON(s),l&&(e.axis=f.toJSON(l)),a&&(e.legendOptions=o.mixin({},a),(a=a.customValues)&&(e.legendOptions.customValues=a.slice(0))),e.stops&&(e.stops=e.stops.map(function(e){return null===(e=o.mixin({},e)).label&&delete e.label,e})),e=o.fixJson(e,!0)}return e},_writeColorInfo:function(e,t,r){return e&&(e=o.mixin({},e),this._processForContext(e,t,"visualVariables["+r+"]"),e.type=y.toJSON(e.type),e.colors&&(e.colors=e.colors.map(function(e){return u.toJSON(e)})),e.stops&&(e.stops=e.stops.map(function(e){return(e=o.mixin({},e)).color&&(e.color=u.toJSON(e.color)),null==e.value&&(e.value=0),null===e.label&&delete e.label,e})),e.legendOptions&&(e.legendOptions=o.mixin({},e.legendOptions)),e=o.fixJson(e,!0)),e},_writeOpacityInfo:function(e,t,r){var n;return e&&(n=o.mixin({},e),this._processForContext(n,t,"visualVariables["+r+"]"),n.type=y.toJSON(n.type),n.opacityValues&&(n.transparencyValues=n.opacityValues.map(b),delete n.opacityValues),n.stops&&(n.stops=n.stops.map(function(e){return(e=o.mixin({},e)).transparency=b(e.opacity),delete e.opacity,null===e.label&&delete e.label,e})),n.legendOptions&&(n.legendOptions=o.mixin({},n.legendOptions)),n=o.fixJson(n,!0)),n}})}.apply(null,n))||(e.exports=i)},371:function(e,t,r){var n,i;n=[r(347),r(340),r(358)],void 0===(i=function(e,t,r){var n=e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),i=0;return t.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:function(){this.id="sym"+i++},properties:{type:{type:String,value:null,json:{read:n.read,write:{ignoreOrigin:!0,writer:n.write}}},color:{type:r,value:new r([0,0,0,1]),json:{read:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e},write:{allowNull:!0}}}}})}.apply(null,n))||(e.exports=i)},374:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336)],void 0===(i=function(e,t,r,n,i,o,a){var s=o({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.type=null,r}return r(t,e),n([a.property({json:{write:!0}})],t.prototype,"name",void 0),n([a.property({json:{read:s.read,write:s.write}})],t.prototype,"type",void 0),n([a.subclass("esri.layers.support.Domain")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},377:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(380),r(631)],void 0===(i=function(e,t,r,n){function i(e,t,r,n,i){var o=e.watch(t,function(t,i,o,a){n&&!n(t)||r.call(e,t,i,o,a)},i);if(Array.isArray(t))for(var a=0,s=t;a<s.length;a++){var l=s[a],u=e.get(l);n&&n(u)&&r.call(e,u,u,t,e)}else{u=e.get(t);n&&n(u)&&r.call(e,u,u,t,e)}return o}function o(e,t,o,a,s){function l(){u&&(u.remove(),u=null)}var u,p=!1,c=new r(l),d=new n;return d.cancel=c.cancel,d.isCanceled=c.isCanceled,d.isFulfilled=c.isFulfilled,d.isRejected=c.isRejected,d.isResolved=c.isResolved,d.then=c.then,d.remove=l,Object.freeze(d),u=i(e,t,function(t,r,n,i){p=!0,l(),o&&o.call(e,t,r,n,i),c.resolve({value:t,oldValue:r,propertyName:n,target:i})},a,s),p&&l(),d}function a(e){return!!e}function s(e){return!e}function l(e){return!0===e}function u(e){return!1===e}function p(e){return void 0!==e}function c(e){return void 0===e}function d(e,t,r,n){for(var i=Array.isArray(t)?t:t.indexOf(",")>-1?t.split(","):[t],o=y(e,t,r,n),a=0,s=i;a<s.length;a++){var l=s[a].trim(),u=e.get(l);r.call(e,u,u,l,e)}return o}function y(e,t,r,n){return e.watch(t,r,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.init=d,t.watch=y,t.once=function(e,t,r,n){return o(e,t,r,null,n)},t.when=function(e,t,r,n){return i(e,t,r,a,n)},t.whenOnce=function(e,t,r,n){return o(e,t,r,a,n)},t.whenNot=function(e,t,r,n){return i(e,t,r,s,n)},t.whenNotOnce=function(e,t,r,n){return o(e,t,r,s,n)},t.whenTrue=function(e,t,r,n){return i(e,t,r,l,n)},t.whenTrueOnce=function(e,t,r,n){return o(e,t,r,l,n)},t.whenFalse=function(e,t,r,n){return i(e,t,r,u,n)},t.whenFalseOnce=function(e,t,r,n){return o(e,t,r,u,n)},t.whenDefined=function(e,t,r,n){return i(e,t,r,p,n)},t.whenDefinedOnce=function(e,t,r,n){return o(e,t,r,p,n)},t.whenUndefined=function(e,t,r,n){return i(e,t,r,c,n)},t.whenUndefinedOnce=function(e,t,r,n){return o(e,t,r,c,n)},t.pausable=function(e,t,r,n){var i=!1,o=e.watch(t,function(t,n,o,a){i||r.call(e,t,n,o,a)},n);return{remove:function(){o.remove()},pause:function(){i=!0},resume:function(){i=!1}}},t.on=function(e,t,r,n,i,o,a){function s(t){var n=l[t];n&&(o&&o(n.target,t,e,r),n.handle.remove(),delete l[t])}var l={},u=d(e,t,function(t,o,a){s(a),t&&"function"==typeof t.on&&(l[a]={handle:t.on(r,n),target:t},i&&i(t,a,e,r))},a);return{remove:function(){for(var e in u.remove(),l)s(e)}}}}.apply(null,n))||(e.exports=i)},378:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(355)],void 0===(i=function(e,t,r){function n(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}function i(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.CONFIGURE=1]="CONFIGURE",e[e.CONFIGURED=2]="CONFIGURED",e[e.OPEN=3]="OPEN",e[e.OPENED=4]="OPENED",e[e.RESPONSE=5]="RESPONSE",e[e.INVOKE=6]="INVOKE",e[e.CANCEL=7]="CANCEL",e[e.CLOSE=8]="CLOSE",e[e.OPEN_PORT=9]="OPEN_PORT"}(t.MessageType||(t.MessageType={}));var o=0;t.newJobId=function(){return o++},t.isTranferableResult=n,t.toInvokeError=function(e){return e?e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details,stack:e.stack}):null},t.postMessage=function(e,t,o,a){2===arguments.length||void 0===o&&void 0===a?e.postMessage(t):(r("esri-workers-arraybuffer-transfer")||(a?(a=a.filter(function(e){return!i(e)})).length||(a=null):n(o)&&o.transferList&&(o.transferList=o.transferList.filter(function(e){return!i(e)}),o.transferList.length||(o.transferList=null))),a?(t.data=o,e.postMessage(t,a)):n(o)?(t.data=o.result,o.transferList?e.postMessage(t,o.transferList):e.postMessage(t)):(t.data=o,e.postMessage(t)))},t.receiveMessage=function(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}}.apply(null,n))||(e.exports=i)},389:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(341),r(339),r(378)],void 0===(i=function(e,t,r,n,i){function o(e,t){e.delete(t)}var a=i.MessageType.CLOSE,s=i.MessageType.CANCEL,l=i.MessageType.INVOKE,u=i.MessageType.RESPONSE,p=i.MessageType.OPEN_PORT,c=function(){function e(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e){e.type===i.MessageType.CANCEL?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))},e.prototype.clear=function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null},e.prototype._process=function(){this._timer=null;for(var e=0,t=this._invokeMessages;e<t.length;e++){var r=t[e];this._cancelledJobIds.has(r.jobId)||this._invoke(r)}this._cancelledJobIds.clear(),this._invokeMessages.length=0},e}();return function(){function e(e,t,r){this._outJobs=new Map,this._inJobs=new Map,this._queue=new c(this._onInvoke.bind(this)),this._onMessage=this._onMessage.bind(this),this._client=t,this._port=e,this._port.addEventListener("message",this._onMessage),this._port.start(),this._channel=r}return e.connect=function(t){var r,n=new MessageChannel;return(r="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t).remoteClient=new e(n.port1,r,n),n.port2},e.prototype.close=function(){this._post({type:a}),this._close()},e.prototype.isBusy=function(){return this._outJobs.size>0},e.prototype.invoke=function(e,t,a){var u=this;if(!this._port)return n.reject(new r("remote-client:port-closed","Can't invoke(), port is closed"));var p=i.newJobId(),c=function(){o(u._outJobs,p),u._post({type:s,jobId:p})};return n.create(function(r,n){var i={resolve:r,reject:n,cancel:c};u._outJobs.set(p,i),u._post({type:l,jobId:p,methodName:e},t,a)},c)},e.prototype.openPort=function(){var e=this,t=i.newJobId(),r=function(){o(e._outJobs,t),e._post({type:s,jobId:t})};return n.create(function(n,i){var o={resolve:n,reject:i,cancel:r};e._outJobs.set(t,o),e._post({type:p,jobId:t})},r)},e.prototype._close=function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(function(e){e.cancel()}),this._inJobs.clear(),this._outJobs.clear(),this._queue.clear(),this._port=this._client=null},e.prototype._onMessage=function(e){var t=i.receiveMessage(e);if(t)switch(t.type){case u:this._onResponse(t);break;case l:this._queue.push(t);break;case s:this._onCancel(t);break;case a:this._close();break;case p:this._onOpenPort(t)}},e.prototype._onCancel=function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);this._queue.push(e),n&&(o(t,r),n.cancel())},e.prototype._onInvoke=function(e){var t,r=this,a=e.methodName,s=e.jobId,l=e.data,p=this._inJobs,c=this._client,d=c[a];try{if(!d&&a&&-1!==a.indexOf("."))for(var y=a.split("."),f=0;f<y.length-1;f++)d=(c=c[y[f]])[y[f+1]];if("function"!=typeof d)throw new TypeError(a+" is not a function");t=d.call(c,l,this)}catch(e){return void this._post({type:u,jobId:s,error:i.toInvokeError(e)})}n.isThenable(t)?(p.set(s,t),t.then(function(e){p.has(s)&&(o(p,s),r._post({type:u,jobId:s},e))}).catch(function(e){p.has(s)&&(o(p,s),e&&"cancel"===e.dojoType||r._post({type:u,jobId:s,error:i.toInvokeError(e||{message:"Error encountered at method "+a})}))})):this._post({type:u,jobId:s},t)},e.prototype._onOpenPort=function(t){var r=new MessageChannel;new e(r.port1,this._client),this._post({type:u,jobId:t.jobId},r.port2,[r.port2])},e.prototype._onResponse=function(e){var t=e.jobId,n=e.error,i=e.data,a=this._outJobs;if(a.has(t)){var s=a.get(t);o(a,t),n?s.reject(r.fromJSON(JSON.parse(n))):s.resolve(i)}},e.prototype._post=function(e,t,r){return i.postMessage(this._port,e,t,r)},e}()}.apply(null,n))||(e.exports=i)},392:function(e,t,r){var n,i;n=[r(347),r(340),r(338),r(383),r(395),r(362),r(613),r(422)],void 0===(i=function(e,t,r,n,i,o,a,s){var l=e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"});return t.createSubclass({declaredClass:"esri.tasks.support.FeatureSet",getDefaults:function(){return r.mixin(this.inherited(arguments),{features:[]})},properties:{displayFieldName:null,exceededTransferLimit:null,features:{value:null,json:{read:function(e,t){for(var r=o.fromJSON(t.spatialReference),i=[],a=0;a<e.length;a++){var s=e[a],l=n.fromJSON(s),u=s.geometry&&s.geometry.spatialReference;l.geometry&&!u&&(l.geometry.spatialReference=r),i.push(l)}return t.transform&&this._hydrate(t.transform,t.geometryType,i),i}}},fields:{value:null,type:[i]},geometryType:{value:null,json:{read:l.read}},spatialReference:{type:o}},toJSON:function(e){var t={hasZ:this.hasZ,hasM:this.hasM};return this.displayFieldName&&(t.displayFieldName=this.displayFieldName),this.fields&&(t.fields=this.fields.map(function(e){return e.toJSON()})),this.spatialReference?t.spatialReference=this.spatialReference.toJSON():this.features[0]&&this.features[0].geometry&&(t.spatialReference=this.features[0].geometry.spatialReference.toJSON()),this.features[0]&&(this.features[0].geometry&&(t.geometryType=s.getJsonType(this.features[0].geometry)),t.features=a._encodeGraphics(this.features,e)),t.exceededTransferLimit=this.exceededTransferLimit,t.transform=this.transform,r.fixJson(t)},quantize:function(e){var t,r,n=e.translate[0],i=e.translate[1],o=e.scale[0],a=e.scale[1],s=this.features,l=function(e,t,r){var n,i,o,a,s,l,u,p=[];for(n=0,i=e.length;n<i;n++)o=e[n],n>0?(l=t(o[0]),u=r(o[1]),l===a&&u===s||(p.push([l-a,u-s]),a=l,s=u)):(a=t(o[0]),s=r(o[1]),p.push([a,s]));return p.length>0?p:null},u=function(e,t,r){return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){var n,i,o,a,s,u;for(u=[],n=0,i=(o=e.rings||e.paths).length;n<i;n++)a=o[n],(s=l(a,t,r))&&u.push(s);return u.length>0?(e.rings?e.rings=u:e.paths=u,e):null}:"multipoint"===e?function(e){var n;return(n=l(e.points,t,r)).length>0?(e.points=n,e):null}:"extent"===e?function(e){return e}:void 0}(this.geometryType,function(e){return Math.round((e-n)/o)},function(e){return Math.round((i-e)/a)});for(t=0,r=s.length;t<r;t++)u(s[t].geometry)||(s.splice(t,1),t--,r--);return this.transform=e,this},_hydrate:function(e,t,r){if(e){var n,i,o=e.translate[0],a=e.translate[1],s=e.scale[0],l=e.scale[1],u=function(e,t,r){return"esriGeometryPoint"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"esriGeometryPolyline"===e||"esriGeometryPolygon"===e?function(e){var n,i,o,a,s,l,u,p,c=e.rings||e.paths;for(n=0,i=c.length;n<i;n++)for(o=0,a=(s=c[n]).length;o<a;o++)l=s[o],o>0?(u+=l[0],p+=l[1]):(u=l[0],p=l[1]),l[0]=t(u),l[1]=r(p)}:"esriGeometryEnvelope"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"esriGeometryMultipoint"===e?function(e){var n,i,o,a,s,l=e.points;for(n=0,i=l.length;n<i;n++)o=l[n],n>0?(a+=o[0],s+=o[1]):(a=o[0],s=o[1]),o[0]=t(a),o[1]=r(s)}:void 0}(t,function(e){return e*s+o},function(e){return a-e*l});for(n=0,i=r.length;n<i;n++)r[n].geometry&&u(r[n].geometry)}}})}.apply(null,n))||(e.exports=i)},395:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(345),r(335),r(340),r(336),r(399),r(600)],void 0===(i=function(e,t,r,n,i,o,a,s){return function(e){function t(t){var r=e.call(this)||this;return r.alias=null,r.defaultValue=void 0,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({alias:this.alias,defaultValue:this.defaultValue,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type})},n([o.property({type:String,json:{write:!0}})],t.prototype,"alias",void 0),n([o.property({json:{write:{allowNull:!0}}})],t.prototype,"defaultValue",void 0),n([o.property({types:a.types,json:{read:{reader:a.fromJSON},write:!0}})],t.prototype,"domain",void 0),n([o.property({type:Boolean,json:{write:!0}})],t.prototype,"editable",void 0),n([o.property({type:Number,json:{write:!0}})],t.prototype,"length",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"name",void 0),n([o.property({type:Boolean,json:{write:!0}})],t.prototype,"nullable",void 0),n([o.property({type:String,json:{read:s.kebabDict.read,write:s.kebabDict.write}})],t.prototype,"type",void 0),i=n([o.subclass("esri.layers.support.Field")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},399:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(597),r(374),r(598),r(599)],void 0===(i=function(e,t,r,n,i,o){function a(e,t){switch(e.type){case"range":var r="range"in e?e.range[0]:e.minValue,n="range"in e?e.range[1]:e.maxValue;if(+t<r||+t>n)return s.VALUE_OUT_OF_RANGE;break;case"coded-value":case"codedValue":if(null==e.codedValues||e.codedValues.every(function(e){return null==e||e.code!==t}))return s.INVALID_CODED_VALUE}return null}var s;Object.defineProperty(t,"__esModule",{value:!0}),t.CodedValueDomain=r,t.DomainBase=n,t.InheritedDomain=i,t.RangeDomain=o,function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(s=t.DomainValidationError||(t.DomainValidationError={})),t.isValidDomainValue=function(e,t){return null===a(e,t)},t.validateDomainValue=a,t.types={key:"type",base:t.DomainBase,typeMap:{range:t.RangeDomain,"coded-value":t.CodedValueDomain}},t.getDomainRange=function(e){if(e&&"range"===e.type)return{min:"range"in e?e.range[0]:e.minValue,max:"range"in e?e.range[1]:e.maxValue}},t.fromJSON=function(e){return e&&e.type?"range"===e.type?t.RangeDomain.fromJSON(e):"codedValue"===e.type?t.CodedValueDomain.fromJSON(e):null:null}}.apply(null,n))||(e.exports=i)},402:function(e,t,r){var n,i;n=[r(351),r(338),r(354),r(592)],void 0===(i=function(e,t,r,n){var i={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},o={color:[0,0,0,1],style:i.STYLE_SOLID,width:.75,cap:i.CAP_ROUND,join:i.JOIN_ROUND,miterLimit:7.5},a=e(n,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line",style:{value:i.STYLE_SOLID,json:{read:function(e,r){return t.valueOf(this._jsonStyles,e)||void 0},write:function(e,t){t.style=this._jsonStyles[e]}}},cap:{value:i.CAP_ROUND,json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}},join:{value:i.JOIN_ROUND,json:{write:{overridePolicy:function(e,t,r){return{enabled:"round"!==e&&(null==r||null==r.origin)}}}}},miterLimit:{value:7.5,cast:r.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash","short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash","long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return t.mixin(this.inherited(arguments),o)},normalizeCtorArgs:function(e,t,n,i,o,a){if(e&&"string"!=typeof e)return e;var s={};return null!=e&&(s.style=e),null!=t&&(s.color=t),null!=n&&(s.width=r.toPt(n)),null!=i&&(s.cap=i),null!=o&&(s.join=o),null!=a&&(s.miterLimit=r.toPt(a)),s},clone:function(){return new a({color:t.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});return t.mixin(a,i),a.defaultProps=o,a}.apply(null,n))||(e.exports=i)},403:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(var o=0;o<i.length;o++)r[n][o]=e(i[o])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}}.apply(null,n))||(e.exports=i)},407:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(379),r(666)],void 0===(i=function(e,t,r,n){var i=2;return function(){function e(e){var t=this;if(this.data=[],this._length=0,this._allocator=null,this._deallocator=function(e,r){return t.data[r]=void 0},this._shrink=function(){},this._hint=new r.RemoveHint,e){if(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator,this._deallocator=e.deallocator,e.initialSize))for(var n=0;n<e.initialSize;++n)this.data[n]=this._allocator(n);e.shrink&&(this._shrink=function(){t.data.length>i*t.length&&(t.data.length=t.length)})}}return e.prototype.toArray=function(){return this.data.slice(0,this.length)},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(e){if(this._allocator)for(;this.data.length<e;)this.data.push(this._allocator(this.data.length));if(this._deallocator)for(var t=e;t<this._length;++t)this._deallocator(this.data[t],t);this._length=e,this._shrink()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.length=0},e.prototype.equal=function(e){return r.equals(this.data,e.data)},e.prototype.push=function(e){return this.data.length===this.length&&this._grow((this.length+1)*i),this.data[this.length++]=e,e},e.prototype.pushArray=function(e){var t=this.length+e.length;t>=this.data.length&&this._grow(Math.max(this.length*i,t));for(var r=0;r<e.length;r++)this.data[this._length++]=e[r];return this.back()},e.prototype.pushNew=function(){return this.data.length===this.length&&this._grow((this.length+1)*i),++this._length,this.back()},e.prototype.pop=function(){if(0!==this.length){var e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}},e.prototype.removeMany=function(e){var t=this,r=[];return this.data=this.data.filter(function(n,i){return!(i>=t.length)&&(e.indexOf(n)<0||(r.push(n),!1))}),this._length=this.data.length,r},e.prototype.removeUnordered=function(e){var t=r.removeUnordered(this.data,e,this.length,this._hint);return void 0!==t&&(this.length=this.length-1),t},e.prototype.removeUnorderedMany=function(e){var t=r.removeUnorderedMany(this.data,e,this.length,this._hint);return this.length=this.length-t.length,t},e.prototype.front=function(){if(0!==this.length)return this.data[0]},e.prototype.back=function(){if(0!==this.length)return this.data[this.length-1]},e.prototype.swapElements=function(e,t){var r;e>=this.length||t>=this.length||(r=[this.data[t],this.data[e]],this.data[e]=r[0],this.data[t]=r[1])},e.prototype.sort=function(e){n.sort(this.data,0,this.length,e)},e.prototype.some=function(e,t){for(var r=0;r<this.length;++r)if(e.call(t,this.data[r],r,this.data))return!0;return!1},e.prototype.find=function(e,t){for(var r=0;r<this.length;++r){var n=this.data[r];if(e.call(t,n,r,this.data))return n}},e.prototype.filter=function(t,r,n){n=n||new e;for(var i=0;i<this.length;++i)t.call(r,this.data[i],i,this.data)&&n.push(this.data[i]);return n},e.prototype.forEach=function(e,t){for(var r=0;r<this.length;++r)e.call(t,this.data[r],r,this.data)},e.prototype.map=function(e,t){for(var r=new Array(this.length),n=0;n<this.length;++n)r[n]=e.call(t,this.data[n],n,this.data);return r},e.prototype._grow=function(e){if(this._allocator)for(;this.data.length<e;)this.data.push(this._allocator(this.data.length))},e}()}.apply(null,n))||(e.exports=i)},412:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(338),r(336),r(370),r(361),r(375)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.symbol=null,t.type="simple",t}var a;return r(t,e),a=t,t.prototype.writeSymbolWebScene=function(e,t,r,n){s.writeTarget(e,t,r,n)},t.prototype.writeSymbol=function(e,t,r,n){s.writeTarget(e,t,r,n)},t.prototype.readSymbol=function(e,t,r){return s.read(e,t,r)},t.prototype.getSymbol=function(e,t){return this.symbol},t.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]},t.prototype.clone=function(){return new a({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:i.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},n([o.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([o.property({types:l.rendererTypes})],t.prototype,"symbol",void 0),n([o.writer("web-scene","symbol",{symbol:{types:l.rendererTypes3D}})],t.prototype,"writeSymbolWebScene",null),n([o.writer("symbol")],t.prototype,"writeSymbol",null),n([o.reader("symbol")],t.prototype,"readSymbol",null),n([o.enumeration.serializable()({simple:"simple"})],t.prototype,"type",void 0),a=n([o.subclass("esri.renderers.SimpleRenderer")],t)}(o.declared(a))}.apply(null,n))||(e.exports=i)},414:function(e,t,r){var n,i;n=[r(351),r(338),r(347),r(341),r(343),r(360),r(391),r(371),r(739),r(361),r(375),r(370),r(424),r(643)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y){var f=i.getLogger("esri.renderers.ClassBreaksRenderer");d=d.LegendOptions,y=y.ClassBreakInfo;var h=r({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),m=o.ensureType(y),v=e(c,{declaredClass:"esri.renderers.ClassBreaksRenderer",properties:{backgroundFillSymbol:{types:{base:s,key:"type",typeMap:{"simple-fill":p.types.typeMap["simple-fill"],"picture-fill":p.types.typeMap["picture-fill"],"polygon-3d":p.types.typeMap["polygon-3d"]}},value:null,json:{origins:{"web-scene":{read:u.read,write:{target:{backgroundFillSymbol:{type:l}},writer:u.writeTarget}}},read:u.read,write:u.writeTarget}},classBreakInfos:{type:[y],json:{read:function(e,t,r){if(Array.isArray(e)){var n=t.minValue;return e.map(function(e){var t=new y;return t.read(e,r),null==t.minValue&&(t.minValue=n),null==t.maxValue&&(t.maxValue=t.minValue),n=t.maxValue,t})}},write:function(e,t,r,n){e=e.map(function(e){return e.write({},n)}),this._areClassBreaksConsecutive()&&e.forEach(function(e){delete e.classMinValue}),t[r]=e}}},minValue:{type:Number,readOnly:!0,dependsOn:["classBreakInfos"],get:function(){return this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}},defaultLabel:{type:String,value:null,json:{write:!0}},defaultSymbol:{types:p.rendererTypes,value:null,json:{origins:{"web-scene":{read:u.read,write:{target:{defaultSymbol:{types:p.rendererTypes3D}},writer:u.writeTarget}}},read:u.read,write:u.writeTarget}},valueExpression:{type:String,value:null,json:{write:!0}},valueExpressionTitle:{type:String,value:null,json:{write:!0}},compiledFunc:{dependsOn:["valueExpression"],get:function(){return a.createFunction(this.valueExpression)}},legendOptions:{type:d,value:null,json:{write:!0}},field:{value:null,cast:function(e){return null==e?e:"function"==typeof e?e:o.ensureString(e)},json:{type:String,write:function(e,t,r,i){"string"==typeof e?t[r]=e:i&&i.messages?i.messages.push(new n("property:unsupported","ClassBreaksRenderer.field set to a function cannot be written to JSON")):f.error(".field: cannot write field to JSON since it's not a string value")}}},isMaxInclusive:!0,normalizationField:{type:String,value:null,json:{write:!0}},normalizationTotal:{type:Number,value:null,json:{write:!0}},normalizationType:{type:h.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],get:function(){var e=this._get("normalizationType"),t=!!this.normalizationField,r=null!=this.normalizationTotal;return t||r?(e=t?"field":r&&"percent-of-total",t&&r&&console.warn("warning: both normalizationField and normalizationTotal are set!")):"field"!==e&&"percent-of-total"!==e||(e=null),e},json:{type:h.jsonValues,read:h.read,write:h.write}},requiredFields:{dependsOn:["field","normalizationField","valueExpression"]},type:{type:["class-breaks"],value:"class-breaks",json:{type:["classBreaks"]}}},constructor:function(){this.classBreakInfos=[]},addClassBreakInfo:function(e,r,n){var i;i="number"==typeof e?new y({minValue:e,maxValue:r,symbol:n}):m(t.clone(e)),this.classBreakInfos.push(i),1===this.classBreakInfos.length&&this.notifyChange("minValue")},removeClassBreakInfo:function(e,t){var r,n,i=this.classBreakInfos.length;for(n=0;n<i;n++)if((r=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue])[0]==e&&r[1]==t){this.classBreakInfos.splice(n,1);break}},getBreakIndex:function(e,t){var r,n,i,o=this.field,s=this.classBreakInfos,l=e.attributes,u=s.length,p=this.isMaxInclusive;if(this.valueExpression)r=a.executeFunction(this.compiledFunc,a.createExecContext(e,a.getViewInfo(t)));else if("function"==typeof o)r=o(e);else{r=parseFloat(l[o]);var c,d,y=this.normalizationType;if(y)if(c=parseFloat(this.normalizationTotal),d=parseFloat(l[this.normalizationField]),"log"===y)r=Math.log(r)*Math.LOG10E;else if("percent-of-total"!==y||isNaN(c)){if("field"===y&&!isNaN(d)){if(isNaN(r)||isNaN(d))return-1;r/=d}}else r=r/c*100}if(null!=r&&!isNaN(r)&&"number"==typeof r)for(n=0;n<u;n++)if((i=[s[n].minValue,s[n].maxValue])[0]<=r&&(p?r<=i[1]:r<i[1]))return n;return-1},getClassBreakInfo:function(e,t){var r=this.getBreakIndex(e,t);return-1!==r?this.classBreakInfos[r]:null},getSymbol:function(e,t){var r=this.getBreakIndex(e,t);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol},getSymbols:function(){var e=[];return this.classBreakInfos.forEach(function(t){t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e},clone:function(){return new v({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:t.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:t.clone(this.visualVariables),legendOptions:t.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},collectRequiredFields:function(e){this.inherited(arguments),[this.field,this.normalizationField].forEach(function(t){t&&(e[t]=!0)}),this.valueExpression&&a.extractFieldNames(this.valueExpression).forEach(function(t){e[t]=!0})},_areClassBreaksConsecutive:function(){for(var e=this.classBreakInfos,t=1;t<e.length;t++)if(e[t-1].maxValue!==e[t].minValue)return!1;return!0}});return v}.apply(null,n))||(e.exports=i)},415:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(358),r(338),r(336),r(370),r(644)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(t){var r=e.call(this)||this;return r.blurRadius=10,r.colorStops=[new l.HeatmapColorStop({ratio:0,color:new i("rgba(255, 140, 0, 0)")}),new l.HeatmapColorStop({ratio:.75,color:new i("rgba(255, 140, 0, 1)")}),new l.HeatmapColorStop({ratio:.9,color:new i("rgba(255, 0,   0, 1)")})],r.field=null,r.fieldOffset=0,r.maxPixelIntensity=100,r.minPixelIntensity=0,r.type="heatmap",r}var s;return r(t,e),s=t,t.prototype.clone=function(){return new s({blurRadius:this.blurRadius,colorStops:o.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})},n([a.property({type:Number,json:{write:!0}})],t.prototype,"blurRadius",void 0),n([a.property({type:[l.HeatmapColorStop],json:{write:!0}})],t.prototype,"colorStops",void 0),n([a.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([a.property({type:Number,json:{write:{overridePolicy:function(e,t,r){return{enabled:null==r}}}}})],t.prototype,"fieldOffset",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"maxPixelIntensity",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"minPixelIntensity",void 0),n([a.property({dependsOn:["field"],readOnly:!0})],t.prototype,"requiredFields",void 0),n([a.enumeration.serializable()({heatmap:"heatmap"})],t.prototype,"type",void 0),s=n([a.subclass("esri.renderers.HeatmapRenderer")],t)}(a.declared(s))}.apply(null,n))||(e.exports=i)},416:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(388),r(431),r(379),r(341),r(338),r(343),r(349),r(336),r(360),r(411),r(370),r(621),r(424),r(645),r(391),r(361),r(634),r(375)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h,m,v,b,g,w,S){var _=u.getLogger("esri.renderers.UniqueValueRenderer"),j=d.ensureType(v.default);return function(e){function t(t){var r=e.call(this)||this;return r._valueInfoMap={},r._isDefaultSymbolDerived=!1,r.type="unique-value",r.backgroundFillSymbol=null,r.field=null,r.field2=null,r.field3=null,r.valueExpression=null,r.valueExpressionTitle=null,r.legendOptions=null,r.defaultLabel=null,r.fieldDelimiter=null,r.portal=null,r.styleOrigin=null,r.diff={uniqueValueInfos:function(e,t){if(e||t){if(!e||!t)return{type:"complete",oldValue:e,newValue:t};for(var r=!1,n={type:"collection",added:[],removed:[],changed:[],unchanged:[]},i=0;i<t.length;i++)!function(i){var o=a.find(e,function(e){return e.value===t[i].value});o?h.diff(o,t[i])?(n.changed.push({type:"complete",oldValue:o,newValue:t[i]}),r=!0):(n.unchanged.push({oldValue:o,newValue:t[i]}),r=!0):(n.added.push(t[i]),r=!0)}(i);for(i=0;i<e.length;i++)!function(i){a.find(t,function(t){return t.value===e[i].value})||(n.removed.push(e[i]),r=!0)}(i);return r?n:void 0}}},r._set("uniqueValueInfos",[]),r}var u;return r(t,e),u=t,t.prototype.writeBackgroundFillSymbolWebScene=function(e,t,r,n){g.writeTarget(e,t,r,n)},t.prototype.castField=function(e){return null==e?e:"function"==typeof e?e:d.ensureString(e)},t.prototype.writeField=function(e,t,r,n){"string"==typeof e?t[r]=e:n&&n.messages?n.messages.push(new s("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):_.error(".field: cannot write field to JSON since it's not a string value")},Object.defineProperty(t.prototype,"compiledFunc",{get:function(){return b.createFunction(this.valueExpression)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSymbol",{set:function(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)},enumerable:!0,configurable:!0}),t.prototype.readDefaultSymbol=function(e,t,r){return g.read(e,t,r)},t.prototype.writeDefaultSymbolWebScene=function(e,t,r,n){this._isDefaultSymbolDerived||g.writeTarget(e,t,r,n)},t.prototype.writeDefaultSymbol=function(e,t,r,n){this._isDefaultSymbolDerived||g.writeTarget(e,t,r,n)},t.prototype.readPortal=function(e,t,r){return r.portal||y.getDefault()},t.prototype.readStyleOrigin=function(e,t,r){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){var n=p.read(t.styleUrl,r);return Object.freeze({styleUrl:n})}},t.prototype.writeStyleOrigin=function(e,t,r,n){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=p.write(e.styleUrl,n),p.isAbsolute(t.styleUrl)&&(t.styleUrl=p.normalize(t.styleUrl)))},Object.defineProperty(t.prototype,"uniqueValueInfos",{set:function(e){this.styleOrigin?_.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap())},enumerable:!0,configurable:!0}),t.prototype.addUniqueValueInfo=function(e,t){var r;this.styleOrigin?_.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(r="object"==typeof e?j(e):new v.default({value:e,symbol:t}),this.uniqueValueInfos.push(r),this._valueInfoMap[r.value]=r)},t.prototype.removeUniqueValueInfo=function(e){if(this.styleOrigin)_.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var t=0;t<this.uniqueValueInfos.length;t++)if(this.uniqueValueInfos[t].value===e+""){delete this._valueInfoMap[e],this.uniqueValueInfos.splice(t,1);break}},t.prototype.getUniqueValueInfo=function(e,t){var r,n=this.field,i=e.attributes;if(this.valueExpression)r=b.executeFunction(this.compiledFunc,b.createExecContext(e,b.getViewInfo(t)));else if("function"!=typeof n&&this.field2){var o=this.field2,a=this.field3,s=[];n&&s.push(i[n]),o&&s.push(i[o]),a&&s.push(i[a]),r=s.join(this.fieldDelimiter||"")}else"function"==typeof n?r=n(e):n&&(r=i[n]);return this._valueInfoMap[r+""]},t.prototype.getSymbol=function(e,t){var r=this.getUniqueValueInfo(e,t);return r&&r.symbol||this.defaultSymbol},t.prototype.getSymbols=function(){for(var e=[],t=0,r=this.uniqueValueInfos;t<r.length;t++){var n=r[t];n.symbol&&e.push(n.symbol)}return this.defaultSymbol&&e.push(this.defaultSymbol),e},t.prototype.clone=function(){var e=new u({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:l.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:l.clone(this.visualVariables),legendOptions:l.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:l.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);var t=l.clone(this.uniqueValueInfos);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(l.clone(this.styleOrigin))),Object.freeze(t)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e},t.prototype.collectRequiredFields=function(e){this.inherited(arguments),[this.field,this.field2,this.field3].forEach(function(t){t&&"string"==typeof t&&(e[t]=!0)}),this.valueExpression&&b.extractFieldNames(this.valueExpression).forEach(function(t){e[t]=!0})},t.prototype.populateFromStyle=function(){var e=this;return w.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(t){var r=[];return e._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(function(n){var i=new o.WebStyleSymbol({styleUrl:t.styleUrl,styleName:t.styleName,portal:e.portal,name:n.name});e.defaultSymbol||n.name!==t.data.defaultItem||(e.defaultSymbol=i,e._isDefaultSymbolDerived=!0);var a=new v.default({value:n.name,symbol:i});r.push(a),e._valueInfoMap[n.name]=a}),e._set("uniqueValueInfos",Object.freeze(r)),!e.defaultSymbol&&e.uniqueValueInfos.length&&(e.defaultSymbol=e.uniqueValueInfos[0].symbol,e._isDefaultSymbolDerived=!0),e})},t.prototype._updateValueInfoMap=function(){var e=this;this._valueInfoMap={},this.uniqueValueInfos.forEach(function(t){return e._valueInfoMap[t.value+""]=t})},t.fromPortalStyle=function(e,t){var r=new u(t&&t.properties);r._set("styleOrigin",Object.freeze({styleName:e})),r._set("portal",t&&t.portal||y.getDefault());var n=r.populateFromStyle();return n.catch(function(t){_.error("#fromPortalStyle('"+e+"'[, ...])","Failed to create unique value renderer from style name",t)}),n},t.fromStyleUrl=function(e,t){var r=new u(t&&t.properties);r._set("styleOrigin",Object.freeze({styleUrl:e}));var n=r.populateFromStyle();return n.catch(function(t){_.error("#fromStyleUrl('"+e+"'[, ...])","Failed to create unique value renderer from style URL",t)}),n},n([c.enumeration.serializable()({uniqueValue:"unique-value"})],t.prototype,"type",void 0),n([c.property({types:{base:o.BaseSymbol,key:"type",typeMap:{"simple-fill":S.rendererTypes.typeMap["simple-fill"],"picture-fill":S.rendererTypes.typeMap["picture-fill"],"polygon-3d":S.rendererTypes.typeMap["polygon-3d"]}},json:{read:g.read,write:g.writeTarget}})],t.prototype,"backgroundFillSymbol",void 0),n([c.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:o.PolygonSymbol3D}})],t.prototype,"writeBackgroundFillSymbolWebScene",null),n([c.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],t.prototype,"field",void 0),n([c.cast("field")],t.prototype,"castField",null),n([c.writer("field")],t.prototype,"writeField",null),n([c.property({type:String,json:{write:!0}})],t.prototype,"field2",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"field3",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"valueExpression",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"valueExpressionTitle",void 0),n([c.property({dependsOn:["valueExpression"]})],t.prototype,"compiledFunc",null),n([c.property({type:m.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([c.property({type:String,json:{write:!0}})],t.prototype,"defaultLabel",void 0),n([c.property({types:S.rendererTypes})],t.prototype,"defaultSymbol",null),n([c.reader("defaultSymbol")],t.prototype,"readDefaultSymbol",null),n([c.writer("web-scene","defaultSymbol",{defaultSymbol:{types:S.rendererTypes3D}})],t.prototype,"writeDefaultSymbolWebScene",null),n([c.writer("defaultSymbol")],t.prototype,"writeDefaultSymbol",null),n([c.property({type:String,json:{write:!0}})],t.prototype,"fieldDelimiter",void 0),n([c.property({type:y,readOnly:!0})],t.prototype,"portal",void 0),n([c.reader("portal",["styleName"])],t.prototype,"readPortal",null),n([c.property({readOnly:!0})],t.prototype,"styleOrigin",void 0),n([c.reader("styleOrigin",["styleName","styleUrl"])],t.prototype,"readStyleOrigin",null),n([c.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],t.prototype,"writeStyleOrigin",null),n([c.property({type:[v.default],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],t.prototype,"uniqueValueInfos",null),n([c.property({dependsOn:["field","field2","field3","valueExpression"],readOnly:!0})],t.prototype,"requiredFields",void 0),n([i(1,c.cast(S.ensureType))],t.prototype,"addUniqueValueInfo",null),u=n([c.subclass("esri.renderers.UniqueValueRenderer")],t)}(c.declared(f))}.apply(null,n))||(e.exports=i)},423:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(341),r(405),r(442),r(414),r(415),r(412),r(416)],void 0===(i=function(e,t,r,n,i,o,a,s,l){function u(e,t,r){if(!e)return null;if(e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type)return r&&r.messages&&r.messages.push(new i("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null;var n=function(e){return e&&c[e.type]||null}(e);if(n){var o=new n;return o.read(e,r),o}return r&&r.messages&&e&&r.messages.push(new i("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:r})),null}function p(e,t,n){return e?n&&"web-scene"===n.origin&&"heatmap"===e.type?(n.messages&&n.messages.push(new r("renderer:unsupported","Renderer of type '"+e.declaredClass+"' are not supported in scenes.",{renderer:e,context:n})),null):e.write(t,n):null}Object.defineProperty(t,"__esModule",{value:!0});var c={simple:s,uniqueValue:l,classBreaks:o,heatmap:a};t.read=u,t.writeTarget=function(e,t,r,i){var o=p(e,{},i);o&&n.setDeepValue(r,o,t)},t.write=p,t.fromJSON=function(e,t){return u(e,0,t)}}.apply(null,n))||(e.exports=i)},424:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({title:this.title})},n([o.property({type:String,json:{write:!0}})],t.prototype,"title",void 0),i=n([o.subclass("esri.renderers.support.LegendOptions")],t)}(o.declared(i));t.LegendOptions=a,t.default=a}.apply(null,n))||(e.exports=i)},425:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1}}();t.default=r}.apply(null,n))||(e.exports=i)},426:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(336)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minScale=0,t.maxScale=0,t}return r(t,e),n([o.property({type:Number,json:{write:!0}})],t.prototype,"minScale",void 0),n([o.property({type:Number,json:{write:!0}})],t.prototype,"maxScale",void 0),n([o.subclass("esri.layers.mixins.ScaleRangeLayer")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},427:function(e,t,r){var n,i;n=[r(766),r(340),r(338),r(347),r(692),r(662),r(451),r(646),r(391),r(711),r(361),r(375)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){function d(e){var t=l.createSyntaxTree(e),r=t&&t.body&&t.body[0]&&t.body[0].body&&t.body[0].body.body;if(!r||1!==r.length)return null;var n="ExpressionStatement"===r[0].type&&r[0].expression;if(!n||"MemberExpression"!==n.type)return null;var i=n.object;if(!i||"Identifier"!==i.type||"$feature"!==i.name)return null;var o=n.property;if(!o)return null;switch(o.type){case"Literal":return o.value;case"Identifier":return o.name}return null}function y(e){return!e||"service"!==e.origin&&(!e.layer||!s.isOfType(e.layer,"map-image"))}var f=n({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0}),h=new u,m=t.createSubclass({declaredClass:"esri.layers.support.LabelClass",properties:{name:{type:String,value:null,json:{write:!0}},labelExpression:{type:String,value:null,json:{read:function(e,t,r,n){var i=t.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e},write:{allowNull:!0,writer:function(e,t,r,n){if(this.labelExpressionInfo&&y(n))if(null!=this.labelExpressionInfo.value)e=this._templateStringToSql(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var i=d(this.labelExpressionInfo.expression);i&&(e="["+i+"]")}null!=e&&(t[r]=e)}}}},labelExpressionInfo:{value:null,type:o,json:{write:{overridePolicy:function(e,t,r){return y(r)?{allowNull:!0}:{enabled:!1}},writer:function(e,t,r,n){if(null==e&&null!=this.labelExpression&&y(n))e=new o({expression:this.getLabelExpressionArcade()});else if(!e)return;var i=e.toJSON(n);i.expression&&(t[r]=i)}}}},labelPlacement:{type:f.apiValues,value:null,json:{type:f.jsonValues,read:f.read,write:f.write}},maxScale:{type:Number,value:0,json:{write:function(e,t){(e||this.minScale)&&(t.maxScale=e)}}},minScale:{type:Number,value:0,json:{write:function(e,t){(e||this.maxScale)&&(t.minScale=e)}}},requiredFields:{readOnly:!0,dependsOn:["labelExpression","labelExpressionInfo","where"],get:function(){var e=Object.create(null);return this._collectRequiredFields(e),Object.keys(e)}},symbol:{value:null,types:c.labelTypes,json:{origins:{"web-scene":{read:p.read,write:{target:{symbol:{types:c.labelTypes3D}},writer:p.writeTarget}}},read:p.read,write:p.writeTarget}},useCodedValues:{type:Boolean,value:null,json:{write:!0}},where:{type:String,value:null,json:{write:!0}}},getLabelExpression:function(){var e={expression:"",type:"none"};return this.labelExpressionInfo?this.labelExpressionInfo.value?(e.expression=this.labelExpressionInfo.value,e.type="conventional"):this.labelExpressionInfo.expression&&(e.expression=this.labelExpressionInfo.expression,e.type="arcade"):null!=this.labelExpression&&(e.expression=this._sqlToTemplateString(this.labelExpression),e.type="conventional"),e},getLabelExpressionArcade:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return a.convertTemplatedStringToArcade(e.expression);case"arcade":return e.expression}return null},getOptions:function(e){var t={spatialReference:e},r=this.labelExpressionInfo;if(r){var n=r.expression;n&&!r.value&&(t.hasArcadeExpression=!0,t.compiledArcadeFunc=l.createFunction(n))}return t},getLabelExpressionSingleField:function(){var e=this.getLabelExpression();if(!e)return null;switch(e.type){case"conventional":return function(e){var t=e.match(v);return t&&t[1].trim()||null}(e.expression);case"arcade":return d(e.expression)}return null},clone:function(){return new m({labelExpression:this.labelExpression,labelExpressionInfo:r.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:this.symbol.clone(),where:this.where,useCodedValues:this.useCodedValues})},_collectRequiredFields:function(e){this._collectLabelExpressionRequiredFields(this.getLabelExpression(),e),this._collectWhereRequiredFields(this.where,e)},_sqlToTemplateString:function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")},_templateStringToSql:function(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")},_collectWhereRequiredFields:function(e,t){if(null!=e){var r=e.split(" ");3===r.length&&(t[r[0]]=!0),7===r.length&&(t[r[0]]=!0,t[r[4]]=!0)}},_collectLabelExpressionRequiredFields:function(e,t){if("arcade"===e.type)l.extractFieldNames(e.expression).forEach(function(e){t[e]=!0});else{var r=e.expression.match(/{[^}]*}/g);r&&r.forEach(function(e){t[e.slice(1,-1)]=!0})}}});m.evaluateWhere=function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var n=e.split(" ");if(3===n.length)return r(t[n[0]],n[1],n[2]);if(7===n.length){var i=r(t[n[0]],n[1],n[2]),o=n[3],a=r(t[n[4]],n[5],n[6]);switch(o){case"AND":return i&&a;case"OR":return i||a}}return!1}catch(t){console.log("Error.: can't parse = "+e)}},m.buildLabelText=function(e,t,r,n){var i="";if(n&&n.hasArcadeExpression){if(n.compiledArcadeFunc){h.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:r});var o={vars:{$feature:h},spatialReference:n.spatialReference},a=l.executeFunction(n.compiledArcadeFunc,o);null!=a&&(i=a.toString())}}else{var s=t&&t.attributes||{};i=e.replace(/{[^}]*}/g,function(e){return m.formatField(e.slice(1,-1),e,s,r,n)})}return i},m.formatField=function(t,n,o,a,s){var l,u,p=n,c=t.toLowerCase();for(l=0;l<a.length;l++)if(a[l].name.toLowerCase()===c){p=o[a[l].name];var d=a[l].domain;if(d&&"object"==typeof d){if("codedValue"==d.type)for(u=0;u<d.codedValues.length;u++)d.codedValues[u].code==p&&(p=d.codedValues[u].name);else"range"==d.type&&d.minValue<=p&&p<=d.maxValue&&(p=d.name);return null==p?"":p}var y=a[l].type;if("date"==y){var f=e.fromJSON(s&&s.dateFormat||"shortDate"),h="DateFormat"+e.getFormat(f);h&&(p=r.substitute({myKey:p},"{myKey:"+h+"}"))}else"integer"!=y&&"small-integer"!=y&&"long"!=y&&"double"!=y||s&&s.numberFormat&&s.numberFormat.digitSeparator&&s.numberFormat.places&&(p=i.format(p,{places:s.numberFormat.places}))}return null==p?"":p};var v=/^\s*\{([^}]+)\}\s*$/i;return m}.apply(null,n))||(e.exports=i)},429:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(461),r(406),r(619)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.screenSizePerspectiveEnabled={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader:function(e,t){return null==t.screenSizePerspective&&"defaults"===this.originOf("screenSizePerspectiveEnabled")?void n.getProperties(this).store.set("screenSizePerspectiveEnabled",!1,r.OriginId.DEFAULTS):t.screenSizePerspective}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer:function(e,t,r,n){"defaults"===this.originOf("screenSizePerspectiveEnabled")&&e?t[r]=e:i.willPropertyWrite(this,"screenSizePerspectiveEnabled",{},n)&&(t[r]=e)}}}}}},t.popupEnabled={type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",writer:function(e,t,r){t[r]=!e}}}},t.labelsVisible={type:Boolean,json:{read:{source:"showLabels"},write:{target:"showLabels"}}}}.apply(null,n))||(e.exports=i)},436:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(343),r(428),r(336),r(394)],void 0===(i=function(e,t,r,n,i,o,a,s){var l=i.getLogger("esri.layers.mixins.ArcGISService");return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"title",{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=s.parse(this.url);if(e&&e.title)return e.title}return this._get("title")||""},set:function(e){this._set("title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{set:function(e){this._set("url",s.sanitizeUrl(e,l))},enumerable:!0,configurable:!0}),n([a.property({dependsOn:["url"]})],t.prototype,"title",null),n([a.property({type:String})],t.prototype,"url",null),n([a.subclass("esri.layers.mixins.ArcGISService")],t)}(a.declared(o))}.apply(null,n))||(e.exports=i)},437:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(607)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r)}.apply(null,n))||(e.exports=i)},438:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(336)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshInterval=0,t}return r(t,e),t.prototype.refresh=function(){this.emit("refresh")},n([o.property({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0}})],t.prototype,"refreshInterval",void 0),n([o.subclass("esri.layers.mixins.RefreshableLayer")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},440:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(338),r(336)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.definitionExpression=null,r.globalIds=null,r.num=null,r.objectIds=null,r.size=null,r.start=null,r}var i;return r(t,e),i=t,t.prototype.writeStart=function(e,t,r){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new i(o.clone({attachmentTypes:this.attachmentTypes,definitionExpression:this.definitionExpression,globalIds:this.globalIds,num:this.num,objectIds:this.objectIds,size:this.size,start:this.start}))},n([a.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),n([a.property({type:String,json:{write:!0}})],t.prototype,"definitionExpression",void 0),n([a.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),n([a.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),n([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),n([a.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),n([a.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),n([a.writer("start"),a.writer("num")],t.prototype,"writeStart",null),i=n([a.subclass("esri.tasks.support.AttachmentQuery")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},444:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(364),r(340),r(338),r(336)],void 0===(i=function(e,t,r,n,i,o,a,s){return function(e){function t(t){var r=e.call(this,t)||this;return r.definitionExpression=null,r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r}var o;return r(t,e),o=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new o(a.clone({definitionExpression:this.definitionExpression,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source}))},n([s.property({type:String,json:{write:!0}})],t.prototype,"definitionExpression",void 0),n([s.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),n([s.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),n([s.property({type:Date})],t.prototype,"historicMoment",void 0),n([s.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),n([s.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),n([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),n([s.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),n([s.property({type:i.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),n([s.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),n([s.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),n([s.property({json:{write:!0}})],t.prototype,"source",void 0),o=n([s.subclass("esri.tasks.support.RelationshipQuery")],t)}(s.declared(o))}.apply(null,n))||(e.exports=i)},446:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(339)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.when=function e(t,n){return Array.isArray(n)?r.create(function(e){t(n,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(t)})}):e(t,[n]).then(function(e){return e[0]})},t.getAbsMid=function(e,t,r){return t.toAbsMid?t.toAbsMid(e):r.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,n))||(e.exports=i)},447:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(587),r(405),r(399)],void 0===(i=function(e,t,r,n,i){function o(e,t,r){if(e)for(var i=0,o=e;i<o.length;i++){var s=o[i],l=n.getDeepValue(s,t),u=l&&"function"!=typeof l&&a(l,r);u&&n.setDeepValue(s,u.name,t)}}function a(e,t){if("string"!=typeof e)return null;if(null!=t){e=e.toLowerCase();for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i&&i.name.toLowerCase()===e)return i}}return null}function s(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function l(e){return null===e||s(e)}function u(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function p(e){return null===e||u(e)}function c(e){return null!=e&&"string"==typeof e}function d(e){return null===e||c(e)}function y(e){return!0}function f(e,t){var r;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":r=e.nullable?p:u;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=e.nullable?l:s;break;case"string":case"esriFieldTypeString":r=e.nullable?d:c;break;default:r=y}return 1===arguments.length?r:r(t)}function h(e){return null!=e&&S.has(e.type)}function m(e,t){return e.nullable&&null===t?null:h(e)&&!v(e.type,t)?g.OUT_OF_RANGE:f(e,t)?e.domain?i.validateDomainValue(e.domain,t):null:w.INVALID_TYPE}function v(e,t){var r=b(e);return!!r&&t>=r.min&&t<=r.max}function b(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return{min:-32768,max:32767};case"esriFieldTypeInteger":case"integer":return{min:-2147483648,max:2147483647};case"esriFieldTypeSingle":case"single":return{min:-3.4e38,max:1.2e38};case"esriFieldTypeDouble":case"double":var t=Number.MAX_VALUE;return{min:-Number.MAX_VALUE,max:t}}}Object.defineProperty(t,"__esModule",{value:!0}),t.fixRendererFields=function(e,r){if(null!=e&&null!=r)for(var n=0,i=Array.isArray(e)?e:[e];n<i.length;n++){var a=i[n];if(o(t.rendererFields,a,r),a.visualVariables)for(var s=0,l=a.visualVariables;s<l.length;s++){var u=l[s];o(t.visualVariableFields,u,r)}}},t.getField=a,t.getFieldDefaultValue=function(e){var t=e.defaultValue;return void 0!==t&&f(e,t)?t:e.nullable?null:void 0},t.isValueMatchingFieldType=f,t.rendererFields=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],t.visualVariableFields=["field","normalizationField"],t.numericTypes=["integer","small-integer","single","double"];var g,w,S=new r.default(t.numericTypes.concat(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));t.isNumericField=h,t.isStringField=function(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)},t.isDateField=function(e){return null!=e&&("date"===e.type||"esriFieldTypeDate"===e.type)},t.isValidFieldValue=function(e,t){return null===m(e,t)},(g=t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",(w=t.TypeValidationError||(t.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type",t.validateFieldValue=m,t.isNumberInRange=v,t.getFieldRange=function(e){var t=i.getDomainRange(e.domain);return t||(h(e)?b(e.type):void 0)},t.validationErrorToString=function(e,t,r){switch(e){case i.DomainValidationError.INVALID_CODED_VALUE:return"Value "+r+" is not in the coded domain - field: "+t.name+", domain: "+JSON.stringify(t.domain);case i.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+r+" is out of the range of valid values - field: "+t.name+", domain: "+JSON.stringify(t.domain);case w.INVALID_TYPE:return"Value "+r+" is not a valid value for the field type - field: "+t.name+", type: "+t.type+", nullable: "+t.nullable;case g.OUT_OF_RANGE:var n=b(t.type),o=n.min,a=n.max;return"Value "+r+" is out of range for the number type - field: "+t.name+", type: "+t.type+", value range is "+o+" to "+a}}}.apply(null,n))||(e.exports=i)},451:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(663)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n="__begin__",i="__end__",o=new RegExp(n,"ig"),a=new RegExp(i,"ig"),s=new RegExp("^"+n,"i"),l=new RegExp(i+"$","i"),u='"',p=u+" + ",c=" + "+u;t.convertTemplatedStringToArcade=function(e){var t;return e?(t=r.replace(e,function(e,t){return n+'$feature["'+t+'"]'+i}),t=s.test(t)?t.replace(s,""):u+t,t=(t=l.test(t)?t.replace(l,""):t+u).replace(o,p).replace(a,c)):t='""',t}}.apply(null,n))||(e.exports=i)},452:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(364),r(340),r(347),r(336),r(360),r(367),r(443),r(409),r(386),r(638)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f){var h=s({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc"});return function(e){function t(t){var r=e.call(this)||this;return r.dpi=96,r.format=null,r.origin=null,r.minScale=0,r.maxScale=0,r.size=null,r.spatialReference=null,r}var a;return n(t,e),a=t,t.create=function(e){void 0===e&&(e={size:256,spatialReference:o.SpatialReference.WebMercator});var t=e.resolutionFactor||1,r=e.scales,n=e.size||256,i=e.spatialReference||o.SpatialReference.WebMercator,s=d.getInfo(i),l=s?new o.Point(s.origin[0],s.origin[1],i):new o.Point(0,0,i),u=1/(39.37*c.getMetersPerUnitForSR(i)*96),p=[];if(r)for(var y=0;y<r.length;y++){var f=(v=r[y])*u;p.push({level:y,scale:v,resolution:f})}else{var h=d.isGeographic(i)?512/n*147748799.285417:256/n*591657527.591555,m=Math.ceil(24/t);p.push({level:0,scale:h,resolution:h*u});for(y=1;y<m;y++){var v;f=(v=h/Math.pow(2,t))*u;p.push({level:y,scale:v,resolution:f}),h=v}}return new a({dpi:96,lods:p,origin:l,size:n,spatialReference:i})},Object.defineProperty(t.prototype,"isWrappable",{get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var r=d.getInfo(e);return e.isWrappable&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1},enumerable:!0,configurable:!0}),t.prototype.readOrigin=function(e,t){return o.Point.fromJSON(r({spatialReference:t.spatialReference},e))},Object.defineProperty(t.prototype,"lods",{set:function(e){var t=this,r=0,n=0,i=[];this._levelToLOD={},e&&(r=-1/0,n=1/0,e.forEach(function(e){i.push(e.scale),r=e.scale>r?e.scale:r,n=e.scale<n?e.scale:n,t._levelToLOD[e.level]=e})),this._set("scales",i),this._set("minScale",r),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()},enumerable:!0,configurable:!0}),t.prototype.readSize=function(e,t){return[t.cols,t.rows]},t.prototype.writeSize=function(e,t){t.cols=e[0],t.rows=e[0]},t.prototype.zoomToScale=function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];var r=Math.round(e-.5),n=Math.round(e);return t[n]+(n-e)*(t[r]-t[n])},t.prototype.scaleToZoom=function(e){for(var t=this.scales,r=t.length-1,n=0;n<r;n++){var i=t[n],o=t[n+1];if(i<=e)return n;if(o===e)return n+1;if(i>e&&o<e)return n+1-(e-o)/(i-o)}return n},t.prototype.snapScale=function(e,t){void 0===t&&(t=.95);var r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))},t.prototype.tileAt=function(e,t,r,n){var i,o,a=this.lodAt(e);if(!a)return null;if("number"==typeof t)i=t,o=r;else if(d.equals(t.spatialReference,this.spatialReference))i=t.x,o=t.y,n=r;else{var s=y.project(t,this.spatialReference);if(!s)return null;i=s.x,o=s.y,n=r}var l=a.resolution*this.size[0],u=a.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:p.create()}),n.level=e,n.row=Math.floor((this.origin.y-o)/u+.001),n.col=Math.floor((i-this.origin.x)/l+.001),this.updateTileInfo(n),n},t.prototype.updateTileInfo=function(e){var t=this.lodAt(e.level);if(t){var r=t.resolution*this.size[0],n=t.resolution*this.size[1];e.id=e.level+"/"+e.row+"/"+e.col,e.extent||(e.extent=p.create()),e.extent[0]=this.origin.x+e.col*r,e.extent[1]=this.origin.y-(e.row+1)*n,e.extent[2]=e.extent[0]+r,e.extent[3]=e.extent[1]+n}},t.prototype.upsampleTile=function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))},t.prototype.getTileBounds=function(e,t){var r=this.lodAt(t.level).resolution,n=r*this.size[0],i=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+n,e[3]=e[1]+i,e},t.prototype.lodAt=function(e){return this._levelToLOD&&this._levelToLOD[e]||null},t.prototype.clone=function(){return a.fromJSON(this.write({}))},t.prototype._initializeUpsampleLevels=function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,r=0;r<e.length;r++){var n=e[r];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}},i([l.property({type:Number,json:{write:!0}})],t.prototype,"compressionQuality",void 0),i([l.property({type:Number,json:{write:!0}})],t.prototype,"dpi",void 0),i([l.property({type:String,json:{read:h.read,write:h.write}})],t.prototype,"format",void 0),i([l.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],t.prototype,"isWrappable",null),i([l.property({type:o.Point,json:{write:!0}})],t.prototype,"origin",void 0),i([l.reader("origin")],t.prototype,"readOrigin",null),i([l.property({type:[f],value:null,json:{write:!0}})],t.prototype,"lods",null),i([l.property({readOnly:!0})],t.prototype,"minScale",void 0),i([l.property({readOnly:!0})],t.prototype,"maxScale",void 0),i([l.property({readOnly:!0})],t.prototype,"scales",void 0),i([l.property({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],t.prototype,"size",void 0),i([l.reader("size",["rows","cols"])],t.prototype,"readSize",null),i([l.writer("size",{cols:{type:u.Integer},rows:{type:u.Integer}})],t.prototype,"writeSize",null),i([l.property({type:o.SpatialReference,json:{write:!0}})],t.prototype,"spatialReference",void 0),a=i([l.subclass("esri.layers.support.TileInfo")],t)}(l.declared(a))}.apply(null,n))||(e.exports=i)},455:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=null,t}return r(t,e),n([o.property({type:String,readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),n([o.subclass("esri.layers.support.FeatureReduction")],t)}(o.declared(i));t.FeatureReduction=a,t.default=a}.apply(null,n))||(e.exports=i)},457:function(e,t,r){var n,i;n=[r(371),r(402)],void 0===(i=function(e,t){return e.createSubclass({declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:t,json:{read:{default:null},write:!0}},type:null}})}.apply(null,n))||(e.exports=i)},458:function(e,t,r){var n,i;n=[r(351),r(354),r(371)],void 0===(i=function(e,t,r){return e(r,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(e){return e&&-1*e},write:function(e,t){t.angle=e&&-1*e}}},type:{},xoffset:{value:0,cast:t.toPt,json:{write:!0}},yoffset:{value:0,cast:t.toPt,json:{write:!0}},size:{value:9,cast:function(e){return"auto"===e?e:t.toPt(e)},json:{write:!0}}}})}.apply(null,n))||(e.exports=i)},459:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(347),r(338)],void 0===(i=function(e,t,r,n){function i(e){return null!=e&&e.hasOwnProperty("mapLayerId")}function o(e){return null!=e&&e.hasOwnProperty("dataSource")}function a(e){return e?(i(e)&&(e.type=t.MAPLAYER),o(e)&&(e.type=t.DATALAYER,e.dataSource.type||function(e){e.workspaceId?e.gdbVersion?e.type="table":e.query||e.oidFields?e.type="query-table":e.type="raster":e.leftTableKey&&e.rightTableKey&&e.leftTableSource&&e.rightTableSource&&(e.type="join-table",e.leftTableSource=a(e.leftTableSource),e.rightTableSource=a(e.rightTableSource))}(e.dataSource)),e):e}function s(e){var r={};return e.type===t.MAPLAYER?(r.mapLayerId=e.mapLayerId,e.gdbVersion&&(r.gdbVersion=e.gdbVersion)):e.type===t.DATALAYER&&(e.fields&&(r.fields=e.fields),r.dataSource=function(e){var t;switch(e.type){case"table":t={dataSourceName:e.dataSourceName,workspaceId:e.workspaceId,gdbVersion:e.gdbVersion};break;case"query-table":t={geometryType:u.toJSON(e.geometryType),workspaceId:e.workspaceId,query:e.query,oidFields:e.oidFields,spatialReference:e.spatialReference};break;case"join-table":t={leftTableSource:s(e.leftTableSource),rightTableSource:s(e.rightTableSource),leftTableKey:e.leftTableKey,rightTableKey:e.rightTableKey,joinType:d.toJSON(e.joinType)};break;case"raster":t={workspaceId:e.workspaceId,dataSourceName:e.dataSourceName}}return t.type=c.toJSON(e.type),n.fixJson(t)}(e.dataSource)),r.type=p.toJSON(e.type),n.fixJson(r)}function l(e){var r={};return p.fromJSON(e.type)===t.MAPLAYER?(r.mapLayerId=e.mapLayerId,e.gdbVersion&&(r.gdbVersion=e.gdbVersion)):p.fromJSON(e.type)===t.DATALAYER&&(e.fields&&(r.fields=e.fields),r.dataSource=function(e){var t;switch(e.type){case"table":t={dataSourceName:e.dataSourceName,workspaceId:e.workspaceId,gdbVersion:e.gdbVersion};break;case"queryTable":t={geometryType:u.fromJSON(e.geometryType),workspaceId:e.workspaceId,query:e.query,oidFields:e.oidFields,spatialReference:e.spatialReference};break;case"joinTable":t={leftTableSource:l(e.leftTableSource),rightTableSource:l(e.rightTableSource),leftTableKey:e.leftTableKey,rightTableKey:e.rightTableKey,joinType:d.fromJSON(e.joinType)};break;case"raster":t={workspaceId:e.workspaceId,dataSourceName:e.dataSourceName}}return t.type=c.fromJSON(e.type),n.fixJson(t)}(e.dataSource)),r.type=p.fromJSON(e.type),n.fixJson(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.MAPLAYER="map-layer",t.DATALAYER="data-layer";var u=r({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),p=r({mapLayer:t.MAPLAYER,dataLayer:t.DATALAYER}),c=r({joinTable:"join-table",queryTable:"query-table"}),d=r({esriLeftOuterJoin:"left-outer-join",esriLeftInnerJoin:"left-inner-join"});t.isMapLayerSource=i,t.isDataLayerSource=o,t.castSource=a,t.sourceToJSON=s,t.sourceFromJSON=l}.apply(null,n))||(e.exports=i)},586:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(349)],void 0===(i=function(e,t,r){function n(e,t,n){return t.imageData?r.makeData({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):i(t.url,n)}function i(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!r.isAbsolute(e)&&t.layer.parsedUrl?r.join(t.layer.parsedUrl.path,"images",e):r.read(e,t)}function o(e,t,n,i){if(r.isDataProtocol(e)){var o=r.dataComponents(e);t.contentType=o.mediaType,t.imageData=o.data,n&&n.imageData===t.imageData&&n.url&&(t.url=a(n.url,i))}else t.url=a(e,i)}function a(e,t){return r.write(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.readImageDataOrUrl=n,t.read=i,t.writeImageDataAndUrl=o,t.write=a,t.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:n},write:{writer:function(e,t,r,n){o(e,t,this.source,n)}}}},t.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(e,t,r){var n={};return t.imageData&&(n.imageData=t.imageData),t.contentType&&(n.contentType=t.contentType),t.url&&(n.url=i(t.url,r)),n}}}}}.apply(null,n))||(e.exports=i)},587:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(653),o=r(450),a=r(654),s=r(614);r(660),t.Set=o.default.Set,s.default("es6-set")||(t.Set=((n=function(){function e(e){if(this._setData=[],this[Symbol.toStringTag]="Set",e)if(a.isArrayLike(e))for(var t=0;t<e.length;t++)this.add(e[t]);else try{for(var r=i.__values(e),n=r.next();!n.done;n=r.next()){var o=n.value;this.add(o)}}catch(e){s={error:e}}finally{try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(s)throw s.error}}var s,l}return e.prototype.add=function(e){return this.has(e)?this:(this._setData.push(e),this)},e.prototype.clear=function(){this._setData.length=0},e.prototype.delete=function(e){var t=this._setData.indexOf(e);return-1!==t&&(this._setData.splice(t,1),!0)},e.prototype.entries=function(){return new a.ShimIterator(this._setData.map(function(e){return[e,e]}))},e.prototype.forEach=function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()},e.prototype.has=function(e){return this._setData.indexOf(e)>-1},e.prototype.keys=function(){return new a.ShimIterator(this._setData)},Object.defineProperty(e.prototype,"size",{get:function(){return this._setData.length},enumerable:!0,configurable:!0}),e.prototype.values=function(){return new a.ShimIterator(this._setData)},e.prototype[Symbol.iterator]=function(){return new a.ShimIterator(this._setData)},e}())[Symbol.species]=n,n)),t.default=t.Set},588:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(338),r(336)],void 0===(i=function(e,t,r,n,i,o,a,s){var l=o({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return r(t,e),t.prototype.writeDrawingTool=function(e,t){t.drawingTool=l.toJSON(e)},t.prototype.writePrototype=function(e,t){t.prototype=a.fixJson(a.clone(e),!0)},t.prototype.writeThumbnail=function(e,t){t.thumbnail=a.fixJson(a.clone(e))},n([s.property({json:{write:!0}})],t.prototype,"name",void 0),n([s.property({json:{write:!0}})],t.prototype,"description",void 0),n([s.property({json:{read:l.read,write:l.write}})],t.prototype,"drawingTool",void 0),n([s.writer("drawingTool")],t.prototype,"writeDrawingTool",null),n([s.property({json:{write:!0}})],t.prototype,"prototype",void 0),n([s.writer("prototype")],t.prototype,"writePrototype",null),n([s.property({json:{write:!0}})],t.prototype,"thumbnail",void 0),n([s.writer("thumbnail")],t.prototype,"writeThumbnail",null),n([s.subclass("esri.layers.support.FeatureTemplate")],t)}(s.declared(i))}.apply(null,n))||(e.exports=i)},592:function(e,t,r){var n,i;n=[r(351),r(354),r(371)],void 0===(i=function(e,t,r){return e(r,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line",width:{value:.75,cast:t.toPt,json:{write:!0}}}})}.apply(null,n))||(e.exports=i)},593:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t,r,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=r||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.getMessage=function(){var t=this._getLength(),r=this._pos,n=new e(this._data,this._dataView,r,r+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){var n="",i="";r=Math.min(this._end,r);for(var o=t;o<r;++o){var a=e[o];128&a?i+="%"+a.toString(16):(n+=decodeURIComponent(i)+String.fromCharCode(a),i="")}return i.length&&(n+=decodeURIComponent(i)),n},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e}()}.apply(null,n))||(e.exports=i)},595:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.lengths=e,this.coords=t}}();t.default=r}.apply(null,n))||(e.exports=i)},597:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(338),r(336),r(374)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.codedValues=null,r.type="coded-value",r}var a;return r(t,e),a=t,t.prototype.writeCodedValues=function(e,t){var r=null;e&&(r=e.map(function(e){return i.fixJson(i.clone(e))})),t.codedValues=r},t.prototype.getName=function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some(function(e){return String(e.code)===r&&(t=e.name),!!t})}return t},t.prototype.clone=function(){return new a({codedValues:i.clone(this.codedValues),name:this.name})},n([o.property({json:{write:!0}})],t.prototype,"codedValues",void 0),n([o.writer("codedValues")],t.prototype,"writeCodedValues",null),n([o.enumeration.serializable()({codedValue:"coded-value"})],t.prototype,"type",void 0),a=n([o.subclass("esri.layers.support.CodedValueDomain")],t)}(o.declared(a))}.apply(null,n))||(e.exports=i)},598:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(374)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(t){var r=e.call(this,t)||this;return r.type="inherited",r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o},n([i.enumeration.serializable()({inherited:"inherited"})],t.prototype,"type",void 0),o=n([i.subclass("esri.layers.support.InheritedDomain")],t)}(i.declared(o))}.apply(null,n))||(e.exports=i)},599:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(374)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(t){var r=e.call(this,t)||this;return r.maxValue=null,r.minValue=null,r.type="range",r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({maxValue:this.maxValue,minValue:this.minValue,name:this.name})},n([i.property({json:{read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{target:"range",writer:function(e,t,r){t[r]=[this.minValue,e]}}}})],t.prototype,"maxValue",void 0),n([i.property({json:{read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue]}}}})],t.prototype,"minValue",void 0),n([i.enumeration.serializable()({range:"range"})],t.prototype,"type",void 0),o=n([i.subclass("esri.layers.support.RangeDomain")],t)}(i.declared(o))}.apply(null,n))||(e.exports=i)},600:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(347)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.kebabDict=r({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})}.apply(null,n))||(e.exports=i)},603:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t,r,n){void 0===e&&(e=null),void 0===t&&(t={}),this.geometry=e,this.attributes=t,r&&(this.centroid=r),null!=n&&(this.objectId=n)}}();t.default=r}.apply(null,n))||(e.exports=i)},607:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(381),r(435),r(343),r(339),r(608),r(389),r(609)],void 0===(i=function(e,t,n,i,o,a,s,l,u){function p(){if(v)return v;for(var e=d+y,t=[],r=0;r<e;r++)!function(e){var r=u.create(e).then(function(t){return m[e]=t,t});t.push(r)}(r);return v=i(t).then(function(){})}Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=s,t.RemoteClient=l;var c=n("host-browser")?navigator.hardwareConcurrency:0;c||(c=n("safari")&&n("mac")||n("trident")?8:2);var d=n("esri-workers-debug")?1:Math.max(1,Math.ceil(c/2)),y=n("esri-workers-debug")?1:Math.max(1,Math.floor(c/2)),f=o.getLogger("esri.core.workers"),h=0,m=[];t.initialize=function(){p()},t.open=function(n,i,o){if(void 0===i&&(i={}),Array.isArray(n))return new t.Connection(n.map(function(e){return new t.RemoteClient(e,i.client)}));if("string"!=typeof n){f.warn("workers-open:signature-deprecated","DEPRECATED: workers.open() changed signature.");var s=n;n=i,i={client:s,strategy:o?"dedicated":"distributed"}}var l=i.strategy||"distributed";return"local"===l?a.create(function(i){Promise.resolve().then(function(){var r=[e(n,null,!1)];(function(e){i(t.RemoteClient.connect(e))}).apply(null,r)}).catch(r.oe)}).then(function(e){return new t.Connection([new t.RemoteClient(e,i.client)])}):p().then(function(){if("dedicated"===l){var e=d+h++;return h%=y,m[e].open(n).then(function(e){return new t.Connection([new t.RemoteClient(e,i.client)])})}return a.all(m.map(function(e){return e.open(n)})).then(function(e){return new t.Connection(e.map(function(e){return new t.RemoteClient(e,i.client)}))})})},t.terminate=function(){v&&(v.cancel(),v=null);for(var e=0;e<m.length;e++)m[e]&&m[e].terminate();m.length=0};var v=null}.apply(null,n))||(e.exports=i)},608:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(339)],void 0===(i=function(e,t,r){return function(){function e(e){this._clientIdx=0,this._clients=e}return e.prototype.broadcast=function(e,t){for(var r=[],n=0,i=this._clients;n<i.length;n++){var o=i[n];r.push(o.invoke(e,t))}return r},e.prototype.close=function(){for(var e=0,t=this._clients;e<t.length;e++)t[e].close();this._clients=[]},e.prototype.invoke=function(e,t,n,i){var o=i&&i.client;if(!this._clients||!this._clients.length)return r.reject(new Error("Connection closed"));null!=o&&-1!==this._clients.indexOf(o)||this._clients.some(function(e){return!e.isBusy()&&(o=e,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,o=this._clients[this._clientIdx]);var a=o.invoke(e,t,n);return i&&(i.client=o),a},e.prototype.openPorts=function(){return r.all(this._clients.map(function(e){return e.openPort()}))},e}()}.apply(null,n))||(e.exports=i)},609:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(620),r(341),r(343),r(339),r(378),r(610)],void 0===(i=function(e,t,r,n,i,o,a,s){function l(e,t){e.delete(t)}var u=i.getLogger("esri.core.workers"),p=a.MessageType.CANCEL,c=a.MessageType.INVOKE,d=a.MessageType.OPEN,y=a.MessageType.OPENED,f=a.MessageType.RESPONSE;return function(){function e(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",function(e){e.preventDefault(),u.error(e)})}return e.create=function(t){return s.createWorker().then(function(r){return new e(r,t)})},e.prototype.terminate=function(){this.worker.terminate()},e.prototype.open=function(e){var t=this,r=a.newJobId(),n=function(){l(t._outJobs,r),t._post({type:p,jobId:r})};return o.create(function(i,o){var a={resolve:i,reject:o,cancel:n};t._outJobs.set(r,a),t._post({type:d,jobId:r,modulePath:e})},n)},e.prototype._onMessage=function(e){var t=a.receiveMessage(e);if(t)switch(t.type){case y:case f:this._onResponse(t);break;case p:this._onCancel(t);break;case c:this._onInvoke(t)}},e.prototype._onCancel=function(e){var t=this._inJobs.get(e.jobId);t&&t.cancel()},e.prototype._onInvoke=function(e){var t,n=this,i=e.methodName,s=e.jobId,u=e.data,p=this._inJobs,c=r.workerMessages[i];try{if("function"!=typeof c)throw new TypeError(i+" is not a function");t=c.call(null,u)}catch(e){return void this._post({type:f,jobId:s,error:a.toInvokeError(e)})}o.isThenable(t)?(p.set(s,t),t.then(function(e){l(p,s),n._post({type:f,jobId:s},e)}).catch(function(e){l(p,s),e||(e={message:"Error encountered at method"+i}),e.dojoType&&"cancel"===e.dojoType||n._post({type:f,jobId:s,error:a.toInvokeError(e)})})):this._post({type:f,jobId:s},t)},e.prototype._onResponse=function(e){var t=e.jobId,r=e.error,i=e.data,o=this._outJobs.get(t);o&&(l(this._outJobs,t),r?o.reject(n.fromJSON(JSON.parse(r))):o.resolve(i))},e.prototype._post=function(e,t,r){return a.postMessage(this.worker,e,t,r)},e}()}.apply(null,n))||(e.exports=i)},610:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(356),r(124),r(350),r(353),r(343),r(339),r(349),r(611),r(378),r(612)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d){function y(e){return l.create(function(t){function r(i){var o=c.receiveMessage(i);if(o)switch(o.type){case S:f(e);break;case g:e.removeEventListener("message",r),e.removeEventListener("error",n),t(e)}}function n(t){t.preventDefault(),e.removeEventListener("message",r),e.removeEventListener("error",n),v.warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new d).addEventListener("message",r),e.addEventListener("error",n)}e.addEventListener("message",r),e.addEventListener("error",n)})}function f(e){var t,o=i.workers.loaderUrl||p.DEFAULT_LOADER_URL;if(null!=i.default){var s=r({},i);delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(i));var l=i.workers.loaderConfig,u=p.default({baseUrl:l.baseUrl,locale:n.locale,has:r({"config-deferredInstrumentation":0,"dojo-test-sniff":0,"esri-secure-context":a("esri-secure-context"),"esri-workers-arraybuffer-transfer":a("esri-workers-arraybuffer-transfer"),"events-keypress-typed":0,"host-webworker":1},l.has),map:r({},l.map),paths:r({},l.paths),packages:l.packages||[]});e.postMessage({type:w,configure:{esriConfig:t,loaderUrl:o,loaderConfig:u}})}Object.defineProperty(t,"__esModule",{value:!0});var h=u.normalize(e.toUrl("./worker.js")),m=!u.hasSameOrigin(h,location.href),v=s.getLogger("esri.core.workers"),b=null;a.add("esri-workers-arraybuffer-transfer",!a("safari")||a("safari")>=12);var g=c.MessageType.CONFIGURED,w=c.MessageType.CONFIGURE,S=c.MessageType.HANDSHAKE;t.createWorker=function(){if(!a("esri-workers"))return y(new d);if(!m){var e=void 0;try{e=new Worker(h)}catch(t){v.warn("Failed to create Worker. Fallback to execute module in main thread",event),e=new d}return y(e)}return b||(b=o(h,{responseType:"text"})),b.then(function(e){return new Worker(URL.createObjectURL(new Blob([e.data],{type:"text/javascript"})))}).catch(function(e){return v.warn("Failed to create Worker. Fallback to execute module in main thread",e),new d}).then(function(e){return y(e)})}}.apply(null,n))||(e.exports=i)},611:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(355),r(349)],void 0===(i=function(e,t,r,n,i){function o(t){return i.removeQueryParameters(e.toUrl(t))}function a(e,t){for(var n=0,a=e;n<a.length;n++)if(a[n].name===t.name)return;var s=r({},t),l=o(s.name+"/x.js"),u=l.slice(0,l.length-5);s.location=i.makeAbsolute(u),e.push(s)}Object.defineProperty(t,"__esModule",{value:!0});var s=n("esri-built")?"dojo/dojo-lite.js":"dojo/dojo.js";t.DEFAULT_LOADER_URL=i.makeAbsolute(o(s)),t.DEFAULT_CONFIG={baseUrl:function(){var e=o("dojo/x.js");return i.makeAbsolute(e.slice(0,e.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette",main:"dist/maquette.umd"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}},t.default=function(e){var n={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:r({},e.has),map:r({},e.map),packages:e.packages&&e.packages.concat()||[],paths:r({},e.paths)};e.hasOwnProperty("async")||(n.async=!0),e.hasOwnProperty("isDebug")||(n.isDebug=!1),e.baseUrl||(n.baseUrl=t.DEFAULT_CONFIG.baseUrl),t.DEFAULT_CONFIG.packages.forEach(function(e){a(n.packages,e)});for(var i=n.map=n.map||{},o=0,s=Object.keys(t.DEFAULT_CONFIG.map);o<s.length;o++){var l=s[o];i[l]||(i[l]=t.DEFAULT_CONFIG.map[l])}return n}}.apply(null,n))||(e.exports=i)},612:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(355),r(453),r(378)],void 0===(i=function(e,t,n,i,o){var a=function(){return function(){var e=this,t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(r){e[r]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t[r].apply(t,e)}})}}(),s=i.MutationObserver||i.WebKitMutationObserver,l=function(){var e;if(i.process&&i.process.nextTick)e=function(e){i.process.nextTick(e)};else if(i.Promise)e=function(e){i.Promise.resolve().then(e)};else if(s){var t=[],r=document.createElement("div");new s(function(){for(;t.length>0;)t.shift()()}).observe(r,{attributes:!0}),e=function(e){t.push(e),r.setAttribute("queueStatus","1")}}return e}();return function(){function t(){this._dispatcher=new a,this._isInitialized=!1,this._workerPostMessage({type:o.MessageType.HANDSHAKE})}return t.prototype.terminate=function(){},Object.defineProperty(t.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)},enumerable:!0,configurable:!0}),t.prototype.postMessage=function(e,t){var r=this;l(function(){r._workerMessageHandler(new MessageEvent("message",{data:e}))})},t.prototype.dispatchEvent=function(e){return this._dispatcher.dispatchEvent(e)},t.prototype.addEventListener=function(e,t,r){this._dispatcher.addEventListener(e,t,r)},t.prototype.removeEventListener=function(e,t,r){this._dispatcher.removeEventListener(e,t,r)},t.prototype._workerPostMessage=function(e,t){var r=this;l(function(){r.dispatchEvent(new MessageEvent("message",{data:e}))})},t.prototype._workerMessageHandler=function(t){var i=this,a=o.receiveMessage(t);if(a){var s=a.jobId;switch(a.type){case o.MessageType.CONFIGURE:this._isInitialized||this._workerPostMessage({type:o.MessageType.CONFIGURED});break;case o.MessageType.OPEN:var l=a.modulePath;n("esri-webpack")?Promise.all([r.e(3),r.e(2),r.e(5),r.e(7),r.e(67)]).then(function(){var t=[r(389),r(752),r(753),r(735),r(716),r(754),r(682),e(l,null,!1)];(function(e,t,r,n,a,l,u,p){var c;switch(p){case"esri/views/vectorTiles/WorkerTileHandler":c=t;break;case"esri/views/2d/layers/features/Pipeline":c=r;break;case"esri/views/3d/layers/PointCloudWorker":c=n;break;case"esri/views/3d/layers/SceneLayerWorker":c=a;break;case"esri/layers/graphics/sources/support/CSVSourceWorker":c=l;break;case"esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker":c=u;break;default:c=p}var d=e.connect(c);i._workerPostMessage({type:o.MessageType.OPENED,jobId:s,data:d})}).apply(null,t)}).catch(r.oe):Promise.resolve().then(function(){var t=[r(389),e(l,null,!1)];(function(e,t){var r=e.connect(t);i._workerPostMessage({type:o.MessageType.OPENED,jobId:s,data:r})}).apply(null,t)}).catch(r.oe)}}},t}()}.apply(null,n))||(e.exports=i)},613:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(357),r(363)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.graphicsExtent=function(e){if(!e||!e.length)return null;var t=r.isCollection(e)?e.getItemAt(0).geometry:e[0].geometry,i=t.extent,o=t;null===i&&(i=new n(o.x,o.y,o.x,o.y,t.spatialReference));for(var a=1;a<e.length;a++){o=t=r.isCollection(e)?e.getItemAt(a).geometry:e[a].geometry;var s=t.extent;null===s&&(s=new n(o.x,o.y,o.x,o.y,t.spatialReference)),i=i.clone().union(s)}return i.width<0&&i.height<0?null:i},t.getGeometries=function(e){return e.map(function(e){return e.geometry})},t._encodeGraphics=function(e,t){var r=[];return e.forEach(function(e,n){var i=e.toJSON(),o={};if(i.geometry){var a=t&&t[n];o.geometry=a&&a.toJSON()||i.geometry}i.attributes&&(o.attributes=i.attributes),r[n]=o}),r}}.apply(null,n))||(e.exports=i)},615:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(414),r(415),r(370),r(412),r(416)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.types={key:"type",base:i,typeMap:{heatmap:n,simple:o,"unique-value":a,"class-breaks":r}}}.apply(null,n))||(e.exports=i)},621:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(346),r(357),r(406)],void 0===(i=function(e,t,r,n,i){function o(e){return e instanceof r}function a(e){return e instanceof n?Object.keys(e.items):o(e)?i.getProperties(e).keys():e?Object.keys(e):[]}function s(e,t){return e instanceof n?e.items[t]:e[t]}function l(e){return e?e.declaredClass:null}function u(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var n=a(e),i=a(t);if(0!==n.length||0!==i.length){if(!n.length||!i.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var c=i.filter(function(e){return-1===n.indexOf(e)}),d=n.filter(function(e){return-1===i.indexOf(e)}),y=n.filter(function(r){return i.indexOf(r)>-1&&s(e,r)!==s(t,r)}).concat(c,d).sort(),f=l(e);if(f&&p.indexOf(f)>-1&&y.length)return{type:"complete",oldValue:e,newValue:t};var h,m=o(e)&&o(t);for(var v in y){var b=y[v],g=s(e,b),w=s(t,b),S=void 0;(m||"function"!=typeof g&&"function"!=typeof w)&&g!==w&&(null==g&&null==w||(S=r&&r[b]&&"function"==typeof r[b]?r[b](g,w):"object"==typeof g&&"object"==typeof w&&l(g)===l(w)?u(g,w):{type:"complete",oldValue:g,newValue:w})&&((h=h||{type:"partial",diff:{}}).diff[b]=S))}return h}}Object.defineProperty(t,"__esModule",{value:!0});var p=["esri.Color","esri.portal.Portal"];t.diff=function(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&l(e)!==l(t)?{type:"complete",oldValue:e,newValue:t}:u(e,t)}}.apply(null,n))||(e.exports=i)},627:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(350),r(349),r(422),r(626),r(628),r(403)],void 0===(i=function(e,t,r,n,i,o,a,s,l){function u(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(r&&(i.geometry=JSON.stringify(r),i.geometryType=o.getJsonType(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(i.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var a=n.timeExtent;i.time=[null!=a.startTime?a.startTime:"null",null!=a.endTime?a.endTime:"null"],delete n.timeExtent}return i}function p(e,t,o,s,p){void 0===s&&(s={});var c="string"==typeof e?i.urlToObject(e):e,d=t.geometry?[t.geometry]:[];return s.responseType="pbf"===o?"array-buffer":"json",a.normalizeCentralMeridian(d,null,s).then(function(e){var i=e&&e[0];i&&((t=t.clone()).geometry=i);var a=l.mapParameters(r({},c.query,{f:o},p,u(t,p)));return n(c.path+"/query",r({},s,{query:a}))})}Object.defineProperty(t,"__esModule",{value:!0});var c="Layer does not support extent calculation.";t.queryToQueryStringParameters=u,t.executeQuery=function(e,t,r){return p(e,t,"json",r)},t.executeQueryPBF=function(e,t,r){return p(e,t,"pbf",r).then(function(e){var t=s.parsePBFFeatureQuery(e.data),r=e;return r.data=t,r})},t.executeQueryForIds=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return p(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(c);if(t.hasOwnProperty("count"))throw new Error(c);return e})}}.apply(null,n))||(e.exports=i)},628:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(341),r(343),r(425),r(629)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=n.getLogger("esri.tasks.operations.pbfQueryUtils");t.parsePBFFeatureQuery=function(e){try{var t=o.parseFeatureQuery(e).queryResult.featureResult;if(t&&t.features&&t.features.length&&t.objectIdFieldName)for(var n=t.objectIdFieldName,s=0,l=t.features;s<l.length;s++){var u=l[s];u.attributes&&(u.objectId=u.attributes[n])}return t}catch(e){var p=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return a.error(p),new i.default}}}.apply(null,n))||(e.exports=i)},629:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(593),r(603),r(425),r(595)],void 0===(i=function(e,t,r,n,i,o){function a(e){return e>=_.length?null:_[e]}function s(e){return e>=j.length?null:j[e]}function l(e){return e>=x.length?null:x[e]}function u(e){return e>=O.length?null:O[e]}function p(e){for(var t=new o.default,r=t.coords;e.next();)switch(e.tag()){case 3:for(var n=e.getUInt32(),i=e.pos()+n,a=0;e.pos()<i;)r[a++]=e.getSInt64();break;case 1:case 2:default:e.skip()}return t}function c(e){for(var t=new o.default,r=t.coords,n=t.lengths;e.next();)switch(e.tag()){case 2:for(var i=e.getUInt32(),a=e.pos()+i;e.pos()<a;)n.push(e.getUInt32());break;case 3:for(var s=e.getUInt32(),l=(a=e.pos()+s,0);e.pos()<a;)r[l++]=e.getSInt64();break;case 1:default:e.skip()}return t}function d(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function y(e){for(var t={type:a(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=a(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=s(e.getEnum());break;case 5:case 6:default:e.skip()}return t}function f(e,t){for(var r=new n.default,i=0;e.next();)switch(e.tag()){case 1:var o=e.getMessage(),a=t[i++].name;r.attributes[a]=d(o);break;case 2:r.geometry=c(e.getMessage());break;case 4:r.centroid=p(e.getMessage());break;default:e.skip()}return r}function h(e){for(var t=[0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 3:case 4:t.push(e.getDouble());break;default:e.skip()}return t}function m(e){for(var t=[0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 3:case 4:t.push(e.getDouble());break;default:e.skip()}return t}function v(e){for(var t={originPosition:l(0)};e.next();)switch(e.tag()){case 1:t.originPosition=l(e.getEnum());break;case 2:t.scale=h(e.getMessage());break;case 3:t.translate=m(e.getMessage());break;default:e.skip()}return t}function b(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function g(e){for(var t={};e.next();)switch(e.tag()){case 1:t.wkid=e.getUInt32();break;case 5:t.wkt=e.getString();break;case 2:case 3:case 4:default:e.skip()}return t}function w(e){var t=new i.default;for(t.geometryType=u(0);e.next();)switch(e.tag()){case 1:t.objectIdFieldName=e.getString();break;case 3:t.globalIdFieldName=e.getString();break;case 4:t.geohashFieldName=e.getString();break;case 5:t.geometryProperties=b(e.getMessage());break;case 7:t.geometryType=u(e.getEnum());break;case 8:t.spatialReference=g(e.getMessage());break;case 10:t.hasZ=e.getBool();break;case 11:t.hasM=e.getBool();break;case 12:var r=e.getMessage();t.transform=v(r);break;case 9:var n=e.getBool();t.exceededTransferLimit=n;break;case 13:var o=e.getMessage();t.fields.push(y(o));break;case 15:var a=e.getMessage();t.features.push(f(a,t.fields));break;case 2:case 6:default:e.skip()}return t}function S(e){for(var t={};e.next();)switch(e.tag()){case 1:t.featureResult=w(e.getMessage());break;default:e.skip()}return t}Object.defineProperty(t,"__esModule",{value:!0});var _=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],j=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],O=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],x=["upperLeft","lowerLeft"];t.parseFeatureQuery=function(e){for(var t=new r(new Uint8Array(e),new DataView(e)),n={};t.next();)switch(t.tag()){case 2:n.queryResult=S(t.getMessage());break;default:t.skip()}return n}}.apply(null,n))||(e.exports=i)},634:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(350),r(431),r(341),r(339),r(349),r(411),r(673),r(361),r(757),r(747)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c){function d(e,t){return t.load().then(function(){var r=new l({disableExtraQuery:!0,query:"owner:"+v+" AND type:"+b+' AND typekeywords:"'+e+'"'});return t.queryItems(r)}).then(function(t){var r=t.results,n=null,o=e.toLowerCase();if(r&&Array.isArray(r))for(var a=0,s=r;a<s.length;a++){var l=s[a];if(l.typeKeywords.some(function(e){return e.toLowerCase()===o})&&l.type===b&&l.owner===v){n=l;break}}if(n)return n.load();throw new i("symbolstyleutils:style-not-found","The style '"+e+"' could not be found",{styleName:e})})}function y(e,t){return e.styleUrl?function(e,t){return h(e).then(function(t){return{data:t.data,baseUrl:a.removeFile(e),styleUrl:e}})}(e.styleUrl):e.styleName?function(e,t){var r,n=t.portal||s.getDefault(),i=n.url+" - "+(n.user&&n.user.username)+" - "+e;return m[i]||(m[i]=d(e,n).then(function(e){return r=e,e.fetchData()}).then(function(t){return{data:t,baseUrl:r.itemUrl,styleName:e}})),m[i]}(e.styleName,t):o.reject(new i("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function f(e,t,r){for(var s=e.data,l={portal:r.portal,url:a.urlToObject(e.baseUrl),origin:"portal-item"},d=0,y=s.items;d<y.length;d++){var f=function(i){if(i.name!==t)return"continue";var o=a.read(i.webRef,l),s={portal:r.portal,url:a.urlToObject(a.removeFile(o)),origin:"portal-item"};return{value:h(o).then(function(o){var d=u.fromJSON(o.data,s);if(d&&d.isInstanceOf(n.BaseSymbol3D)){if(i.thumbnail)if(i.thumbnail.href){var y=a.read(i.thumbnail.href,l);d.thumbnail=new c.default({url:y})}else i.thumbnail.imageData&&(d.thumbnail=new c.default({url:"data:image/png;base64,"+i.thumbnail.imageData}));e.styleUrl?d.styleOrigin=new p({portal:r.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(d.styleOrigin=new p({portal:r.portal,styleName:e.styleName,name:t}))}return d})}}(y[d]);if("object"==typeof f)return f.value}return o.reject(new i("symbolstyleutils:symbol-name-not-found","The symbol name '"+t+"' could not be found",{symbolName:t}))}function h(e){var t={responseType:"json",query:{f:"json"}};return r(a.normalize(e),t)}Object.defineProperty(t,"__esModule",{value:!0});var m={};t.fetchStyle=y,t.resolveWebStyleSymbol=function(e,t){return e.name?y(e,t).then(function(r){return f(r,e.name,t)}):o.reject(new i("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))},t.fetchSymbolFromStyle=f,t.styleNameFromItem=function(e){for(var t=0,r=e.typeKeywords;t<r.length;t++){var n=r[t];if(/^Esri.*Style$/.test(n)&&"Esri Style"!==n)return n}};var v="esri_en",b="Style"}.apply(null,n))||(e.exports=i)},635:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(339),r(442)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadStyleRenderer=function(e,t){var i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);return i&&"unique-value"===i.type&&i.styleOrigin?i.populateFromStyle().catch(function(r){t&&t.messages&&t.messages.push(new n("renderer:style-reference","Failed to create unique value renderer from style reference: "+r.message,{error:r,context:t})),e.clear("renderer",t.origin)}).then(function(){return null}):r.resolve(null)}}.apply(null,n))||(e.exports=i)},637:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(414),r(415),r(370),r(412),r(416),r(423)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0}),t.ClassBreaksRenderer=r,t.HeatmapRenderer=n,t.BaseRenderer=i,t.SimpleRenderer=o,t.UniqueValueRenderer=a,t.isRenderer=function(e){return e instanceof t.BaseRenderer},t.fromJSON=s.fromJSON}.apply(null,n))||(e.exports=i)},638:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(360)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this,t)||this;return r.level=0,r.levelValue=null,r.resolution=0,r.scale=0,r}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})},n([o.property({type:a.Integer,json:{write:!0}})],t.prototype,"level",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"levelValue",void 0),n([o.property({type:Number,json:{write:!0}})],t.prototype,"resolution",void 0),n([o.property({type:Number,json:{write:!0}})],t.prototype,"scale",void 0),i=n([o.subclass("esri.layers.support.LOD")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},639:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(350),r(349),r(403)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0}),t.processAttachmentQueryResult=function(e,t,n){for(var o={},a=0,s=e;a<s.length;a++)for(var l=s[a],u=l.parentObjectId,p=0,c=l.attachmentInfos;p<c.length;p++){var d=c[p],y=d.id,f=i.addProxy(t+"/"+u+"/attachments/"+y+(n?"?token="+n:"")),h=r({},d,{parentObjectId:u,url:f});o[u]?o[u].push(h):o[u]=[h]}return o},t.executeAttachmentQuery=function(e,t,i){var a={query:o.mapParameters(r({},e.query,{f:"json"},function(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}(t)))};return i&&(a=r({},i,a)),n(e.path+"/queryAttachments",a)}}.apply(null,n))||(e.exports=i)},641:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(338),r(336),r(642)],void 0===(i=function(e,t,r,n,i,o,a,s,l){var u=o({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),p=o({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance"}),c=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];return function(e){function t(t){var r=e.call(this)||this;return r.lengthUnit=null,r.visualVariables=null,r}var i;return r(t,e),i=t,Object.defineProperty(t.prototype,"classificationMethod",{get:function(){var e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e},set:function(e){this._set("classificationMethod",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(e){this._set("fields",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},set:function(e){this._set("field1",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"field2",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(e){this._set("field2",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(e){this._set("focus",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(e){this._set("numClasses",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"standardDeviationInterval",{get:function(){var e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(e){this._set("standardDeviationInterval",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._get("type")},set:function(e){var t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i({classificationMethod:this.classificationMethod,fields:this.fields&&this.fields.slice(0),field1:a.clone(this.field1),field2:a.clone(this.field2),focus:this.focus,numClasses:this.numClasses,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(e){return e.clone()})})},n([s.property({type:u.apiValues,value:null,dependsOn:["type"],json:{type:u.jsonValues,read:u.read,write:u.write}})],t.prototype,"classificationMethod",null),n([s.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"fields",null),n([s.property({value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"field1",null),n([s.property({value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"field2",null),n([s.property({type:String,value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"focus",null),n([s.property({type:Number,value:null,dependsOn:["type"],json:{write:!0}})],t.prototype,"numClasses",null),n([s.property({type:c,json:{type:c,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],t.prototype,"lengthUnit",void 0),n([s.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],t.prototype,"standardDeviationInterval",null),n([s.property({type:String,value:null,json:{type:p.jsonValues,read:p.read,write:p.write}})],t.prototype,"type",null),n([s.property({type:[l],json:{write:!0}})],t.prototype,"visualVariables",void 0),i=n([s.subclass("esri.renderers.support.AuthoringInfo")],t)}(s.declared(i))}.apply(null,n))||(e.exports=i)},642:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336),r(698)],void 0===(i=function(e,t,r,n,i,o,a,s){var l=o({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),u=o({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity"}),p={key:function(e){return"number"==typeof e?"number":"string"},typeMap:{number:Number,string:String},base:null},c=["high-to-low","above-and-below","centered-on","extremes"],d=["seconds","minutes","hours","days","months","years"];return function(e){function t(t){var r=e.call(this)||this;return r.endTime=null,r.field=null,r.maxSliderValue=null,r.minSliderValue=null,r.startTime=null,r.type=null,r.units=null,r}var i;return r(t,e),i=t,t.prototype.castEndTime=function(e){return"string"==typeof e||"number"==typeof e?e:null},t.prototype.castStartTime=function(e){return"string"==typeof e||"number"==typeof e?e:null},Object.defineProperty(t.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(e){this._set("style",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(e){this._set("theme",e)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})},n([a.property({types:p,json:{write:!0}})],t.prototype,"endTime",void 0),n([s.cast("endTime")],t.prototype,"castEndTime",null),n([a.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"maxSliderValue",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"minSliderValue",void 0),n([a.property({types:p,json:{write:!0}})],t.prototype,"startTime",void 0),n([s.cast("startTime")],t.prototype,"castStartTime",null),n([a.property({type:l.apiValues,value:null,dependsOn:["type"],json:{type:l.jsonValues,read:l.read,write:l.write}})],t.prototype,"style",null),n([a.property({type:c,value:null,dependsOn:["type"],json:{type:c,write:!0}})],t.prototype,"theme",null),n([a.property({type:u.apiValues,json:{type:u.jsonValues,read:u.read,write:u.write}})],t.prototype,"type",void 0),n([a.property({type:d,json:{type:d,write:!0}})],t.prototype,"units",void 0),i=n([a.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},643:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(361),r(375)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=null,t.maxValue=0,t.symbol=null,t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})},n([o.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([o.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),n([o.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),n([o.property({types:s.rendererTypes,json:{origins:{"web-scene":{read:a.read,write:{target:{symbol:{types:s.rendererTypes3D}},writer:a.writeTarget}}},read:a.read,write:a.writeTarget}})],t.prototype,"symbol",void 0),i=n([o.subclass("esri.renderers.support.ClassBreakInfo")],t)}(o.declared(i));t.ClassBreakInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},644:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(358),r(340),r(336)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this)||this;return r.color=null,r.ratio=null,r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({color:this.color,ratio:this.ratio})},n([a.property({type:i,json:{write:!0}})],t.prototype,"color",void 0),n([a.property({type:Number,json:{write:!0}})],t.prototype,"ratio",void 0),o=n([a.subclass("esri.renderers.support.HeatmapColorStop")],t)}(a.declared(o));t.HeatmapColorStop=s,t.default=s}.apply(null,n))||(e.exports=i)},645:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(361),r(375)],void 0===(i=function(e,t,r,n,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.symbol=null,t.value=null,t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})},n([o.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([o.property({types:s.rendererTypes,json:{origins:{"web-scene":{read:a.read,write:{target:{symbol:{types:s.rendererTypes3D}},writer:a.writeTarget}}},read:a.read,write:a.writeTarget}})],t.prototype,"symbol",void 0),n([o.property({type:String,json:{write:!0}})],t.prototype,"value",void 0),i=n([o.subclass("esri.renderers.support.UniqueValueInfo")],t)}(o.declared(i));t.UniqueValueInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},646:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isOfType=function(e,t){var r=e.constructor._meta;if(!r||!r.bases)return!1;var n=r.bases,i=Array.isArray(t);return n.some(function(e){var r=e.__accessorMetadata__;if(!r)return!1;var n=r.properties;if(!n||!n.type||!n.type.value)return!1;var o=n.type.value;return i?-1!==t.indexOf(o):o===t})}}.apply(null,n))||(e.exports=i)},647:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(388),r(344),r(364),r(336),r(740),r(627),r(639),r(648),r(440),r(392),r(419),r(444)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.source=null,r}return r(t,e),t.prototype.execute=function(e,t){return this.executeJSON(e,t).then(function(e){return y.fromJSON(e)})},t.prototype.executeJSON=function(e,t){return u.executeQuery(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then(function(e){return e.data})},t.prototype.executeForCount=function(e,t){return u.executeQueryForCount(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then(function(e){return e.data.count})},t.prototype.executeForExtent=function(e,t){return u.executeQueryForExtent(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then(function(e){return{count:e.data.count,extent:a.Extent.fromJSON(e.data.extent)}})},t.prototype.executeForIds=function(e,t){return u.executeQueryForIds(this.parsedUrl,this._normalizeQuery(e),o({},this.requestOptions,t)).then(function(e){return e.data.objectIds})},t.prototype.executeRelationshipQuery=function(e,t){return(this.gdbVersion||this.source)&&(e=e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source})),c.executeRelationshipQuery(this.parsedUrl,e,o({},this.requestOptions,t)).then(function(e){var t=e.data,r={};return Object.keys(t).forEach(function(e){return r[e]=y.fromJSON(t[e])}),r})},t.prototype.executeAttachmentQuery=function(e,t){var r=this,n=t&&t.query&&t.query.token;return p.executeAttachmentQuery(this.parsedUrl,e,o({},this.requestOptions,t)).then(function(e){return p.processAttachmentQueryResult(e.data.attachmentGroups,r.parsedUrl.path,n)})},t.prototype._normalizeQuery=function(e){return this.gdbVersion||this.source?e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source}):e},n([s.property()],t.prototype,"gdbVersion",void 0),n([s.property()],t.prototype,"source",void 0),n([i(0,s.cast(f))],t.prototype,"execute",null),n([i(0,s.cast(f))],t.prototype,"executeJSON",null),n([i(0,s.cast(f))],t.prototype,"executeForCount",null),n([i(0,s.cast(f))],t.prototype,"executeForExtent",null),n([i(0,s.cast(f))],t.prototype,"executeForIds",null),n([i(0,s.cast(h))],t.prototype,"executeRelationshipQuery",null),n([i(0,s.cast(d))],t.prototype,"executeAttachmentQuery",null),n([s.subclass("esri.tasks.QueryTask")],t)}(s.declared(l))}.apply(null,n))||(e.exports=i)},648:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(350),r(403)],void 0===(i=function(e,t,r,n,i){function o(e){var t=e.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.outFields&&(t.outFields=t.outFields.join(",")),t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.source&&(t.layer=JSON.stringify({source:t.source}),delete t.source),t}Object.defineProperty(t,"__esModule",{value:!0}),t.toQueryStringParameters=o,t.executeRelationshipQuery=function(e,t,a){var s={query:i.mapParameters(r({},e.query,{f:"json"},o(t)))};return a&&(s=r({},a,s)),n(e.path+"/queryRelatedRecords",s).then(function(e){for(var t=e.data,r=t.geometryType,n=t.spatialReference,i={},o=0,a=t.relatedRecordGroups;o<a.length;o++){var s=a[o],l={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:n,features:s.relatedRecords};if(null!=s.objectId)i[s.objectId]=l;else for(var u in s)s.hasOwnProperty(u)&&"relatedRecords"!==u&&(i[s[u]]=l)}return e.data=i,e})}}.apply(null,n))||(e.exports=i)},652:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(346),r(338),r(336),r(395),r(447)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return r(t,e),i=t,t.fromWorker=function(e){if(!e)return null;var t=JSON.parse(e),r=new i;return r.fields=t.fields&&t.fields.map(function(e){return s.fromJSON(e)}),r.options=t.options,r.process=new(Function.bind.apply(Function,[void 0].concat(t.process.args,[t.process.body]))),r},Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i(o.clone({fields:this.fields,options:this.options,process:this.process}))},t.prototype.getField=function(e){return l.getField(e,this.fields)},t.prototype.refresh=function(){this.notifyChange("version")},t.prototype.toWorker=function(){var e=this.process.toString();return JSON.stringify({fields:this.fields,options:this.options,process:{body:e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),args:e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g)}})},n([a.property({type:[s]})],t.prototype,"fields",void 0),n([a.property()],t.prototype,"options",void 0),n([a.property()],t.prototype,"process",void 0),n([a.property({readOnly:!0,dependsOn:["process","options","fields"]})],t.prototype,"version",null),i=n([a.subclass("esri.layers.support.FeatureProcessing")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},661:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(455)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="selection",t}return r(t,e),n([i.property()],t.prototype,"type",void 0),n([i.subclass("esri.layers.support.FeatureReductionSelection")],t)}(i.declared(o.default));t.FeatureReductionSelection=a,t.default=a}.apply(null,n))||(e.exports=i)},662:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336),r(451)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.expression=null,t}var i;return r(t,e),i=t,t.prototype.readExpression=function(e,t){return t.value?a.convertTemplatedStringToArcade(t.value):e},t.prototype.writeExpression=function(e,t,r){null!=this.value&&(e=a.convertTemplatedStringToArcade(this.value)),t[r]=e},t.prototype.clone=function(){return new i({value:this.value,expression:this.expression})},n([o.property({json:{read:!1,write:!1}})],t.prototype,"value",void 0),n([o.property({json:{write:{allowNull:!0}}})],t.prototype,"expression",void 0),n([o.reader("expression",["expression","value"])],t.prototype,"readExpression",null),n([o.writer("expression")],t.prototype,"writeExpression",null),i=n([o.subclass("esri.layers.support.LabelExpressionInfo")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},663:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(405)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.replace=function(e,t,n){return void 0===n&&(n=/\{([^\}]+)\}/g),e.replace(n,"function"==typeof t?t:function(e,n){return r.getDeepValue(n,t)})}}.apply(null,n))||(e.exports=i)},664:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(427)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=/\[([^\[\]]+)\]/gi;t.reader=function(e,t,i){var o=this;return e?e.map(function(e){var a=new r;if(a.read(e,i),a.labelExpression){var s=t.fields||t.layerDefinition&&t.layerDefinition.fields||o.fields;a.labelExpression=a.labelExpression.replace(n,function(e,t){return"["+function(e,t){if(!t)return e;for(var r=e.toLowerCase(),n=0;n<t.length;n++){var i=t[n].name;if(i.toLowerCase()===r)return i}return e}(t,s)+"]"})}return a}):null}}.apply(null,n))||(e.exports=i)},666:function(e,t,r){var n;void 0===(n=function(){function e(e,t,r,n){for(var i=t,o=t,a=r>>>1,s=e[i-1];o<=a;){(o=i<<1)<r&&n(e[o-1],e[o])<0&&++o;var l=e[o-1];if(n(l,s)<=0)break;e[i-1]=l,i=o}e[i-1]=s}function t(e,t){return e<t?-1:e>t?1:0}return{sort:function(r,n,i,o){void 0===n&&(n=0),void 0===i&&(i=r.length),void 0===o&&(o=t);for(var a=i>>>1;a>n;a--)e(r,a,i,o);var s=n+1;for(a=i-1;a>n;a--){var l=r[n];r[n]=r[a],r[a]=l,e(r,s,a,o)}return r}}}.apply(null,[]))||(e.exports=n)},671:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(364),r(383),r(346),r(357),r(341),r(353),r(347),r(623),r(343),r(446),r(437),r(336),r(360),r(674),r(392),r.dj.m(e)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h,m,v,b,g){function w(e){var t=e.geometry,r=e.attributes;return{geometry:t&&"mesh"!==t.type?t&&t.toJSON():null,attributes:r}}Object.defineProperty(t,"__esModule",{value:!0});var S=p({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),_=d.getLogger("esri.layers.graphics.sources.MemorySource"),j=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return r(a,t),a.prototype.load=function(){var t=this;return this.addResolvingPromise(f.open(y.getAbsMid("./support/MemorySourceWorker",e,g),{client:this,strategy:u("esri-workers-for-memory-layers")?"dedicated":"local"}).then(function(e){t._connection=e;var r=t.layer,n=r.fields,i=r.spatialReference,o=r.geometryType,a=r.objectIdField,s=r.hasM,l=r.hasZ;return e.invoke("load",{features:t.items.map(w),fields:n&&n.map(function(e){return e.toJSON()}),geometryType:S.toJSON(o),hasM:s,hasZ:l,objectIdField:a,spatialReference:i&&i.toJSON()}).then(function(e){e.featureErrors.length&&_.warn("Encountered "+e.featureErrors.length+" validation errors while loading features",e.featureErrors),t.layerDefinition=e.layerDefinition})})),this.when()},a.prototype.applyEdits=function(e){var t=this;return this.load().then(function(){return t._applyEdits(e)})},a.prototype.openPorts=function(){var e=this;return this.load().then(function(){return e._connection.openPorts()})},a.prototype.queryFeatures=function(e){return this.queryFeaturesJSON(e).then(function(e){return b.fromJSON(e)})},a.prototype.queryFeaturesJSON=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryFeatures",e?e.toJSON():null)})},a.prototype.queryFeatureCount=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null)})},a.prototype.queryObjectIds=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null)})},a.prototype.queryExtent=function(e){var t=this;return this.load().then(function(){return t._connection.invoke("queryExtent",e?e.toJSON():null)}).then(function(e){return{count:e.count,extent:i.Extent.fromJSON(e.extent)}})},a.prototype._applyEdits=function(e){var t=this;if(!this._connection)throw new l("feature-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,n=[],i=[],o=[];if(e.addFeatures)for(var a=0,s=e.addFeatures;a<s.length;a++){var u=s[a];n.push(w(u))}if(e.deleteFeatures)for(var p=0,c=e.deleteFeatures;p<c.length;p++){var d=c[p];"objectId"in d&&null!=d.objectId?i.push(d.objectId):"attributes"in d&&null!=d.attributes[r]&&i.push(d.attributes[r])}if(e.updateFeatures)for(var y=0,f=e.updateFeatures;y<f.length;y++){u=f[y];o.push(w(u))}return this._connection.invoke("applyEdits",{adds:n,updates:o,deletes:i}).then(function(e){var r=e.fullExtent,n=e.featureEditResults;return t.fullExtent=r,t._createEditsResult(n)})},a.prototype._createEditsResult=function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[]}},a.prototype._createFeatureEditResult=function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new l("feature-layer-source:edit-failure",t.description,{code:t.code}):null}},n([v.shared({Type:o,ensureType:m.ensureType(o)})],a.prototype,"itemType",void 0),n([h.property({constructOnly:!0})],a.prototype,"layer",void 0),n([h.property()],a.prototype,"layerDefinition",void 0),n([h.subclass("esri.layers.graphics.sources.MemorySource")],a)}(h.declared(a,s,c));t.MemorySource=j,t.default=j}.apply(null,n))||(e.exports=i)},674:function(e,t,r){var n,i;n=[r(351),r(675),r(340),r(338)],void 0===(i=function(e,t,r,n){return{subclass:function(i,o){return function(o){var a=t.declareDefinition(o,i);s&&(a.instanceMembers.properties=function e(t,r){if(!t)return r;if(!r)return t;for(var n in r){var i=t[n],o=r[n];Array.isArray(o)&&Array.isArray(i)?t[n]=i.concat(o):t[n]="object"==typeof o&&"object"==typeof i?e(i,o):o}return t}(s,a.instanceMembers.properties));var s=a.instanceMembers.properties;if(s)for(var l in s){var u=s[l];u&&!u.reader&&u.type&&(u.type===Date?u.reader=function(e){return null!=e?new Date(e):null}:-1!==u.type._meta.bases.indexOf(r)&&(u.reader=function(e){return function(t){return e.fromJSON(t)}}(u.type)))}return n.mixin(e(a.bases,a.instanceMembers),a.classMembers)}},shared:t.shared,property:function(e){return function(t,r){var n=Object.getPrototypeOf(t),i=n&&n.properties;t.properties&&t.properties!==i||(t.properties={}),t.properties=t.properties||{},t.properties[r]=e||{}}}}}.apply(null,n))||(e.exports=i)},675:function(e,t,r){var n,i;n=[r(351),r(338)],void 0===(i=function(e,t){var r={declareDefinition:function(e,t){var r,n=[],i=Object.getPrototypeOf(e.prototype);if(i!==Object.prototype){var o=i.constructor;r=o.prototype,n.push(o)}t&&(n=n.concat(t));for(var a={},s=Object.getOwnPropertyNames(e.prototype),l=0;l<s.length;l++){var u=s[l];if("constructor"!==u){var p=u;"dojoConstructor"===u&&(p="constructor"),r&&e.prototype[u]===r[u]||(a[p]=e.prototype[u])}}s=Object.getOwnPropertyNames(e);var c=Object.getOwnPropertyNames(i.constructor),d={};for(l=0;l<s.length;l++)u=s[l],-1===c.indexOf(u)&&(d[u]=e[u]);return{bases:n,instanceMembers:a,classMembers:d}},subclass:function(n){return function(i){var o=r.declareDefinition(i,n);return t.mixin(e(o.bases,o.instanceMembers),o.classMembers)}},shared:function(e){return function(t,r){t[r]=e}}};return r}.apply(null,n))||(e.exports=i)},676:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(336)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){return e.call(this,t)||this}var i;return r(t,e),i=t,t.prototype.clone=function(){var e=this,t=e.name,r=e.fields,n=e.isAscending,o=e.isUnique,a=e.description;return new i({name:t,fields:r,isAscending:n,isUnique:o,description:a})},n([o.property({constructOnly:!0})],t.prototype,"name",void 0),n([o.property({constructOnly:!0})],t.prototype,"fields",void 0),n([o.property({constructOnly:!0})],t.prototype,"isAscending",void 0),n([o.property({constructOnly:!0})],t.prototype,"isUnique",void 0),n([o.property({constructOnly:!0})],t.prototype,"description",void 0),i=n([o.subclass("esri.layers.support.FeatureIndex")],t)}(o.declared(i));t.FeatureIndex=a,t.default=a}.apply(null,n))||(e.exports=i)},677:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(338),r(336),r(399),r(588)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(t){var r=e.call(this,t)||this;return r.id=null,r.name=null,r.domains=null,r.templates=null,r}return r(t,e),t.prototype.readDomains=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(n.type){case"range":t[r]=s.RangeDomain.fromJSON(n);break;case"codedValue":t[r]=s.CodedValueDomain.fromJSON(n);break;case"inherited":t[r]=s.InheritedDomain.fromJSON(n)}}return t},t.prototype.writeDomains=function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]&&e[n].toJSON());o.fixJson(r),t.domains=r},t.prototype.readTemplates=function(e){return e&&e.map(function(e){return new l(e)})},t.prototype.writeTemplates=function(e,t){t.templates=e&&e.map(function(e){return e.toJSON()})},n([a.property({json:{write:!0}})],t.prototype,"id",void 0),n([a.property({json:{write:!0}})],t.prototype,"name",void 0),n([a.property({json:{write:!0}})],t.prototype,"domains",void 0),n([a.reader("domains")],t.prototype,"readDomains",null),n([a.writer("domains")],t.prototype,"writeDomains",null),n([a.property({json:{write:!0}})],t.prototype,"templates",void 0),n([a.reader("templates")],t.prototype,"readTemplates",null),n([a.writer("templates")],t.prototype,"writeTemplates",null),n([a.subclass("esri.layers.support.FeatureType")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},678:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(340),r(347),r(336)],void 0===(i=function(e,t,r,n,i,o,a){var s=o({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"});return function(e){function t(t){var r=e.call(this,t)||this;return r.cardinality=null,r.id=null,r.keyField=null,r.name=null,r.relatedTableId=null,r}return r(t,e),n([a.property({json:{read:s.read,write:s.write}})],t.prototype,"cardinality",void 0),n([a.property({json:{read:!0,write:!0}})],t.prototype,"id",void 0),n([a.property({json:{read:!0,write:!0}})],t.prototype,"keyField",void 0),n([a.property({json:{read:!0,write:!0}})],t.prototype,"name",void 0),n([a.property({json:{read:!0,write:!0}})],t.prototype,"relatedTableId",void 0),n([a.subclass("esri.layers.support.Relationship")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},691:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(434),r(364),r(350),r(339),r(349),r(336),r(398),r(695),r(865),r(433),r(432),r(438),r(426),r(866),r(782),r(394)],void 0===(i=function(e,t,n,i,o,a,s,l,u,p,c,d,y,f,h,m,v,b,g,w,S){var _=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];return function(e){function t(t,r){var n=e.call(this)||this;return n.spatialReference=null,n.sublayers=null,n.type="tile",n.url=null,n}return i(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?n({url:e},t):e},t.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service","Map Service"]}).always(function(){return e._fetchService()})),this.when()},Object.defineProperty(t.prototype,"attributionDataUrl",{get:function(){return this._getDefaultAttribution(this._getMapName(this.parsedUrl.path.toLowerCase()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"operationalLayerType",{get:function(){if(this.capabilities)return this.capabilities.operations.supportsExportMap?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer";var e=this.url||this.portalItem&&this.portalItem.url;return e&&/\/ImageServer(\/|\/?$)/i.test(e)?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer"},enumerable:!0,configurable:!0}),t.prototype.readSpatialReference=function(e,t){return(e=e||t.tileInfo&&t.tileInfo.spatialReference)&&s.SpatialReference.fromJSON(e)},Object.defineProperty(t.prototype,"tileServers",{get:function(){return this._getDefaultTileServers(this.parsedUrl.path)},enumerable:!0,configurable:!0}),t.prototype.castTileServers=function(e){return Array.isArray(e)?e.map(function(e){return p.urlToObject(e).path}):null},t.prototype.fetchTile=function(e,t,r,n){var i=this.getTileUrl(e,t,r),o={responseType:"image"};return n&&n.timestamp&&(o.query={_ts:n.timestamp}),l(i,o).then(function(e){return e.data})},t.prototype.getTileUrl=function(e,t,r){var i=!this.tilemapCache&&this.supportsBlankTile,o=a.objectToQuery(n({},this.parsedUrl.query,{blankTile:!i&&null,token:this.token?encodeURIComponent(this.token):null})),s=this.tileServers;return(s&&s.length?s[t%s.length]:this.parsedUrl.path)+"/tile/"+e+"/"+t+"/"+r+(o?"?"+o:"")},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return u.create(function(e){return Promise.all([r.e(5),r.e(12)]).then(function(){var t=[r(983)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return u.create(function(e){return Promise.all([r.e(11),r.e(16),r.e(82)]).then(function(){var t=[r(898)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._fetchService=function(){var e=this;return u.create(function(t,r){e.resourceInfo?t({data:e.resourceInfo}):l(e.parsedUrl.path,{query:n({f:"json"},e.parsedUrl.query),responseType:"json"}).then(t,r)}).then(function(t){if(t.ssl&&(e.url=e.url.replace(/^http:/i,"https:")),e.read(t.data,{origin:"service",url:e.parsedUrl}),10.1===e.version&&!S.isHostedAgolService(e.url))return w.fetchServerVersion(e.url).then(function(t){e.read({currentVersion:t})}).catch(function(){})})},t.prototype._getMapName=function(e){var t=e.match(/^(?:https?:)?\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return t&&t[2]},t.prototype._getDefaultAttribution=function(e){if(e){var t;e=e.toLowerCase();for(var r=0,n=_.length;r<n;r++)if((t=_[r]).toLowerCase().indexOf(e)>-1)return p.makeAbsolute("//static.arcgis.com/attribution/"+t)}},t.prototype._getDefaultTileServers=function(e){var t=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),r=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return t||r?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]},o([c.property({readOnly:!0,dependsOn:["parsedUrl"]})],t.prototype,"attributionDataUrl",null),o([c.property({readOnly:!0})],t.prototype,"operationalLayerType",null),o([c.property()],t.prototype,"popupTemplates",void 0),o([c.property({type:s.SpatialReference})],t.prototype,"spatialReference",void 0),o([c.reader("spatialReference",["spatialReference","tileInfo"])],t.prototype,"readSpatialReference",null),o([c.property()],t.prototype,"resourceInfo",void 0),o([c.property({readOnly:!0})],t.prototype,"sublayers",void 0),o([c.property({dependsOn:["parsedUrl"],readOnly:!0})],t.prototype,"tileServers",null),o([c.cast("tileServers")],t.prototype,"castTileServers",null),o([c.property({readOnly:!0,json:{read:!1}})],t.prototype,"type",void 0),o([c.property({json:{origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writer:p.writeOperationalLayerUrl}}}}})],t.prototype,"url",void 0),o([c.subclass("esri.layers.TileLayer")],t)}(c.declared(d,g.default,f,y,b,h,m,v))}.apply(null,n))||(e.exports=i)},695:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(364),r(336),r(436),r(452),r(732)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.copyright=null,t.minScale=0,t.maxScale=0,t.spatialReference=null,t.tileInfo=null,t.tilemapCache=null,t}return n(t,e),Object.defineProperty(t.prototype,"supportsBlankTile",{get:function(){return this.version>=10.2},enumerable:!0,configurable:!0}),t.prototype.readTileInfo=function(e,t){var r=function(e){return Math.round(1e4*e)/1e4},n=t.minScale?r(t.minScale):1/0,i=t.maxScale?r(t.maxScale):-1/0;return e?(e.lods=e.lods.filter(function(e){var t=r(e.scale);return t<=n&&t>=i}),l.fromJSON(e)):null},t.prototype.readTilemapCache=function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new u({layer:this}):null},i([a.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),i([a.property({json:{origins:{service:{read:!1}}}})],t.prototype,"minScale",void 0),i([a.property({json:{origins:{service:{read:!1}}}})],t.prototype,"maxScale",void 0),i([a.property({type:o.SpatialReference})],t.prototype,"spatialReference",void 0),i([a.property({readOnly:!0,dependsOn:["version"]})],t.prototype,"supportsBlankTile",null),i([a.property({type:l})],t.prototype,"tileInfo",void 0),i([a.reader("service","tileInfo",["tileInfo","minScale","maxScale"])],t.prototype,"readTileInfo",null),i([a.property()],t.prototype,"tilemapCache",void 0),i([a.reader("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),i([a.property()],t.prototype,"version",void 0),i([a.subclass("esri.layers.mixins.ArcGISCachedService")],t)}(a.declared(s))}.apply(null,n))||(e.exports=i)},701:function(e,t,r){var n,i;n=[r(351),r(338),r(354),r(458),r(586)],void 0===(i=function(e,t,r,n,i){var o={width:12,height:12,angle:0,xoffset:0,yoffset:0},a=e(n,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker",url:i.urlPropertyDefinition,source:i.sourcePropertyDefinition,height:{json:{read:{source:["height","size"],reader:function(e,t){return t.size||e}},write:!0},cast:r.toPt},width:{json:{read:{source:["width","size"],reader:function(e,t){return t.size||e}},write:!0},cast:r.toPt},size:{json:{write:!1}}},getDefaults:function(){return t.mixin(this.inherited(arguments),o)},normalizeCtorArgs:function(e,t,n){if(e&&"string"!=typeof e&&null==e.imageData)return e;var i={};return e&&(i.url=e),null!=t&&(i.width=r.toPt(t)),null!=n&&(i.height=r.toPt(n)),i},clone:function(){var e=new a({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",t.clone(this.source)),e}});return a.defaultProps=o,a}.apply(null,n))||(e.exports=i)},702:function(e,t,r){var n,i;n=[r(351),r(338),r(457),r(402)],void 0===(i=function(e,t,r,n){var i={style:"solid",outline:new n,color:[0,0,0,.25]},o=e(r,{declaredClass:"esri.symbols.SimpleFillSymbol",properties:{color:{},type:"simple-fill",style:{value:"solid",type:String,json:{read:function(e){return t.valueOf(this._styles,e)||void 0},write:function(e,t){t.style=this._styles[e]}}}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal","backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return t.mixin(this.inherited(arguments),i)},normalizeCtorArgs:function(e,t,r){if(e&&"string"!=typeof e)return e;var n={};return e&&(n.style=e),t&&(n.outline=t),r&&(n.color=r),n},clone:function(){return new o({color:t.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}});return t.mixin(o,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"}),o.defaultProps=i,o}.apply(null,n))||(e.exports=i)},704:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t){if(void 0===e&&(e=0),this.sizeOfFunction=function(){return 1},this._sizeOf=0,this._cache=new Map,this._queue=[],e<=0)throw new Error("LRU cache size must be bigger than zero!");this._maxSize=e,t&&(t.disposeFunction&&(this.disposeFunction=t.disposeFunction),t.sizeOfFunction&&(this.sizeOfFunction=t.sizeOfFunction))}return Object.defineProperty(e.prototype,"length",{get:function(){return this._cache.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._sizeOf},enumerable:!0,configurable:!0}),e.prototype.clear=function(){var e=this;this._queue.length=0,this.disposeFunction&&this._cache.forEach(function(t,r){e.disposeFunction(r,t)}),this._cache.clear(),this._sizeOf=0},e.prototype.delete=function(e){var t=this._cache.get(e);return!!this._cache.delete(e)&&(this._sizeOf-=this.sizeOfFunction(t),this._queue.splice(this._queue.indexOf(e),1),this.disposeFunction&&this.disposeFunction(e,t),!0)},e.prototype.forEach=function(e,t){this._cache.forEach(e,t)},e.prototype.get=function(e){var t=this._cache.get(e);if(void 0!==t)return this._queue.splice(this._queue.indexOf(e),1),this._queue.unshift(e),t},e.prototype.has=function(e){return this._cache.has(e)},e.prototype.set=function(e,t){var r=this.get(e);return void 0!==r?this._sizeOf-=this.sizeOfFunction(r):this._queue.unshift(e),this._sizeOf+=this.sizeOfFunction(t),this._cache.set(e,t),this._collect(),this},e.prototype._collect=function(){for(;this._queue.length&&this._sizeOf>this._maxSize;){var e=this._queue.pop(),t=this._cache.get(e);this._cache.delete(e)&&(this._sizeOf-=this.sizeOfFunction(t),this.disposeFunction&&this.disposeFunction(e,t))}},e}()}.apply(null,n))||(e.exports=i)},721:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(357),r(365),r(336)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(t){var r=e.call(this)||this;return r._handles=new o,r.root=null,r.refresh=r.refresh.bind(r),r.updateCollections=r.updateCollections.bind(r),r}return r(t,e),t.prototype.initialize=function(){var e=this;this._handles.add(this.rootCollectionNames.map(function(t){return e.watch("root."+t,e.updateCollections,!0)})),this.updateCollections()},t.prototype.destroy=function(){this.root=null,this.refresh(),this._handles.destroy(),this._handles=null},t.prototype.updateCollections=function(){var e=this;this._collections=this.rootCollectionNames.map(function(t){return e.get("root."+t)}).filter(function(e){return null!=e}),this.refresh()},t.prototype.refresh=function(){var e=this._handles;e.remove("collections"),this.removeAll();for(var t=this._collections.slice(),r=0,n=this._collections;r<n.length;r++){var i=n[r];this._processCollection(t,this,i)}for(var o=0,a=t;o<a.length;o++){var s=a[o];e.add(s.on("after-changes",this.refresh),"collections")}},t.prototype._createNewInstance=function(e){return new i(e)},t.prototype._processCollection=function(e,t,r){var n=this;r&&(e.push(r),r.forEach(function(r){r&&(t.push(r),n._processCollection(e,t,n.getChildrenFunction(r)))}))},n([a.property()],t.prototype,"rootCollectionNames",void 0),n([a.property()],t.prototype,"root",void 0),n([a.property()],t.prototype,"getChildrenFunction",void 0),n([a.subclass("esri.core.CollectionFlattener")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},730:function(e,t,r){var n={"./af":463,"./af.js":463,"./ar":464,"./ar-dz":465,"./ar-dz.js":465,"./ar-kw":466,"./ar-kw.js":466,"./ar-ly":467,"./ar-ly.js":467,"./ar-ma":468,"./ar-ma.js":468,"./ar-sa":469,"./ar-sa.js":469,"./ar-tn":470,"./ar-tn.js":470,"./ar.js":464,"./az":471,"./az.js":471,"./be":472,"./be.js":472,"./bg":473,"./bg.js":473,"./bm":474,"./bm.js":474,"./bn":475,"./bn.js":475,"./bo":476,"./bo.js":476,"./br":477,"./br.js":477,"./bs":478,"./bs.js":478,"./ca":479,"./ca.js":479,"./cs":480,"./cs.js":480,"./cv":481,"./cv.js":481,"./cy":482,"./cy.js":482,"./da":483,"./da.js":483,"./de":484,"./de-at":485,"./de-at.js":485,"./de-ch":486,"./de-ch.js":486,"./de.js":484,"./dv":487,"./dv.js":487,"./el":488,"./el.js":488,"./en-au":489,"./en-au.js":489,"./en-ca":490,"./en-ca.js":490,"./en-gb":491,"./en-gb.js":491,"./en-ie":492,"./en-ie.js":492,"./en-il":493,"./en-il.js":493,"./en-nz":494,"./en-nz.js":494,"./eo":495,"./eo.js":495,"./es":496,"./es-do":497,"./es-do.js":497,"./es-us":498,"./es-us.js":498,"./es.js":496,"./et":499,"./et.js":499,"./eu":500,"./eu.js":500,"./fa":501,"./fa.js":501,"./fi":502,"./fi.js":502,"./fo":503,"./fo.js":503,"./fr":504,"./fr-ca":505,"./fr-ca.js":505,"./fr-ch":506,"./fr-ch.js":506,"./fr.js":504,"./fy":507,"./fy.js":507,"./gd":508,"./gd.js":508,"./gl":509,"./gl.js":509,"./gom-latn":510,"./gom-latn.js":510,"./gu":511,"./gu.js":511,"./he":512,"./he.js":512,"./hi":513,"./hi.js":513,"./hr":514,"./hr.js":514,"./hu":515,"./hu.js":515,"./hy-am":516,"./hy-am.js":516,"./id":517,"./id.js":517,"./is":518,"./is.js":518,"./it":519,"./it.js":519,"./ja":520,"./ja.js":520,"./jv":521,"./jv.js":521,"./ka":522,"./ka.js":522,"./kk":523,"./kk.js":523,"./km":524,"./km.js":524,"./kn":525,"./kn.js":525,"./ko":526,"./ko.js":526,"./ky":527,"./ky.js":527,"./lb":528,"./lb.js":528,"./lo":529,"./lo.js":529,"./lt":530,"./lt.js":530,"./lv":531,"./lv.js":531,"./me":532,"./me.js":532,"./mi":533,"./mi.js":533,"./mk":534,"./mk.js":534,"./ml":535,"./ml.js":535,"./mn":536,"./mn.js":536,"./mr":537,"./mr.js":537,"./ms":538,"./ms-my":539,"./ms-my.js":539,"./ms.js":538,"./mt":540,"./mt.js":540,"./my":541,"./my.js":541,"./nb":542,"./nb.js":542,"./ne":543,"./ne.js":543,"./nl":544,"./nl-be":545,"./nl-be.js":545,"./nl.js":544,"./nn":546,"./nn.js":546,"./pa-in":547,"./pa-in.js":547,"./pl":548,"./pl.js":548,"./pt":549,"./pt-br":550,"./pt-br.js":550,"./pt.js":549,"./ro":551,"./ro.js":551,"./ru":552,"./ru.js":552,"./sd":553,"./sd.js":553,"./se":554,"./se.js":554,"./si":555,"./si.js":555,"./sk":556,"./sk.js":556,"./sl":557,"./sl.js":557,"./sq":558,"./sq.js":558,"./sr":559,"./sr-cyrl":560,"./sr-cyrl.js":560,"./sr.js":559,"./ss":561,"./ss.js":561,"./sv":562,"./sv.js":562,"./sw":563,"./sw.js":563,"./ta":564,"./ta.js":564,"./te":565,"./te.js":565,"./tet":566,"./tet.js":566,"./tg":567,"./tg.js":567,"./th":568,"./th.js":568,"./tl-ph":569,"./tl-ph.js":569,"./tlh":570,"./tlh.js":570,"./tr":571,"./tr.js":571,"./tzl":572,"./tzl.js":572,"./tzm":573,"./tzm-latn":574,"./tzm-latn.js":574,"./tzm.js":573,"./ug-cn":575,"./ug-cn.js":575,"./uk":576,"./uk.js":576,"./ur":577,"./ur.js":577,"./uz":578,"./uz-latn":579,"./uz-latn.js":579,"./uz.js":578,"./vi":580,"./vi.js":580,"./x-pseudo":581,"./x-pseudo.js":581,"./yo":582,"./yo.js":582,"./zh-cn":583,"./zh-cn.js":583,"./zh-hk":584,"./zh-hk.js":584,"./zh-tw":585,"./zh-tw.js":585};function i(e){var t=o(e);return r(t)}function o(e){var t=n[e];if(!(t+1)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return t}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=730},732:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(434),r(350),r(346),r(341),r(365),r(343),r(704),r(407),r(339),r(377),r(336),r(803)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h,m){var v=p.getLogger("esri.layers.support.TilemapCache");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new u,r._pendingTilemapRequests={},r._availableLevels={},r.levels=5,r.cacheByteSize=2097152,r.request=a,r}var s;return n(t,e),s=t,t.prototype.initialize=function(){var e=this;this._tilemapCache=new c(this.cacheByteSize,{sizeOfFunction:function(e){return e.byteSize}}),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],function(){return e._initializeTilemapDefinition()}),f.init(this,"layer.tileInfo.lods",function(t){return e._initializeAvailableLevels(t)},!0)]),this._initializeTilemapDefinition()},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},t.prototype.castLevels=function(e){return e<=2?(v.error("Minimum levels for Tilemap is 3, but got ",e),3):e},Object.defineProperty(t.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0}),t.prototype.getTilemap=function(e,t,r){return this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition)},t.prototype.fetchTilemap=function(e,t,r,n){var i=this;if(!this._availableLevels[e])return y.reject(new l("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"));var o=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,r,o);if(a)return y.resolve(a);var s=m.tilemapDefinitionId(o),u=this._pendingTilemapRequests[s];return u||(u=m.Tilemap.fromDefinition(o,n).then(function(e){return i._tilemapCache.set(s,e),delete i._pendingTilemapRequests[s],e}).catch(function(e){return delete i._pendingTilemapRequests[s],y.reject(e)}),this._pendingTilemapRequests[s]=u),y.create(function(e,t){u.then(e,t)})},t.prototype.getAvailability=function(e,t,r){if(!this._availableLevels[e])return"unavailable";var n=this.getTilemap(e,t,r);return n?n.getAvailability(t,r):"unknown"},t.prototype.getAvailabilityUpsample=function(e,t,r,n){n.level=e,n.row=t,n.col=r;var i=this.layer.tileInfo;for(i.updateTileInfo(n);;){var o=this.getAvailability(n.level,n.row,n.col);if("unavailable"!==o)return o;if(!i.upsampleTile(n))return"unavailable"}},t.prototype.fetchAvailability=function(e,t,r,n){return this._availableLevels[e]?this.fetchTilemap(e,t,r,n).always(function(n){if(n instanceof m.Tilemap){var i=n.getAvailability(t,r);return"unavailable"===i?y.reject(new l("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):i}return n&&"cancel"===n.dojoType?y.reject(n):"unknown"}):y.reject(new l("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"))},t.prototype.fetchAvailabilityUpsample=function(e,t,r,n,i){var o=this;n.level=e,n.row=t,n.col=r;var a=this.layer.tileInfo;a.updateTileInfo(n);for(var l=this.fetchAvailability(e,t,r,i).catch(function(e){return e&&"cancel"===e.dojoType?y.reject(e):a.upsampleTile(n)?o.fetchAvailabilityUpsample(n.level,n.row,n.col,n):y.reject(e)}),u={id:n.id,level:e,row:t,col:r},p=this,c=0;s._prefetches.length<s._maxPrefetch&&a.upsampleTile(u);++c)!function(e){var t=p.fetchAvailability(u.level,u.row,u.col,i);s._prefetches.push(t),l.always(function(){return t.cancel()}),t.always(function(){return s._prefetches.removeUnordered(t)})}();return l},t.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;t&&t.token||!this.layer.token||(t=r({},t,{token:this.layer.token})),this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?o.objectToQuery(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}},t.prototype._tilemapFromCache=function(e,t,r,n){var i=this._getTilemapDefinition(e,t,r,n),o=m.tilemapDefinitionId(i);return this._tilemapCache.get(o)},t.prototype._getTilemapDefinition=function(e,t,r,n){return n.level=e,n.row=t-t%this.size,n.col=r-r%this.size,n},t.prototype._initializeAvailableLevels=function(e){var t=this;this._availableLevels={},e&&e.forEach(function(e){return t._availableLevels[e.level]=!0})},t._maxPrefetch=4,t._prefetches=new d({initialSize:s._maxPrefetch}),i([h.property({constructOnly:!0,type:Number})],t.prototype,"levels",void 0),i([h.cast("levels")],t.prototype,"castLevels",null),i([h.property({readOnly:!0,dependsOn:["levels"],type:Number})],t.prototype,"size",null),i([h.property({constructOnly:!0,type:Number})],t.prototype,"cacheByteSize",void 0),i([h.property({constructOnly:!0})],t.prototype,"layer",void 0),i([h.property({constructOnly:!0})],t.prototype,"request",void 0),s=i([h.subclass("esri.layers.support.TilemapCache")],t)}(h.declared(s))}.apply(null,n))||(e.exports=i)},751:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(339)],void 0===(i=function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.layerLookupMap={CSVLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(22)]).then(function(){var t=[r(911)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ElevationLayer:function(){return n.create(function(e){return r.e(35).then(function(){var t=[r(703)];e.apply(null,t)}.bind(this)).catch(r.oe)})},FeatureLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(25)]).then(function(){var t=[r(331)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GroupLayer:function(){return n.create(function(e){return r.e(17).then(function(){var t=[r(714)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GeoRSSLayer:function(){return n.create(function(e){return r.e(36).then(function(){var t=[r(912)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ImageryLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(26),r.e(48)]).then(function(){var t=[r(908)];e.apply(null,t)}.bind(this)).catch(r.oe)})},KMLLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(14),r.e(31),r.e(49)]).then(function(){var t=[r(913)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapImageLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(21)]).then(function(){var t=[r(909)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapNotesLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(73)]).then(function(){var t=[r(1035)];e.apply(null,t)}.bind(this)).catch(r.oe)})},OpenStreetMapLayer:function(){return n.create(function(e){return r.e(39).then(function(){var t=[r(914)];e.apply(null,t)}.bind(this)).catch(r.oe)})},PointCloudLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(28),r.e(50)]).then(function(){var t=[r(915)];e.apply(null,t)}.bind(this)).catch(r.oe)})},SceneLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(23)]).then(function(){var t=[r(795)];e.apply(null,t)}.bind(this)).catch(r.oe)})},IntegratedMeshLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(43)]).then(function(){var t=[r(763)];e.apply(null,t)}.bind(this)).catch(r.oe)})},StreamLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(24)]).then(function(){var t=[r(910)];e.apply(null,t)}.bind(this)).catch(r.oe)})},TileLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(3),r.e(2),r.e(71)]).then(function(){var t=[r(691)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnknownLayer:function(){return n.create(function(e){return r.e(100).then(function(){var t=[r(1036)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnsupportedLayer:function(){return n.create(function(e){return r.e(101).then(function(){var t=[r(1037)];e.apply(null,t)}.bind(this)).catch(r.oe)})},VectorTileLayer:function(){return n.create(function(e){return Promise.all([r.e(16),r.e(37)]).then(function(){var t=[r(736)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WebTileLayer:function(){return n.create(function(e){return r.e(40).then(function(){var t=[r(796)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMSLayer:function(){return n.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(34),r.e(51)]).then(function(){var t=[r(916)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMTSLayer:function(){return n.create(function(e){return r.e(87).then(function(){var t=[r(1038)];e.apply(null,t)}.bind(this)).catch(r.oe)})},BingMapsLayer:function(){return n.create(function(e){return r.e(10).then(function(){var t=[r(772)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}}.apply(null,n))||(e.exports=i)},782:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(693),r(350),r(341),r(339),r(394),r(394),r(751)],void 0===(i=function(e,t,n,i,o,a,s,l,u,p){function c(e){return(0,p.layerLookupMap[e])()}function d(e){return o(e,{responseType:"json",query:{f:"json"}}).then(function(e){return e.data})}Object.defineProperty(t,"__esModule",{value:!0}),t.fromUrl=function(e){return function(e){var t=u.parse(e);if(!t)return s.reject(new a("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e}));var r,n=t.serverType,o=t.sublayer;switch(n){case"MapServer":r=null!=o?"FeatureLayer":function(e){return d(e).then(function(e){return e.tileInfo})}(e).then(function(e){return e?"TileLayer":"MapImageLayer"});break;case"ImageServer":r=d(e).then(function(e){var t=e.tileInfo&&e.tileInfo.format;return e.tileInfo?t&&"LERC"===t.toUpperCase()&&e.cacheType&&"elevation"===e.cacheType.toLowerCase()?"ElevationLayer":"TileLayer":"ImageryLayer"});break;case"SceneServer":r=d(t.url.path).then(function(e){var t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer"};if(e&&Array.isArray(e.layers)&&e.layers.length>0){var r=e.layers[0].layerType;if(null!=t[r])return t[r]}return"SceneLayer"});break;default:r={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"}[n]}var l,p={FeatureLayer:!0,SceneLayer:!0},y={parsedUrl:t,Constructor:null,sublayerIds:null};return i(r).then(function(t){if(l=t,p[t]&&null==o)return function(e){return d(e).then(function(e){return e&&Array.isArray(e.layers)?e.layers.map(function(e){return e.id}).reverse():[]})}(e).then(function(e){1!==e.length&&(y.sublayerIds=e)})}).then(function(){return c(l)}).then(function(e){return y.Constructor=e,y})}(e.url).then(function(t){var i=function(e,t){var r=e.Constructor.prototype.declaredClass;return"esri.layers.FeatureLayer"===r||"esri.layers.StreamLayer"===r?n({outFields:["*"]},t):t}(t,n({},e.properties,{url:e.url}));return t.sublayerIds?s.create(function(e){return r.e(17).then(function(){var t=[r(714)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(e){var r=new e({title:t.parsedUrl.title});return function(e,t){return e.sublayerIds.map(function(r){return new e.Constructor(n({},t,{layerId:r,sublayerTitleMode:"service-name"}))})}(t,i).forEach(function(e){return r.add(e)}),s.resolve(r)}):s.resolve(new t.Constructor(i))})},t.fetchServerVersion=function(e){if(!l.test(e))return s.reject();var t=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return o(t,{query:{f:"json"},responseType:"json"}).then(function(e){return e.data&&e.data.currentVersion?e.data.currentVersion:s.reject()})}}.apply(null,n))||(e.exports=i)},794:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(459)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isExportDynamic=function(e,t,n){return!!e.some(function(e){var t=e.source;return!(!t||t.type===r.MAPLAYER&&t.mapLayerId===e.id&&(!t.gdbVersion||t.gdbVersion===n.gdbVersion))||null!=e.renderer||null!=e.labelingInfo||e.hasOwnProperty("opacity")&&null!=e.opacity||e.hasOwnProperty("labelsVisible")&&null!=e.labelsVisible})||!function(e,t){if(!e||!e.length)return!0;var r=[];if(t.forEach(function e(t){var n=t.id,i=t.sublayers;r.unshift(n),i&&i.forEach(e)}),e.length>r.length)return!1;for(var n=0,i=r.length,o=0,a=e;o<a.length;o++){for(var s=a[o].id;n<i&&r[n]!==s;)n++;if(n>=i)return!1}return!0}(e,t)},t.sameStructureAsService=function(e,t){return t.flatten(function(e){var t=e.sublayers;return t&&t.toArray().reverse()}).toArray().reverse().every(function(t,r){var n=e[r];return n&&t.id===n.id&&(null==t.sublayers&&null==n.sublayers||null!=t.sublayers&&null!=n.sublayers&&t.sublayers.map(function(e){return e.id}).join(",")===n.sublayers.map(function(e){return e.id}).join(","))})}}.apply(null,n))||(e.exports=i)},803:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(350),r(341),r(338),r(339)],void 0===(i=function(e,t,r,n,i,o,a){function s(e){var t;if("vector-tile"===e.service.type)t=e.service.url+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height;else{var r=e.service.tileServers;t=(r&&r.length?r[e.row%r.length]:e.service.url)+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height}var n=e.service.query;return n&&(t=t+"?"+n),t}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this.location={left:0,top:0,width:0,height:0},this.byteSize=40}return e.prototype.getAvailability=function(e,t){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%8,i=r>>3,o=this._tileAvailabilityBitSet;return i<0||i>o.length?"unknown":o[i]&1<<n?"available":"unavailable"},e.prototype._updateFromData=function(e){for(var t=this.location.width,r=this.location.height,n=!0,i=!0,o=Math.ceil(t*r/8),a=new Uint8Array(o),s=0,l=0;l<e.length;l++){var u=l%8;e[l]?(i=!1,a[s]|=1<<u):n=!1,7===u&&++s}this._isAllUnvailable=i,this._isAllAvailable=n,this._isAllAvailable||this._isAllUnvailable||(this._tileAvailabilityBitSet=a,this.byteSize+=a.length)},e.fromDefinition=function(t,o){var l=t.service.request||n,u=t.row,p=t.col,c=t.width,d=t.height,y={query:{f:"json"}};return o=o?r({},y,o):y,l(s(t),o).then(function(e){return e.data}).catch(function(e){return e&&e.details&&422===e.details.httpStatus?{location:{top:u,left:p,width:c,height:d},valid:!0,data:function(){for(var e=[],t=0,r=c*d;t<r;t++)e[t]=0;return e}()}:a.reject(e)}).then(function(t){if(t.location&&(t.location.top!==u||t.location.left!==p||t.location.width!==c||t.location.height!==d))throw new i("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:u,left:p,width:c,height:d}});return e.fromJSON(t)})},e.fromJSON=function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze(o.clone(t.location)),r._updateFromData(t.data),Object.freeze(r)},e.validateJSON=function(e){if(!e||!e.location)throw new i("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new i("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new i("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new i("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new i("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")},e}();t.Tilemap=l,t.tilemapDefinitionId=function(e){return e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height},t.tilemapDefinitionUrl=s,t.default=l}.apply(null,n))||(e.exports=i)},865:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(336),r(363),r(362),r(436),r(429)],void 0===(i=function(e,t,r,n,i,o,a,s,l){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.capabilities=void 0,t.copyright=null,t.fullExtent=null,t.legendEnabled=!0,t.spatialReference=null,t.version=null,t}return r(t,e),t.prototype.readCapabilities=function(e,t){var r=t.capabilities&&t.capabilities.split(",").map(function(e){return e.toLowerCase().trim()});if(!r)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var n=this.type,i=-1!==r.indexOf("query"),o=-1!==r.indexOf("map"),a=!!t.exportTilesAllowed,s=-1!==r.indexOf("tilemap"),l="tile"!==n&&!!t.supportsDynamicLayers,u="tile"!==n&&(!t.tileInfo||l),p="tile"!==n&&(!t.tileInfo||l);return{operations:{supportsQuery:i,supportsExportMap:o,supportsExportTiles:a,supportsTileMap:s},exportMap:o?{supportsSublayersChanges:"tile"!==n,supportsDynamicLayers:l,supportsSublayerVisibility:u,supportsSublayerDefinitionExpression:p}:null,exportTiles:a?{maxExportTilesCount:+t.maxExportTilesCount}:null}},t.prototype.readVersion=function(e,t){var r=t.currentVersion;return r||(r=t.hasOwnProperty("capabilities")||t.hasOwnProperty("tables")?10:t.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),r},n([i.property({readOnly:!0})],t.prototype,"capabilities",void 0),n([i.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),n([i.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),n([i.property({type:o})],t.prototype,"fullExtent",void 0),n([i.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),n([i.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),n([i.property(l.popupEnabled)],t.prototype,"popupEnabled",void 0),n([i.property({type:a})],t.prototype,"spatialReference",void 0),n([i.property()],t.prototype,"version",void 0),n([i.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),n([i.subclass("esri.layers.mixins.ArcGISMapService")],t)}(i.declared(s))}.apply(null,n))||(e.exports=i)},866:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(344),r(337),r(335),r(346),r(357),r(721),r(341),r(338),r(343),r(336),r(360),r(461),r(867),r(794)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h){function m(e,t,r){var n=[],i={};return e.forEach(function(e){var o=new f;if(o.read(e,t),r&&(-1===r.indexOf(o.id)?o.visible=!1:o.visible=!0),i[o.id]=o,null!=e.parentLayerId&&-1!==e.parentLayerId){var a=i[e.parentLayerId];a.sublayers||(a.sublayers=[]),a.sublayers.unshift(o)}else n.unshift(o)}),n}function v(e){return e.__accessor__.store._values}function b(e){return e.__accessor__.overridden}Object.defineProperty(t,"__esModule",{value:!0});var g=p.getLogger("esri.layers.TileLayer"),w=function(e){function t(){var t=e.call(this)||this;return t.allSublayers=new s({root:t,rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return e.sublayers}}),t.watch("sublayers",function(e,r){return t._handleSublayersChange(e,r)},!0),t}return n(t,e),t.prototype.readServiceSublayers=function(e,t,r){return m(t.layers,r)},t.prototype.readSublayersFromItemOrWebMap=function(e,t,r){return!t.layers&&t.visibleLayers?t.visibleLayers.map(function(e){return{id:e}}):m(t.layers,r,t.visibleLayers)},t.prototype.readSublayers=function(e,t,r){var n=m(t.layers,r);return this._updateSublayersForOrigin(y.OriginId.PORTAL_ITEM,n),this._updateSublayersForOrigin(y.OriginId.WEB_MAP,n),this._updateSublayersForOrigin(y.OriginId.WEB_SCENE,n),n},t.prototype.writeSublayers=function(e,t,n,i){var o=e.flatten(function(e){var t=e.sublayers;return t&&t.toArray().reverse()}).toArray().reverse(),a=this.serviceSublayers.flatten(function(e){var t=e.sublayers;return t&&t.toArray().reverse()}).toArray().reduce(function(e,t){return e.set(t.id,t),e},new Map),s=!1,l=!0;this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers?(s=h.isExportDynamic(o,this.serviceSublayers,this),l=!s&&h.sameStructureAsService(o,this.serviceSublayers)):l=h.sameStructureAsService(o,this.serviceSublayers),t.layers=[],o.forEach(function(e){var n=a.get(e.id),o=r({writeAsDynamic:s,writeOverridesOnly:l,serviceSublayer:n},i),u=e.write({},o);(!l||l&&Object.keys(u).length>1)&&t.layers.push(u)}),t.visibleLayers=o.filter(function(e){return e.visible}).map(function(e){return e.id})},t.prototype.findSublayerById=function(e){return this.allSublayers.find(function(t){return t.id===e})},t.prototype.createServiceSublayers=function(){return this.serviceSublayers.map(function(e){return e.clone()})},t.prototype._updateSublayersForOrigin=function(e,t){var r=this.__accessor__.store;if(r.has("sublayers",e)){var n=r.get("sublayers",e).flatten(function(e){return e.sublayers});if(n.every(function(e){return!v(e).hasOwnProperty("minScale")})){var i=n.reduce(function(e,t){return e.set(t.id,t),e},new Map),o=t.map(function(e){return function e(t,r){var n=r.get(t.id);return n?(u.mixin(v(t),v(n)),b(n)&&(t.__accessor__.overridden=u.mixin(b(t)||{},b(n))),n.sublayers&&(t.sublayers=n.sublayers.map(function(t){return e(t,r)}))):t.sublayers&&t.sublayers.forEach(function(t){return e(t,r)}),t}(e.clone(),i)});r.set("sublayers",new(a.ofType(f))(o),e)}}},t.prototype._handleSublayersChange=function(e,t){var r=this;t&&(t.forEach(function(e){e.parent=null,e.layer=null}),this._sublayersHandles.forEach(function(e){return e.remove()}),this._sublayersHandles=null),e&&(e.forEach(function(e){e.parent=r,e.layer=r}),this._sublayersHandles=[e.on("after-add",function(e){var t=e.item;t.parent=r,t.layer=r}),e.on("after-remove",function(e){var t=e.item;t.parent=null,t.layer=null})],"tile"===this.type&&this._sublayersHandles.push(e.on("before-changes",function(e){g.error(new l("tilelayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:r})),e.preventDefault()})))},i([c.property({readOnly:!0})],t.prototype,"allSublayers",void 0),i([c.property({readOnly:!0,type:a.ofType(f)})],t.prototype,"serviceSublayers",void 0),i([c.reader("service","serviceSublayers",["layers"])],t.prototype,"readServiceSublayers",null),i([c.property({value:null,type:a.ofType(f),json:{type:[Number],write:{target:"subLayerIds",allowNull:!0}}})],t.prototype,"sublayers",void 0),i([c.reader(["web-map","web-scene","portal-item"],"sublayers",["layers","visibleLayers"])],t.prototype,"readSublayersFromItemOrWebMap",null),i([c.reader("service","sublayers",["layers"])],t.prototype,"readSublayers",null),i([c.writer(["web-map","web-scene","portal-item"],"sublayers",{layers:{type:[f]},visibleLayers:{type:[d.Integer]}})],t.prototype,"writeSublayers",null),i([c.subclass("esri.layers.mixins.SublayersOwner")],t)}(c.declared(o));t.default=w}.apply(null,n))||(e.exports=i)},867:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(337),r(335),r(388),r(434),r(669),r(357),r(341),r(340),r(338),r(343),r(336),r(360),r(619),r(331),r(429),r(427),r(459),r(423),r(615),r(756),r(647),r(419)],void 0===(i=function(e,t,r,n,i,o,a,s,l,u,p,c,d,y,f,h,m,v,b,g,w,S,_,j){var O=c.getLogger("esri.layers.support.Sublayer"),x=0;return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._sublayersHandles=null,t}var u;return r(t,e),u=t,Object.defineProperty(t.prototype,"definitionExpression",{get:function(){return this._get("definitionExpression")},set:function(e){this._setAndNotifyLayer("definitionExpression",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var e=this._get("id");return null==e?x++:e},set:function(e){if(this._get("id")!==e)return!1===this.get("layer.capabilities.exportMap.supportsDynamicLayers")?void this._logLockedError("id"):void this._set("id",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelingInfo",{get:function(){return this._get("labelingInfo")},set:function(e){this._setAndNotifyLayer("labelingInfo",e)},enumerable:!0,configurable:!0}),t.prototype.writeLabelingInfo=function(e,t,r,n){n&&!n.writeAsDynamic||e&&e.length&&(t.layerDefinition={drawingInfo:{labelingInfo:e.map(function(e){return e.write({},n)})}})},Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return this._get("labelsVisible")},set:function(e){this._setAndNotifyLayer("labelsVisible",e)},enumerable:!0,configurable:!0}),t.prototype.writeLabelsVisible=function(e,t,r,n){n&&!n.writeAsDynamic||(t.showLabels=e)},Object.defineProperty(t.prototype,"layer",{set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(function(t){return t.layer=e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"legendEnabled",{get:function(){return this._get("legendEnabled")},set:function(e){this._set("legendEnabled",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minScale",{get:function(){return this._get("minScale")},set:function(e){this._setAndNotifyLayer("minScale",e)},enumerable:!0,configurable:!0}),t.prototype.readMinScale=function(e,t){return t.minScale||t.layerDefinition&&t.layerDefinition.minScale||0},t.prototype.writeMinScale=function(e,t,r,n){if(n&&n.writeOverridesOnly){var i=n&&n.serviceSublayer;if(i&&i.minScale===e&&i.maxScale===this.maxScale)return}t.minScale=e},Object.defineProperty(t.prototype,"maxScale",{get:function(){return this._get("maxScale")},set:function(e){this._setAndNotifyLayer("maxScale",e)},enumerable:!0,configurable:!0}),t.prototype.readMaxScale=function(e,t){return t.maxScale||t.layerDefinition&&t.layerDefinition.maxScale||0},t.prototype.writeMaxScale=function(e,t,r,n){if(n&&n.writeOverridesOnly){var i=n&&n.serviceSublayer;if(i&&i.maxScale===e&&i.minScale===this.minScale)return}t.maxScale=e},Object.defineProperty(t.prototype,"opacity",{get:function(){return this._get("opacity")},set:function(e){this._setAndNotifyLayer("opacity",e)},enumerable:!0,configurable:!0}),t.prototype.readOpacity=function(e,t){var r=t.layerDefinition;return 1-.01*(null!=r.transparency?r.transparency:r.drawingInfo.transparency)},t.prototype.writeOpacity=function(e,t,r,n){n&&!n.writeAsDynamic||(t.layerDefinition={drawingInfo:{transparency:100-100*e}})},t.prototype.writeParent=function(e,t,r,n){n&&n.writeOverridesOnly||(this.parent&&this.parent!==this.layer?t.parentLayerId=this.parent.id:t.parentLayerId=-1)},Object.defineProperty(t.prototype,"popupEnabled",{get:function(){return this._get("popupEnabled")},set:function(e){this._set("popupEnabled",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popupTemplate",{get:function(){return this._get("popupTemplate")},set:function(e){this._set("popupTemplate",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this._get("renderer")},set:function(e){if(e)for(var t=0,r=e.getSymbols();t<r.length;t++){if(r[t].isInstanceOf(S)){O.warn("Sublayer renderer should use 2D symbols");break}}this._setAndNotifyLayer("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){return(e=t.layerDefinition.drawingInfo.renderer||void 0)&&((e=g.read(e,t,r)||void 0)||O.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r})),e},t.prototype.writeRenderer=function(e,t,r,n){n&&!n.writeAsDynamic||(t.layerDefinition={drawingInfo:{renderer:e.toJSON()}})},Object.defineProperty(t.prototype,"source",{get:function(){return this._get("source")||{mapLayerId:this.id,type:b.MAPLAYER}},set:function(e){this._setAndNotifyLayer("source",e)},enumerable:!0,configurable:!0}),t.prototype.writeSource=function(e,t,r,n){n&&!n.writeAsDynamic&&n.writeOverridesOnly||(t.layerDefinition={source:b.sourceToJSON(e)})},Object.defineProperty(t.prototype,"sublayers",{set:function(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)},enumerable:!0,configurable:!0}),t.prototype.castSublayers=function(e){return y.default(s.ofType(u),e)},t.prototype.writeSublayers=function(e,t,r,n){n&&n.writeOverridesOnly||(t[r]=this.get("sublayers.length")?this.sublayers.map(function(e){return e.id}).toArray().reverse():null)},Object.defineProperty(t.prototype,"title",{get:function(){return this._get("title")},set:function(e){this._set("title",e)},enumerable:!0,configurable:!0}),t.prototype.writeTitle=function(e,t,r,n){if(n&&n.writeOverridesOnly){var i=n&&n.serviceSublayer;if(i&&i.title===e)return}t[r]=e},Object.defineProperty(t.prototype,"url",{get:function(){var e=this.layer,t=this.source;if(!e)return null;if(b.isMapLayerSource(t))return e.parsedUrl.path+"/"+t.mapLayerId;var r={layer:JSON.stringify({source:b.sourceToJSON(this.source)})};return e.parsedUrl.path+"/dynamicLayer?"+o.objectToQuery(r)},set:function(e){e?this._override("url",e):this._clearOverride("url")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._get("visible")},set:function(e){this._setAndNotifyLayer("visible",e)},enumerable:!0,configurable:!0}),t.prototype.writeVisible=function(e,t,r,n){if(n&&n.writeOverridesOnly){var i=n&&n.serviceSublayer;if(i&&i.visible===e)return}t[r]=e},t.prototype.clone=function(){var e=new u;return this.hasOwnProperty("definitionExpression")&&(e.definitionExpression=this.definitionExpression),this.hasOwnProperty("id")&&(e.id=this.id),this.hasOwnProperty("labelingInfo")&&(e.labelingInfo=p.clone(this.labelingInfo)),this.hasOwnProperty("labelsVisible")&&(e.labelsVisible=this.labelsVisible),this.hasOwnProperty("legendEnabled")&&(e.legendEnabled=this.legendEnabled),this.hasOwnProperty("visible")&&(e.visible=this.visible),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("minScale")&&(e.minScale=this.minScale),this.hasOwnProperty("maxScale")&&(e.maxScale=this.maxScale),this.hasOwnProperty("opacity")&&(e.opacity=this.opacity),this.hasOwnProperty("parent")&&(e.parent=this.parent),this.hasOwnProperty("popupEnabled")&&(e.popupEnabled=this.popupEnabled),this.hasOwnProperty("popupTemplate")&&(e.popupTemplate=this.popupTemplate?this.popupTemplate.clone():this.popupTemplate),this.hasOwnProperty("renderer")&&(e.renderer=this.renderer?this.renderer.clone():this.renderer),this.hasOwnProperty("source")&&(e.source=p.clone(this.source)),this.hasOwnProperty("sublayers")&&(e.sublayers=this.sublayers?this.sublayers.clone():this.sublayers),this.hasOwnProperty("title")&&(e.title=this.title),e},t.prototype.createQuery=function(){return new j({returnGeometry:!0,where:this.definitionExpression||"1=1"})},t.prototype.createFeatureLayer=function(){if(this.hasOwnProperty("sublayers"))return null;var e=this.layer&&this.layer.parsedUrl,t=this.source,r=null;e&&(r=b.isMapLayerSource(t)?e.path+"/"+t.mapLayerId:e.path+"/dynamicLayer");var n=new h({url:r});return this.hasOwnProperty("definitionExpression")&&(n.definitionExpression=this.definitionExpression),this.hasOwnProperty("labelingInfo")&&(n.labelingInfo=p.clone(this.labelingInfo)),this.hasOwnProperty("labelsVisible")&&(n.labelsVisible=this.labelsVisible),this.hasOwnProperty("legendEnabled")&&(n.legendEnabled=this.legendEnabled),this.hasOwnProperty("visible")&&(n.visible=this.visible),this.hasOwnProperty("minScale")&&(n.minScale=this.minScale),this.hasOwnProperty("maxScale")&&(n.maxScale=this.maxScale),this.hasOwnProperty("opacity")&&(n.opacity=this.opacity),this.hasOwnProperty("popupTemplate")&&(n.popupTemplate=this.popupTemplate?this.popupTemplate.clone():this.popupTemplate),this.hasOwnProperty("renderer")&&(n.renderer=this.renderer?this.renderer.clone():this.renderer),this.hasOwnProperty("source")&&b.isDataLayerSource(this.source)&&(n.dynamicDataSource=p.clone(this.source)),this.hasOwnProperty("title")&&(n.title=this.title),n},t.prototype.queryFeatures=function(e){var t=this;return void 0===e&&(e=this.createQuery()),new _({url:this.url}).execute(e).then(function(e){return e&&e.features&&e.features.forEach(function(e){e.sourceLayer=t}),e})},t.prototype.toExportImageJSON=function(){var e={id:this.id,source:b.sourceToJSON(this.source)};if(this.definitionExpression&&(e.definitionExpression=this.definitionExpression),this.renderer||this.labelingInfo||null!=this.opacity||null!=this.labelsVisible){var t=e.drawingInfo={};this.renderer&&(t.renderer=this.renderer.toJSON()),null!=this.labelsVisible&&(t.showLabels=this.labelsVisible),!1!==this.labelsVisible&&this.labelingInfo&&(t.labelingInfo=this.labelingInfo.map(function(e){return e.write({},{origin:"service"})}),t.showLabels=!0),null!=this.opacity&&(t.transparency=100-100*this.opacity)}return e},t.prototype._setAndNotifyLayer=function(e,t){var r,n=this.layer,i=this._get(e);switch(e){case"definitionExpression":r="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":r="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":r="supportsDynamicLayers"}r&&!1===this.get("layer.capabilities.exportMap."+r)?this._logLockedError(e):(this._set(e,t),i!==t&&n&&n.emit&&n.emit("sublayer-update",{propertyName:e}))},t.prototype._handleSublayersChange=function(e,t){var r=this;t&&(t.forEach(function(e){e.parent=null,e.layer=null}),this._sublayersHandles.forEach(function(e){return e.remove()}),this._sublayersHandles=null),e&&(e.forEach(function(e){e.parent=r,e.layer=r.layer}),this._sublayersHandles=[e.on("after-add",function(e){var t=e.item;t.parent=r,t.layer=r.layer}),e.on("after-remove",function(e){var t=e.item;t.parent=null,t.layer=null}),e.on("before-changes",function(e){var t=r.get("layer.capabilities.exportMap.supportsSublayersChanges");null==t||t||(O.error(new l("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:r})),e.preventDefault())})])},t.prototype._logLockedError=function(e){O.error(new l("sublayer:locked","Property '"+e+"' can't be changed on Sublayer from the layer '"+this.layer.id+"'",{sublayer:this,layer:this.layer}))},n([d.property({type:String,value:null,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",null),n([d.property({type:Number,json:{write:{ignoreOrigin:!0}}})],t.prototype,"id",null),n([d.property({value:null,type:[v],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",null),n([d.writer("labelingInfo")],t.prototype,"writeLabelingInfo",null),n([d.property({type:Boolean,json:{read:{source:"showLabels"},write:{target:"showLabels"}}})],t.prototype,"labelsVisible",null),n([d.writer("labelsVisible")],t.prototype,"writeLabelsVisible",null),n([d.property({value:null})],t.prototype,"layer",null),n([d.property({type:Boolean,value:!0,json:{read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",null),n([d.property({type:Number,value:0,json:{write:{overridePolicy:function(e,t,r){if(f.willPropertyWrite(this,"maxScale",{},r))return{ignoreOrigin:!0}}}}})],t.prototype,"minScale",null),n([d.reader("portal-item","minScale",["minScale","layerDefinition.minScale"])],t.prototype,"readMinScale",null),n([d.writer("minScale")],t.prototype,"writeMinScale",null),n([d.property({type:Number,value:0,json:{write:{overridePolicy:function(e,t,r){if(f.willPropertyWrite(this,"minScale",{},r))return{ignoreOrigin:!0}}}}})],t.prototype,"maxScale",null),n([d.reader("portal-item","maxScale",["maxScale","layerDefinition.maxScale"])],t.prototype,"readMaxScale",null),n([d.writer("maxScale")],t.prototype,"writeMaxScale",null),n([d.property({type:Number,json:{write:{target:"layerDefinition.drawingInfo.transparency"}}})],t.prototype,"opacity",null),n([d.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],t.prototype,"readOpacity",null),n([d.writer("opacity")],t.prototype,"writeOpacity",null),n([d.property({json:{type:Number,write:{target:"parentLayerId",allowNull:!0}}})],t.prototype,"parent",void 0),n([d.writer("parent")],t.prototype,"writeParent",null),n([d.property(m.popupEnabled)],t.prototype,"popupEnabled",null),n([d.property({value:null,type:a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",null),n([d.property({types:w.types,value:null,json:{write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",null),n([d.reader("renderer",["layerDefinition.drawingInfo.renderer"])],t.prototype,"readRenderer",null),n([d.writer("renderer")],t.prototype,"writeRenderer",null),n([d.property({cast:b.castSource,json:{read:{source:"layerDefinition.source",reader:b.sourceFromJSON},write:{target:"layerDefinition.source"}}})],t.prototype,"source",null),n([d.writer("source")],t.prototype,"writeSource",null),n([d.property({value:null,json:{type:[y.Integer],write:{target:"subLayerIds",allowNull:!0}}})],t.prototype,"sublayers",null),n([d.cast("sublayers")],t.prototype,"castSublayers",null),n([d.writer("sublayers")],t.prototype,"writeSublayers",null),n([d.property({type:String,value:null,json:{read:{source:"name"},write:{target:"name",allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"title",null),n([d.writer("title")],t.prototype,"writeTitle",null),n([d.property({type:String,dependsOn:["layer","source"],json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:function(){return{enabled:this._isOverridden("url")}}}}})],t.prototype,"url",null),n([d.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility"}}})],t.prototype,"visible",null),n([d.writer("visible")],t.prototype,"writeVisible",null),n([i(0,d.cast(j))],t.prototype,"queryFeatures",null),u=n([d.subclass("esri.layers.support.Sublayer")],t)}(d.declared(u))}.apply(null,n))||(e.exports=i)}}]);