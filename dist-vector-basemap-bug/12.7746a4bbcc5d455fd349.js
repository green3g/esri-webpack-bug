(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/tiling/TileKey":441,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileKey":441,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/layers/LayerView":649,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/layers/RefreshableLayerView":667,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Container":696,"esri/views/2d/tiling/enums":706,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/enums":706,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/DisplayObject":715,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileSpan":722,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileInfoView":749,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Evented":767,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/LayerView2D":768,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/QueueProcessor":793,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/LODInfo":806,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileCoverage":807,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileQueue":863,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/Queue":864,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileStrategy":876,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Canvas2DContainer":981,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapSource":982,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/TileLayerView2D":983,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Bitmap":1034,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/viewStateUtils":1073,"esri/views/2d/tiling":1096,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling":1096,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapContainer":1105,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Tiled":1389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/BitmapTile":1547})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1034:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(715)],void 0===(n=function(e,t,i,r){var n=[0,0];return function(e){function t(t){var i=e.call(this)||this;return i.height=0,i.resolution=0,i.rotation=0,i._source=null,i._sourceHandle=null,i.width=0,i.x=0,i.y=0,i.source=t,i.requestRender=i.requestRender.bind(i),i}return i(t,e),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(e){this._sourceHandle&&(this._sourceHandle.remove(),this._sourceHandle=null),this._source=e,this._source&&(this._sourceHandle=this._source.on("update",this.requestRender)),this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.doRender=function(e){this.source&&this.source.ready&&this.renderCanvas2D(e)},t.prototype.renderCanvas2D=function(e){var t=this.source,i=e.context,r=e.state,o=r.resolution,s=r.rotation,a=this.resolution/o*r.pixelRatio;if(!(a<.05)){i.save();var l=r.toScreen(n,this.x,this.y),u=l[0],h=l[1];if(a>.99&&a<1.01?i.translate(Math.round(u),Math.round(h)):(i.translate(u,h),i.scale(a,a)),s){var c=s*Math.PI/180;i.rotate(c)}t.rotation&&(i.translate(.5*this.width,.5*this.height),i.rotate(-t.rotation*Math.PI/180),i.translate(.5*-this.width,.5*-this.height));var p=t.resolution||this.resolution,d=(this.x-t.x)/p,f=-(this.y-t.y)/p,y=(t.width||this.width)*(this.resolution/p),v=(t.height||this.height)*(this.resolution/p);i.clearRect(0,0,this.width,this.height),t.draw(i,Math.round(d),Math.round(f),Math.round(y),Math.round(v),0,0,this.width,this.height),i.restore()}},t}(r)}.apply(null,r))||(e.exports=n)},1073:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e){return e*r}Object.defineProperty(t,"__esModule",{value:!0});var r=Math.PI/180;t.snapToPixel=function(e,t,i){var r=i.resolution,n=i.size;return e[0]=r*(Math.round(t[0]/r)+n[0]%2*.5),e[1]=r*(Math.round(t[1]/r)+n[1]%2*.5),e},t.getOuterSize=function(e,t){var r=i(t.rotation),n=Math.abs(Math.cos(r)),o=Math.abs(Math.sin(r)),s=t.size,a=s[0],l=s[1];return e[0]=Math.round(l*o+a*n),e[1]=Math.round(l*n+a*o),e},t.getBBox=function(e,t,i,r){var n=t[0],o=t[1],s=r[0],a=r[1],l=.5*i;return e[0]=n-l*s,e[1]=o-l*a,e[2]=n+l*s,e[3]=o+l*a,e},t.bboxIntersects=function(e,t){var i=e[0],r=e[1],n=e[2],o=e[3],s=t[0],a=t[1],l=t[2],u=t[3];return!(i>l||n<s||r>u||o<a)}}.apply(null,r))||(e.exports=n)},1096:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(749),i(441),i(863),i(876)],void 0===(n=function(e,t,i,r,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.TileInfoView=i,t.TileKey=r,t.TileQueue=n,t.TileStrategy=o}.apply(null,r))||(e.exports=n)},1105:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(903),i(1073),i(696)],void 0===(n=function(e,t,i,r,n,o,s){var a=[0,0];return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenCanvas=null,t._childrenRenderParameters={context:null,pixelRatio:1,state:new n,stationary:!0},t}return i(t,e),t.prototype.attach=function(t){return this._childrenCanvas||(this._childrenCanvas=document.createElement("canvas"),this._childrenRenderParameters.context=this._childrenCanvas.getContext("2d")),e.prototype.attach.call(this,t)},t.prototype.detach=function(t){e.prototype.detach.call(this,t),this._childrenCanvas=null,this._childrenRenderParameters.context=null},t.prototype.doRender=function(t){this.visible&&e.prototype.doRender.call(this,t)},t.prototype.prepareChildrenRenderParameters=function(e){var t=this._childrenCanvas,i=this._childrenRenderParameters,r=e.state,n=r.pixelRatio,s=i.state;s.copy(r);var l=o.getOuterSize(a,r),u=l[0],h=l[1];return u*=n,h*=n,s.size=a,s.viewpoint.rotation=0,t.width!==u||t.height!==h?(t.width=u,t.height=h):i.context.clearRect(0,0,u,h),i.pixelRatio=e.pixelRatio,i},t.prototype.beforeRenderChildren=function(e,t){this.sortChildren(function(e,t){return t.resolution-e.resolution})},t.prototype.afterRenderChildren=function(e,t){var i=e.context,r=e.state,n=t.context,o=t.state;0===r.rotation?i.drawImage(n.canvas,0,0):(i.save(),i.translate(.5*r.width,.5*r.height),i.rotate(r.rotation*Math.PI/180),i.translate(.5*-r.width,.5*-r.height),i.drawImage(n.canvas,.5*(r.width-o.width),.5*(r.height-o.height)),i.restore())},t}(s)}.apply(null,r))||(e.exports=n)},1389:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(767),i(706)],void 0===(n=function(e,t,i,r,n){return function(e){var t=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.call(this)||this;return r.status=n.TileStatus.INITIALIZED,r}return i(t,e),t}(e);return r.EventedMixin(t)}}.apply(null,r))||(e.exports=n)},1547:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(413),i(1096),i(1034),i(1389),i(706)],void 0===(n=function(e,t,i,r,n,o,s,a,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var i=e.call(this,t)||this;return i.key=new o.TileKey(0,0,0,0),i}return i(t,e),t.prototype.acquire=function(e){},t.prototype.release=function(){this.key.set(0,0,0,0),this.status=l.TileStatus.INITIALIZED,this.source=null},t.pool=new n(t,!0),t}(a(s));t.default=u}.apply(null,r))||(e.exports=n)},441:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(413)],void 0===(n=function(e,t,i){return function(){function e(e,t,i,r){this.set(e,t,i,r)}return e.from=function(t,i,r,n){return e.pool.acquire(t,i,r,n)},e.getId=function(e,t,i,r){return"object"==typeof e?e.level+"/"+e.row+"/"+e.col+"/"+e.world:e+"/"+t+"/"+i+"/"+r},Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world},e.prototype.release=function(){this.level=0,this.row=0,this.col=0,this.world=0},e.prototype.set=function(e,t,i,r){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){var n=e.split("/"),o=n[0],s=n[1],a=n[2],l=n[3];this.level=parseFloat(o),this.row=parseFloat(s),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+t,this.col=+i,this.world=+r||0;return this},e.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world},e.prototype.getChildKeys=function(){var t=this.level+1,i=this.row<<1,r=this.col<<1,n=this.world;return[e.pool.acquire(t,i,r,n),e.pool.acquire(t,i,r+1,n),e.pool.acquire(t,i+1,r,n),e.pool.acquire(t,i+1,r+1,n)]},e.prototype._compare=function(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0},e.sort=function(t){return t.map(function(t){return e.from(t)}).sort(function(e,t){return e._compare(t)}).map(function(e){return e.id})},e.pool=new i(e,!0,null,25,50),e}()}.apply(null,r))||(e.exports=n)},649:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(449),i(365),i(694),i(343),i(624),i(339),i(336)],void 0===(n=function(e,t,i,r,n,o,s,a,l,u,h,c){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handles=new s,t.layer=null,t.parent=null,t.view=null,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";return l.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),h.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},r([c.property()],t.prototype,"layer",void 0),r([c.property()],t.prototype,"parent",void 0),r([c.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),r([c.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),r([c.property()],t.prototype,"view",void 0),r([c.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r([c.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r([c.subclass("esri.views.layers.LayerView")],t)}(c.declared(n,o,a,u))}.apply(null,r))||(e.exports=n)},667:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(336)],void 0===(n=function(e,t,i,r,n,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshTimestamp=null,t}return i(t,e),t.prototype.refresh=function(e){void 0===e&&(e=Date.now()),this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh()},r([o.property()],t.prototype,"layer",void 0),r([o.aliasOf("layer.refreshInterval")],t.prototype,"refreshInterval",void 0),r([o.property({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),r([o.subclass("esri.layers.mixins.RefreshableLayerView")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},696:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(715)],void 0===(n=function(e,t,i,r){var n;return function(e){e[e.BEFORE=0]="BEFORE",e[e.ATTACHING=1]="ATTACHING",e[e.DETACHING=2]="DETACHING",e[e.RENDERING=3]="RENDERING",e[e.AFTER=4]="AFTER",e[e.DONE=5]="DONE"}(n||(n={})),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenSet=new Set,t._childrenToAttach=[],t._childrenToDetach=[],t._renderPhase=n.DONE,t.children=[],t}return i(t,e),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(e){for(var t=this.children.concat(this._childrenToDetach),i=this.prepareChildrenRenderParameters(e),r=0,n=t;r<n.length;r++){var o=n[r];o.attached&&(this.detachChild(o,i),o.attached=!1,o.parent=null)}},t.prototype.doRender=function(e){var t=this.prepareChildrenRenderParameters(e);this._renderPhase=n.BEFORE,this.beforeRenderChildren(e,t),this._renderPhase=n.ATTACHING,this.attachChildren(t),this._renderPhase=n.DETACHING;for(var i=this._childrenToDetach;i.length>0;){var r=i.shift();this.detachChild(r,t),r.attached=!1,r.parent=null}this._renderPhase=n.RENDERING,this.renderChildren(t),this._renderPhase=n.AFTER,this.afterRenderChildren(e,t),this._renderPhase=n.DONE},t.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.prototype.addChildAt=function(e,t){if(void 0===t&&(t=this.numChildren),!e)return e;if(this.contains(e))return e;var i=e.parent;i&&i!==this&&i.removeChild(e),t>=this.numChildren?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e);var r=this._childrenToDetach.indexOf(e);return r>-1&&this._childrenToDetach.splice(r,1),this._childrenToAttach.push(e),this._renderPhase>=n.RENDERING&&this.requestRender(),e},t.prototype.contains=function(e){return this._childrenSet.has(e)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.getChildAt=function(e){return e<0||e>this.children.length?null:this.children[e]},t.prototype.removeAllChildren=function(){for(var e=this.numChildren;e--;)this.removeChildAt(0)},t.prototype.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.getChildIndex(e)):e},t.prototype.removeChildAt=function(e){var t;if(e<0||e>=this.children.length)return null;if(t=this.children.splice(e,1)[0],function(e,t){e.delete(t)}(this._childrenSet,t),t.attached)this._childrenToDetach.push(t),this._renderPhase>=n.RENDERING&&this.requestRender();else{var i=this._childrenToAttach.indexOf(t);i>-1&&this._childrenToAttach.splice(i,1)}return t},t.prototype.requestChildRender=function(e){e&&e.parent===this&&this._renderPhase>=n.RENDERING&&this.requestRender()},t.prototype.setChildIndex=function(e,t){var i=this.getChildIndex(e);i>-1&&(this.children.splice(i,1),this.children.splice(t,0,e),this._renderPhase>=n.RENDERING&&this.requestRender())},t.prototype.sortChildren=function(e){return this._renderPhase>n.RENDERING&&this.requestRender(),this.children.sort(e)},t.prototype.attachChildren=function(e){var t=this._childrenToAttach;if(0!==t.length)for(var i=0,r=!1;!r;){var n=t[i];this.attachChild(n,e)?(n.attached=!0,n.parent=this,t.splice(i,1)):++i,r=t.length===i}},t.prototype.renderChildren=function(e){for(var t=this.children,i=t.length,r=0;r<i;r++){var n=t[r];n.attached&&this.renderChild(n,e)}},t.prototype.beforeRenderChildren=function(e,t){},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){e.detach(t)},t.prototype.renderChild=function(e,t){e.processRender(t)},t.prototype.afterRenderChildren=function(e,t){},t}(r)}.apply(null,r))||(e.exports=n)},706:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,r))||(e.exports=n)},715:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(767)],void 0===(n=function(e,t,i,r){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderRequestedCalled=!1,t._attached=!1,t._opacity=1,t.renderRequested=!1,t._visible=!0,t}return i(t,e),Object.defineProperty(t.prototype,"attached",{get:function(){return this._attached},set:function(e){this._attached!==e&&(this._attached=e,e?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=e,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())},enumerable:!0,configurable:!0}),t.prototype.attach=function(e){return!0},t.prototype.detach=function(e){},t.prototype.processRender=function(e){this._renderRequestedCalled=!1,this.doRender(e),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render")},t.prototype.requestRender=function(){var e=this.renderRequested;this._renderRequestedCalled=!0,this.renderRequested=!0,this.parent&&this.parent.requestChildRender(this),e!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")},t.prototype.dispose=function(){},t}(r.Evented)}.apply(null,r))||(e.exports=n)},722:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(413)],void 0===(n=function(e,t,i){return function(){function e(e,t,i){this.row=e,this.colFrom=t,this.colTo=i}return e.pool=new i(e,!0),e}()}.apply(null,r))||(e.exports=n)},749:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(409),i(806),i(807),i(441),i(722)],void 0===(n=function(e,t,i,r,n,o,s){var a=new o("0/0/0/0"),l=function(){function e(e,t,i,r,n,o,s,a){this.x=e,this.ymin=t,this.ymax=i,this.invM=r,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=s,this.rightBound=a}return e.create=function(t,i){var r;t[1]>i[1]&&(t=(r=[i,t])[0],i=r[1]);var n=t[0],o=t[1],s=i[0],a=i[1],l=s-n,u=a-o,h=0!==u?l/u:0,c=(Math.ceil(o)-o)*h,p=(Math.floor(o)-o)*h;return new e(n,Math.floor(o),Math.ceil(a),h,l<0?c:p,l<0?p:c,l<0?s:n,l<0?n:s)},e.prototype.incrRow=function(){this.x+=this.invM},e.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},e.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},e}(),u=[[0,0],[0,0],[0,0],[0,0]];return function(){function e(e,t){var i=this;this.tileInfo=e,this.fullExtent=t,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};var n=e.lods.slice();n.sort(function(e,t){return t.scale-e.scale});var o=this._lodInfos=n.map(function(i){return r.create(e,i,t)});n.forEach(function(e,t){i._infoByLevel[e.level]=o[t],i._infoByScale[e.scale]=o[t],i.scales[t]=e.scale},this),this._wrap=e.isWrappable}return e.prototype.getLODInfoAt=function(e){return this._infoByLevel[e.level]},e.prototype.getTileBounds=function(e,t,i){void 0===i&&(i=!1),a.set(t);var r=this._infoByLevel[a.level];return r?r.getTileBounds(e,a,i):e},e.prototype.getTileCoords=function(e,t,i){void 0===i&&(i=!1),a.set(t);var r=this._infoByLevel[a.level];return r?r.getTileCoords(e,a,i):e},e.prototype.getTileCoverage=function(e,t){void 0===t&&(t=192);var i,r,o,a=this.getClosestInfoForScale(e.scale),h=n.pool.acquire(a),c=this._wrap,p=1/0,d=-1/0,f=h.spans;u[0][0]=u[0][1]=u[1][1]=u[3][0]=-t,u[1][0]=u[2][0]=e.size[0]+t,u[2][1]=u[3][1]=e.size[1]+t;for(var y=0,v=u;y<v.length;y++){var g=v[y];e.toMap(g,g),g[0]=a.getColumnForX(g[0]),g[1]=a.getRowForY(g[1])}for(var _=[],m=3,w=0;w<4;w++)if(u[w][1]!==u[m][1]){var R=l.create(u[w],u[m]);p=Math.min(R.ymin,p),d=Math.max(R.ymax,d),void 0===_[R.ymin]&&(_[R.ymin]=[]),_[R.ymin].push(R),m=w}else m=w;if(null==p||null==d||d-p>100)return null;var C=[];for(i=p;i<d;){null!=_[i]&&(C=C.concat(_[i])),r=1/0,o=-1/0;for(w=C.length-1;w>=0;w--){R=C[w];r=Math.min(r,R.getLeftCol()),o=Math.max(o,R.getRightCol())}if(r=Math.floor(r),o=Math.floor(o),i>=a.first[1]&&i<=a.last[1])if(c)if(a.size[0]<a.worldSize[0]){var b=Math.floor(o/a.worldSize[0]);for(w=Math.floor(r/a.worldSize[0]);w<=b;w++)f.push(new s(i,Math.max(a.getFirstColumnForWorld(w),r),Math.min(a.getLastColumnForWorld(w),o)))}else f.push(new s(i,r,o));else r>a.last[0]||o<a.first[0]||(r=Math.max(r,a.first[0]),o=Math.min(o,a.last[0]),f.push(new s(i,r,o)));i+=1;for(w=C.length-1;w>=0;w--){(R=C[w]).ymax>=i?R.incrRow():C.splice(w,1)}}return h},e.prototype.getTileIdAtParent=function(e,t){var i=o.pool.acquire(t),r=this._infoByLevel[i.level];if(e.resolution<r.resolution)throw new Error("Cannot calculate parent tile. destination LOD's resolution "+e.resolution+" is not a parent resolution of "+r.resolution);if(e.resolution===r.resolution)return i.id;var n=Math.floor(i.col*r.resolution/e.resolution+.01),s=Math.floor(i.row*r.resolution/e.resolution+.01);return o.getId(e.level,s,n,i.world)},e.prototype.getTileParentId=function(e){var t=o.pool.acquire(e),i=this._infoByLevel[t.level],r=this._lodInfos.indexOf(i)-1;if(r<0)return o.pool.release(t),null;var n=this._lodInfos[r],s=this.getTileIdAtParent(n,t);return o.pool.release(t),s},e.prototype.getTileResolution=function(e){var t=this._infoByLevel["object"==typeof e?e.level:e];return t?t.resolution:-1},e.prototype.getTileScale=function(e){var t=this._infoByLevel[e.level];return t?t.scale:-1},e.prototype.intersects=function(e,t){var i=o.pool.acquire(t),r=this._infoByLevel[i.level],n=e.lodInfo;if(n.resolution>r.resolution){var s=o.pool.acquire(this.getTileIdAtParent(n,i)),a=n.denormalizeCol(s.col,s.world),l=e.spans.some(function(e){return e.row===s.row&&e.colFrom<=a&&e.colTo>=a});return o.pool.release(i),o.pool.release(s),l}if(n.resolution<r.resolution){var u=e.spans.reduce(function(e,t){return e[0]=Math.min(e[0],t.row),e[1]=Math.max(e[1],t.row),e[2]=Math.min(e[2],t.colFrom),e[3]=Math.max(e[3],t.colTo),e},[1/0,-1/0,1/0,-1/0]),h=u[0],c=u[1],p=u[2],d=u[3],f=r.denormalizeCol(i.col,i.world),y=n.getColumnForX(r.getXForColumn(f)),v=n.getRowForY(r.getYForRow(i.row)),g=n.getColumnForX(r.getXForColumn(f+1))-1,_=n.getRowForY(r.getYForRow(i.row+1))-1;return o.pool.release(i),!(y>d||g<p||v>c||_<h)}var m=n.denormalizeCol(i.col,i.world),w=e.spans.some(function(e){return e.row===i.row&&e.colFrom<=m&&e.colTo>=m});return o.pool.release(i),w},e.prototype.normalizeBounds=function(e,t,r){if(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._wrap){var n=i.getInfo(this.tileInfo.spatialReference),o=-r*(n.valid[1]-n.valid[0]);e[0]+=o,e[2]+=o}return e},e.prototype.getClosestInfoForScale=function(e){var t=this.scales;return this._infoByScale[e]?this._infoByScale[e]:(e=t.reduce(function(t,i,r,n){return Math.abs(i-e)<Math.abs(t-e)?i:t},t[0]),this._infoByScale[e])},e.prototype.scaleToLevel=function(e){var t=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(var i=t.length-1;i>=0;i--)if(e<t[i]){return i===t.length-1?this._infoByScale[t[t.length-1]].level:this._infoByScale[t[i]].level+(t[i]-e)/(t[i]-t[i+1])}return this._infoByScale[t[0]].level},e}()}.apply(null,r))||(e.exports=n)},767:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(454),i(418)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.on=function(e,t){return r.after(this,"on"+e,t,!0)},e.prototype.once=function(e,t){return n.once(this,e,t)},e.prototype.emit=function(e){n.emit(this,e,this)},e.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},e}();t.Evented=o,t.EventedMixin=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.on=function(e,t){return r.after(this,"on"+e,t,!0)},t.prototype.once=function(e,t){return n.once(this,e,t)},t.prototype.emit=function(e,t){n.emit(this,e,t)},t.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},t}(e)}}.apply(null,r))||(e.exports=n)},768:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(377),i(336),i(649)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t.lastUpdateId=-1,t.moving=!1,t.updateRequested=!1,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.when(function(){e.requestUpdate()}),n.init(this,"suspended",function(t){e.container.visible=!t,!t&&e.updateRequested&&e.view.requestLayerViewUpdate(e)},!0),n.init(this,"fullOpacity",function(t){e.container.opacity=t},!0);var t=function(){this.notifyChange("rendering")}.bind(this);this.container.on("post-render",t),this.container.on("will-render",t)},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.updateRequested=!1,this.layer=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.isRendering()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return this.attached&&(this.moving||this.container.renderRequested)},t.prototype.canResume=function(){var e=this.inherited(arguments),t=this.layer;if(e&&null!=t.minScale&&null!=t.minScale){var i=this.view.scale,r=t.minScale,n=t.maxScale,o=!r,s=!n;!o&&i<=r&&(o=!0),!s&&i>=n&&(s=!0),e=o&&s}return e},r([o.property()],t.prototype,"attached",void 0),r([o.property()],t.prototype,"container",void 0),r([o.property()],t.prototype,"moving",void 0),r([o.property({dependsOn:["moving"]})],t.prototype,"rendering",null),r([o.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),r([o.property({readOnly:!0})],t.prototype,"updateParameters",void 0),r([o.property()],t.prototype,"updateRequested",void 0),r([o.property({dependsOn:["updateRequested","attached"]})],t.prototype,"updating",null),r([o.property()],t.prototype,"view",void 0),r([o.subclass("esri.views.2d.layers.LayerView2D")],t)}(o.declared(s))}.apply(null,r))||(e.exports=n)},793:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(380),i(864),i(462)],void 0===(n=function(e,t,i,r,n){return function(){function e(e){this._apiPromises=new Map,this._processingItems=new Map,this._isPaused=!1,this._scheduledNextHandle=null,this.concurrency=1,this.ordered=!1,e.concurrency&&(this.concurrency=e.concurrency),this.ordered=!!e.ordered,this._queue=new r(e.peeker?{peeker:e.peeker}:void 0),this.process=e.process}return Object.defineProperty(e.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._queue.clear();var e=[];this._processingItems.forEach(function(t){return e.push(t.resultPromise)}),this._processingItems.clear(),e.forEach(function(e){return e.cancel()}),e.length=0,this._apiPromises.forEach(function(t){return e.push(t)}),this._apiPromises.clear(),e.forEach(function(e){return e.cancel()}),this._cancelNext()},e.prototype.find=function(e,t){var i=this,r=void 0;return this._apiPromises.forEach(function(n,o){e.call(t,o)&&(r=i._apiPromises.get(o).promise)}),r},e.prototype.get=function(e){var t=this._apiPromises.get(e);return t&&t.promise||void 0},e.prototype.isOngoing=function(e){return this._processingItems.has(e)},e.prototype.has=function(e){return this._apiPromises.has(e)},e.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},e.prototype.push=function(e){var t=this;if(this._apiPromises.has(e))return this._apiPromises.get(e).promise;var r=new i(function(i){var r=t._processingItems.get(e);r?r.resultPromise.cancel(i):(t._remove(e),t._scheduleNext())});return this._add(e,r),this._scheduleNext(),r.promise},e.prototype.reset=function(){var e=[];this._processingItems.forEach(function(t){return e.push(t)}),this._processingItems.clear();for(var t=0,i=e;t<i.length;t++){var r=i[t];r.resultPromise.isFulfilled()?this._processReset(r):(r.isReset=!0,r.resultPromise.cancel())}},e.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())},e.prototype._scheduleNext=function(){var e=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=n.schedule(function(){e._scheduledNextHandle=null,e._next()}))},e.prototype._next=function(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())},e.prototype._processResult=function(e,t){this._remove(e.item),this._scheduleNext(),e.dfd.resolve(t)},e.prototype._processError=function(e,t){e.isReset?this._processReset(e):(this._remove(e.item),this._scheduleNext(),e.dfd.reject(t))},e.prototype._processReset=function(e){this._remove(e.item),this._add(e.item,e.dfd),this._scheduleNext()},e.prototype._processOrdered=function(e,t){var i=this,r=!1;if(e.isReset)this._processReset(e);else{e.result=t,this._itemsToProcess||(this._itemsToProcess=[]),this._processingItems.forEach(function(e){r||(e.result?i._itemsToProcess.push(e):r=!0)});for(var n=0,o=this._itemsToProcess;n<o.length;n++){var s=o[n];!1===s.result.ok?this._processError(s,s.result.error):this._processResult(s,s.result.value)}this._itemsToProcess.length=0}},e.prototype._process=function(e){var t=this;if(null!=e){var i=this._apiPromises.get(e),r=this.process(e);if(function(e){return e&&"function"==typeof e.then}(r)){var n={item:e,resultPromise:r,result:null,dfd:i,isReset:!1};this._processingItems.set(e,n),this.ordered?r.then(function(e){return t._processOrdered(n,{ok:!0,value:e})},function(e){return t._processOrdered(n,{ok:!1,error:e})}):r.then(function(e){return t._processResult(n,e)},function(e){return t._processError(n,e)})}else i.resolve(r),this._remove(e)}},e.prototype._add=function(e,t){this._apiPromises.set(e,t),this._queue.push(e)},e.prototype._remove=function(e){this._queue.remove(e),this._apiPromises.delete(e),this._processingItems.delete(e)},e.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},e}()}.apply(null,r))||(e.exports=n)},806:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(409),i(441)],void 0===(n=function(e,t,i,r){function n(e,t){return[e,t]}function o(e,t,i){return e[0]=t,e[1]=i,e}var s=new r("0/0/0/0");return function(){function e(e,t,i,r,n,o,s,a,l,u,h,c){this.level=e,this.resolution=t,this.scale=i,this.origin=r,this.first=n,this.last=o,this.size=s,this.norm=a,this.worldStart=l,this.worldEnd=u,this.worldSize=h,this.wrap=c}return e.create=function(t,r,s){var a,l,u,h,c=i.getInfo(t.spatialReference),p=n(t.origin.x,t.origin.y),d=n(t.size[0]*r.resolution,t.size[1]*r.resolution),f=n(-1/0,-1/0),y=n(1/0,1/0),v=n(1/0,1/0);return s&&(o(f,Math.max(0,Math.floor((s.xmin-p[0])/d[0])),Math.max(0,Math.floor((p[1]-s.ymax)/d[1]))),o(y,Math.max(0,Math.floor((s.xmax-p[0])/d[0])),Math.max(0,Math.floor((p[1]-s.ymin)/d[1]))),o(v,y[0]-f[0]+1,y[1]-f[1]+1)),t.isWrappable?(a=n(Math.ceil(Math.round(2*c.origin[1]/r.resolution)/t.size[0]),v[1]),l=n(Math.floor((c.origin[0]-p[0])/d[0]),f[1]),u=n(a[0]+l[0]-1,y[1]),h=!0):(l=f,u=y,a=v,h=!1),new e(r.level,r.resolution,r.scale,p,f,y,v,d,l,u,a,h)},e.prototype.normalizeCol=function(e){if(!this.wrap)return e;var t=this.worldSize[0];return e<0?t-1-Math.abs((e+1)%t):e%t},e.prototype.denormalizeCol=function(e,t){return this.wrap?this.worldSize[0]*t+e:e},e.prototype.getWorldForColumn=function(e){return this.wrap?Math.floor(e/this.worldSize[0]):0},e.prototype.getFirstColumnForWorld=function(e){return e*this.worldSize[0]+this.first[0]},e.prototype.getLastColumnForWorld=function(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1},e.prototype.getColumnForX=function(e){return(e-this.origin[0])/this.norm[0]},e.prototype.getXForColumn=function(e){return this.origin[0]+e*this.norm[0]},e.prototype.getRowForY=function(e){return(this.origin[1]-e)/this.norm[1]},e.prototype.getYForRow=function(e){return this.origin[1]-e*this.norm[1]},e.prototype.getTileBounds=function(e,t,i){void 0===i&&(i=!1),s.set(t);var r=i?s.col:this.denormalizeCol(s.col,s.world),n=s.row;return function(e,t,i,r,n){e[0]=t,e[1]=i,e[2]=r,e[3]=n}(e,this.getXForColumn(r),this.getYForRow(n+1),this.getXForColumn(r+1),this.getYForRow(n)),e},e.prototype.getTileCoords=function(e,t,i){void 0===i&&(i=!1),s.set(t);var r=i?s.col:this.denormalizeCol(s.col,s.world);return Array.isArray(e)?o(e,this.getXForColumn(r),this.getYForRow(s.row)):(e.x=this.getXForColumn(r),e.y=this.getYForRow(s.row)),e},e}()}.apply(null,r))||(e.exports=n)},807:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(737),i(413),i(722)],void 0===(n=function(e,t,i,r,n){return function(){function e(e){this.lodInfo=e,this.spans=i.acquire()}return e.prototype.release=function(){for(var e=0,t=this.spans;e<t.length;e++){var r=t[e];n.pool.release(r)}i.release(this.spans)},e.prototype.forEach=function(e,t){var i=this.spans,r=this.lodInfo,n=r.level;if(0!==i.length)for(var o=0,s=i;o<s.length;o++)for(var a=s[o],l=a.row,u=a.colFrom,h=a.colTo,c=u;c<=h;c++)e.call(t,n,l,r.normalizeCol(c),r.getWorldForColumn(c))},e.pool=new r(e,!0),e}()}.apply(null,r))||(e.exports=n)},863:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(337),i(335),i(346),i(793),i(336),i(683)],void 0===(n=function(e,t,i,r,n,o,s,a){var l=new Set,u=[],h=new Map,c=[0,0];return function(e){function t(t){var i=e.call(this,t)||this;return i._keysToRequests=new Map,i.concurrency=6,i.process=null,i.strategy="scale-first",i.tileInfoView=null,i.tileServers=null,i}return i(t,e),t.prototype.initialize=function(){var e=this,t="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this),i=this,r=i.tileServers,n=i.concurrency,s=i.process;r&&r.length>0?this._queues=r.map(function(i){return new o({concurrency:n,process:function(t){var r=e._keysToRequests.get(t);return s(r,i)},peeker:t})}):this._queues=[new o({concurrency:n,process:function(t){var i=e._keysToRequests.get(t);return s(i)},peeker:t})]},Object.defineProperty(t.prototype,"length",{get:function(){return this._queues.reduce(function(e,t){return e+t.length},0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onGoingCount",{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.length>0||this.onGoingCount>0},enumerable:!0,configurable:!0}),t.prototype.clear=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].clear();this._keysToRequests.clear(),this.notifyChange("updating")},t.prototype.find=function(e,t){for(var i=this,r=0,n=this._queues;r<n.length;r++){var o=n[r].find(function(t){return e(i._keysToRequests.get(t).key)});if(o)return o}},t.prototype.getPromise=function(e){for(var t="string"==typeof e?e:e.id,i=0,r=this._queues;i<r.length;i++){var n=r[i].get(t);if(n)return n}},t.prototype.getRequest=function(e){var t="string"==typeof e?e:e.id;return this._keysToRequests.get(t)},t.prototype.has=function(e){return"string"==typeof e?this._keysToRequests.has(e):this._keysToRequests.has(e.id)},t.prototype.isOngoing=function(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queues.some(function(e){return e.isOngoing(t)})},t.prototype.pause=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].pause()},t.prototype.push=function(e){var t=this,i=e.key.id;if(this.has(i))return this.getPromise(i);var r=this._queues[e.key.row%this._queues.length].push(i),n=function(){t._keysToRequests.delete(i),t.notifyChange("updating")};return this._keysToRequests.set(i,e),r.then(n,n),this.notifyChange("updating"),r},t.prototype.reset=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].reset();this.notifyChange("updating")},t.prototype.resume=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].resume()},t.prototype._peekByScaleFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,n=0,o=e;n<o.length;n++){var s=o[n],a=this._keysToRequests.get(s),c=this.tileInfoView.getTileScale(a.key);h.has(c)||(h.set(c,[]),i=Math.max(c,i),r=Math.min(c,r)),h.get(c).push(a.key),l.add(c)}var p=this.state.scale;h.has(p)||(function(e,t){e.length=0,t.forEach(function(t){return e.push(t)})}(u,l),u.sort(),p=u.reduce(function(e,t,i,r){return Math.abs(t-p)<Math.abs(e-p)?t:e},u[0])),p=Math.min(p,i),p=Math.max(p,r);var d=h.get(p),f=t.getClosestInfoForScale(p),y=f.getColumnForX(this.state.center[0]),v=f.getRowForY(this.state.center[1]);return d.sort(function(e,t){var i=f.denormalizeCol(e.col,e.world),r=f.denormalizeCol(t.col,t.world);return Math.sqrt((y-i)*(y-i)+(v-e.row)*(v-e.row))-Math.sqrt((y-r)*(y-r)+(v-t.row)*(v-t.row))}),l.clear(),h.clear(),d[0].id},t.prototype._peekByCenterFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=this.state.center,r=Number.POSITIVE_INFINITY,n=null,o=0,s=e;o<s.length;o++){var l=s[o],u=this._keysToRequests.get(l);t.getTileCoords(c,u.key);var h=a.distance(c,i);h<r&&(r=h,n=u.key)}return n.id},r([s.property({constructOnly:!0})],t.prototype,"concurrency",void 0),r([s.property({constructOnly:!0})],t.prototype,"process",void 0),r([s.property()],t.prototype,"state",void 0),r([s.property({constructOnly:!0})],t.prototype,"strategy",void 0),r([s.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),r([s.property({constructOnly:!0})],t.prototype,"tileServers",void 0),r([s.property({readOnly:!0})],t.prototype,"updating",null),r([s.subclass()],t)}(s.declared(n))}.apply(null,r))||(e.exports=n)},864:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e){this._items=[],this._itemSet=new Set,this._peeker=function(e){return e[0]},this._length=0,e&&e.peeker&&(this._peeker=e.peeker)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._itemSet.clear(),this._items.length=0,this._length=0},e.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)},e.prototype.push=function(e){this.contains(e)||this._add(e)},e.prototype.contains=function(e){return this._length>0&&this._itemSet.has(e)},e.prototype.pop=function(){if(0!==this._length){var e=this.peek();return this._remove(e),e}},e.prototype.remove=function(e){this.contains(e)&&this._remove(e)},e.prototype._add=function(e){this._items.push(e),this._itemSet.add(e),this._length++},e.prototype._remove=function(e){this._itemSet.delete(e),this._items.splice(this._items.indexOf(e),1),this._length--},e}()}.apply(null,r))||(e.exports=n)},876:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(441)],void 0===(n=function(e,t,i,r){function n(e,t){e.delete(t)}var o=new r(0,0,0,0),s=new Map,a=[],l=[];return function(){function e(e){this._previousResolution=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),null!=e.buffer&&(this.buffer=e.buffer)}return e.prototype.destroy=function(){this.tileIndex.clear()},e.prototype.update=function(e){var t=this,i=this.tileIndex,r=this.tileInfoView.getTileCoverage(e.state,this.buffer);if(r){var u=r.spans,h=r.lodInfo,c=h.level,p=e.state.resolution,d=!e.stationary&&p>this._previousResolution;this._previousResolution=p,i.forEach(function(e){return e.visible=!0}),this.tiles.length=0,s.clear();var f=0,y=0;if(u.length>0)for(var v=0,g=u;v<g.length;v++)for(var _=g[v],m=_.row,w=_.colFrom,R=_.colTo,C=w;C<=R;C++){f++;var b=o.set(c,m,h.normalizeCol(C),h.getWorldForColumn(C)).id;if(i.has(b)){if((I=i.get(b)).attached){s.set(b,I),y++;continue}I.attached||d||this._addParentTile(b,s)}else{var I=this.acquireTile(o);this.tileIndex.set(b,I),d||this._addParentTile(b,s)}}var x=y===f;l.length=0,a.length=0,i.forEach(function(e,i){if(o.set(i),!s.has(i)){var n=t.tileInfoView.intersects(r,o);if(!n||!d&&x)if("purge"===t.cachePolicy){!(o.level!==c)&&n||a.push(i)}else(o.level>c||!n)&&a.push(i);else e.attached?l.push(i):o.level>c&&a.push(i)}});for(var T=0,q=l;T<q.length;T++){b=q[T];(I=i.get(b))&&I.attached&&s.set(b,I)}for(var P=0,M=a;P<M.length;P++){b=M[P],I=i.get(b);this.releaseTile(I),n(i,b)}return s.forEach(function(e){return t.tiles.push(e)}),i.forEach(function(e){s.has(e.key.id)||(e.visible=!1)}),l.length=0,a.length=0,s.clear(),x}},e.prototype.clear=function(){var e=this,t=this.tileIndex;t.forEach(function(t){e.releaseTile(t)}),t.clear()},e.prototype._addParentTile=function(e,t){for(var i=e,r=null;i=this.tileInfoView.getTileParentId(i);)if(this.tileIndex.has(i)&&(r=this.tileIndex.get(i))&&r.attached){t.has(r.key.id)||t.set(r.key.id,r);break}},e}()}.apply(null,r))||(e.exports=n)},981:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(339),i(903),i(696),i(710)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenRenderParameters={context:null,pixelRatio:1,state:new n,stationary:!0},t.hidpi=!1,t}return i(t,e),t.prototype.createElement=function(){var e=document.createElement("canvas");return e.setAttribute("class","esri-display-object"),e},t.prototype.setElement=function(e){this.element=e},t.prototype.takeScreenshot=function(e){var t=this._childrenRenderParameters.state,i={context:null,pixelRatio:e.pixelRatio,state:new n,stationary:!0};i.opacity=this._childrenRenderParameters.opacity,i.state.copy(t);var o,a=e.framebufferWidth,l=e.framebufferHeight,u=e.region,h=document.createElement("canvas");if(h.width=a,h.height=l,i.context=h.getContext("2d"),this.beforeRenderChildren(i,i),void 0!==e.rotation&&null!==e.rotation){var c=i.state,p=c.clone();p.viewpoint.rotation=e.rotation,i.state=p,this.renderChildren(i),i.state=c}else this.renderChildren(i);this.afterRenderChildren(i,i);try{o=i.context.getImageData(u.x,u.y,u.width,u.height)}catch(e){return r.reject(e)}return r.resolve(s.encodeResult(o,e,h,{flipY:!1,premultipliedAlpha:!1}))},t.prototype.doRender=function(t){var i=this.element,r=i.style;if(this.visible){var n=t.state,o=t.pixelRatio,s=n.width,a=n.height;i.width=s*(this.hidpi?o:1),i.height=a*(this.hidpi?o:1),r.display="block",r.opacity=""+Math.min(this.opacity,this.parent.opacity),r.width=s+"px",r.height=a+"px",e.prototype.doRender.call(this,t)}else r.display="none"},t.prototype.prepareChildrenRenderParameters=function(e){var t=this._childrenRenderParameters;return t.context=this.element.getContext("2d"),t.pixelRatio=e.pixelRatio,t.state.copy(e.state),t.state.pixelRatio=this.hidpi?e.pixelRatio:1,t.stationary=e.stationary,t},t.prototype.beforeRenderChildren=function(e,t){var i=t.context,r=t.state;if(i.save(),r.spatialReference.isWrappable){var n=r.width,o=r.height,s=r.rotation,a=r.pixelRatio,l=this.hidpi?a:1,u=s*Math.PI/180,h=Math.abs(Math.cos(u)),c=Math.abs(Math.sin(u)),p=Math.round(n*l*h+o*l*c),d=r.worldScreenWidth*l;if(d<p){var f=n*l*.5,y=o*l*.5;u&&(i.translate(f,y),i.rotate(u),i.translate(-f,-y)),i.beginPath(),i.rect(f-.5*d,y-.5*p,d,p),i.closePath(),u&&(i.translate(f,y),i.rotate(-u),i.translate(-f,-y)),i.clip("evenodd")}}},t.prototype.afterRenderChildren=function(e,t){t.context.restore()},t.prototype.renderChild=function(e,t){t.context.save(),e.processRender(t),t.context.restore()},t}(o)}.apply(null,r))||(e.exports=n)},982:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(413),i(1069)],void 0===(n=function(e,t,i,r,n){function o(e){return e&&"render"in e}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this)||this;return i._height=0,i.pixelRatio=1,i.resolution=0,i.rotation=0,i._width=0,i.x=0,i.y=0,i.data=t,i}return i(t,e),t.prototype.release=function(){this.data=null},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this._width=this._height=0,e&&(o(e)||(e instanceof HTMLImageElement?(this._width=e.naturalWidth,this._height=e.naturalHeight):e.width>0&&e.height>0&&(this._width=e.width,this._height=e.height)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return o(this._data)?this._data.height:this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){return o(this._data)?this._data.width>0&&this._data.height>0:this._width>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return o(this.data)?this._data.width:this._width},enumerable:!0,configurable:!0}),t.prototype.draw=function(e,t,i,r,n,s,a,l,u){this.ready&&(o(this._data)?this._data.render(e,t,i,r,n,s,a,l,u):function(e){return e&&!("render"in e)}(this._data)&&r&&n&&l&&u&&e.drawImage(this._data,t,i,r,n,s,a,l,u))},t.pool=new r(t,!0),t}(n.default);t.default=s}.apply(null,r))||(e.exports=n)},983:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(345),i(335),i(341),i(339),i(336),i(1105),i(982),i(1547),i(981),i(768),i(706),i(749),i(863),i(876),i(667)],void 0===(n=function(e,t,i,r,n,o,s,a,l,u,h,c,p,d,f,y,v){var g=[0,0];return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tileStrategy=null,t._tileInfoView=null,t._fetchQueue=null,t._tileRequests=new Map,t.container=new h,t.layer=null,t}return i(t,e),t.prototype.initialize=function(){var e,t=this.layer.tileInfo,i=t&&t.spatialReference;i||(e=new n("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer})),i.equals(this.view.spatialReference)||(e=new n("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer})),e&&this.addResolvingPromise(o.reject(e))},t.prototype.getPopupData=function(e){var t=this.layer;if("tile"!==t.type)return[];var i=this.view.scale;return t.allSublayers.toArray().filter(function(e){var t=0===e.minScale||i<=e.minScale,r=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&t&&r}).map(function(t){var i=t.createQuery();return i.geometry=e,i.outFields=t.popupTemplate.requiredFields,t.queryFeatures(i).then(function(e){return e.features})})},t.prototype.hitTest=function(e,t){return null},t.prototype.update=function(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange("updating")},t.prototype.attach=function(){var e=this;this._tileContainer=new a,this.container.addChild(this._tileContainer),this._tileInfoView=new d(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new f({tileInfoView:this._tileInfoView,tileServers:"tileServers"in this.layer?this.layer.tileServers:null,concurrency:this.layer.url&&-1!==this.layer.url.indexOf("tiles.arcgis.com")?12:6,process:function(t,i){return e.fetchTile(t,i)}}),this._tileStrategy=new y({cachePolicy:"keep",acquireTile:function(t){return e.acquireTile(t)},releaseTile:function(t){return e.releaseTile(t)},tileInfoView:this._tileInfoView})},t.prototype.detach=function(){this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeChild(this._tileContainer),this._fetchQueue=this._tileStrategy=this._tileInfoView=this._tileContainer=null},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.doRefresh=function(){var e=this;this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach(function(t){return e._enqueueTileFetch(t)}),this.notifyChange("updating"))},t.prototype.isUpdating=function(){var e=!0;return this._tileRequests.forEach(function(t){e=e&&t.isFulfilled()}),!e},t.prototype.getTileBounds=function(e,t){return this._tileInfoView.getTileBounds(e,t)},t.prototype.getTileCoords=function(e,t){return this._tileInfoView.getTileCoords(e,t)},t.prototype.getTileResolution=function(e){return this._tileInfoView.getTileResolution(e)},t.prototype.acquireTile=function(e){var t,i,r=u.default.pool.acquire();return r.key.set(e),t=this._tileInfoView.getTileCoords(g,r.key),r.x=t[0],r.y=t[1],r.resolution=this._tileInfoView.getTileResolution(r.key),i=this._tileInfoView.tileInfo.size,r.width=i[0],r.height=i[1],this._enqueueTileFetch(r),this.requestUpdate(),r},t.prototype.releaseTile=function(e){var t=this,i=this._tileRequests.get(e);i&&!i.isFulfilled()&&i.cancel(),this._tileRequests.delete(e),this._tileContainer.removeChild(e),e.once("detach",function(){u.default.pool.release(e),t.requestUpdate()}),this.requestUpdate()},t.prototype.fetchTile=function(e,t){var i=this,r="tilemapCache"in this.layer?this.layer.tilemapCache:null;if(r){var n=e.level,o=e.row,s=e.col;return r.fetchAvailabilityUpsample(n,o,s,e).then(function(){return i._fetchImage(e)}).catch(function(){return e.level=n,e.row=o,e.col=s,i._fetchImage(e)})}return this._fetchImage(e)},t.prototype._enqueueTileFetch=function(e){var t=this;if(!this._fetchQueue.has(e.key)){var i=this._fetchQueue.push(e.key).then(function(i){e.status=p.TileStatus.READY,e.source=i,e.once("attach",function(){return t.requestUpdate()}),t._tileContainer.addChild(e),t.requestUpdate()});this._tileRequests.set(e,i)}},t.prototype._fetchImage=function(e){var t=this;return this.layer.fetchTile(e.level,e.row,e.col,{timestamp:this.refreshTimestamp}).then(function(i){var r,n=l.default.pool.acquire(i);return r=t.getTileCoords(g,e),n.x=r[0],n.y=r[1],n.resolution=t.getTileResolution(e),n})},r([s.subclass("esri.views.2d.layers.TileLayerView2D")],t)}(s.declared(c,v))}.apply(null,r))||(e.exports=n)}}]);