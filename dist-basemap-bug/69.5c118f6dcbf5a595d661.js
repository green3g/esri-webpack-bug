(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/screenUtils":357,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/screenUtils":357,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/Symbol":373,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/utils":379,"esri/core/workers/RemoteClient":391,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/RemoteClient":391,"esri/symbols/SimpleLineSymbol":407,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleLineSymbol":407,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers":443,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/requireUtils":454,"esri/views/2d/tiling/TileKey":456,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileKey":456,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/FillSymbol":464,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/MarkerSymbol":465,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/support/urlUtils":591,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/LineSymbol":593,"esri/core/pbf":594,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/pbf":594,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workers":609,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/Connection":610,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerOwner":611,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/workerFactory":612,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/loaderConfig":613,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/workers/WorkerFallback":614,"esri/views/2d/engine/webgl/enums":623,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/enums":623,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/layers/LayerView":664,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/common":671,"esri/views/2d/engine/webgl/Utils":675,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/Utils":675,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/vec2":698,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/PictureMarkerSymbol":713,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/symbols/SimpleFillSymbol":714,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Container":716,"esri/views/2d/tiling/enums":725,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/enums":725,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/DisplayObject":728,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileSpan":733,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/mat2d":745,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/mat4":759,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/common":765,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileInfoView":766,"esri/views/2d/engine/webgl/definitions":774,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/definitions":774,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/Evented":787,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/LayerView2D":790,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/QueueProcessor":815,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/vec4":820,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/LODInfo":834,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileCoverage":835,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileQueue":838,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/Queue":839,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileStrategy":900,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/vec3":903,"esri/core/libs/gl-matrix/vec2":961,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/vec2":961,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/sources/resolver":968,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/MaterialPrograms":969,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/rendererUtils":970,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrush":1013,"esri/views/2d/engine/webgl/GeometryUtils":1022,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/GeometryUtils":1022,"esri/views/2d/engine/webgl/color":1027,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/color":1027,"esri/views/2d/engine/webgl/util/serializationUtils":1060,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/util/serializationUtils":1060,"esri/views/2d/engine/webgl/number":1061,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/number":1061,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/LRUCache":1280,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrush":1281,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/Rect":1282,"esri/views/vectorTiles/MemoryBuffer":1290,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/MemoryBuffer":1290,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/VectorTileLayerView2D":1292,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/util/iterator":1304,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLPainter":1386,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfoUtils":1387,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfo":1388,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialKeyInfo":1389,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/BackgroundPrograms":1390,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/RectangleBinPack":1391,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/mat3":1392,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/VectorTileDisplayObject":1434,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/StageGL":1527,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/BitBlitRenderer":1528,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/BitBlitPrograms":1529,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/sources/shaderRepository":1530,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/Fader":1531,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialManager":1532,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialInfoUtils_updateMaterialVariations":1533,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/SymbolProperties":1534,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrushInfo":1535,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/TileInfoPrograms":1536,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrushStencil":1537,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":1538,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":1539,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":1540,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":1541,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushText":1542,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/WGLHighlightPainter":1543,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/highlight/HighlightRenderer":1544,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/HighlightPrograms":1545,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":1546,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/StencilPrograms":1547,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/TileHandler":1548,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/GlyphMosaic":1549,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/GlyphSource":1550,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/SpriteMosaic":1551,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/SpriteSource":1552,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/TileIndex":1553,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/RenderBucket":1554,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/Renderer":1555,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/BackgroundRenderer":1556,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/CircleRenderer":1557,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/FadeRecorder":1558,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/FillRenderer":1559,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/LineRenderer":1560,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/SymbolRenderer":1561,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/IconRenderer":1562,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/SDFRenderer":1563,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/TileInfoRenderer":1564,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/shaders/ProgramCache":1565,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/shaders/Programs":1566,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/shaders/sources/resolver":1567,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/renderers/shaders/sources/shaderRepository":1568,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/TileInfoViewPOT":2345,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/VectorTileContainer":2346})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[69,48,49,50,51],{1013:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(1281),i(1304)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.draw=function(e,t){var i=this;if(t.canDisplay){var n=this.getGeometryType(),o=t.getDisplayList(e.drawPhase),a=t.getGeometry(n);a&&r.forEachIter(o.ofType(n),function(n){return i.drawGeometry(e,t,n,a)})}},t}(n.default);t.default=o}.apply(null,n))||(e.exports=r)},1022:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,n))||(e.exports=r)},1027:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1061)],void 0===(r=function(e,t,i){function n(e,t){return Array.isArray(t)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):(e[0]=t.r,e[1]=t.g,e[2]=t.b,e[3]=t.a),e}function r(e,t,i){void 0===t&&(t=0),void 0===i&&(i=!1);var n=e[t+3];return e[t+0]*=n,e[t+1]*=n,e[t+2]*=n,i||(e[t+3]*=255),e}Object.defineProperty(t,"__esModule",{value:!0}),t.white=[255,255,255,1];var o=[0,0,0,0];t.premultiplyAlpha=r,t.copyAndPremultiply=function(e){return r(n([],e))},t.premultiplyAlphaUint32=function(e){return r(n(o,e)),i.i8888to32(o[0],o[1],o[2],o[3])},t.premultiplyAlphaRGBA=function(e){var t=e.r,n=e.g,r=e.b,o=e.a,a=t*o,s=n*o,l=r*o,u=255*o;return i.i8888to32(a,s,l,u)}}.apply(null,n))||(e.exports=r)},1060:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeList=function(e,t){if(null!==t){e.push(t.length);for(var i=0,n=t;i<n.length;i++)n[i].serialize(e);return e}e.push(0)},t.deserializeList=function(e,t,i){for(var n=e.readInt32(),r=new Array(n),o=0;o<r.length;o++)r[o]=t.deserialize(e,i);return r}}.apply(null,n))||(e.exports=r)},1061:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=new Float32Array(1),n=new Uint32Array(i.buffer);t.nextHighestPowerOfTwo=function(e){var t=e;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},t.toUint32=function(e){return i[0]=e,n[0]},t.i1616to32=function(e,t){return 65535&e|t<<16},t.i8888to32=function(e,t,i,n){return 255&e|(255&t)<<8|(255&i)<<16|n<<24},t.i8816to32=function(e,t,i){return 255&e|(255&t)<<8|i<<16},t.numTo32=function(e){return 0|e}}.apply(null,n))||(e.exports=r)},1280:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e){if(this._cache={},this._lruQueue=[],e<=0)throw new Error("LRU cache size must be bigger than zero!");this._maxSize=e}return e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.insert=function(e,t){null===this.use(e)?(this._collect(),this._cache[e]=t,this._lruQueue.unshift(e)):this._cache[e]=t},e.prototype.use=function(e){var t=this._cache[e];return t?(this._lruQueue.splice(this._lruQueue.indexOf(e),1),this._lruQueue.unshift(e),t):null},e.prototype.print=function(){for(var e=0,t=this._lruQueue;e<t.length;e++){var i=t[e];console.log("key: "+i+", value: "+this._cache[i])}},e.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var e=this._lruQueue.pop(),t=this._cache[e];t&&t.release&&t.release(),delete this._cache[e]}},e}()}.apply(null,n))||(e.exports=r)},1281:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){}}();t.default=i}.apply(null,n))||(e.exports=r)},1282:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=r)},1290:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,i,n){return 255&e|(255&t)<<8|(255&i)<<16|n<<24},e.i8816to32=function(e,t,i){return 255&e|(255&t)<<8|i<<16},e}()}.apply(null,n))||(e.exports=r)},1292:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336),i(384),i(366),i(354),i(340),i(337),i(1527),i(790),i(2345),i(456),i(838),i(900),i(711),i(1548),i(2346),i(1434)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v,m,g){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handles=new o,t._fetchQueue=null,t._tileRequests=new Map,t.container=new u,t}return i(t,e),t.prototype.initialize=function(){this.container.useContextVersion(this.view?this.view.renderContext:null)},t.prototype.hitTest=function(e,t){var i=this;return this.visible&&this._vectorTileContainer?this._vectorTileContainer.hittest(e,t).then(function(e){var t=i._tileHandler.getStyleRepository().layers;if(null===e||e<0||e>=t.length)return null;var n=t[e],o=new r({attributes:{layerId:e,layerName:n.id}});return o.layer=i.layer,o.sourceLayer=i.layer,o}):s.resolve(null)},t.prototype.update=function(e){if(this._tileHandlerPromise&&this._tileHandlerPromise.isFulfilled()){if(e.pixelRatio!==this._tileHandler.devicePixelRatio)return void this._start();this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();for(var t=0,i=this._vectorTileContainer.children;t<i.length;t++){var n=i[t];this._tileHandler.updateTile(n,e)}this.notifyChange("updating")}},t.prototype.attach=function(){this._tileHandlerPromise=this._start()},t.prototype.detach=function(){this._stop()},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.destroy=function(){this.container.dispose(),this._vectorTileContainer.destroy(),this._tileHandler.destroy()},t.prototype.takeScreenshot=function(e){if(!this.container)return s.reject("Could not find an object capable of capturing screenshot!");var t=_.toRenderSettings(e,this.view);return this.container.takeScreenshot(t)},t.prototype.canResume=function(){var e=this.inherited(arguments),t=this.layer;if(e&&t.currentStyleInfo){var i=this.view.scale,n=t.currentStyleInfo;if(n&&n.layerDefinition){var r=n.layerDefinition;r.minScale&&r.minScale<i&&(e=!1),r.maxScale&&r.maxScale>i&&(e=!1)}}return e},t.prototype.isUpdating=function(){var e=!0;return this._tileRequests.forEach(function(t){e=e&&t.isFulfilled()}),!e},t.prototype.acquireTile=function(e){var t=this,i=h.pool.acquire();i.set(e.level,e.row,e.col,e.world);var n=this.updateParameters.state.rotation,r=this._tileHandler.getStyleRepository(),o=g.pool.acquire(i,i,this.layer.tileInfo,r,n);return this._tileHandlerPromise.then(function(){var e=t._tileHandler.getRefKey(i).then(function(e){return e?(o.refKey=e,t._fetchQueue.push(o.key).then(function(e){o.setData(e.tileData,e.client),o.once("attach",function(){return t.requestUpdate()}),t._vectorTileContainer.addChild(o),t.notifyChange("updating")})):(o.setData(null,null),o.once("attach",function(){return t.requestUpdate()}),void t._vectorTileContainer.addChild(o))});t._tileRequests.set(i.id,e),t.notifyChange("updating")}),o},t.prototype.releaseTile=function(e){var t=e.key.id,i=this._tileRequests.get(t);i.isFulfilled()||i.cancel(),this._tileRequests.delete(t),this._vectorTileContainer.removeChild(e),this.requestUpdate(),e.once("detach",function(){return g.pool.release(e)}),this.notifyChange("updating")},t.prototype._stop=function(){this._tileHandlerPromise&&!this._tileHandlerPromise.isFulfilled()&&this._tileHandlerPromise.cancel(),this._handles.removeAll(),this._tileStrategy&&this._tileStrategy.destroy(),this._vectorTileContainer&&(this._vectorTileContainer.removeAllChildren(),this.container.removeChild(this._vectorTileContainer)),this._tileHandler&&this._tileHandler.stop(),g.pool.prune(),this._vectorTileContainer=this._tileHandler=this._tileStrategy=this._tileInfoView=null},t.prototype._start=function(){var e=this;return a("esri-webgl")?(this._stop(),this._handles.add(this.watch("layer.currentStyleInfo",function(){return e.attach()})),this._vectorTileContainer=new m,this.container.addChild(this._vectorTileContainer),this._tileInfoView=new c(this.layer.tileInfo,this.layer.fullExtent),this._tileHandler=new v(this.layer,function(){return e.requestUpdate()},window.devicePixelRatio||1,!0,this._tileInfoView),this._tileHandler.start().then(function(){e._tileStrategy=new p({cachePolicy:"keep",acquireTile:function(t){return e.acquireTile(t)},releaseTile:function(t){return e.releaseTile(t)},tileInfoView:e._tileInfoView}),e._fetchQueue=new f({tileInfoView:e._tileInfoView,process:function(t){return e._getTileData(t)}}),e._vectorTileContainer.initialize(e._tileHandler.spriteMosaic,e._tileHandler.glyphMosaic,e.layer.tileInfo,e._tileInfoView),e.requestUpdate()})):s.reject("WebGL is required but not supported!")},t.prototype._getTileData=function(e){return this._tileHandler.getTileData(e,this.updateParameters.state.rotation)},n([l.property({dependsOn:["view.scale","layer.currentStyleInfo"]})],t.prototype,"suspended",void 0),n([l.subclass("esri.views.2d.layers.VectorTileLayerView2D")],t)}(l.declared(d))}.apply(null,n))||(e.exports=r)},1304:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEachIter=function(e,t){for(;;){var i=e.next(),n=i.value;if(i.done)return;t(n)}}}.apply(null,n))||(e.exports=r)},1386:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(345),i(354),i(759),i(623),i(1022),i(1532),i(675),i(1535),i(1537),i(1538),i(1539),i(1540),i(1541),i(1542),i(1543),i(377)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v,m){Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){this._initialized=!1}return e.prototype.registerPass=function(e,t){this._initialize();for(var i=0,n=t;i<n.length;i++){var r=n[i];this._passMap.set(r,e)}return this},e.prototype.getPaintPassTs=function(e){return this._initialize(),this._passMap.has(e)?[this._passMap.get(e)]:[]},e.prototype._initialize=function(){this._initialized||(this._passMap=new Map,this._initialized=!0)},e}();t.WGLPainterOptions=g;var y=new Uint8Array(4*l.C_HITTEST_SEARCH_SIZE*l.C_HITTEST_SEARCH_SIZE),x=new Uint32Array(y.buffer),b=function(){function e(){this._hlPainter=new v,this._extrudeMatrix=new Float32Array(16),this._extrudeNoRotationMatrix=new Float32Array(16),this._extrudeRotateVector=new Float32Array([0,0,1]),this._extrudeScaleVector=new Float32Array([1,1,1]),this._state={rotation:0,width:0,height:0},this._cachedWidth=0,this._cachedHeight=0,this._cachedRotation=0,this.materialManager=new s}return e.allGeometryPhases=function(){return[o.WGLDrawPhase.FILL,o.WGLDrawPhase.LINE,o.WGLDrawPhase.MARKER,o.WGLDrawPhase.TEXT]},e.toWGLDrawPhases=function(e){for(var t,i=[],n=0;n<o.WGLDrawPhase.NUM_DRAW_PHASES;n++)(t=1<<n)&e&&i.push(t);return i},Object.defineProperty(e.prototype,"extrudeMatrix",{get:function(){return this._extrudeMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extrudeNoRotationMatrix",{get:function(){return this._extrudeNoRotationMatrix},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.materialManager.dispose(),this.textureManager=null,this._hlPainter&&(this._hlPainter.dispose(),this._hlPainter=null),this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null),this._passes&&(this._passes.forEach(function(e){return e.dispose()}),this._passes.clear()),this._brushes&&(this._brushes.forEach(function(e){return e.forEach(function(e){return e.dispose()})}),this._brushes.clear())},e.prototype.initialize=function(e){this.materialManager.initialize(e)},e.prototype.update=function(e,t){this._state=e,this._state.width===this._cachedWidth&&this._state.height===this._cachedHeight&&this._state.rotation===this._cachedRotation||(this._extrudeScaleVector[0]=2/e.width,this._extrudeScaleVector[1]=-2/e.height,r.identity(this._extrudeMatrix),r.rotate(this._extrudeMatrix,this._extrudeMatrix,-e.rotation*a.C_DEG_TO_RAD,this._extrudeRotateVector),r.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),r.transpose(this._extrudeMatrix,this._extrudeMatrix),r.identity(this._extrudeNoRotationMatrix),r.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),r.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},e.prototype.getBrushes=function(e){if(!this._brushes){var t=new c.default,i=new p.default,n=new f.default,r=new _.default,a=new h.default,s=new u.default,l=new d.default;this._brushes=new Map,this._brushes.set(o.WGLDrawPhase.FILL,[t]),this._brushes.set(o.WGLDrawPhase.MARKER,[i]),this._brushes.set(o.WGLDrawPhase.LINE,[n]),this._brushes.set(o.WGLDrawPhase.TEXT,[r]),this._brushes.set(o.WGLDrawPhase.LABEL,[a]),this._brushes.set(o.WGLDrawPhase.LABEL_ALPHA,[a]),this._brushes.set(o.WGLDrawPhase.HITTEST,[t,i,n,r]),this._brushes.set(o.WGLDrawPhase.HIGHLIGHT,[t,i,n,r]),this._brushes.set(o.WGLDrawPhase.CLIP,[l]),this._brushes.set(o.WGLDrawPhase.DEBUG,[s])}if(!this._brushes.has(e))throw new Error("WGLPainter: Tried to get brush for unknown phase: "+e);return this._brushes.get(e)},e.prototype.bindTextureManager=function(e){this.textureManager=e},e.prototype.draw=function(e,t,i,n){i[0]===o.WGLDrawPhase.LABEL_ALPHA&&i[0]===o.WGLDrawPhase.LABEL||this._drawClippingRects(e,t);var r=e.context;r.setBlendingEnabled(!0),r.setStencilWriteMask(0),r.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,i,n),this._debugTiles(e,t)},e.prototype.setHighlightOptions=function(e){this._hlPainter.setHighlightOptions(e)},e.prototype.highlight=function(e,t){var i=e.context,n=i.getViewport();this._hlPainter.setup(i,n.width,n.height),this._hlPainter.startMaskDraw(i),this._drawClippingRects(e,t),i.setBlendingEnabled(!0),i.setStencilWriteMask(0),i.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,[o.WGLDrawPhase.HIGHLIGHT]),this._hlPainter.draw(i)},e.prototype.hitTest=function(e,t){var i=l.C_HITTEST_SEARCH_SIZE,n=[0,0],r=[0,0],a=e.state;if(a.toMap(n,[0,0]),a.toMap(r,[i,i]),0===t.filter(function(e){return!(n[0]>e.bounds[2]||r[0]<e.bounds[0]||n[1]<e.bounds[1]||r[1]>e.bounds[3])}).length)return[];var s=e.context;this._hittestFBO||(this._hittestFBO=m.create(s,{colorTarget:0,depthStencilTarget:3,width:i,height:i}));var u=s.getViewport(),d=s.getBoundFramebufferObject();s.bindFramebuffer(this._hittestFBO),s.setViewport(0,0,i,i),this._drawClippingRects(e,t);var c=s.gl;s.setClearColor(1,1,1,1),s.clear(c.COLOR_BUFFER_BIT),s.setBlendingEnabled(!1),s.setStencilWriteMask(0),this._drawPhases(e,t,[o.WGLDrawPhase.HITTEST]),s.setBlendingEnabled(!0),this._hittestFBO.readPixels(0,0,i,i,6408,5121,y);for(var h=i*i,f=new Set,p=0;p<h;p++){var _=x[p];4294967295!==_&&f.add(_)}s.bindFramebuffer(d),s.setViewport(u.x,u.y,u.width,u.height);var v=[];return f.forEach(function(e){v.push(e)}),v},e.prototype._getPaintPass=function(e){if(this._passes||(this._passes=new Map),!this._passes.has(e))try{this._passes.set(e,new e)}catch(t){throw new Error("Tried to instantiate WGLPaintPass with unknown constructor: "+e+",\n"+t)}return this._passes.get(e)},e.prototype._getPaintPasses=function(e,t){var i=this;return t.getPaintPassTs(e).map(function(e){return i._getPaintPass(e)})},e.prototype._drawPhases=function(e,t,n,r){e.context.setStencilTestEnabled(!0);for(var o=0,a=n;o<a.length;o++){var s=a[o],l=r?this._getPaintPasses(s,r):[],u=i({},e,{drawPhase:s});l.forEach(function(t){return t.preRender(e,e.rendererInfo)});for(var d=0,c=t;d<c.length;d++)c[d].doRender(u);l.reverse().forEach(function(t){return t.postRender(e,e.rendererInfo)})}e.context.setStencilTestEnabled(!1)},e.prototype._debugTiles=function(e,t){n("esri-feature-tiles-debug")&&this._drawPhases(e,t,[o.WGLDrawPhase.DEBUG])},e.prototype._drawClippingRects=function(e,t){if(0!==t.length){var i=e.context;i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setClearStencil(0),i.clear(i.gl.STENCIL_BUFFER_BIT),i.setStencilWriteMask(255);for(var n=0,r=t.length;n<t.length;n++,r--){var a=t[n];a.attached&&(a.stencilRef=r)}this._drawPhases(e,t,[o.WGLDrawPhase.CLIP]),e.context.setColorMask(!0,!0,!0,!0)}},e}();t.default=b}.apply(null,n))||(e.exports=r)},1387:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(623),i(1388),i(1389)],void 0===(r=function(e,t,i,n,r){function o(e){if(e.geometryType===i.WGLGeometryType.UNKNOWN)return-1;var t,n,r=((n=[])[0]=!!(t=e).sdf,n[1]=!!t.vvSizeMinMaxValue,n[2]=!!t.vvSizeScaleStops,n[3]=!!t.vvSizeFieldStops,n[4]=!!t.vvSizeUnitValue,n[5]=!!t.vvColor,n[6]=!!t.vvRotation,n[7]=!!t.vvOpacity,n[8]=!!t.visibility,n[9]=!!t.pattern,n[10]=!!t.heatmap,n.reduce(function(e,t,i){return t&&(e|=1<<i+2),e},0)<<3);return e.geometryType+r}Object.defineProperty(t,"__esModule",{value:!0}),t.createTextMaterialInfo=function(e,t,a){var s=new n.default,l=new r;return l.geometryType=a,l.sdf=!0,l.pattern=!1,l.visibility=!1,l.heatmap=!1,s.texBindingInfo.push(new n.TexBindingInfo(2,e.page,"u_texture")),0===t?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(t&i.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(t&i.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(t&i.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(t&i.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(t&i.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(t&i.WGLVVFlag.COLOR),l.vvRotation=0!=(t&i.WGLVVFlag.ROTATION)),s.materialKey=o(l),s.materialKeyInfo=l,s},t.createMaterialInfo=function(e,t,a){var s=new n.default,l=new r;if(l.geometryType=t,e){var u=e.spriteMosaicItem;l.sdf=u.sdf,l.pattern=!0,s.texBindingInfo.push(new n.TexBindingInfo(1,u.page,"u_texture"))}else l.sdf=!1,l.pattern=!1;return 0===a?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(a&i.WGLVVFlag.COLOR),l.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),l.visibility=!1,s.materialKey=o(l),s.materialKeyInfo=l,s},t.getMaterialKey=o,t.getMaterialVariations=function(e){return{geometryType:7&e,programOptions:{id:0!=(1&(e>>=3)),highlight:0!=(2&e),isSDF:0!=(4&e),vvSizeMinMaxValue:0!=(8&e),vvSizeScaleStops:0!=(16&e),vvSizeFieldStops:0!=(32&e),vvSizeUnitValue:0!=(64&e),vvColor:0!=(128&e),vvRotation:0!=(256&e),vvOpacity:0!=(512&e),visibility:0!=(1024&e),pattern:0!=(2048&e),heatmap:0!=(4096&e)}}}}.apply(null,n))||(e.exports=r)},1388:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(623),i(1387),i(1533),i(1389),i(1060)],void 0===(r=function(e,t,i,n,r,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,i){this.unit=e,this.pageId=t,this.semantic=i}return e.prototype.clone=function(){return new e(this.unit,this.pageId,this.semantic)},e.prototype.serialize=function(e){return e.push(this.unit),e.push(this.pageId),e},e.deserialize=function(t){return new e(t.readInt32(),t.readInt32(),"u_texture")},e}();t.TexBindingInfo=s;var l=function(){function e(e,t){this.name=e,this.value=t}return e.prototype.clone=function(){return new e(this.name,this.value)},e.prototype.serialize=function(e){return e.push(this.value),e},e.deserialize=function(t){return new e("u_my_param",t.readInt32())},e}();t.MaterialParam=l;var u=function(){function e(){this.texBindingInfo=[],this.materialParams=[]}return e.fromSprite=function(t,r,a){var l=new e,u=new o;return u.geometryType=r,t?(u.sdf=t.sdf,u.pattern=!0,l.texBindingInfo.push(new s(1,t.page,"u_texture"))):(u.sdf=!1,u.pattern=!1),0===a?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(a&i.WGLVVFlag.COLOR),u.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),u.visibility=!1,l.materialKey=n.getMaterialKey(u),l.materialKeyInfo=u,l},e.fromGlyph=function(t,r,a){var l=new e,u=new o;return u.geometryType=r,u.sdf=!0,u.pattern=!1,u.visibility=!1,u.heatmap=!1,l.texBindingInfo.push(new s(2,t.page,"u_texture")),0===a?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(a&i.WGLVVFlag.COLOR),u.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),l.materialKey=n.getMaterialKey(u),l.materialKeyInfo=u,l},e.prototype.copy=function(e){this.materialParams=e.materialParams.map(function(e){return e.clone()}),this.texBindingInfo=e.texBindingInfo.map(function(e){return e.clone()}),e.materialKeyInfo&&(this.materialKeyInfo=new o,this.materialKeyInfo.copy(e.materialKeyInfo)),this.materialKey=e.materialKey},e.prototype.serialize=function(e){return e.push(this.materialKey),a.serializeList(e,this.texBindingInfo),a.serializeList(e,this.materialParams),e},e.deserialize=function(t){var i=new e;return i.materialKey=t.readInt32(),i.texBindingInfo=a.deserializeList(t,s),i.materialParams=a.deserializeList(t,l),i.materialKeyInfo=new o,r(i.materialKeyInfo,i.materialKey),i},e}();t.default=u}.apply(null,n))||(e.exports=r)},1389:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(){this.sdf=!1,this.vvSizeMinMaxValue=!1,this.vvSizeScaleStops=!1,this.vvSizeFieldStops=!1,this.vvSizeUnitValue=!1,this.vvColor=!1,this.vvRotation=!1,this.vvOpacity=!1,this.visibility=!1,this.pattern=!1,this.heatmap=!1}return e.prototype.copy=function(e){this.geometryType=e.geometryType,this.sdf=e.sdf,this.vvSizeMinMaxValue=e.vvSizeMinMaxValue,this.vvSizeScaleStops=e.vvSizeScaleStops,this.vvSizeFieldStops=e.vvSizeFieldStops,this.vvSizeUnitValue=e.vvSizeUnitValue,this.vvColor=e.vvColor,this.vvRotation=e.vvRotation,this.vvOpacity=e.vvOpacity,this.visibility=e.visibility,this.pattern=e.pattern,this.heatmap=e.heatmap},e.prototype.hasVV=function(){return void 0===this._hasVV&&(this._hasVV=this.vvColor||this.vvOpacity||this.vvRotation||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue),this._hasVV},e.prototype.hasVVSize=function(){return this.vvSizeMinMaxValue||this.vvSizeFieldStops||this.vvSizeScaleStops||this.vvSizeUnitValue},e.prototype.hasVVColor=function(){return this.vvColor},e.prototype.hasVVRotation=function(){return this.vvRotation},e.prototype.hasVVOpacity=function(){return this.vvOpacity},e}()}.apply(null,n))||(e.exports=r)},1390:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.background={name:"background",shaders:{vertexShader:i.resolveIncludes("background/background.vert"),fragmentShader:i.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1391:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1282)],void 0===(r=function(e,t,i){return function(){function e(e,t){this._width=0,this._height=0,this._free=[],this._width=e,this._height=t,this._free.push(new i(0,0,e,t))}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.allocate=function(e,t){if(e>this._width||t>this._height)return new i;for(var n=null,r=-1,o=0;o<this._free.length;++o){var a=this._free[o];e<=a.width&&t<=a.height&&(null===n||a.y<=n.y&&a.x<=n.x)&&(n=a,r=o)}return null===n?new i:(this._free.splice(r,1),n.width<n.height?(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,t)),n.height>t&&this._free.push(new i(n.x,n.y+t,n.width,n.height-t))):(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,n.height)),n.height>t&&this._free.push(new i(n.x,n.y+t,e,n.height-t))),new i(n.x,n.y,e,t))},e.prototype.release=function(e){for(var t=0;t<this._free.length;++t){var i=this._free[t];if(i.y===e.y&&i.height===e.height&&i.x+i.width===e.x)i.width+=e.width;else if(i.x===e.x&&i.width===e.width&&i.y+i.height===e.y)i.height+=e.height;else if(e.y===i.y&&e.height===i.height&&e.x+e.width===i.x)i.x=e.x,i.width+=e.width;else{if(e.x!==i.x||e.width!==i.width||e.y+e.height!==i.y)continue;i.y=e.y,i.height+=e.height}this._free.splice(t,1),this.release(e)}this._free.push(e)},e}()}.apply(null,n))||(e.exports=r)},1392:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(t){var i=new e.ARRAY_TYPE(9);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromValues:function(t,i,n,r,o,a,s,l,u){var d=new e.ARRAY_TYPE(9);return d[0]=t,d[1]=i,d[2]=n,d[3]=r,d[4]=o,d[5]=a,d[6]=s,d[7]=l,d[8]=u,d},set:function(e,t,i,n,r,o,a,s,l,u){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var i=t[1],n=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],d=t[8],c=d*a-s*u,h=-d*o+s*l,f=u*o-a*l,p=i*c+n*h+r*f;return p?(p=1/p,e[0]=c*p,e[1]=(-d*n+r*u)*p,e[2]=(s*n-r*a)*p,e[3]=h*p,e[4]=(d*i-r*l)*p,e[5]=(-s*i+r*o)*p,e[6]=f*p,e[7]=(-u*i+n*l)*p,e[8]=(a*i-n*o)*p,e):null},adjoint:function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],d=t[8];return e[0]=a*d-s*u,e[1]=r*u-n*d,e[2]=n*s-r*a,e[3]=s*l-o*d,e[4]=i*d-r*l,e[5]=r*o-i*s,e[6]=o*u-a*l,e[7]=n*l-i*u,e[8]=i*a-n*o,e},determinant:function(e){var t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*(u*o-a*l)+i*(-u*r+a*s)+n*(l*r-o*s)},multiply:function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=i[0],f=i[1],p=i[2],_=i[3],v=i[4],m=i[5],g=i[6],y=i[7],x=i[8];return e[0]=h*n+f*a+p*u,e[1]=h*r+f*s+p*d,e[2]=h*o+f*l+p*c,e[3]=_*n+v*a+m*u,e[4]=_*r+v*s+m*d,e[5]=_*o+v*l+m*c,e[6]=g*n+y*a+x*u,e[7]=g*r+y*s+x*d,e[8]=g*o+y*l+x*c,e}};return t.mul=t.multiply,t.translate=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=i[0],f=i[1];return e[0]=n,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=h*n+f*a+u,e[7]=h*r+f*s+d,e[8]=h*o+f*l+c,e},t.rotate=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=Math.sin(i),f=Math.cos(i);return e[0]=f*n+h*a,e[1]=f*r+h*s,e[2]=f*o+h*l,e[3]=f*a-h*n,e[4]=f*s-h*r,e[5]=f*l-h*o,e[6]=u,e[7]=d,e[8]=c,e},t.scale=function(e,t,i){var n=i[0],r=i[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=i+i,s=n+n,l=r+r,u=i*a,d=n*a,c=n*s,h=r*a,f=r*s,p=r*l,_=o*a,v=o*s,m=o*l;return e[0]=1-c-p,e[3]=d-m,e[6]=h+v,e[1]=d+m,e[4]=1-u-p,e[7]=f-_,e[2]=h-v,e[5]=f+_,e[8]=1-u-c,e},t.normalFromMat4=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],d=t[8],c=t[9],h=t[10],f=t[11],p=t[12],_=t[13],v=t[14],m=t[15],g=i*s-n*a,y=i*l-r*a,x=i*u-o*a,b=n*l-r*s,S=n*u-o*s,I=r*u-o*l,w=d*_-c*p,M=d*v-h*p,V=d*m-f*p,D=c*v-h*_,T=c*m-f*_,C=h*m-f*v,E=g*C-y*T+x*D+b*V-S*M+I*w;return E?(E=1/E,e[0]=(s*C-l*T+u*D)*E,e[1]=(l*V-a*C-u*M)*E,e[2]=(a*T-s*V+u*w)*E,e[3]=(r*T-n*C-o*D)*E,e[4]=(i*C-r*V+o*M)*E,e[5]=(n*V-i*T-o*w)*E,e[6]=(_*I-v*S+m*b)*E,e[7]=(v*x-p*I-m*y)*E,e[8]=(p*S-_*x+m*g)*E,e):null},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e},t.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e},t.sub=t.subtract,t.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e},t.multiplyScalarAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e[4]=t[4]+i[4]*n,e[5]=t[5]+i[5]*n,e[6]=t[6]+i[6]*n,e[7]=t[7]+i[7]*n,e[8]=t[8]+i[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=i[0],f=i[1],p=i[2],_=i[3],v=i[4],m=i[5],g=t[6],y=i[7],x=i[8];return Math.abs(n-h)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-p)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-_)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-v)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-m)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(u-g)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(d-y)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(c-x)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))},t}.apply(null,n))||(e.exports=r)},1434:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(412),i(759),i(961),i(410),i(728),i(725),i(456),i(1554),i(385)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c){var h=["fillVertexBuffer","fillDDVertexBuffer","fillIndexBuffer","outlineVertexBuffer","outlineDDVertexBuffer","outlineIndexBuffer","lineVertexBuffer","lineDDVertexBuffer","lineIndexBuffer","iconVertexBuffer","iconDDVertexBuffer","iconIndexBuffer","textVertexBuffer","textDDVertexBuffer","textIndexBuffer","circleVertexBuffer","circleIndexBuffer"];return function(e){function t(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var a=e.call(this)||this;return a._renderBuckets=[],a._vectorTileData=null,a._symbolUpdateData=null,a.status=l.TileStatus.INITIALIZED,a.coords=[0,0],a.bounds=[0,0,0,0],a.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]},a.stencilData={mask:0,reference:0},a.status=l.TileStatus.INITIALIZED,a.tileTransform.transform=r.create(),a.tileTransform.displayCoord=o.create(),i.length>0&&(t=a.acquire).call.apply(t,[a].concat(i)),a}return i(t,e),t.prototype.reset=function(){u.pool.release(this.key),this.key=null,this.refKey=null,this.coords[0]=0,this.coords[1]=0,this.bounds[0]=0,this.bounds[1]=0,this.bounds[2]=0,this.bounds[3]=0,this.width=0,this.height=0,this.resolution=null,this.rotation=0,this._vectorTileData=null,this.styleLayers=null,this.client=null,this.id=null,this.tileTransform.transform.fill(0),this.tileTransform.displayCoord.fill(0),this.stencilData.mask=0,this.stencilData.reference=0,this._renderBuckets.length=0,this._symbolUpdateData=null,this.status=l.TileStatus.INITIALIZED},t.prototype.acquire=function(e,t,i,n,r){this.key=e,this.refKey=t;var o=i.lodAt(e.level),s=null!==o?o.resolution:0,l=i.size[0]*s,u=i.origin,d=e.col*l,c=e.row*l,h=i.spatialReference,f=0;if(h&&(h._isWrappable?h._isWrappable():h.isWrappable)){var p=a.getInfo(h);f=p.valid[1]-p.valid[0]}var _=e.world*f,v=u.x+d+_,m=u.y-c,g=v+l,y=m-l;this.coords[0]=v,this.coords[1]=m,this.bounds[0]=v,this.bounds[1]=m,this.bounds[2]=g,this.bounds[3]=y,this.widthInPixels=i.size[1],this.coordRange=4096,this.resolution=s,this.rotation=r,this.styleLayers=n,this.id=e.id},t.prototype.setData=function(e,t){this._vectorTileData=e,this.client=t,e&&e.bufferDataInfo||(this.status=l.TileStatus.NO_DATA)},t.prototype.updateSymbolData=function(e){e&&(this._symbolUpdateData=e,this.requestRender())},t.prototype.dispose=function(){for(var e=["fillVertexArrayObject","fillDDVertexArrayObject","outlineVertexArrayObject","lineVertexArrayObject","lineDDVertexArrayObject","iconVertexArrayObject","iconDDVertexArrayObject","textVertexArrayObject","textDDVertexArrayObject","circleVertexArrayObject","fillVertexBuffer","fillDDVertexBuffer","fillIndexBuffer","outlineVertexBuffer","outlineDDVertexBuffer","outlineIndexBuffer","lineVertexBuffer","lineDDVertexBuffer","lineIndexBuffer","iconVertexBuffer","iconDDVertexBuffer","iconIndexBuffer","textVertexBuffer","textDDVertexBuffer","textIndexBuffer","circleVertexBuffer","circleIndexBuffer","texture"],t=0;t<e.length;++t){var i=e[t];this[i]&&(this[i].dispose(),this[i]=null)}this._renderBuckets.length=0,this.status=l.TileStatus.INITIALIZED},t.prototype.getCpuMemoryUsage=function(){return null!=this._vectorTileData&&this._vectorTileData.bufferData?this._vectorTileData.bufferData.reduce(function(e,t){return e+t.byteLength},0)+this._vectorTileData.bufferDataInfo.byteLength+this._vectorTileData.bucketDataInfo.byteLength:0},t.prototype.getGpuMemoryUsage=function(){var e=this,t=h.reduce(function(t,i){return e[i]?t+e[i].size:t},0);return this.texture&&(t+=this.texture.descriptor.width*this.texture.descriptor.height*4),t},t.prototype.attach=function(e){return this.status!==l.TileStatus.INITIALIZED||(this._createRenderBuckets(),this._createBufferObjects(e),this._vectorTileData=null,this.status=l.TileStatus.READY,!0)},t.prototype._createRenderBuckets=function(){if(0===this._renderBuckets.length)for(var e=new Uint32Array(this._vectorTileData.bucketDataInfo),t=e.length,i=0;i<t;){var n=e[i];switch(e[i+1]){case 0:var r=new d.BackgroundRenderBucket;r.layerID=n,this._renderBuckets.push(r),i+=2;break;case 1:var o=new d.FillRenderBucket;o.layerID=n,o.triangleElementStart=e[i+2],o.triangleElementCount=e[i+3],o.outlineElementStart=e[i+4],o.outlineElementCount=e[i+5],this._renderBuckets.push(o),i+=6;break;case 2:var a=new d.LineRenderBucket;a.layerID=n,a.triangleElementStart=e[i+2],a.triangleElementCount=e[i+3],this._renderBuckets.push(a),i+=4;break;case 3:var s=new d.SymbolRenderBucket;s.layerID=n,s.isSDF=0!==e[i+2];var l=i+3,u=e[l];if(l++,u>0)for(var c=void 0,h=void 0,f=void 0,p=0;p<u;p++)c=e[l],h=e[l+1],f=e[l+2],s.markerPerPageElementsMap.set(c,[h,f]),l+=3;var _=l,v=e[_];if(_++,v>0)for(c=void 0,h=void 0,f=void 0,p=0;p<v;p++)c=e[_],h=e[_+1],f=e[_+2],s.glyphPerPageElementsMap.set(c,[h,f]),_+=3;this._renderBuckets.push(s),i+=5+3*u+3*v;break;case 4:var m=new d.CircleRenderBucket;m.layerID=n,m.triangleElementStart=e[i+2],m.triangleElementCount=e[i+3],this._renderBuckets.push(m),i+=4;break;default:console.error("Bad bucket type!"),i+=2}}},t._createBufferToObject=function(){var e=[];return e[1]={create:c.createVertex,var:"fillVertexBuffer"},e[2]={create:c.createVertex,var:"fillDDVertexBuffer"},e[3]={create:c.createIndex,var:"fillIndexBuffer"},e[4]={create:c.createVertex,var:"outlineVertexBuffer"},e[5]={create:c.createVertex,var:"outlineDDVertexBuffer"},e[6]={create:c.createIndex,var:"outlineIndexBuffer"},e[7]={create:c.createVertex,var:"lineVertexBuffer"},e[9]={create:c.createIndex,var:"lineIndexBuffer"},e[10]={create:c.createVertex,var:"iconVertexBuffer"},e[11]={create:c.createVertex,var:"iconDDVertexBuffer"},e[12]={create:c.createIndex,var:"iconIndexBuffer"},e[13]={create:c.createVertex,var:"textVertexBuffer"},e[14]={create:c.createVertex,var:"textDDVertexBuffer"},e[15]={create:c.createIndex,var:"textIndexBuffer"},e[16]={create:c.createVertex,var:"circleVertexBuffer"},e[17]={create:c.createIndex,var:"circleIndexBuffer"},e},t.prototype._createBufferObjects=function(e){for(var i=e.context,n=new Uint32Array(this._vectorTileData.bufferDataInfo),r=n.length,o=0,a=0;a<r;a+=2,o++){var s=n[a];if(!(n[a+1]<=0||0===this._vectorTileData.bufferData[o].byteLength)){var l=t.bufferToObject[s];l?this[l.var]?this[l.var].setData(this._vectorTileData.bufferData[o]):this[l.var]=l.create(i,35044,this._vectorTileData.bufferData[o]):console.error("Bad buffer type "+s)}}},t.prototype.detach=function(t){this.client&&this.status!==l.TileStatus.INVALID&&this.status!==l.TileStatus.INITIALIZED&&this.client.invoke("destructTileData",this.id),this.dispose(),e.prototype.detach.call(this,t)},t.prototype.doRender=function(e){if(this.visible&&this.status===l.TileStatus.READY){var t=e.context,i=e.renderer;if(t&&i){var n=e.drawphase;this._symbolUpdateData&&this._updateSymbolData(e),t.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);var r=this.styleLayers,o=void 0!==e.layerOpacity?e.layerOpacity:1;if(0!==o){var a=this._renderBuckets.length;if(0===n)for(var s=a-1;s>=0;s--){1!==(u=this._renderBuckets[s]).type&&0!==u.type||!u.hasData()||i.renderBucket(t,u,e.displayLevel,e.requiredLevel,n,this,r.layers[u.layerID],o)}else for(s=0;s<a;s++){var u;(u=this._renderBuckets[s]).hasData()&&i.renderBucket(t,u,e.displayLevel,e.requiredLevel,n,this,r.layers[u.layerID],o)}}}}},t.prototype._updateSymbolData=function(e){if(!this._symbolUpdateData.bucketDataInfo)return!0;var t=new Uint32Array(this._symbolUpdateData.bucketDataInfo),i=t.length;if(0===i)return this._symbolUpdateData=null,!0;if(this.status!==l.TileStatus.READY)return this.requestRender(),!1;for(var n=e.context,r=new Uint32Array(this._symbolUpdateData.bufferDataInfo),o=r.length,a=0,s=0;s<o;s+=2,a++)switch(r[s]){case 10:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null),this.iconVertexBuffer=c.createVertex(n,35044,this._symbolUpdateData.bufferData[a]);break;case 11:this.iconDDVertexBuffer&&(this.iconDDVertexBuffer.dispose(),this.iconDDVertexBuffer=null),this.iconDDVertexBuffer=c.createVertex(n,35044,this._symbolUpdateData.bufferData[a]);break;case 12:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null),this.iconIndexBuffer=c.createIndex(n,35044,this._symbolUpdateData.bufferData[a]);break;case 13:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null),this.textVertexBuffer=c.createVertex(n,35044,this._symbolUpdateData.bufferData[a]);break;case 14:this.textDDVertexBuffer&&(this.textDDVertexBuffer.dispose(),this.textDDVertexBuffer=null),this.textDDVertexBuffer=c.createVertex(n,35044,this._symbolUpdateData.bufferData[a]);break;case 15:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=c.createIndex(n,35044,this._symbolUpdateData.bufferData[a])}for(var u=this._renderBuckets.length,h=0;h<u;h++)if(this._renderBuckets[h]instanceof d.SymbolRenderBucket){var f=this._renderBuckets[h];f.markerPerPageElementsMap.clear(),f.glyphPerPageElementsMap.clear()}for(var p,_,v=0;v<i;){var m=t[v];_=-1;var g=this._renderBuckets.length;for(h=0;h<g;h++)if(this._renderBuckets[h].layerID===m){_=h;break}(p=this._renderBuckets[_])||((p=new d.SymbolRenderBucket).layerID=m,p.isSDF=0!==t[v+2],this._renderBuckets.push(p));var y=v+3,x=t[y];if(y++,x>0)for(var b=void 0,S=void 0,I=void 0,w=0;w<x;w++)b=t[y],S=t[y+1],I=t[y+2],p.markerPerPageElementsMap.set(b,[S,I]),y+=3;var M=y,V=t[M];if(M++,V>0)for(b=void 0,S=void 0,I=void 0,w=0;w<V;w++)b=t[M],S=t[M+1],I=t[M+2],p.glyphPerPageElementsMap.set(b,[S,I]),M+=3;v+=5+3*x+3*V}return this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null),this.iconDDVertexArrayObject&&(this.iconDDVertexArrayObject.dispose(),this.iconDDVertexArrayObject=null),this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null),this.textDDVertexArrayObject&&(this.textDDVertexArrayObject.dispose(),this.textDDVertexArrayObject=null),this._symbolUpdateData=null,!0},t.pool=new n(t),t.bufferToObject=t._createBufferToObject(),t}(s)}.apply(null,n))||(e.exports=r)},1527:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(354),i(340),i(716),i(1528),i(623),i(1531),i(1386),i(1547),i(671),i(745),i(698),i(711),i(385),i(796),i(377),i(417),i(1010),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v,m,g,y,x){function b(e){return{state:e.state,pixelRatio:e.pixelRatio,stationary:e.stationary}}return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._clipData=new Float32Array(8),t._upperLeft=f.create(),t._upperRight=f.create(),t._lowerLeft=f.create(),t._lowerRight=f.create(),t._mat2=h.create(),t._clipRendererInitialized=!1,t._contextVersion=null,t._labelFader=new l.default(t),t}return i(t,e),Object.defineProperty(t.prototype,"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0}),t.prototype.fadeInLabels=function(){this._labelFader.reset(),this.requestRender()},t.prototype.createElement=function(){var e=document.createElement("canvas");return e.setAttribute("class","esri-display-object"),e},t.prototype.setElement=function(e){this.element=e},t.prototype.useContextVersion=function(e){this._renderingContext||(this._contextVersion=e)},t.prototype.attach=function(t){if(this.attached)return!0;this._resizeCanvas(t);var i=v.createContextOrErrorHTML(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0},this._contextVersion);return this._renderingContext=new y(i),this._contextVersion=this._renderingContext.contextVersion,this.attached=!0,this._cachedRenderParams=b(t),this._painter||(this._painter=new u.default,this._painter.initialize(this._renderingContext)),e.prototype.attach.call(this,t)},t.prototype.detach=function(t){e.prototype.detach.call(this,t),this._boundFBO=null,this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null),this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO1=null),this._labelsFBO2&&(this._labelsFBO2.dispose(),this._labelsFBO2=null),this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null),this._clipVAO&&(this._clipVAO.dispose(),this._clipVAO=null,this._clipVBO=null),this._painter&&(this._painter.dispose(),this._painter=null),this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null),this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null),this._cachedRenderParams=null},t.prototype.renderChildren=function(e){var t=this.children;e.drawPhase=s.WGLDrawPhase.FILL|s.WGLDrawPhase.LINE|s.WGLDrawPhase.MARKER|s.WGLDrawPhase.TEXT;for(var i=t.length,r=0;r<i;r++){(u=t[r]).attached&&this.renderChild(u,e)}if(n("esri-featurelayer-webgl-labeling")){var o=e.context,a=o.getBoundFramebufferObject();o.bindFramebuffer(this._labelsFBO2);var l=e.stationary;if(o.setClearColor(0,0,0,l?0:1),o.clear(o.gl.COLOR_BUFFER_BIT),l){e.drawPhase=s.WGLDrawPhase.LABEL_ALPHA,e.labelFBO=this._labelsFBO1,e.labelStep=this._labelFader.step();for(r=0;r<i;r++){(u=t[r]).attached&&this.renderChild(u,e)}}else this._labelFader.reset();o.bindFramebuffer(a),e.labelFBO=this._labelsFBO2,e.drawPhase=s.WGLDrawPhase.LABEL;for(r=0;r<i;r++){var u;(u=t[r]).attached&&this.renderChild(u,e)}var d=this._labelsFBO2;this._labelsFBO2=this._labelsFBO1,this._labelsFBO1=d}},t.prototype.beforeRenderChildren=function(e,t){var i=t.context,r=t.state,o=t.pixelRatio,a=this._painter;if(a){i.enforceState(),a.update(r,o);var s=r.width,l=r.height,u=r.rotation;if(s=Math.round(s*o),l=Math.round(l*o),this._boundFBO=i.getBoundFramebufferObject(),!n("esri-featurelayer-webgl-labeling")||this._labelsFBO1&&this._labelsFBO1.width===s&&this._labelsFBO1.height===l||(this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO2.dispose()),this._labelsFBO1=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0}),i.bindFramebuffer(this._labelsFBO1),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),i.bindFramebuffer(this._boundFBO),this._labelsFBO2=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0})),!(r.spatialReference&&(r.spatialReference._isWrappable?r.spatialReference._isWrappable():r.spatialReference.isWrappable)))return void(this._clipFrame=!1);var d=c.toRadian(u),p=Math.abs(Math.cos(d)),_=Math.abs(Math.sin(d)),v=Math.round(s*p+l*_),g=Math.round(r.worldScreenWidth);if(v<=g)return void(this._clipFrame=!1);this._clipFBO&&this._clipFBO.width===s&&this._clipFBO.height===l||(this._clipFBO=new m(i,{colorTarget:0,depthStencilTarget:3,width:s,height:l}));var y=.5*s,x=.5*l,b=1/s,S=1/l,I=.5*g*o,w=.5*(s*_+l*p),M=this._upperLeft,V=this._upperRight,D=this._lowerLeft,T=this._lowerRight;f.set(M,-I,-w),f.set(V,I,-w),f.set(D,-I,w),f.set(T,I,w),h.identity(this._mat2),h.translate(this._mat2,this._mat2,[y,x]),0!==u&&h.rotate(this._mat2,this._mat2,d),f.transformMat2d(M,M,this._mat2),f.transformMat2d(V,V,this._mat2),f.transformMat2d(D,D,this._mat2),f.transformMat2d(T,T,this._mat2);var C=this._clipData;C.set([2*D[0]*b-1,2*(l-D[1])*S-1,2*T[0]*b-1,2*(l-T[1])*S-1,2*M[0]*b-1,2*(l-M[1])*S-1,2*V[0]*b-1,2*(l-V[1])*S-1]),this._clipRendererInitialized||this._initializeClipRenderer(i),this._clipVBO.setData(C),this._boundFBO=i.getBoundFramebufferObject(),i.bindFramebuffer(this._clipFBO),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),this._clipFrame=!0}},t.prototype.afterRenderChildren=function(e,t){var i=this._renderingContext;i.logIno(),this._clipFrame&&this._clipRendererInitialized&&(i.bindFramebuffer(this._boundFBO),this._boundFBO=null,i.bindVAO(this._clipVAO),i.bindProgram(this._clipStencilProgram),i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setStencilWriteMask(255),i.setStencilFunction(519,1,255),i.drawElements(4,6,5123,0),i.bindVAO(),i.setColorMask(!0,!0,!0,!0),i.setBlendingEnabled(!0),i.setStencilFunction(514,1,255),this._blitRenderer.render(i,this._clipFBO.colorTexture,9728,1),i.setStencilTestEnabled(!1))},t.prototype.doRender=function(t){var i=this.element.style;this.visible?(i.display="block",i.opacity=""+this.opacity,this._resizeCanvas(t),e.prototype.doRender.call(this,t),this._cachedRenderParams=b(t)):i.display="none"},t.prototype.takeScreenshot=function(e){if(!this._cachedRenderParams)return r.reject();this._cachedRenderParams.pixelRatio=e.pixelRatio;var t=e.framebufferWidth,i=e.framebufferHeight,n=e.region,o=document.createElement("canvas");o.width=t,o.height=i;var a=p.createEmptyImageData(n.width,n.height,o),s=this._renderingContext,l=m.create(s,{colorTarget:0,depthStencilTarget:3,width:t,height:i});s.bindFramebuffer(l),s.setViewport(0,0,t,i);var u=this._cachedRenderParams,d=this._renderingContext.gl;if(this._renderingContext.setClearColor(0,0,0,0),this._renderingContext.setClearDepth(1),this._renderingContext.setClearStencil(0),this._renderingContext.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT),u.context=this._renderingContext,u.painter=this._painter,this.beforeRenderChildren(u,u),null!=e.rotation){var c=u.state,h=c.clone();h.viewpoint.rotation=e.rotation,u.state=h,this.renderChildren(u),u.state=c}else this.renderChildren(u);this.afterRenderChildren(u,u),l.readPixels(n.x,i-(n.y+n.height),n.width,n.height,6408,5121,new Uint8Array(a.data.buffer)),s.bindFramebuffer();var f=p.encodeResult(a,e,o,{flipY:!0,premultipliedAlpha:!0});return r.resolve(f)},t.prototype.prepareChildrenRenderParameters=function(e){if(!this.attached||!this._renderingContext)return null;var t=b(e),i=this._renderingContext,n=i.gl;return i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT),i.setViewport(0,0,this.element.width,this.element.height),i.setDepthWriteEnabled(!1),t.context=i,t.painter=this._painter,t},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){return e.detach(t)},t.prototype.renderChild=function(e,t){return e.processRender(t)},t.prototype._resizeCanvas=function(e){var t=this.element,i=t.style,n=e.state,r=e.pixelRatio,o=Math.round(n.width*r),a=Math.round(n.height*r);t.width===o&&t.height===a||(t.width=o,t.height=a),i.width=n.width+"px",i.height=n.height+"px"},t.prototype._initializeClipRenderer=function(e){if(this._clipRendererInitialized)return!0;this._blitRenderer=new a;var t=d.stencil.attributes,i=g.createProgram(e,d.stencil);if(!i)return!1;var n=_.createVertex(e,35040,32),r=new Uint16Array([0,1,2,2,1,3]),o=_.createIndex(e,35044,r),s=new x(e,t,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:n},o);return this._clipStencilProgram=i,this._clipVBO=n,this._clipVAO=s,this._clipRendererInitialized=!0,!0},t}(o)}.apply(null,n))||(e.exports=r)},1528:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1529),i(385),i(417),i(381)],void 0===(r=function(e,t,i,n,r,o){return function(){function e(){this._initialized=!1}return e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},e.prototype.render=function(e,t,i,n){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(1,771,1,771),e.bindVAO(this._vertexArrayObject),e.bindProgram(this._program),t.setSamplingMode(i),e.bindTexture(t,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",n),e.drawArrays(5,0,4),e.bindVAO())},e.prototype._initialize=function(e){if(this._initialized)return!0;var t=i.bitBlit.attributes,a=r.createProgram(e,i.bitBlit);if(!a)return!1;var s=new Int8Array(16);s[0]=-1,s[1]=-1,s[2]=0,s[3]=0,s[4]=1,s[5]=-1,s[6]=1,s[7]=0,s[8]=-1,s[9]=1,s[10]=0,s[11]=1,s[12]=1,s[13]=1,s[14]=1,s[15]=1;var l=new o(e,t,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:n.createVertex(e,35044,s)});return this._program=a,this._vertexArrayObject=l,this._initialized=!0,!0},e}()}.apply(null,n))||(e.exports=r)},1529:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.bitBlit={name:"bitBlit",shaders:{vertexShader:i.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:i.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}}.apply(null,n))||(e.exports=r)},1530:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor = u_color;\n}\n","background.vert":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n}\n"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\n\nvarying mediump vec2 v_uv;\n\nvoid main() {\n  lowp vec4 color = texture2D(u_tex, v_uv);\n\n  // Note: output in pre-multiplied alpha for correct alpha compositing\n  gl_FragColor = color *  u_opacity;\n}\n","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_tex;\n}\n"},heatmap:{"heatmap.frag":"precision mediump float;\n\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nuniform mediump vec2 u_minmax;\nuniform lowp sampler2D u_gradient;\n\nvarying mediump vec2 v_uv;\nvarying mediump float v_slope;\n\nvec4 getColor(float intensity) {\n  float normalizedIntensity = clamp((intensity - u_minmax.x) * v_slope, 0.0, 1.0);\n\n  return texture2D(u_gradient, vec2(0.5, normalizedIntensity));\n}\n\nvoid main() {\n  // sample the intensity value\n  lowp vec4 color = texture2D(u_texture, v_uv);\n\n  // interpolate the color from the ramp using the intensity value\n  gl_FragColor = getColor(color.r) *  u_opacity;\n}\n","heatmap.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nuniform mediump vec2 u_minmax;\n\nvarying mediump vec2 v_uv;\nvarying mediump float v_slope;\n\nvoid main(void) {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_tex;\n  v_slope = 1.0 / (u_minmax.y - u_minmax.x);\n}\n"},highlight:{"blur.frag":"// A gaussian blur shader. It blurs the alpha channel of its input\n// according to 4 different sigma and stores the results into the\n// four channel of the target framebuffer.\n\n// It is intended to be called twice; the first time to perform an\n// horizontal blur, and a second time to perform a vertical blur.\n\n// This shader is used to turn the highlight mask into a highlight\n// map. The highlight map is an approximation of the signed distance\n// field of the mask.\n\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// Blur direction information. There are two possible\n// configurations that the host code can use.\n//  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\n//    case u_direction[0] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[2] = 1/WIDTH is in texel units\n//    and is used to sample the right texel from the texture map.\n//  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\n//    case u_direction[1] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[3] = 1/HEIGHT is in texel units\n//    and is used to sample the right texel from the texture map.\nuniform mediump vec4 u_direction;\n\n// Source to destination channel selection matrix.\nuniform mediump mat4 u_channelSelector;\n\n// The highlight map is obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// This is the highlight mask if we have not blurred horizontally yet, otherwise\n// it is the horizontally blurred highlight map and blurring it one more time\n// vertically will complete the process.\nuniform sampler2D u_texture;\n\n// The gaussian kernel. Note that it lacks the normalization constant, because\n// we want to store it unnormalized in the highlight map (i.e. having a peak\n// value of 1). Note also that we are using the SIMD (single instruction, multiple\n// data) capabilities of the GPU to compute four different gaussian kernels, one\n// for each sigma.\nmediump vec4 gauss(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\n\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\n\n// Sample the input texture and accumulated its gaussian weighted value and the\n// total weight.\nvoid accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  // Computes the gaussian weights, one for each sigma.\n  // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n  mediump vec4 w = gauss(i * u_direction.xy);\n\n  // Accumumates the values.\n  // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n  tot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n\n  // Accumulates the weights.\n  weight += w;\n}\n\nvoid main(void) {\n  // Initialize accumulated values and weights to zero.\n  mediump vec4 tot = vec4(0.0, 0.0, 0.0, 0.0);\n  mediump vec4 weight = vec4(0.0, 0.0, 0.0, 0.0);\n\n  // Accumulates enough samples. These will be taken\n  // horizontally or vertically depending on the value\n  // of u_direction.\n  accumGauss(-5.0, tot, weight);\n  accumGauss(-4.0, tot, weight);\n  accumGauss(-3.0, tot, weight);\n  accumGauss(-2.0, tot, weight);\n  accumGauss(-1.0, tot, weight);\n  accumGauss(0.0, tot, weight);\n  accumGauss(1.0, tot, weight);\n  accumGauss(2.0, tot, weight);\n  accumGauss(3.0, tot, weight);\n  accumGauss(4.0, tot, weight);\n  accumGauss(5.0, tot, weight);\n\n  // Compute blurred values.\n  mediump vec4 rgba = tot / weight;\n\n  // Return the values. Note that each channel will contain\n  // the result of a different blur operation, one for each\n  // of the four chosen sigma.\n  gl_FragColor = vec4(rgba);\n}\n","highlight.frag":"// Takes as input the highlight map, estimated the signed distance field,\n// and shades the fragments according to their estimated distance from the\n// edge of the highlighted feature.\n\n// A shade texture is used to turn distance values into colors; the shade\n// texture is basically a color gradient and is recomputed on the host\n// every time that the user alters the highlight options.\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// The highlight map. Each channel is a blurred\n// version of the alpha channel of the highlight mask.\n//  - Channel 0 (red) corresponds to a gaussian blur with sigma = u_sigmas[0];\n//  - Channel 1 (green) corresponds to a gaussian blur with sigma = u_sigmas[1];\n//  - Channel 2 (blue) corresponds to a gaussian blur with sigma = u_sigmas[2];\n//  - Channel 3 (alpha) corresponds to a gaussian blur with sigma = u_sigmas[3];\n// As of today, only channel 3 is used for distance estimation.\n// But the availability of different amounts of blur leaves the\n// door open to multi-scale approaches.\nuniform sampler2D u_texture;\n\n// The highlight map was obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// A 1-D texture used to shade the highlight.\nuniform sampler2D u_shade;\n\n// The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\nuniform mediump vec2 u_minMaxDistance;\n\n// Signed distance estimation.\nmediump float estimateDistance() {\n  // Use the largest sigma and the corresponding distance value stored in the\n  // last channel of the highlight map.\n  mediump float sigma = u_sigmas[3];\n  mediump float y = texture2D(u_texture, v_texcoord)[3];\n\n  // Estimates the distance by linearization and local inversion around\n  // the inflection point. The inflection point is in x = 0.\n  const mediump float y0 = 0.5;                           // Value of the convolution at the inflection point.\n  mediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\n  mediump float d = (y - y0) / m0;                        // Inversion of a local linearization.\n\n  // Return the estimated distance.\n  return d;\n}\n\n// Shading based on estimated distance.\nmediump vec4 shade(mediump float d) {\n  // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\n  mediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n\n  // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\n  // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\n  // banding artifacts.\n  // We don't really know if we need this or not.\n  mappedDistance = clamp(mappedDistance, 0.0, 1.0);\n\n  // Sample the 1-D shade texture on its center line (i.e. on t=0.5).\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\n\nvoid main(void) {\n  // Estimate the distance.\n  mediump float d = estimateDistance();\n\n  // Shade the distance.\n  gl_FragColor = shade(d);\n}\n","textured.vert":"// Identity vertex shader that outputs an untransformed 2-D vertex\n// and passes its texture coordinates unchanged to the interpolator.\n\n// Vertex position.\nattribute mediump vec2 a_position;\n\n// Texture coordinates.\nattribute mediump vec2 a_texcoord;\n\n// Texture coordinates to be interpolated.\nvarying mediump vec2 v_texcoord;\n\nvoid main(void) {\n  // Pass the position unchanged.\n  gl_Position = vec4(a_position, 0.0, 1.0);\n\n  // Pass the texture coordinates unchanged.\n  v_texcoord = a_texcoord;\n}\n"},materials:{fill:{"fill.frag":"precision lowp float;\nuniform lowp float u_opacity;\n\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\nvoid main()\n{\n#ifdef PATTERN\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  // sample the sprite mosaic\n  lowp vec4 color = texture2D(u_texture, samplePos);\n  gl_FragColor = u_opacity * v_opacity * v_color * color;\n#else\n  gl_FragColor = u_opacity * v_opacity * v_color;\n#endif // PATTERN\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  //if (gl_FragColor.a < 1.0 / 255.0) {\n  //  discard;\n  //}\n  gl_FragColor = v_id;\n#endif // ID\n}\n","fill.vert":"precision mediump float;\n\nattribute vec2 a_pos;\nattribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux;\n\nattribute float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/fill/vvUniforms.glsl>\n#include <materials/fill/vvFunctions.glsl>\n\n#ifdef PATTERN\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n#ifdef VV_OPACITY\n  v_opacity = getVVOpacity(a_vv.y);\n#else\n  v_opacity = 1.0;\n#endif\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.x, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n\n#ifdef PATTERN\n  // calculate the pattern matrix\n  mat3 patternMatrix = mat3(1.0, 0.0, 0.0,\n                            0.0, 1.0, 0.0,\n                            0.0, 0.0, 1.0);\n  patternMatrix[0][0] = 1.0 / (u_zoomFactor * a_aux.x);\n  patternMatrix[1][1] = 1.0 / (u_zoomFactor * a_aux.y);\n\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from\n  // tile coordinates to texture coordinates.\n  v_tileTextureCoord = (patternMatrix * vec3(a_pos, 1.0)).xy;\n  v_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n#endif // PATTERN\n\n  float z = 2.0 * (1.0 - a_visible); // clip the vertex if the geometry isn't visible\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0);\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\n\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR)|| defined(VV_OPACITY)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_OPACITY\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n"},icon:{"icon.frag":"precision mediump float;\n\nuniform lowp sampler2D u_texture;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\n\n// we need the conversion function from RGBA to float\n#include <util/encoding.glsl>\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n#ifdef HEATMAP\nvarying mediump float v_heatmapWeight;\n#endif // HEATMAP\n\nconst float softEdgeRatio = 1.0; // use blur here if needed\n\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor = v_color;\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  float d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\n\n  // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n  float size = max(v_size.x, v_size.y);\n  float dist = d * size * softEdgeRatio;\n\n  // set the fragment's transparency according to the distance from the edge\n  fillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\n\n  // count for the outline\n  // therefore tint the entire icon area.\n  if (v_outlineWidth > 0.25) {\n    lowp vec4 outlinePixelColor = v_outlineColor;\n\n    // outlines can't be larger than the size of the symbol\n    float clampedOutlineSize = min(v_outlineWidth, size);\n\n    outlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n\n    // finally combine the outline and the fill colors (outline draws on top of fill)\n    gl_FragColor = v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor = v_transparency * fillPixelColor;\n  }\n#else // not an SDF\n  lowp vec4 texColor = texture2D(u_texture, v_tex);\n\n#ifdef HEATMAP\n  texColor.r *= v_heatmapWeight;\n#endif // HEATMAP\n\n  gl_FragColor = v_transparency * texColor;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","icon.vert":"precision mediump float;\n\n//const float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst vec2 SIGNED_BYTE_TO_UNSIGNED = vec2(128.0);\n\n// per quad (instance) attributes (20 bytes ==> equivalent of 5 bytes per vertex)\nattribute vec2 a_pos;\nattribute vec4 a_vertexOffsetAndTex;\nattribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\n\nattribute float a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n// the of the icon given in pixels\nvarying mediump vec2 v_size;\n\n// icon color. If is a picture-marker it is used to tint the texture color\nvarying lowp vec4 v_color;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n#ifdef HEATMAP\nattribute float a_heatmapWeight;\nvarying mediump float v_heatmapWeight;\n#endif // HEATMAP\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/icon/vvUniforms.glsl>\n#include <materials/icon/vvFunctions.glsl>\n\nvoid main()\n{\n  vec2 a_offset = a_vertexOffsetAndTex.xy;\n  vec2 a_tex = a_vertexOffsetAndTex.zw + SIGNED_BYTE_TO_UNSIGNED; // offset to change from signed to unsigned byte\n  vec2 a_size = a_sizeAndOutlineWidth.xy;\n\n  // default values (we need them for the variations to come)\n  float a_angle = 0.0;\n  float delta_z = 2.0 * (1.0 - a_visible);\n  float depth = 0.0;\n  v_transparency = 1.0;\n\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  // vv size override the original symbol's size\n  float h = getVVMinMaxSize(a_vv.x, a_size.y);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  float h = u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  float h = getVVStopsSize(a_vv.x, a_size.y);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  float h = getVVUnitValue(a_vv.x, a_size.y);\n#endif // VV_SIZE_UNIT_VALUE\n\n  // make sure to preserve the aspect ratio of the symbol\n  vec2 size = vec2(h * a_size.x / a_size.y, h);\n  vec2 offset = a_offset * size / a_size;\n  v_size = size;\n#else\n#ifdef HEATMAP\n  // reconstruct the kernel size\n  a_size = 9.0 * a_size + 1.0;\n#endif // HEATMAP\n\n  vec2 offset = a_offset;\n  v_size = a_size;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef SDF\n  offset *= 2.0;\n#endif // SDF\n\n#ifdef VV_ROTATION\n  gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, delta_z, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, 0.0, 0.0);\n#else\n  gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, delta_z, 1.0) + u_extrudeMatrix * vec4(offset, 0.0, 0.0);\n#endif // VV_ROTATION\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#else\n  v_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.y, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n  // output the texture coordinates and the transparency\n  v_tex = a_tex / u_mosaicSize;\n\n#ifdef SDF\n  v_outlineColor = a_outlineColor;\n  v_outlineWidth = a_sizeAndOutlineWidth.z;\n#endif // SDF\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n\n#ifdef HEATMAP\n  v_heatmapWeight = a_heatmapWeight;\n#endif // HEATMAP\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  // we need to multiply by 8 in order to translate to tile coordinates\n  float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\n#endif // VV_ROTATION\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif // VV_ROTATION\n"},label:{"label.frag":"precision lowp float;\n\nuniform mediump sampler2D u_referenceTex;\nuniform mediump vec2 u_screenSize;\nuniform mediump float u_pixelRatio;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying mediump float v_fadeStep;\n#else\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_color;\n#endif // ID\n\nconst vec3 epsilon = vec3(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n\nvoid main()\n{\n  mediump vec2 refTextPos = gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  mediump vec4 referenceFragment = texture2D(u_referenceTex, refTextPos);\n#ifdef ID\n  mediump float alpha = clamp(referenceFragment.a + v_fadeStep, 0.0, 1.0);\n  // fill the whole quad\n  gl_FragColor = vec4(alpha);\n#else\n  // read the fade alpha\n  lowp float fadeAlpha = referenceFragment.a;\n\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float sdfAlpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n  gl_FragColor = fadeAlpha * sdfAlpha * v_transparency * v_color;\n#endif\n}\n","label.vert":"precision mediump float;\n\nattribute vec2 a_pos;                  // 2 * 2 (2 x signed 16)\nattribute vec4 a_color;                // 4 (4 x unsigned byte)\nattribute vec2 a_vertexOffset;         // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\nattribute vec4 a_texAndSize;          // 4 (4 x unsigned byte) texture coordinatesm and font size. w is for the halo size\nattribute vec4 a_refSymbolAndPlacementOffset; // 4 (4 x unsigned byte) the offset of the reference symbol of the feature (x,y) and the placement offset (z, w) all given in pixels\n\nattribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\nattribute mediump vec2 a_visibilityRange; // 2 x unsigned byte;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\n\n// the opacity of the layer\nuniform mediump float u_opacity;\n\n// the curent zoom\nuniform mediump float u_zoomLevel; // the current zoom level X 10\nuniform lowp float u_mapRotation;\nuniform lowp float u_mapAligned;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n#ifdef ID\nuniform mediump float u_fadeStep;\nvarying mediump float v_fadeStep;\n#else\nvarying mediump vec4 v_color;\n#endif // ID\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision = 1.0 / 8.0;\nconst float outlineScale = 1.0 / 10.0;\nconst float sdfFontSize = 24.0;\n\n// maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n// 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\nconst float maxSdfDistance = 8.0;\n\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\nvoid main()\n{\n  // make sure to clip the vertices in case that given record is marked as invisible\n  float z = 2.0 * (1.0 - a_visible);\n\n  // clip the vertex if we are beyond the visibility range of the vertex\n  // please note: min value of 0 is regarded infinity. max value of 255 is regarded infinity\n  z += 1.0 + sign(a_visibilityRange.x - u_zoomLevel);\n  z += 1.0 + sign(u_zoomLevel - a_visibilityRange.y);\n\n  // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n  mediump float halo = mod(a_pos, 2.0).x;\n\n  float fontSize = a_texAndSize.z;\n\n  float fontScale = fontSize / sdfFontSize;\n  // we need to scale the extrude matrix by the font-scale in order to get the right text size\n  mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n  float mapRotation = u_mapAligned * C_DEG_TO_RAD * -u_mapRotation;\n  float sinA = sin(mapRotation);\n  float cosA = cos(mapRotation);\n\n  mat4 mapRotationMat = mat4(cosA, sinA, 0.0, 0.0,\n                            -sinA, cosA, 0.0, 0.0,\n                              0.0,  0.0, 1.0, 0.0,\n                              0.0,  0.0, 0.0, 1.0);\n\n  vec4 refSymbolOffset = mapRotationMat *  vec4(a_refSymbolAndPlacementOffset.xy, 0.0, 0.0);\n\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) +\n                u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) +\n                u_extrudeMatrix * vec4(refSymbolOffset.xy + a_refSymbolAndPlacementOffset.zw, 0.0, 0.0) +\n                extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n  v_tex = a_texAndSize.xy / u_mosaicSize;\n  v_antialiasingWidth = 0.106 * sdfFontSize / fontSize / u_pixelRatio;\n  // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = halo * outlineScale * a_texAndSize.w / fontScale / maxSdfDistance;\n\n  v_transparency = u_opacity;\n\n#ifdef ID\n  v_fadeStep = u_fadeStep;\n#else\n  v_color = a_color;\n#endif // ID\n}\n"},line:{"constants.glsl":"const float thinLineHalfWidth = 1.0; // meaning that a 2 pixels line width is considered a thin line\nconst float thinLineWidthFactor = 1.1;\n","line.frag":"precision lowp float;\n\nuniform lowp float u_blur;\nuniform mediump float u_antialiasing;\n\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform mediump float u_zoomFactor;\n\nvarying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\nvarying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef SDF\nconst float sdfPatternHalfWidth = 15.5; // YF: assumed that the width will be set to 31\nconst float widthFactor = 2.0;\n\n// we need the conversion function from RGBA to float\n#include <util/encoding.glsl>\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n#include <materials/line/constants.glsl>\n\nvoid main()\n{\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n  mediump float thinLineFactor = max(thinLineWidthFactor * step(v_lineHalfWidth, thinLineHalfWidth), 1.0);\n\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist = length(v_normal) * v_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // when it is a thin line then use a slightly shallower slope in order to add more feathering\n  lowp float alpha = clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n\n#if defined(SDF)\n  mediump float lineHalfWidth = widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio = lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY = 0.5 + 0.5 * v_normal.y;\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  mediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n\n  // the distance is a proportional to the line width\n  float dist = d * lineHalfWidth;\n\n  lowp vec4 fillPixelColor = v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor = fillPixelColor;\n#elif defined(PATTERN)\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n  //              | -> line-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -> line-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n  mediump float relativeTexY = 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color = texture2D(u_texture, texCoord);\n\n  gl_FragColor = v_transparency * alpha * v_color * color;\n#else // solid line (no texture, no pattern)\n  // output the fragment color\n  gl_FragColor = v_transparency * alpha * v_color;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","line.vert":"precision mediump float;\n\nattribute vec2 a_pos;\nattribute vec4 a_id;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\n\nattribute float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\nuniform lowp float u_opacity; // the layer's opacity\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\n\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\nconst float scale = 1.0 / 31.0;\n#ifdef SDF\nconst float widthFactor = 2.0;\n#else\nconst float widthFactor = 1.0;\n#endif\n\n\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\n#endif // PATTERN\n\n// we need to accumulated distance only if it is a pattern or an SDF line\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/line/vvUniforms.glsl>\n#include <materials/line/vvFunctions.glsl>\n\n// include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n#include <materials/line/constants.glsl>\n\nvoid main()\n{\n// size VV block\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  mediump float lineHalfWidth = 0.5 * getVVMinMaxSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  mediump float lineHalfWidth = 0.5 * u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  mediump float lineHalfWidth = 0.5 * getVVStopsSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  mediump float lineHalfWidth = 0.5 * getVVUnitValue(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_UNIT_VALUE\n\n#else // no VV\n  mediump float lineHalfWidth = a_accumulatedDistanceAndHalfWidth.y * scale;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_OPACITY\nv_transparency = u_opacity * getVVOpacity(a_vv.z);\n#else\nv_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nv_color = getVVColor(a_vv.y, a_color);\n#else\nv_color = a_color;\n#endif // VV_COLOR\n\n  // make sure to clip the vertices in case that the width of the line is 0 (or negative), or in case that the line is not visible\n  float z = 2.0 * (step(lineHalfWidth, 0.0) + (1.0 - a_visible));\n\n  // add an antialiasing distance. We use 0.2 rather than 0.5 in order to match the SVG renderer\n  // also limit the total line width to 1.3 pixels. Below this value lines don't look good compared to the SVG renderer\n  lineHalfWidth = max(lineHalfWidth, 0.45) + 0.2 * u_antialiasing;\n\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n  // in practice, a thin line is a line who's half width vary from 0.45px to the value of thinLineHalfWidth, as the value\n  // is claped in line 221 above\n  mediump float thinLineFactor = max(thinLineWidthFactor * step(lineHalfWidth, thinLineHalfWidth), 1.0);\n\n  v_lineHalfWidth = lineHalfWidth;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ [0, 1])\n  // in a case of a thin line we move each vertex twice as far\n  mediump vec2 dist = thinLineFactor * widthFactor * lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n  // transform the vertex\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n  v_normal = a_offsetAndNormal.zw * scale;\n\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance = a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif // PATTERN || SDF\n\n#ifdef PATTERN\nv_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\nv_patternSize = vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif // PATTERN\n\n#ifdef ID\nv_id = a_id;\n#endif // ID\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  float f = (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\nattribute vec3 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n"},text:{"text.frag":"precision lowp float;\n\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float alpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n  gl_FragColor = alpha * v_color;\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","text.vert":"precision mediump float;\n\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\nattribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\nattribute vec4 a_id;            // 4 (4 x unsigned byte)\nattribute vec4 a_color;         // 4 (4 x unsigned byte)\nattribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\nattribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\n\nattribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\n\n// the opacity of the layer\nuniform mediump float u_opacity;\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision = 1.0 / 8.0;\nconst float outlineScale = 1.0 / 10.0;\nconst float sdfFontSize = 24.0;\n\n// maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n// 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\nconst float maxSdfDistance = 8.0;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/text/vvUniforms.glsl>\n#include <materials/text/vvFunctions.glsl>\n\nvoid main()\n{\n  // make sure to clip the vertices in case that given record is marked as invisible\n  float z = 2.0 * (1.0 - a_visible);\n\n  // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n  mediump float halo = mod(a_pos, 2.0).x;\n\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  // vv size override the original symbol's size\n  vec2 size = vec2(getVVMinMaxSize(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  vec2 size = vec2(u_vvSizeScaleStopsValue);\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  vec2 size = vec2(getVVStopsSize(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  vec2 size = vec2(getVVUnitValue(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_UNIT_VALUE\n\n  float fontSize = size.x;\n#else // this generic case, no VV\n  float fontSize = a_texFontSize.z;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  float fontScale = fontSize / sdfFontSize;\n  // we need to scale the extrude matrix by the font-scale in order to get the right text size\n  mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  //gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n#ifdef VV_ROTATION\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * getVVRotation(a_vv.w) * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n#else\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n#endif // VV_ROTATION\n\n  v_tex = a_texFontSize.xy / u_mosaicSize;\n  v_antialiasingWidth = 0.105 * sdfFontSize / fontSize / u_pixelRatio;\n  // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = halo * outlineScale * a_texFontSize.w / fontScale / maxSdfDistance;\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#else\n  v_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\n  // we don't want to override the halo color\n  v_color = halo * a_color + (1.0 - halo) * getVVColor(a_vv.y, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  // we need to multiply by 8 in order to translate to tile coordinates\n  float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\n#endif // VV_ROTATION\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif // VV_ROTATION\n"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}\n","stencil.vert":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n}\n"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color = texture2D(u_texture, v_tex);\n  gl_FragColor = 0.75 * color;\n}\n","tileInfo.vert":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex = a_pos;\n}\n"},util:{"encoding.glsl":"// Factors to convert rgba back to float\nconst vec4 rgba2float_factors = vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\n\nfloat rgba2float(vec4 rgba) {\n  // Convert components from 0->1 back to 0->255 and then\n  // add the components together with their corresponding\n  // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n  return dot(rgba, rgba2float_factors);\n}\n"}}}.apply(null,n))||(e.exports=r)},1531:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===t&&(t=250),this.duration=t,this._lastTime=0,this._startTime=0,this._parent=e}return e.prototype.reset=function(){this._lastTime,this._startTime=performance.now()},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,this._parent.requestRender(),0;var t=e-this._lastTime;this._lastTime=e;var i=2*this.duration;return e-this._startTime<i&&this._parent.requestRender(),t/this.duration},e}();t.default=i}.apply(null,n))||(e.exports=r)},1532:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(623),i(1387),i(969),i(417)],void 0===(r=function(e,t,i,n,r,o){return function(){function e(){this._programByKey=new Map,this.isInitialize=!1}return e.prototype.dispose=function(){this._programCache&&this._programCache.dispose()},e.prototype.initialize=function(e){this.isInitialize||(this._programCache=new o.ProgramCache(e),this.isInitialize=!0)},e.prototype.getProgram=function(e,t){if(e|=t===i.WGLDrawPhase.HITTEST?8:0,e|=t===i.WGLDrawPhase.HIGHLIGHT?16:0,this._programByKey[e])return this._programByKey[e];var o=n.getMaterialVariations(e),a=null;switch(o.geometryType){case i.WGLGeometryType.MARKER:a=this._programCache.getProgram(r.icon,o.programOptions);break;case i.WGLGeometryType.TEXT:a=this._programCache.getProgram(r.text,o.programOptions);break;case i.WGLGeometryType.LABEL:a=this._programCache.getProgram(r.label,o.programOptions);break;case i.WGLGeometryType.FILL:a=this._programCache.getProgram(r.fill,o.programOptions);break;case i.WGLGeometryType.LINE:a=this._programCache.getProgram(r.line,o.programOptions)}return a&&(this._programByKey[e]=a),a},e}()}.apply(null,n))||(e.exports=r)},1533:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(e,t){return e.geometryType=7&t,t>>=3,e.sdf=0!=(4&t),e.vvSizeMinMaxValue=0!=(8&t),e.vvSizeScaleStops=0!=(16&t),e.vvSizeFieldStops=0!=(32&t),e.vvSizeUnitValue=0!=(64&t),e.vvColor=0!=(128&t),e.vvRotation=0!=(256&t),e.vvOpacity=0!=(512&t),e.visibility=0!=(1024&t),e.pattern=0!=(2048&t),e.heatmap=0!=(4096&t),e}}.apply(null,n))||(e.exports=r)},1534:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(412)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.color=[0,0,0,0],this.haloColor=[0,0,0,0],this.haloSize=0,this.size=12,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}return e.prototype.acquire=function(e,t,i,n,r,o,a,s,l){this.color=e,this.haloColor=t,this.haloSize=i,this.size=n,this.angle=r,this.offsetX=o,this.offsetY=a,this.hAnchor=s,this.vAnchor=l},e.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0,this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0,this.haloSize=0,this.size=0,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0},e.pool=new i(e),e}();t.TextProperties=n}.apply(null,n))||(e.exports=r)},1535:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(774),i(1022),i(1281),i(1390),i(1536),i(725),i(385),i(417),i(371),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h){Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(){var t=e.call(this)||this;return t._initialized=!1,t._maxWidth=0,t._color=new Float32Array([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null),this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null),this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null),this._canvas=null},t.prototype.draw=function(e,t){var i=e.context;if(t.status!==l.TileStatus.INITIALIZED){this._initialized||this._initialize(i),i.bindVAO(this._outlineVertexArrayObject),i.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._outlineProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_coord_range",n.TILE_SIZE),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),i.setLineWidth(2),i.drawArrays(3,0,4),i.bindVAO();var r=this._getTexture(i,t);r&&(i.bindVAO(this._tileInfoVertexArrayObject),i.bindProgram(this._tileInfoProgram),i.bindTexture(r,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",r.descriptor.width,r.descriptor.height),i.drawArrays(5,0,4),i.bindVAO())}},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=d.createProgram(e,a.background),i=d.createProgram(e,s.tileInfo),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},r=new Int8Array([0,0,1,0,1,1,0,1]),o=u.createVertex(e,35044,r),l=new h(e,a.background.attributes,n,{geometry:o}),c=new Int8Array([0,0,1,0,0,1,1,1]),f=u.createVertex(e,35044,c),p=new h(e,s.tileInfo.attributes,n,{geometry:f});return this._outlineProgram=t,this._tileInfoProgram=i,this._outlineVertexArrayObject=l,this._tileInfoVertexArrayObject=p,this._initialized=!0,!0},t.prototype._getTexture=function(e,t){if(t.texture)return t.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var i=t.key.id,n=this._canvas.getContext("2d");n.font="24px sans-serif",n.textAlign="left",n.textBaseline="middle";var o=n.measureText(i),a=Math.pow(2,Math.ceil(r.log2(o.width+2)));return a>this._maxWidth&&(this._maxWidth=a),n.clearRect(0,0,this._maxWidth,32),n.fillStyle="blue",n.fillText(i,0,16),t.texture=new c(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),t.texture},t}(o.default);t.default=f}.apply(null,n))||(e.exports=r)},1536:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.tileInfo={name:"tileInfo",shaders:{vertexShader:i.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:i.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1537:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(820),i(774),i(1281),i(1390),i(385),i(417),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=e.call(this)||this;return t._color=n.create(),t._initialized=!1,t._color.set([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)},t.prototype.draw=function(e,t){var i=e.context;this._initialized||this._initialize(i),i.setStencilFunctionSeparate(1032,519,t.stencilRef,255),i.bindVAO(this._solidVertexArrayObject),i.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",r.TILE_SIZE),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),i.drawArrays(5,0,4),i.bindVAO()},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=l.createProgram(e,a.background);if(!t)return!1;var i=new Int8Array([0,0,1,0,0,1,1,1]),n=s.createVertex(e,35044,i),r=new u(e,a.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:n});return this._solidProgram=t,this._solidVertexArrayObject=r,this._initialized=!0,!0},t}(o.default);t.default=d}.apply(null,n))||(e.exports=r)},1538:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isInitialized=!1,t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.FILL},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,o=e.painter,a=e.rendererInfo,s=e.requiredLevel,l=e.stationary,u=i.indexCount,d=i.indexFrom;this._initialize();var c=i.materialInfo.materialKeyInfo,h=e.painter.materialManager.getProgram(i.materialInfo.materialKey,e.drawPhase);if(h){r.bindProgram(h);var f=this._getVAO(r,t,c.hasVV());if(r.bindVAO(f),i.materialInfo.texBindingInfo.length>0){var p=i.materialInfo.texBindingInfo[0],_=p.pageId,v=e.painter.textureManager.sprites;this._spritesTextureSize[0]=v.getWidth(_),this._spritesTextureSize[1]=v.getHeight(_);var m=1/Math.pow(2,s-t.key.level)/e.pixelRatio;h.setUniform1f("u_zoomFactor",m);var g=l?9728:9729;o.textureManager.bindSpritePage(r,_,p.unit,g),h.setUniform1i(p.semantic,p.unit),h.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}h.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),h.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),h.setUniform1f("u_opacity",1),c.vvColor&&(h.setUniform1fv("u_vvColorValues",a.vvColorValues),h.setUniform4fv("u_vvColors",a.vvColors)),c.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),h.setUniform1fv("u_vvOpacities",a.vvOpacities)),r.drawElements(4,u,5125,4*d),r.bindVAO(null)}},t.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},this._isInitialized=!0},t.prototype._getVAO=function(e,t,i){if(t.fillGeometry.vao)return t.fillGeometry.vao;var n=t.fillGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],o=t.fillGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],l=t.fillGeometry.indexBuffer;return n&&l?(t.fillGeometry.vao=new s(e,a.fill.attributes,i?this._fillVertexAttributeLayoutVV:this._fillVertexAttributeLayout,{geometry:n,visibility:o},l),t.fillGeometry.vao):null},t}(o.default);t.default=l}.apply(null,n))||(e.exports=r)},1539:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_texAndSize",count:4,type:5121,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_refSymbolAndPlacementOffset",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}],visibilityRange:[{name:"a_visibilityRange",count:2,type:5121,offset:0,stride:2,normalized:!1,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.drawGeometry=function(e,t,i,r){if(e.requiredLevel===t.key.level){var o=e.context,a=e.painter,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,d=i.indexFrom,c=e.drawPhase===n.WGLDrawPhase.LABEL_ALPHA,h=l.materialKey;c&&(h|=8);var f=a.materialManager.getProgram(h,s);if(f){o.setStencilTestEnabled(!1),o.bindProgram(f);var p=this._getVAO(o,t);if(o.bindVAO(p),c)o.setBlendingEnabled(!1),f.setUniform1f("u_fadeStep",e.labelStep);else{var _=l.texBindingInfo[0],v=_.pageId;a.textureManager.bindGlyphsPage(o,v,_.unit),f.setUniform1i(_.semantic,_.unit)}var m=a.textureManager.glyphs;this._glyphsTextureSize[0]=m.width/4,this._glyphsTextureSize[1]=m.height/4;var g=a.extrudeNoRotationMatrix;o.bindTexture(e.labelFBO.colorTexture,3),f.setUniform1i("u_referenceTex",3),f.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),f.setUniformMatrix4fv("u_extrudeMatrix",g),f.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),f.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),f.setUniform1f("u_pixelRatio",e.pixelRatio),f.setUniform1f("u_opacity",1),f.setUniform1f("u_zoomLevel",10*e.displayLevel),f.setUniform1f("u_mapRotation",e.state.rotation),f.setUniform1f("u_mapAligned",0),f.setUniform2fv("u_screenSize",e.state.size),o.drawElements(4,u,5125,4*d),o.bindVAO(null),o.setStencilTestEnabled(!0),o.setBlendingEnabled(!0)}}},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LABEL},t.prototype._getVAO=function(e,t){var i=t.labelGeometry;if(i&&i.vao)return i.vao;var n=i.vertexBufferMap[r.C_VBO_GEOMETRY],o=i.vertexBufferMap[r.C_VBO_VISIBILITY],l=i.vertexBufferMap[r.C_VBO_VISIBILITY_RANGE],u=i.indexBuffer;return n&&u&&l?(i.vao=new s(e,a.label.attributes,this._vertexAttributeLayout,{geometry:n,visibility:o,visibilityRange:l},u),i.vao):null},t}(o.default);t.default=l}.apply(null,n))||(e.exports=r)},1540:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LINE},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,o=e.painter,a=e.rendererInfo,s=e.requiredLevel,l=e.drawPhase,u=i.indexFrom,d=i.indexCount,c=i.materialInfo,h=c.materialKeyInfo,f=o.materialManager.getProgram(c.materialKey,l);if(f){r.bindProgram(f);var p=this._getVAO(r,t,h.hasVV());r.bindVAO(p);var _=1/e.pixelRatio;if(c.texBindingInfo.length>0){var v=c.texBindingInfo[0],m=v.pageId,g=o.textureManager.sprites;this._spritesTextureSize[0]=g.getWidth(m),this._spritesTextureSize[1]=g.getHeight(m),o.textureManager.bindSpritePage(r,m,v.unit),f.setUniform1i(v.semantic,v.unit),f.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}var y=Math.pow(2,s-t.key.level)/e.pixelRatio;f.setUniform1f("u_zoomFactor",y),f.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),f.setUniformMatrix4fv("u_extrudeMatrix",o.extrudeMatrix),f.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),f.setUniform1f("u_opacity",1),f.setUniform1f("u_blur",0+_),f.setUniform1f("u_antialiasing",_),f.setUniform1f("u_zoomFactor",y),h.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),h.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),h.vvSizeFieldStops&&(f.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),h.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),h.vvColor&&(f.setUniform1fv("u_vvColorValues",a.vvColorValues),f.setUniform4fv("u_vvColors",a.vvColors)),h.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),f.setUniform1fv("u_vvOpacities",a.vvOpacities)),r.setFaceCullingEnabled(!0),r.setFrontFace(2305),r.setCullFace(1029),r.drawElements(4,d,5125,4*u),r.setFaceCullingEnabled(!1),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i){if(t.lineGeometry.vao)return t.lineGeometry.vao;var n=t.lineGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],o=t.lineGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],l=t.lineGeometry.indexBuffer;return n&&l?(t.lineGeometry.vao=new s(e,a.line.attributes,i?this._lineVertexAttributeLayoutVV:this._lineVertexAttributeLayout,{geometry:n,visibility:o},l),t.lineGeometry.vao):null},t}(o.default);t.default=l}.apply(null,n))||(e.exports=r)},1541:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(371),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:24,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:40,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:40,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:40,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:40,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:40,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:40,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:24,stride:40,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:28,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.MARKER},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,o=e.painter,a=e.rendererInfo,s=e.drawPhase,l=i.indexCount,u=i.indexFrom,d=i.materialInfo,c=d.materialKeyInfo,h=c.heatmap,f=o.materialManager.getProgram(d.materialKey,s);if(f){r.bindProgram(f);var p=this._getVAO(r,t,c.hasVV(),h);if(r.bindVAO(p),h){var _=this._getIntensityTexture(r,a.heatmapParameters);r.bindTexture(_,1),f.setUniform1i("u_texture",1),this._spritesTextureSize[0]=Math.round(a.heatmapParameters.radius),this._spritesTextureSize[1]=Math.round(a.heatmapParameters.radius)}else{var v=d.texBindingInfo[0],m=v.pageId;o.textureManager.bindSpritePage(r,m,v.unit),f.setUniform1i(v.semantic,v.unit);var g=o.textureManager.sprites;this._spritesTextureSize[0]=g.getWidth(m)/4,this._spritesTextureSize[1]=g.getHeight(m)/4}var y=a.vvMaterialParameters.vvRotationEnabled&&"geographic"===a.vvMaterialParameters.vvRotationType?o.extrudeMatrix:o.extrudeNoRotationMatrix;f.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),f.setUniformMatrix4fv("u_extrudeMatrix",y),f.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),f.setUniform2fv("u_mosaicSize",this._spritesTextureSize),f.setUniform1f("u_opacity",1),c.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),c.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),c.vvSizeFieldStops&&(f.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),c.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),c.vvColor&&(f.setUniform1fv("u_vvColorValues",a.vvColorValues),f.setUniform4fv("u_vvColors",a.vvColors)),c.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),f.setUniform1fv("u_vvOpacities",a.vvOpacities)),c.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1),r.drawElements(4,l,5125,4*u),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,n){if(t.iconGeometry.vao)return t.iconGeometry.vao;var o=t.iconGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],s=t.iconGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],u=t.iconGeometry.indexBuffer;return o&&u?(t.iconGeometry.vao=new l(e,a.icon.attributes,i?this._iconVertexAttributesWithVV:n?this._iconVertexAttributesWithHeatmap:this._iconVertexAttributes,{geometry:o,visibility:s},u),t.iconGeometry.vao):null},t.prototype._getIntensityTexture=function(e,t){if(t.intensityKernel&&!t.refreshIntensityKernel)return t.intensityKernel;t.intensityKernel&&(t.intensityKernel.dispose(),t.intensityKernel=null);for(var i=t.radius,n=t.kernelSize,r=t.blurRadius,o=i*i,a=[],l=-1;++l<n;)a[l]=Math.exp(-Math.pow(l-r,2)/(2*o))/(Math.sqrt(2*Math.PI)*(i/2));for(var u,d,c,h=[],f=0;f<n;f++)for(d=a[f],l=0;l<n;l++)c=f*n+l,u=a[l],h[4*c+0]=d*u,h[4*c+1]=0,h[4*c+2]=0,h[4*c+3]=1;var p=new s(e,{target:3553,pixelFormat:6408,internalFormat:e.capabilities.colorBufferFloat.RGBA32F,dataType:5126,samplingMode:e.capabilities.textureFloatLinear?9729:9728,wrapMode:33071,width:n,height:n},new Float32Array(h));return t.intensityKernel=p,t.refreshIntensityKernel=!1,p},t}(o.default);t.default=u}.apply(null,n))||(e.exports=r)},1542:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.TEXT},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,o=e.painter,a=e.rendererInfo,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,d=i.indexFrom,c=l.materialKeyInfo,h=c.vvSizeMinMaxValue||c.vvSizeScaleStops||c.vvSizeFieldStops||c.vvSizeUnitValue||c.vvColor||c.vvRotation||c.vvOpacity,f=o.materialManager.getProgram(l.materialKey,s);if(f){r.bindProgram(f);var p=this._getVAO(r,t,h,this.getGeometryType());r.bindVAO(p);var _=l.texBindingInfo[0],v=_.pageId;o.textureManager.bindGlyphsPage(r,v,_.unit),f.setUniform1i(_.semantic,_.unit);var m=o.textureManager.glyphs;this._glyphsTextureSize[0]=m.width/4,this._glyphsTextureSize[1]=m.height/4;var g=a.vvMaterialParameters.vvRotationEnabled&&"geographic"===a.vvMaterialParameters.vvRotationType?o.extrudeMatrix:o.extrudeNoRotationMatrix;f.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),f.setUniformMatrix4fv("u_extrudeMatrix",g),f.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),f.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),f.setUniform1f("u_pixelRatio",1),f.setUniform1f("u_opacity",1),c.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),c.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),c.vvSizeFieldStops&&(f.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),f.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),c.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),c.vvColor&&(f.setUniform1fv("u_vvColorValues",a.vvColorValues),f.setUniform4fv("u_vvColors",a.vvColors)),c.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),f.setUniform1fv("u_vvOpacities",a.vvOpacities)),c.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1),r.drawElements(4,u,5125,4*d),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,n){var o=t.getGeometry(n);if(o&&o.vao)return o.vao;var l=o.vertexBufferMap[r.C_VBO_GEOMETRY],u=o.vertexBufferMap[r.C_VBO_VISIBILITY],d=o.indexBuffer;return l&&d?(o.vao=new s(e,a.text.attributes,i?this._vertexAttributeLayoutVV:this._vertexAttributeLayout,{geometry:l,visibility:u},d),o.vao):null},t}(o.default);t.default=l}.apply(null,n))||(e.exports=r)},1543:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(354),i(1544),i(1546)],void 0===(r=function(e,t,i,n,r){return function(){function e(){this._hlRenderer=new n,this._hlSurfaces=new r,this._width=void 0,this._height=void 0,this._adjustedWidth=void 0,this._adjustedHeight=void 0}return e.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose(),this._hlRenderer&&this._hlRenderer.dispose(),this._boundFBO=null},e.prototype.setup=function(e,t,i){this._width=t,this._height=i;var n=t%4,r=i%4;t+=n<2?-n:4-n,i+=r<2?-r:4-r,this._adjustedWidth=t,this._adjustedHeight=i,this._boundFBO=e.getBoundFramebufferObject();var o=Math.round(.75*t),a=Math.round(.75*i);this._hlRenderer.setup(e,o,a),this._hlSurfaces.setup(e,o,a)},e.prototype.setHighlightOptions=function(e){this._hlRenderer.setHighlightOptions({fillColor:e.fillColor,outlineColor:e.outlineColor,outlineWidth:.75*e.outlineWidth,outerHaloWidth:.75*e.outerHaloWidth,innerHaloWidth:.75*e.innerHaloWidth,outlinePosition:.75*e.outlinePosition})},e.prototype.startMaskDraw=function(e){e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.setClearStencil(0),e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.STENCIL_BUFFER_BIT),e.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight)},e.prototype.draw=function(e){e.setStencilTestEnabled(!1),e.setBlendingEnabled(!1),e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex),i("esri-feature-highlight-debug")?(e.bindFramebuffer(null),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex)):(e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex),e.bindFramebuffer(this._boundFBO),e.setBlendingEnabled(!0),e.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex),this._boundFBO=null)},e}()}.apply(null,n))||(e.exports=r)},1544:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1545),i(385),i(417),i(371),i(381)],void 0===(r=function(e,t,i,n,r,o,a){var s=[void 0,void 0,void 0,1],l=[3,4],u=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function e(){this._width=void 0,this._height=void 0,this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3},this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources.shadeTex.dispose(),this._resources=null)},e.prototype.preBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",u),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.finalBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",d),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.renderHighlight=function(e,t){e.bindTexture(t,l[0]),e.bindTexture(this._resources.shadeTex,l[1]),e.bindProgram(this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype._initialize=function(e,t,u){this._width=t,this._height=u;var d=new n(e,34962,35044,new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]).buffer),c=new a(e,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d}),h=r.createProgram(e,i.highlight),f=r.createProgram(e,i.blur);h.setUniform1i("u_texture",l[0]),h.setUniform1i("u_shade",l[1]),h.setUniform4fv("u_sigmas",s),f.setUniform1i("u_texture",l[0]),f.setUniform4fv("u_sigmas",s);var p=new o(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:d,quadVAO:c,highlightProgram:h,blurProgram:f,shadeTex:p}},e.prototype.setHighlightOptions=function(e){function t(e,t,i){h[0]=(1-i)*e[0]+i*t[0],h[1]=(1-i)*e[1]+i*t[1],h[2]=(1-i)*e[2]+i*t[2],h[3]=(1-i)*e[3]+i*t[3]}if(this._highlightOptions=e,this._resources){var i=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth,n=e.outlinePosition-e.outlineWidth/2,r=e.outlinePosition+e.outlineWidth/2,o=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth,a=Math.sqrt(Math.PI/2)*s[3],l=Math.abs(i)>a?Math.round(10*(Math.abs(i)-a))/10:0,u=Math.abs(o)>a?Math.round(10*(Math.abs(o)-a))/10:0;l&&!u?console.warn("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&u?console.warn("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&u&&console.warn("The highlight is "+Math.max(l,u)+"px away from the edge of the feature; consider reducing some width values.");for(var d,c=new Uint8Array(1024),h=[void 0,void 0,void 0,void 0],f=0;f<256;++f)(d=i+f/255*(o-i))<i?(c[4*f+0]=0,c[4*f+1]=0,c[4*f+2]=0,c[4*f+3]=0):d<n?t([0,0,0,0],e.outlineColor,(d-i)/(n-i)):d<r?(h[0]=e.outlineColor[0],h[1]=e.outlineColor[1],h[2]=e.outlineColor[2],h[3]=e.outlineColor[3]):d<o?t(e.outlineColor,e.fillColor,(d-r)/(o-r)):(c[4*f+0]=e.fillColor[0],c[4*f+1]=e.fillColor[1],c[4*f+2]=e.fillColor[2],c[4*f+3]=e.fillColor[3]),c[4*f+0]=255*h[0]*h[3],c[4*f+1]=255*h[1]*h[3],c[4*f+2]=255*h[2]*h[3],c[4*f+3]=255*h[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[i,o]),this._resources.shadeTex.updateData(0,0,0,256,1,c)}},e.prototype.setup=function(e,t,i){this._resources?(this._width=t,this._height=i):(this._initialize(e,t,i),this.setHighlightOptions(this._highlightOptions))},e}()}.apply(null,n))||(e.exports=r)},1545:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.highlight={name:"highlight",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}},t.blur={name:"blur",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}}.apply(null,n))||(e.exports=r)},1546:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(377),i(371)],void 0===(r=function(e,t,i,n){function r(e,t,r){var o=new n(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:t,height:r,samplingMode:9729});return[o,i.createWithAttachments(e,o,{colorTarget:0,depthStencilTarget:2})]}return function(){function e(){this._width=void 0,this._height=void 0,this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)},e.prototype._initialize=function(e,t,i){this._width=t,this._height=i;var n=r(e,t,i),o=n[0],a=n[1],s=r(e,t,i),l=s[0],u=s[1];this._resources={sharedBlur1Tex:o,sharedBlur1Fbo:a,sharedBlur2Tex:l,sharedBlur2Fbo:u}},e.prototype.setup=function(e,t,i){!this._resources||this._width===t&&this._height===i||this.dispose(),this._resources||this._initialize(e,t,i)},Object.defineProperty(e.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=r)},1547:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.stencil={name:"stencil",shaders:{vertexShader:i.resolveIncludes("stencil/stencil.vert"),fragmentShader:i.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1548:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(380),i(433),i(351),i(354),i(1280),i(340),i(454),i(443),i(456),i(616),i(1549),i(1550),i(1551),i(1552),i(1553),i(1434),i.dj.m(e)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v,m,g){var y=new a(10),x=new Map;return function(){function t(e,t,i,n,r){void 0===n&&(n=!1),this.devicePixelRatio=i,this.allowUpdates=n,this._spriteMosaic=null,this._glyphMosaic=null,this._connection=null,this._tileIndex=null,this._updateQueue=new Map,this._ongoingRequests=new Map,this._vectorTileLayer=e,this._styleRepository=e.styleRepository,this._requestUpdate=t}return t.prototype.destroy=function(){this.stop(),this._vectorTileLayer=this._requestUpdate=this._styleRepository=null,this._spriteMosaic&&(this._spriteMosaic.dispose(),this._spriteMosaic=null),this._glyphMosaic&&(this._glyphMosaic.dispose(),this._glyphMosaic=null)},Object.defineProperty(t.prototype,"initialized",{get:function(){return this._broadcastPromise&&this._broadcastPromise.isFulfilled()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ongoingRequestCount",{get:function(){return this._ongoingRequests.size},enumerable:!0,configurable:!0}),t.prototype.start=function(){var t=this;this.stop();var r=this._styleRepository,a=new _(r.sprite,this.devicePixelRatio);a.devicePixelRatio=this.devicePixelRatio;var s=a.load().then(function(){t._spriteMosaic=new p(1024,1024,250),t._spriteMosaic.setSpriteSource(a),o("stable-symbol-rendering")&&t._spriteMosaic.preloadSpriteItems()}),d=new f(r.glyphs);this._glyphMosaic=new h(1024,1024,d);var c=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),v=u.open(l.getAbsMid("./WorkerTileHandler",e,g),{client:this}).then(function(e){t._connection=e}),m=new i(function(e){s.isFulfilled()||s.cancel(),c.isFulfilled()||c.cancel(),v.isFulfilled()||v.cancel()});return n([s,c,v]).then(function(e){n(t._connection.broadcast("setLayers",r.styleJSON)).then(function(){m.resolve()})}),this._broadcastPromise=m.promise,this._broadcastPromise},t.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel(),this._updateQueue.forEach(function(e){return e.cancel()}),this._ongoingRequests.forEach(function(e){return e.cancel()}),this._connection&&(this._connection.close(),this._connection=null)},t.prototype.updateTile=function(e,t){var i=this;if(!this.allowUpdates)return s.resolve(null);if(!this._broadcastPromise.isFulfilled()||!this._connection)return s.reject(new Error("no connection"));var n=Math.round(c.degToByte(t.state.rotation));if(e.rotation===n)return s.resolve(null);var r,o=e.key;return this._updateQueue.has(o.id)&&(r=this._updateQueue.get(o.id)).cancel(),e.rotation=n,r=this._connection.invoke("update",{key:e.id,rotation:n},null,{client:e.client}).then(function(t){return e.updateSymbolData(t),t}).always(function(){i._updateQueue.delete(o.id)}),this._updateQueue.set(e.id,r),r},t.prototype.getVectorTile=function(e,t,i,n){var r=this;void 0===n&&(n=0);var o=new d(e,t,i,0);return this.getRefKey(o).then(function(e){var t=new m(o,e,r._vectorTileLayer.tileInfo,r._styleRepository,0);return e?r.getTileData(t.key,0).then(function(e){return t.setData(e.tileData,e.client),t}):(t.setData(null,null),t)})},t.prototype.getTileData=function(e,t){var i=this;return this._broadcastPromise.isFulfilled()&&this._connection?this.getRefKey(e).then(function(n){if(!n)return s.resolve(null);var r=Math.round(c.degToByte(t));return i._getTileData(i._connection,e,n,r).then(function(e){return e&&e.tileData?e:s.reject("No data")})}):s.reject(new Error("no connection"))},t.prototype.getRefKey=function(e){return this._tileIndex?this._tileIndex.dataKey(e):s.resolve(e)},t.prototype.getSprites=function(e){return this._spriteMosaic.getSpriteItems(e)},t.prototype.getGlyphs=function(e){return this._glyphMosaic.getGlyphItems(e.tileID,e.font,e.codePoints)},t.prototype.getStyleRepository=function(){return this._styleRepository},t.prototype.getTileIndex=function(){return this._tileIndex},t.prototype._getTileData=function(e,t,i,n){var r=this,o={client:null},a=this._ongoingRequests.get(t.id);if(a)return a;var l=this._vectorTileLayer.getTileUrl(i.level,i.row,i.col);return a=this._connection.invoke("getTile",{key:t.id,refKey:i.id,url:l,rotation:n,cacheTile:this.allowUpdates},null,o).then(function(e){return r._ongoingRequests.delete(t.id),{tileData:e,client:o.client}}).catch(function(e){return r._ongoingRequests.delete(t.id),r._connection.invoke("destructTileData",t.id,null,o),s.reject(e)}),this._ongoingRequests.set(t.id,a),a},t.prototype._fetchTileMap=function(e){var t=this;if(this._vectorTileLayer.capabilities.operations.supportsTileMap&&this._vectorTileLayer.tilemapCache)return this._tileIndex=new v(this._vectorTileLayer.tilemapCache),s.resolve();if(!e)return s.resolve();if(y.has(e))return this._tileIndex=y.use(e),s.resolve();if(x.has(e))return x.get(e).then(function(e){t._tileIndex=new v(e.data)});var i=r(e,{responseType:"json"});return i.then(function(i){t._tileIndex=new v(i.data),x.delete(e),y.insert(e,t._tileIndex)}),x.set(e,i),i},t}()}.apply(null,n))||(e.exports=r)},1549:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(354),i(340),i(1282),i(1391),i(371)],void 0===(r=function(e,t,i,n,r,o,a){var s;return i("stable-symbol-rendering")&&(s=new Set),function(){function e(e,t,i){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphIndex={},this._textures=[],this._rangePromises=new Map,(e<=0||t<=0)&&console.error("Glyph mosaic width and height must be greater than zero!"),this.width=e,this.height=t,this._glyphSource=i,this._binPack=new o(e-4,t-4),this._glyphData.push(new Uint8Array(e*t)),this._dirties.push(!0),this._textures.push(void 0)}return e.prototype.getGlyphItems=function(e,t,a){for(var l=this,u=[],d=this._glyphSource,c=new Set,h=0,f=a;h<f.length;h++){var p=f[h],_=Math.floor(p*(1/256));c.add(_)}var v=[];return c.forEach(function(e){if(e<=256){var i=t+e;if(l._rangePromises.has(i))v.push(l._rangePromises.get(i));else{var n=d.getRange(t,e).always(function(){l._rangePromises.delete(i)});l._rangePromises.set(i,n),v.push(n)}}}),n.all(v).then(function(e){var n,h=l._glyphIndex[t];if(h||(h={},l._glyphIndex[t]=h),i("stable-symbol-rendering")){s.clear();for(var f=0,p=a;f<p.length;f++){var _=p[f];s.add(_)}var v=[];c.forEach(function(e){v.push(e)}),v.sort(),n=[];for(var m=0,g=v;m<g.length;m++)for(var y=g[m],x=0;x<256;++x)n.push(256*y+x)}else n=a;for(var b=0,S=n;b<S.length;b++){var I=h[_=S[b]];if(I)i("stable-symbol-rendering")&&!s.has(_)||(u[_]={rect:I.rect,metrics:I.metrics,page:I.page});else{var w=d.getGlyph(t,_);if(w&&w.metrics){var M=w.metrics,V=void 0;if(0===M.width)V=new r(0,0,0,0);else{var D=M.width+6,T=M.height+6,C=D%4?4-D%4:4,E=T%4?4-T%4:4;1===C&&(C=5),1===E&&(E=5),(V=l._binPack.allocate(D+C,T+E)).isEmpty&&(l._dirties[l._currentPage]||(l._glyphData[l._currentPage]=null),l._currentPage=l._glyphData.length,l._glyphData.push(new Uint8Array(l.width*l.height)),l._dirties.push(!0),l._textures.push(void 0),l._binPack=new o(l.width-4,l.height-4),V=l._binPack.allocate(D+C,T+E));var O=l._glyphData[l._currentPage],z=w.bitmap,A=void 0,P=void 0;if(z)for(var F=0;F<T;F++){A=D*F,P=l.width*(V.y+F+1)+V.x;for(var R=0;R<D;R++)O[P+R+1]=z[A+R]}}h[_]={rect:V,metrics:M,tileIDs:null,page:l._currentPage},i("stable-symbol-rendering")&&!s.has(_)||(u[_]={rect:V,metrics:M,page:l._currentPage}),l._dirties[l._currentPage]=!0}}}return u})},e.prototype.removeGlyphs=function(e){for(var t in this._glyphIndex){var i=this._glyphIndex[t];if(i){var n=void 0;for(var r in i)if((n=i[r]).tileIDs.delete(e),0===n.tileIDs.size){for(var o=this._glyphData[n.page],a=n.rect,s=void 0,l=void 0,u=0;u<a.height;u++)for(s=this.width*(a.y+u)+a.x,l=0;l<a.width;l++)o[s+l]=0;delete i[r],this._dirties[n.page]=!0}}}},e.prototype.bind=function(e,t,i,n){void 0===n&&(n=0),this._textures[i]||(this._textures[i]=new a(e,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&r.setData(this._glyphData[i]),e.bindTexture(r,n),this._dirties[i]=!1},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0},e}()}.apply(null,n))||(e.exports=r)},1550:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(351),i(594),i(340)],void 0===(r=function(e,t,i,n,r){var o=function(){function e(e){if(this._metrics=[],this._bitmaps=[],e)for(;e.next();)switch(e.tag()){case 1:for(var t=e.getMessage();t.next();)switch(t.tag()){case 3:for(var i=t.getMessage(),n=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0;i.next();)switch(i.tag()){case 1:n=i.getUInt32();break;case 2:r=i.getBytes();break;case 3:o=i.getUInt32();break;case 4:a=i.getUInt32();break;case 5:s=i.getSInt32();break;case 6:l=i.getSInt32();break;case 7:u=i.getUInt32();break;default:i.skip()}n&&(this._metrics[n]={width:o,height:a,left:s,top:l,advance:u},this._bitmaps[n]=r);break;default:t.skip()}break;default:e.skip()}}return e.prototype.getMetrics=function(e){return this._metrics[e]},e.prototype.getBitmap=function(e){return this._bitmaps[e]},e}(),a=function(){function e(){this._ranges=[]}return e.prototype.getRange=function(e){return this._ranges[e]},e.prototype.addRange=function(e,t){this._ranges[e]=t},e}();return function(){function e(e){this._glyphInfo={},this._baseURL=e}return e.prototype.getRange=function(e,t){var a=this._getFontStack(e);if(a.getRange(t))return r.resolve();var s=256*t,l=s+255,u=this._baseURL.replace("{fontstack}",e).replace("{range}",s+"-"+l);return i(u,{responseType:"array-buffer"}).then(function(e){a.addRange(t,new o(new n(new Uint8Array(e.data),new DataView(e.data))))}).catch(function(){a.addRange(t,new o)})},e.prototype.getGlyph=function(e,t){var i=this._getFontStack(e);if(i){var n=Math.floor(t/256);if(!(n>256)){var r=i.getRange(n);if(r)return{metrics:r.getMetrics(t),bitmap:r.getBitmap(t)}}}},e.prototype._getFontStack=function(e){var t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new a),t},e}()}.apply(null,n))||(e.exports=r)},1551:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(616),i(1282),i(1391),i(371)],void 0===(r=function(e,t,i,n,r,o){return function(){function e(e,t,i){void 0===i&&(i=0),this._size=[],this._mosaicsData=[],this._textures=[],this._dirties=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects={},this.pixelRatio=1,(e<=0||t<=0)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!"),this._pageWidth=e,this._pageHeight=t,i>0&&(this._maxItemSize=i),this._binPack=new r(e-4,t-4)}return e.prototype.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]},e.prototype.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]},e.prototype.setSpriteSource=function(e){if(this.dispose(),this.pixelRatio=e.devicePixelRatio,0===this._mosaicsData.length){this._binPack=new r(this._pageWidth-4,this._pageHeight-4);var t=Math.floor(this._pageWidth),i=Math.floor(this._pageHeight),n=new Uint32Array(t*i);this._mosaicsData[0]=n,this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0)}this._sprites=e},e.prototype.getSpriteItem=function(e,t){void 0===t&&(t=!1);var i=this._mosaicRects[e];if(i)return i;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var n=this._sprites.getSpriteInfo(e);if(!n||!n.width||!n.height||n.width<0||n.height<0)return null;var r=n.width,o=n.height,a=this._allocateImage(r,o),s=a[0],l=a[1],u=a[2];return s.width<=0?null:(this._copy(s,n,l,u,t),i={rect:s,width:r,height:o,anchorX:0,anchorY:0,sdf:n.sdf,pixelRatio:n.pixelRatio,page:l},this._mosaicRects[e]=i,i)},e.prototype.preloadSpriteItems=function(){for(var e=0,t=this._sprites.spriteNames;e<t.length;e++){var i=t[e];this.getSpriteItem(i,!0)}},e.prototype.getSpriteItems=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i];t[r]=this.getSpriteItem(r)}return t},e.prototype.getMosaicItemPosition=function(e,t){var i=this.getSpriteItem(e,t),n=i&&i.rect;if(!n)return null;n.width=i.width,n.height=i.height;var r=i.width,o=i.height;return{size:[i.width,i.height],tl:[(n.x+2)/this._size[i.page][0],(n.y+2)/this._size[i.page][1]],br:[(n.x+2+r)/this._size[i.page][0],(n.y+2+o)/this._size[i.page][1]],page:i.page}},e.prototype.bind=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this._textures[i]||(this._textures[i]=new o(e,{pixelFormat:6408,dataType:5121,width:this._size[i][0],height:this._size[i][1]},new Uint8Array(this._mosaicsData[i].buffer)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&r.setData(new Uint8Array(this._mosaicsData[i].buffer)),e.bindTexture(r,n),this._dirties[i]=!1},e._copyBits=function(e,t,i,n,r,o,a,s,l,u,d){var c=n*t+i,h=s*o+a;if(d){h-=o;for(var f=-1;f<=u;c=((++f+u)%u+n)*t+i,h+=o)for(var p=-1;p<=l;p++)r[h+p]=e[c+(p+l)%l]}else for(f=0;f<u;f++){for(p=0;p<l;p++)r[h+p]=e[c+p];c+=t,h+=o}},e.prototype._copy=function(t,i,n,r,o,a){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(n>=this._mosaicsData.length)){var s=new Uint32Array(a?a.buffer:this._sprites.image.buffer),l=this._mosaicsData[n];l&&s||console.error("Source or target images are uninitialized!");var u=a?i.width:this._sprites.width;e._copyBits(s,u,i.x,i.y,l,r[0],t.x+2,t.y+2,i.width,i.height,o),this._dirties[n]=!0}},e.prototype._allocateImage=function(e,t){e+=2,t+=2;var o=Math.max(e,t);if(this._maxItemSize&&this._maxItemSize<o){var a=Math.pow(2,Math.ceil(i.log2(e))),s=Math.pow(2,Math.ceil(i.log2(t))),l=new n(0,0,e,t);return this._mosaicsData.push(new Uint32Array(a*s)),this._dirties.push(!0),this._size.push([a,s]),this._textures.push(void 0),[l,this._mosaicsData.length-1,[a,s]]}var u=e%4?4-e%4:4,d=t%4?4-t%4:4;1===u&&(u=5),1===d&&(d=5);var c=this._binPack.allocate(e+u,t+d);return c.width<=0?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new r(this._pageWidth-4,this._pageHeight-4),this._allocateImage(e,t)):[c,this._currentPage,[this._pageWidth,this._pageHeight]]},e.prototype.dispose=function(){this._binPack=null,this._mosaicRects={};for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0},e}()}.apply(null,n))||(e.exports=r)},1552:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336),i(380),i(605),i(351),i(340),i(350)],void 0===(r=function(e,t,i,n,r,o,a,s,l){return function(){function e(e,t){this.baseURL=e,this.devicePixelRatio=t,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded"}return Object.defineProperty(e.prototype,"spriteNames",{get:function(){var e=[];for(var t in this._spritesData)e.push(t);return e.sort(),e},enumerable:!0,configurable:!0}),e.prototype.getSpriteInfo=function(e){return this._spritesData[e]},e.prototype.load=function(){var e=this;return this.loadStatus="loading",this.baseURL?this._loadSprites().then(function(){return e.loadStatus="loaded",e}).catch(function(t){return e.loadStatus="failed",e}):s.resolve(this)},e.prototype._loadSprites=function(){var e=this;this._isRetina=this.devicePixelRatio>1.15;var t=this.baseURL,i=this._isRetina?"@2x":"";return a(t+i+".json",{responseType:"json"}).then(function(n){var a=Object.keys(n.data);if(!a||0===a.length||1===a.length&&"_ssl"===a[0])return s.resolve(null);e._spritesData=n.data;var u=new r,d=new Image;d.crossOrigin="anonymous",d.onload=function(){d.onload=null,e.width=d.width,e.height=d.height;var t=document.createElement("canvas");t.width=d.width,t.height=d.height;var i=t.getContext("2d");i.drawImage(d,0,0,d.width,d.height);for(var n,r=i.getImageData(0,0,d.width,d.height),o=new Uint8Array(r.data),a=0;a<o.length;a+=4)n=o[a+3]/255,o[a]=o[a]*n,o[a+1]=o[a+1]*n,o[a+2]=o[a+2]*n;e.image=o,u.resolve()};var c=""+t+i+".png";if(o.id){var h=o.id.findCredential(c);h&&h.token&&(c+="?token="+h.token)}return d.src=l.addProxy(c),u})},e}()}.apply(null,n))||(e.exports=r)},1553:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(340),i(721),i(456)],void 0===(r=function(e,t,i,n,r){return function(){function e(e){if(e instanceof n)this._tilemapCache=e;else{if(!(e&&"index"in e))throw new Error("Invalid tilemap!");this._tilemap=e.index}}return e.prototype.dataKey=function(e){if(this._tilemapCache){var t=e.level,i=e.row,n=e.col,o=new r(e);return this._tilemapCache.fetchAvailabilityUpsample(t,i,n,o).then(function(){return o}).catch(function(e){if(e&&"cancel"===e.dojoType)throw e;return o.level=t,o.row=i,o.col=n,o})}return this._getIndexedDataKey(e)},e.prototype.forEach=function(e,t,i,n,r){this._callback=r,this._maxLevel=t+e,this._forEach(this._tilemap,t,i,n)},e.prototype._forEach=function(e,t,i,n){0!==e&&(this._callback(t,i,n),t!==this._maxLevel&&"object"==typeof e&&(this._forEach(e[0],t+1,2*i,2*n),this._forEach(e[1],t+1,2*i,2*n+1),this._forEach(e[2],t+1,2*i+1,2*n),this._forEach(e[3],t+1,2*i+1,2*n+1)))},e.prototype._getIndexedDataKey=function(e){var t=[e];if(e.level<0||e.row<0||e.col<0||e.row>>e.level>0||e.col>>e.level>0)return i.resolve(null);for(var n=e;0!==n.level;)n=new r(n.level-1,n.row>>1,n.col>>1,n.world),t.push(n);var o,a,s=this._tilemap,l=t.pop();if(1===s)return i.resolve(l);for(;t.length;)if(a=(1&(o=t.pop()).col)+((1&o.row)<<1),s){if(0===s[a]){l=null;break}if(1===s[a]){l=o;break}l=o,s=s[a]}return i.resolve(l)},e}()}.apply(null,n))||(e.exports=r)},1554:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e){this.type=e}}();t.RenderBucket=r;var o=function(e){function t(){var t=e.call(this,2)||this;return t.triangleElementStart=0,t.triangleElementCount=0,t}return i(t,e),t.prototype.hasData=function(){return this.triangleElementCount>0},t}(r);t.LineRenderBucket=o;var a=function(e){function t(){var t=e.call(this,1)||this;return t.triangleElementStart=0,t.triangleElementCount=0,t.outlineElementStart=0,t.outlineElementCount=0,t}return i(t,e),t.prototype.hasData=function(){return this.triangleElementCount>0||this.outlineElementCount>0},t}(r);t.FillRenderBucket=a;var s=function(e){function t(){var t=e.call(this,3)||this;return t.markerPerPageElementsMap=new Map,t.glyphPerPageElementsMap=new Map,t.isSDF=!1,t}return i(t,e),t.prototype.hasData=function(){return this.markerPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0},t}(r);t.SymbolRenderBucket=s;var l=function(e){function t(){var t=e.call(this,4)||this;return t.triangleElementStart=0,t.triangleElementCount=0,t}return i(t,e),t.prototype.hasData=function(){return this.triangleElementCount>0},t}(r);t.CircleRenderBucket=l;var u=function(e){function t(){return e.call(this,0)||this}return i(t,e),t.prototype.hasData=function(){return!0},t}(r);t.BackgroundRenderBucket=u}.apply(null,n))||(e.exports=r)},1555:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(759),i(616),i(1556),i(1557),i(1558),i(1559),i(1560),i(1561),i(1564),i(1565),i(377)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h){return function(){function e(){this._extrudeRotateVector=new Float32Array([0,0,1]),this._extrudeScaleVector=new Float32Array([1,1,1]),this._state={rotation:0,width:0,height:0},this._cachedWidth=0,this._cachedHeight=0,this._cachedRotation=0,this._programCache=null}return e.prototype.initialize=function(e,t,i){void 0===i&&(i=!0),this._SpriteMosaic=e,this._glyphMosaic=t,this._ignoreSpeed=!i,this._fadeRecorder=new a.FadeRecorder(300),this._extrudeMatrix=new Float32Array(16),this._extrudeNoRotationMatrix=new Float32Array(16),this._backgroundColor=new Float32Array([1,0,0,1])},e.prototype.dispose=function(){this._backgroundRenderer&&(this._backgroundRenderer.dispose(),this._backgroundRenderer=null),this._lineRenderer&&(this._lineRenderer.dispose(),this._lineRenderer=null),this._fillRenderer&&(this._fillRenderer.dispose(),this._fillRenderer=null),this._symbolRenderer&&(this._symbolRenderer.dispose(),this._symbolRenderer=null),this._circleRenderer&&(this._circleRenderer.dispose(),this._circleRenderer=null),this._tileInfoRenderer&&(this._tileInfoRenderer.dispose(),this._tileInfoRenderer=null),this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null),this._programCache&&this._programCache.dispose()},e.prototype.initializeProgramCache=function(e){if(null===this._programCache){var t=new c.default;t.initialize(e),this._backgroundRenderer=new r(t),this._lineRenderer=new l(t),this._fillRenderer=new s(t),this._symbolRenderer=new u(t),this._circleRenderer=new o(t),this._tileInfoRenderer=new d(t),this._programCache=t}},e.prototype.setStateParams=function(e,t,r){this._fadeRecorder.recordLevel(r),this._state=e,this._state.width===this._cachedWidth&&this._state.height===this._cachedHeight&&this._state.rotation===this._cachedRotation||(this._extrudeScaleVector[0]=2/e.width,this._extrudeScaleVector[1]=-2/e.height,i.identity(this._extrudeMatrix),i.rotate(this._extrudeMatrix,this._extrudeMatrix,-e.rotation*n.C_DEG_TO_RAD,this._extrudeRotateVector),i.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),i.transpose(this._extrudeMatrix,this._extrudeMatrix),i.identity(this._extrudeNoRotationMatrix),i.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),i.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},e.prototype.drawClippingMasks=function(e,t){if(0!==t.length){e.setDepthWriteEnabled(!1),e.setDepthTestEnabled(!1),e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(7680,7680,7681),e.setStencilWriteMask(255),e.setClearStencil(0);var i=e.gl;e.clear(i.STENCIL_BUFFER_BIT);for(var n=0,r=t;n<r.length;n++){var o=r[n];o.attached&&o.visible&&(e.setStencilFunctionSeparate(1032,519,o.stencilData.reference,o.stencilData.mask),this._backgroundRenderer.renderSolidColor(e,{u_matrix:o.tileTransform.transform,u_normalized_origin:o.tileTransform.displayCoord,u_coord_range:o.coordRange,u_depth:0,u_color:this._backgroundColor}))}e.setColorMask(!0,!0,!0,!0),e.setBlendingEnabled(!0)}},e.prototype.renderDebug=function(e,t){var i=t.key;this._backgroundColor.set([i.col%2,i.row%2,i.col%2==0&&i.row%2==0?1:0,.5]),this._backgroundRenderer.renderSolidColor(e,{u_matrix:t.tileTransform.transform,u_normalized_origin:t.tileTransform.displayCoord,u_coord_range:t.coordRange,u_depth:0,u_color:this._backgroundColor})},e.prototype.renderBucket=function(e,t,i,n,r,o,a,s){if(!(void 0!==a.minzoom&&a.minzoom>i+1e-6||void 0!==a.maxzoom&&a.maxzoom<=i-1e-6))switch(t.type){case 0:2!==r&&this._renderBackground(e,t,i,r,o,a,s);break;case 1:2!==r&&this._renderFill(e,t,i,r,o,a,s);break;case 2:1!==r&&3!==r||this._renderLine(e,t,i,r,o,a,s);break;case 3:2!==r&&3!==r||this._renderSymbol(e,t,i,r,n,o,a,s);break;case 4:2!==r&&3!==r||this._renderCircle(e,t,i,r,n,o,a,s)}},e.prototype.renderTileInfo=function(e,t){this._tileInfoRenderer.render(e,t)},e.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()},e.prototype.hitTest=function(e,t,i,n,r,o,a){var s=[0,0],l=[0,0],u=e.state;u.toMap(s,[0,0]),u.toMap(l,[o,o]);var d=n.filter(function(e){return!(s[0]>e.bounds[2]||l[0]<e.bounds[0]||s[1]<e.bounds[3]||l[1]>e.bounds[1])});if(0===d.length)return[];d.sort(function(e,t){return e.key.level-t.key.level});for(var c=d.length,f=1;f<=c;f++){(y=d[f-1]).attached&&(y.stencilData.reference=f,y.stencilData.mask=255)}a(u,r,d);var p=e.context;this._hittestFBO||(this._hittestFBO=h.create(p,{colorTarget:0,depthStencilTarget:3,width:o,height:o}));var _=p.getViewport(),v=p.getBoundFramebufferObject();p.bindFramebuffer(this._hittestFBO),p.setViewport(0,0,o,o);var m=p.gl;p.setDepthWriteEnabled(!0),p.setStencilWriteMask(255),p.setClearColor(1,1,1,1),p.setClearDepth(1),p.setClearStencil(0),p.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT|m.STENCIL_BUFFER_BIT),p.setDepthWriteEnabled(!1),this.drawClippingMasks(p,d),p.setBlendingEnabled(!1),p.setStencilWriteMask(0),p.setStencilOp(7680,7680,7681),p.setDepthFunction(515),p.setDepthTestEnabled(!0),p.setDepthWriteEnabled(!0),p.setStencilTestEnabled(!0);for(var g=0;g<c;g++){var y;(y=d[g]).attached&&y.doRender(e)}p.setStencilTestEnabled(!1),p.setDepthTestEnabled(!1),this._readbackBuffer||(this._readbackBuffer=new Uint8Array(4*o*o),this._readbackBuffer32=new Uint32Array(this._readbackBuffer.buffer)),this._hittestFBO.readPixels(0,0,o,o,6408,5121,this._readbackBuffer);var x=new Set,b=o*o,S=Math.round(b/2),I=this._readbackBuffer32[S];4294967295!==I&&x.add(I);for(f=0;f<b;f++)4294967295!==(I=this._readbackBuffer32[f])&&x.add(I);p.bindFramebuffer(v),p.setViewport(_.x,_.y,_.width,_.height);var w=[];return x.forEach(function(e){w.push(e)}),w},e.prototype._renderBackground=function(e,t,i,n,r,o,a){this._backgroundRenderer.render(e,t,i,n,r,o,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,a)},e.prototype._renderLine=function(e,t,i,n,r,o,a){this._lineRenderer.render(e,t,i,n,this._state,r,o,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,a)},e.prototype._renderFill=function(e,t,i,n,r,o,a){this._fillRenderer.render(e,t,i,this._state.rotation,n,r,o,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,a)},e.prototype._renderCircle=function(e,t,i,n,r,o,a,s){var l=!0;r===o.key.level&&(l=!1),e.setStencilTestEnabled(l),this._circleRenderer.render(e,t,i,n,this._state.rotation,o,a,this._extrudeMatrix,s)},e.prototype._renderSymbol=function(e,t,i,n,r,o,a,s){var l=!0;r===o.key.level&&(l=!1),e.setStencilTestEnabled(l),this._symbolRenderer.render(e,t,i,n,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),o,a,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,s)},e}()}.apply(null,n))||(e.exports=r)},1556:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1392),i(820),i(1290),i(970),i(385),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){return function(){function e(e){this._patternMatrix=i.create(),this._color=n.create(),this._solidrendererInitialized=!1,this._rendererInitialized=!1,this._programOptions={id:!1,pattern:!1},this._programCache=e,this._color.set([1,0,0,1])}return e.prototype.dispose=function(){this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},e.prototype.renderSolidColor=function(e,t){this._solidrendererInitialized||this._initializeSolidRenderer(e),e.bindVAO(this._solidVertexArrayObject);var i=this._programOptions;i.id=!1,i.pattern=!1;var n=this._programCache.getProgram(0,0,i);e.bindProgram(n),n.setUniformMatrix4fv("u_transformMatrix",t.u_matrix),n.setUniform2fv("u_normalized_origin",t.u_normalized_origin),n.setUniform1f("u_coord_range",t.u_coord_range||4096),n.setUniform1f("u_depth",t.u_depth||0),n.setUniform4fv("u_color",t.u_color||this._color),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.render=function(e,t,n,r,a,s,l,u,d){this._rendererInitialized||this._initialize(e);var c=s.getPaintValue("background-color",n),h=d*s.getPaintValue("background-opacity",n),f=s.getPaintValue("background-pattern",n),p=void 0!==f,_=c[3]*h,v=p||_<1;if((!v||0!==r)&&(v||1!==r)){var m=3===r,g=(m?1:0)<<1|(p?1:0),y=this._programOptions;y.id=m,y.pattern=p;var x=this._programCache.getProgram(0,g,y);if(e.bindVAO(this._vertexArrayObject),e.bindProgram(x),x.setUniform1f("u_coord_range",a.coordRange),x.setUniform1f("u_depth",s.z||0),x.setUniformMatrix4fv("u_transformMatrix",a.tileTransform.transform),x.setUniform2fv("u_normalized_origin",a.tileTransform.displayCoord),p){var b=l.getMosaicItemPosition(f,!0);if(!b)return;var S=512*Math.pow(2,Math.floor(n)-a.key.level)*u;i.identity(this._patternMatrix);var I=S/b.size[0],w=S/b.size[1];this._patternMatrix[0]=I,this._patternMatrix[4]=w,l.bind(e,9729,0),x.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),x.setUniform1f("u_opacity",h),x.setUniform2f("u_pattern_tl",b.tl[0],b.tl[1]),x.setUniform2f("u_pattern_br",b.br[0],b.br[1]),x.setUniform1i("u_texture",0)}else this._color[0]=_*c[0],this._color[1]=_*c[1],this._color[2]=_*c[2],this._color[3]=_,x.setUniform4fv("u_color",this._color);if(m){var M=o.int32To4Bytes(t.layerID);x.setUniform4f("u_id",M[0],M[1],M[2],M[3])}e.drawArrays(5,0,4),e.bindVAO()}},e.prototype._initializeSolidRenderer=function(e){if(this._solidrendererInitialized)return!0;var t=new Int8Array([0,0,1,0,0,1,1,1]),i=a.createVertex(e,35044,t),n=new s(e,this._programCache.getProgramAttributes(0),{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:i});return this._solidVertexArrayObject=n,this._solidrendererInitialized=!0,!0},e.prototype._initialize=function(e){if(this._rendererInitialized)return!0;var t=[];t.push(r.i1616to32(0,0)),t.push(r.i1616to32(1,0)),t.push(r.i1616to32(0,1)),t.push(r.i1616to32(1,1));var i=new Uint32Array(t),n=a.createVertex(e,35044,i),o=new s(e,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:n});return this._vertexArrayObject=o,this._rendererInitialized=!0,!0},e}()}.apply(null,n))||(e.exports=r)},1557:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(759),i(903),i(820),i(616),i(970),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){return function(){function e(e){this._initialized=!1,this._programOptions={id:!1},this._programCache=e,this._viewProjMat=i.create(),this._offsetVector=n.create(),this._color=r.create(),this._strokeColor=r.create()}return e.prototype.dispose=function(){},e.prototype.render=function(e,t,n,r,s,l,u,d,c){if(0!==t.triangleElementCount){this._initialized||this._initialize(e);var h=u.hasDataDrivenRadius?1:u.getPaintValue("circle-radius",n),f=u.hasDataDrivenColor?[1,1,1,1]:u.getPaintValue("circle-color",n),p=u.hasDataDrivenOpacity?1:u.getPaintValue("circle-opacity",n),_=u.hasDataDrivenStrokeWidth?1:u.getPaintValue("circle-stroke-width",n),v=u.hasDataDrivenStrokeColor?[1,1,1,1]:u.getPaintValue("circle-stroke-color",n),m=u.hasDataDrivenStrokeOpacity?1:u.getPaintValue("circle-stroke-opacity",n),g=u.hasDataDrivenBlur?0:u.getPaintValue("circle-blur",n),y=p*f[3]*c;this._color[0]=y*f[0],this._color[1]=y*f[1],this._color[2]=y*f[2],this._color[3]=y,y=m*v[3]*c,this._strokeColor[0]=y*v[0],this._strokeColor[1]=y*v[1],this._strokeColor[2]=y*v[2],this._strokeColor[3]=y;var x=l.tileTransform.transform,b=u.getPaintValue("circle-translate",n);if(0!==b[0]||0!==b[1]){i.copy(this._viewProjMat,l.tileTransform.transform);var S=b[0],I=b[1],w=0,M=0,V=l.coordRange/512,D=(1<<l.key.level)/Math.pow(2,n)*V;if(1===u.getPaintValue("circle-translate-anchor",n)){var T=-o.C_DEG_TO_RAD*s,C=Math.sin(T),E=Math.cos(T);w=D*(S*E-I*C),M=D*(S*C+I*E)}else w=D*S,M=D*I;this._offsetVector[0]=w,this._offsetVector[1]=M,this._offsetVector[2]=0,i.translate(this._viewProjMat,this._viewProjMat,this._offsetVector),x=this._viewProjMat}var O=this._getCircleVAO(e,l);if(O){e.bindVAO(O);var z=3===r,A=z?1:0,P=this._programOptions;P.id=z;var F=this._programCache.getProgram(5,A,P);if(e.bindProgram(F),F.setUniformMatrix4fv("u_transformMatrix",x),F.setUniformMatrix4fv("u_extrudeMatrix",d),F.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),F.setUniform1f("u_depth",u.z),F.setUniform1f("u_radius",h),F.setUniform4fv("u_color",this._color),F.setUniform1f("u_blur",g),F.setUniform1f("u_stroke_width",_),F.setUniform4fv("u_stroke_color",this._strokeColor),F.setUniform1f("u_antialiasingWidth",1.2),z){var R=a.int32To4Bytes(t.layerID);F.setUniform4f("u_id",R[0],R[1],R[2],R[3])}e.drawElements(4,t.triangleElementCount,5125,12*t.triangleElementStart),e.bindVAO()}}},e.prototype._initialize=function(e){return!!this._initialized||(this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._initialized=!0,!0)},e.prototype._getCircleVAO=function(e,t){if(t.circleVertexArrayObject)return t.circleVertexArrayObject;var i=t.circleVertexBuffer,n=t.circleIndexBuffer;return i&&n?(t.circleVertexArrayObject=new s(e,this._programCache.getProgramAttributes(5),this._vertexAttributes,{geometry:i},n),t.circleVertexArrayObject):null},e}()}.apply(null,n))||(e.exports=r)},1558:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(701)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,i,n){this.fadeSpeed=e,this.minfadeLevel=t,this.maxfadeLevel=i,this.fadeChange=n}}();t.FadeProperties=n;var r=function(){function e(e){void 0===e&&(e=300),this._levelSnapshots=[],this._duration=e}return e.prototype.recordLevel=function(e){var t=i(),n=this._levelSnapshots;0===n.length&&(n.push({level:e,now:0}),n.push({level:e,now:0})),2!==n.length&&n[0].level===e||n.push({level:e,now:t})},e.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var e=this._duration,t=this._levelSnapshots,i=t.length,n=t[i-1],r=-1;i>r+1&&t[r+1].now+e<n.now;)r++;for(r<0&&(r=0);r<i;r++)if(t[r].level!==n.level)return!0;return!1},e.prototype.getFadeValues=function(e){void 0===e&&(e=!1);for(var t=this._duration,n=i(),r=this._levelSnapshots;r.length>3&&r[1].now+t<n;)r.shift();r[1].now+t<n&&(r[0].level=r[1].level);var o=r[0].level,a=r[r.length-1],s=a.level,l=Math.min(o,s),u=Math.max(o,s),d=(a.level-r[1].level)/((a.now-r[1].now)/t),c=(n-a.now)/t*d;return e?{fadeSpeed:0,minfadeLevel:l,maxfadeLevel:u,fadeChange:0}:{fadeSpeed:d,minfadeLevel:l,maxfadeLevel:u,fadeChange:c}},e}();t.FadeRecorder=r}.apply(null,n))||(e.exports=r)},1559:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1392),i(759),i(903),i(820),i(616),i(970),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l){return function(){function e(e){this._initialized=!1,this._fillProgramOptions={id:!1,dd:!1,pattern:!1},this._outlineProgramOptions={id:!1,dd:!1},this._programCache=e,this._viewProjMat=n.create(),this._offsetVector=r.create(),this._patternMatrix=i.create(),this._color=o.create(),this._outlineColor=o.create()}return e.prototype.dispose=function(){},e.prototype.render=function(e,t,i,r,o,l,u,d,c,h,f){if(0!==t.triangleElementCount){this._initialized||this._initialize(e);var p=void 0!==u.getPaintValue("fill-pattern",i),_=u.hasDataDrivenColor?[1,1,1,1]:u.getPaintValue("fill-color",i),v=u.hasDataDrivenOpacity?1:u.getPaintValue("fill-opacity",i),m=v*_[3]*f;this._color[0]=m*_[0],this._color[1]=m*_[1],this._color[2]=m*_[2],this._color[3]=m;var g,y=3===o;y&&(g=s.int32To4Bytes(t.layerID));var x=l.tileTransform.transform,b=l.coordRange/512,S=u.getPaintValue("fill-translate",i);if(0!==S[0]||0!==S[1]){n.copy(this._viewProjMat,l.tileTransform.transform);var I=S[0],w=S[1],M=0,V=0,D=(1<<l.key.level)/Math.pow(2,i)*b;if(1===u.getPaintValue("fill-translate-anchor",i)){var T=-a.C_DEG_TO_RAD*r,C=Math.sin(T),E=Math.cos(T);M=D*(I*E-w*C),V=D*(I*C+w*E)}else M=D*I,V=D*w;this._offsetVector[0]=M,this._offsetVector[1]=V,this._offsetVector[2]=0,n.translate(this._viewProjMat,this._viewProjMat,this._offsetVector),x=this._viewProjMat}if(this._drawFill(e,t,i,o,l,u,d,x,h,f,y,g),u.getPaintValue("fill-antialias",i)&&!p&&t.outlineElementCount>0&&(1===o||3===o)){var O=u.hasDataDrivenOutline;if(u.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0],this._outlineColor[1]=this._color[1],this._outlineColor[2]=this._color[2],this._outlineColor[3]=this._color[3]}else{var z=u.hasDataDrivenOutlineColor?[1,1,1,1]:u.getPaintValue("fill-outline-color",i),A=v*z[3]*f;this._outlineColor[0]=A*z[0],this._outlineColor[1]=A*z[1],this._outlineColor[2]=A*z[2],this._outlineColor[3]=A}var P=.75/h,F=this._getOutlineVAO(e,l,O);if(F){e.bindVAO(F);var R=(y?1:0)<<1|(O?1:0),L=this._outlineProgramOptions;L.id=y,L.dd=O;var U=this._programCache.getProgram(2,R,L);e.bindProgram(U),U.setUniformMatrix4fv("u_transformMatrix",x),U.setUniformMatrix4fv("u_extrudeMatrix",c),U.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),U.setUniform1f("u_depth",u.z+1/65536),U.setUniform1f("u_outline_width",P),U.setUniform4fv("u_color",this._outlineColor),y&&U.setUniform4f("u_id",g[0],g[1],g[2],g[3]),e.drawElements(4,t.outlineElementCount,5125,12*t.outlineElementStart),e.bindVAO()}}}},e.prototype._initialize=function(e){return!!this._initialized||(this._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},this._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]},this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},this._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]},this._initialized=!0,!0)},e.prototype._drawFill=function(e,t,n,r,o,a,s,l,u,d,c,h){var f=a.getPaintValue("fill-pattern",n),p=void 0!==f,_=a.hasDataDrivenOpacity?1:d*a.getPaintValue("fill-opacity",n),v=a.hasDataDrivenColor?[1,1,1,1]:a.getPaintValue("fill-color",n),m=_*v[3]*d;this._color[0]=m*v[0],this._color[1]=m*v[1],this._color[2]=m*v[2],this._color[3]=m;var g=a.hasDataDrivenFill,y=p||m<1||g;if((!y||0!==r)&&(y||1!==r)){var x=this._getFillVAO(e,o,g);if(x){e.bindVAO(x);var b=(c?1:0)<<2|(g?1:0)<<1|(p?1:0),S=this._fillProgramOptions;S.id=c,S.dd=g,S.pattern=p;var I=this._programCache.getProgram(1,b,S);if(e.bindProgram(I),p){var w=s.getMosaicItemPosition(f,!0);if(w){var M=o.coordRange/512/Math.pow(2,Math.round(n)-o.key.level)/u;i.identity(this._patternMatrix);var V=1/(w.size[0]*M),D=1/(w.size[1]*M);this._patternMatrix[0]=V,this._patternMatrix[4]=D,s.bind(e,9729,w.page,1),I.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),I.setUniform2f("u_pattern_tl",w.tl[0],w.tl[1]),I.setUniform2f("u_pattern_br",w.br[0],w.br[1]),I.setUniform1i("u_texture",1)}}I.setUniformMatrix4fv("u_transformMatrix",l),I.setUniform2fv("u_normalized_origin",o.tileTransform.displayCoord),I.setUniform1f("u_depth",a.z+1/65536),I.setUniform4fv("u_color",this._color),c&&I.setUniform4f("u_id",h[0],h[1],h[2],h[3]),e.drawElements(4,t.triangleElementCount,5125,12*t.triangleElementStart),e.bindVAO()}}},e.prototype._getFillVAO=function(e,t,i){if(i){if(t.fillDDVertexArrayObject)return t.fillDDVertexArrayObject;var n=t.fillDDVertexBuffer,r=t.fillIndexBuffer;return n&&r?(t.fillDDVertexArrayObject=new l(e,this._programCache.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:n},r),t.fillDDVertexArrayObject):null}if(t.fillVertexArrayObject)return t.fillVertexArrayObject;n=t.fillVertexBuffer,r=t.fillIndexBuffer;return n&&r?(t.fillVertexArrayObject=new l(e,this._programCache.getProgramAttributes(1),this._fillVertexAttributes,{geometry:n},r),t.fillVertexArrayObject):null},e.prototype._getOutlineVAO=function(e,t,i){if(i){if(t.outlineDDVertexArrayObject)return t.outlineDDVertexArrayObject;var n=t.outlineDDVertexBuffer,r=t.outlineIndexBuffer;return n&&r?(t.outlineDDVertexArrayObject=new l(e,this._programCache.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:n},r),t.outlineDDVertexArrayObject):null}if(t.outlineVertexArrayObject)return t.outlineVertexArrayObject;n=t.outlineVertexBuffer,r=t.outlineIndexBuffer;return n&&r?(t.outlineVertexArrayObject=new l(e,this._programCache.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:n},r),t.outlineVertexArrayObject):null},e}()}.apply(null,n))||(e.exports=r)},1560:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(759),i(961),i(903),i(820),i(616),i(970),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l){return function(){function e(e){this._initialized=!1,this._programOptions={id:!1,dd:!1,pattern:!1},this._programCache=e,this._viewProjMat=i.create(),this._offsetVector=r.create(),this._color=o.create(),this._dashArray=n.create()}return e.prototype.dispose=function(){},e.prototype.render=function(e,t,n,r,o,l,u,d,c,h,f){if(0!==t.triangleElementCount){this._initialized||this._initialize(e);var p=l.tileTransform.transform,_=l.coordRange/512,v=u.getPaintValue("line-translate",n);if(0!==v[0]||0!==v[1]){i.copy(this._viewProjMat,l.tileTransform.transform);var m=v[0],g=v[1],y=0,x=0,b=(1<<l.key.level)/Math.pow(2,n)*_,S=o.rotation;if(1===u.getPaintValue("line-translate-anchor",n)){var I=-a.C_DEG_TO_RAD*S,w=Math.sin(I),M=Math.cos(I);y=b*(m*M-g*w),x=b*(m*w+g*M)}else y=b*m,x=b*g;this._offsetVector[0]=y,this._offsetVector[1]=x,this._offsetVector[2]=0,i.translate(this._viewProjMat,this._viewProjMat,this._offsetVector),p=this._viewProjMat}var V=u.getPaintValue("line-pattern",n),D=void 0!==V,T=1/h,C=u.getPaintValue("line-blur",n),E=u.hasDataDrivenColor?[1,1,1,1]:u.getPaintValue("line-color",n),O=u.hasDataDrivenOpacity?1:u.getPaintValue("line-opacity",n),z=u.hasDataDrivenWidth?1:u.getPaintValue("line-width",n),A=O*E[3]*f;this._color[0]=A*E[0],this._color[1]=A*E[1],this._color[2]=A*E[2],this._color[3]=A;var P,F=u.hasDataDrivenLine,R=3===r;R&&(P=s.int32To4Bytes(t.layerID));var L=this._getLineVAO(e,l,F);if(L){e.bindVAO(L);var U=(R?1:0)<<2|(F?1:0)<<1|(D?1:0),j=this._programOptions;j.id=R,j.dd=F,j.pattern=D;var B=this._programCache.getProgram(3,U,j);if(e.bindProgram(B),B.setUniformMatrix4fv("u_transformMatrix",p),B.setUniformMatrix4fv("u_extrudeMatrix",c),B.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),B.setUniform1f("u_depth",u.z),B.setUniform1f("u_blur",C),B.setUniform1f("u_antialiasing",T),B.setUniform4fv("u_color",this._color),B.setUniform1f("u_width",z),R&&B.setUniform4f("u_id",P[0],P[1],P[2],P[3]),D){var k=d.getMosaicItemPosition(V,!0);k&&(d.bind(e,9729,k.page,1),B.setUniform2f("u_pattern_tl",k.tl[0],k.br[1]),B.setUniform2f("u_pattern_br",k.br[0],k.tl[1]),B.setUniform2f("u_spriteSize",_*k.size[0],k.size[1]),B.setUniform1i("u_texture",1))}else{var N=u.getPaintValue("line-dasharray",n);N.length<2&&(N=[1,-1]);var G=_;this._dashArray[0]=G*N[0],this._dashArray[1]=G*N[1],B.setUniform2fv("u_dasharray",this._dashArray)}e.drawElements(4,t.triangleElementCount,5125,12*t.triangleElementStart),e.bindVAO()}}},e.prototype._initialize=function(e){return!!this._initialized||(this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]},this._initialized=!0,!0)},e.prototype._getLineVAO=function(e,t,i){if(i){if(t.lineDDVertexArrayObject)return t.lineDDVertexArrayObject;var n=t.lineDDVertexBuffer,r=t.lineIndexBuffer;return n&&r?(t.lineDDVertexArrayObject=new l(e,this._programCache.getProgramAttributes(3),this._vertexAttributesDD,{geometry:n},r),t.lineDDVertexArrayObject):null}if(t.lineVertexArrayObject)return t.lineVertexArrayObject;n=t.lineVertexBuffer,r=t.lineIndexBuffer;return n&&r?(t.lineVertexArrayObject=new l(e,this._programCache.getProgramAttributes(3),this._vertexAttributes,{geometry:n},r),t.lineVertexArrayObject):null},e}()}.apply(null,n))||(e.exports=r)},1561:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1562),i(1563)],void 0===(r=function(e,t,i,n){return function(){function e(e){this._iconRenderer=new i(e),this._sdfRenderer=new n(e)}return e.prototype.dispose=function(){this._iconRenderer&&(this._iconRenderer.dispose(),this._iconRenderer=null),this._sdfRenderer&&(this._sdfRenderer.dispose(),this._sdfRenderer=null)},e.prototype.render=function(e,t,i,n,r,o,a,s,l,u,d,c,h,f){t.hasData()&&(t.markerPerPageElementsMap.size>0&&this._iconRenderer.render(e,t,i,n,r,o,a,s,l,d,c,f),t.glyphPerPageElementsMap.size>0&&this._sdfRenderer.render(e,t,i,n,r,o,a,s,u,d,c,h,f))},e}()}.apply(null,n))||(e.exports=r)},1562:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(759),i(903),i(820),i(616),i(970),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s){return function(){function e(e){this._spritesTextureSize=new Float32Array(2),this._initialized=!1,this._programOptions={id:!1,dd:!1,sdf:!1},this._programCache=e,this._viewProjMat=i.create(),this._offsetVector=n.create(),this._color=r.create()}return e.prototype.dispose=function(){},e.prototype.render=function(e,t,n,r,s,l,u,d,c,h,f,p){var _=this;this._initialized||this._initialize(e);var v=d.hasDataDrivenIconSize?1:d.getLayoutValue("icon-size",n),m=d.hasDataDrivenIconColor?[1,1,1,1]:d.getPaintValue("icon-color",n),g=d.hasDataDrivenIconOpacity?1:d.getPaintValue("icon-opacity",n),y=m[3]*g*p;this._color[0]=y*m[0],this._color[1]=y*m[1],this._color[2]=y*m[2],this._color[3]=y;var x=d.getLayoutValue("icon-rotation-alignment",n);2===x&&(x=1===d.getLayoutValue("symbol-placement",n)?0:1);var b=0===x,S=t.isSDF,I=d.hasDataDrivenIcon,w=3===r,M=o.degToByte(s),V=u.tileTransform.transform,D=d.getPaintValue("icon-translate",n);if(0!==D[0]||0!==D[1]){i.copy(this._viewProjMat,u.tileTransform.transform);var T=D[0],C=D[1],E=0,O=0,z=u.coordRange/512,A=(1<<u.key.level)/Math.pow(2,n)*z;if(1===d.getPaintValue("icon-translate-anchor",n)){var P=-o.C_DEG_TO_RAD*s,F=Math.sin(P),R=Math.cos(P);E=A*(T*R-C*F),O=A*(T*F+C*R)}else E=A*T,O=A*C;this._offsetVector[0]=E,this._offsetVector[1]=O,this._offsetVector[2]=0,i.translate(this._viewProjMat,this._viewProjMat,this._offsetVector),V=this._viewProjMat}var L=b?h:f,U=this._getIconVAO(e,u,I);if(U){e.bindVAO(U);var j=(w?1:0)<<2|(I?1:0)<<1|(S?1:0),B=this._programOptions;B.id=w,B.dd=I,B.sdf=S;var k=this._programCache.getProgram(4,j,B);if(e.bindProgram(k),S){var N=d.getPaintValue("icon-halo-color",n),G=d.getPaintValue("icon-halo-width",n);k.setUniform4f("u_outlineColor",N[0],N[1],N[2],N[3]),k.setUniform1f("u_outlineSize",G)}if(k.setUniformMatrix4fv("u_transformMatrix",V),k.setUniformMatrix4fv("u_extrudeMatrix",L),k.setUniform2fv("u_normalized_origin",u.tileTransform.displayCoord),k.setUniform1f("u_depth",d.z),k.setUniform1f("u_mapRotation",M),k.setUniform1f("u_keepUpright",0),k.setUniform1f("u_level",10*n),k.setUniform1f("u_fadeSpeed",10*l.fadeSpeed),k.setUniform1f("u_minfadeLevel",10*l.minfadeLevel),k.setUniform1f("u_maxfadeLevel",10*l.maxfadeLevel),k.setUniform1f("u_fadeChange",10*(n+l.fadeChange)),k.setUniform1i("u_texture",1),k.setUniform1f("u_size",v),k.setUniform4fv("u_color",this._color),w){var W=a.int32To4Bytes(t.layerID);k.setUniform4f("u_id",W[0],W[1],W[2],W[3])}t.markerPerPageElementsMap.forEach(function(t,i){_._spritesTextureSize[0]=c.getWidth(i)/4,_._spritesTextureSize[1]=c.getHeight(i)/4,k.setUniform2fv("u_mosaicSize",_._spritesTextureSize),c.bind(e,9729,i,1),e.drawElements(4,t[1],5125,12*t[0])}),e.bindVAO()}},e.prototype._initialize=function(e){return!!this._initialized||(this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]},this._initialized=!0,!0)},e.prototype._getIconVAO=function(e,t,i){if(i){if(t.iconDDVertexArrayObject)return t.iconDDVertexArrayObject;var n=t.iconDDVertexBuffer,r=t.iconIndexBuffer;return n&&r?(t.iconDDVertexArrayObject=new s(e,this._programCache.getProgramAttributes(4),this._vertexAttributesDD,{geometry:n},r),t.iconDDVertexArrayObject):null}if(t.iconVertexArrayObject)return t.iconVertexArrayObject;n=t.iconVertexBuffer,r=t.iconIndexBuffer;return n&&r?(t.iconVertexArrayObject=new s(e,this._programCache.getProgramAttributes(4),this._vertexAttributes,{geometry:n},r),t.iconVertexArrayObject):null},e}()}.apply(null,n))||(e.exports=r)},1563:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(354),i(759),i(903),i(820),i(616),i(970),i(381)],void 0===(r=function(e,t,i,n,r,o,a,s,l){return function(){function e(e){this._initialized=!1,this._programOptions={id:!1,dd:!1},this._programCache=e,this._viewProjMat=n.create(),this._offsetVector=r.create(),this._extrudeMat=n.create(),this._haloColor=o.create(),this._sdfColor=o.create(),this._scaleVec=r.create()}return e.prototype.dispose=function(){},e.prototype.render=function(e,t,r,o,l,u,d,c,h,f,p,_,v){var m=this;if(!i("esri-vector-tiles-avoid-text")){this._initialized||this._initialize(e);var g=a.degToByte(l),y=c.getLayoutValue("text-rotation-alignment",r);2===y&&(y=1===c.getLayoutValue("symbol-placement",r)?0:1);var x=0===y,b=c.getLayoutValue("text-keep-upright",r)&&x,S=3===o,I=.8*3/_,w=c.hasDataDrivenTextSize?1:c.getLayoutValue("text-size",r),M=c.hasDataDrivenTextColor?[1,1,1,1]:c.getPaintValue("text-color",r),V=c.hasDataDrivenTextOpacity?1:c.getPaintValue("text-opacity",r),D=M[3]*V*v;this._sdfColor[0]=D*M[0],this._sdfColor[1]=D*M[1],this._sdfColor[2]=D*M[2],this._sdfColor[3]=D,this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([h.width/4,h.height/4]));var T=d.tileTransform.transform,C=c.getPaintValue("text-translate",r);if(0!==C[0]||0!==C[1]){n.copy(this._viewProjMat,d.tileTransform.transform);var E=C[0],O=C[1],z=0,A=0,P=d.coordRange/512,F=(1<<d.key.level)/Math.pow(2,r)*P;if(1===c.getPaintValue("text-translate-anchor",r)){var R=-a.C_DEG_TO_RAD*l,L=Math.sin(R),U=Math.cos(R);z=F*(E*U-O*L),A=F*(E*L+O*U)}else z=F*E,A=F*O;this._offsetVector[0]=z,this._offsetVector[1]=A,this._offsetVector[2]=0,n.translate(this._viewProjMat,this._viewProjMat,this._offsetVector),T=this._viewProjMat}x?n.copy(this._extrudeMat,f):n.copy(this._extrudeMat,p),this._scaleVec[0]=1/24,this._scaleVec[1]=1/24,this._scaleVec[2]=1,n.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);var j=c.hasDataDrivenText,B=this._getSDFVAO(e,d,j);if(B){e.bindVAO(B);var k=(S?1:0)<<1|(j?1:0),N=this._programOptions;N.id=S,N.dd=j;var G=this._programCache.getProgram(6,k,N);if(e.bindProgram(G),G.setUniformMatrix4fv("u_transformMatrix",T),G.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),G.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord),G.setUniform1f("u_depth",c.z+1/65536),G.setUniform2fv("u_mosaicSize",this._glyphTextureSize),G.setUniform1f("u_mapRotation",g),G.setUniform1f("u_keepUpright",b?1:0),G.setUniform1f("u_level",10*r),G.setUniform1f("u_fadeSpeed",10*u.fadeSpeed),G.setUniform1f("u_minfadeLevel",10*u.minfadeLevel),G.setUniform1f("u_maxfadeLevel",10*u.maxfadeLevel),G.setUniform1f("u_fadeChange",10*(r+u.fadeChange)),G.setUniform1i("u_texture",0),G.setUniform1f("u_size",w),G.setUniform1f("u_antialiasingWidth",I),S){var W=s.int32To4Bytes(t.layerID);G.setUniform4f("u_id",W[0],W[1],W[2],W[3])}t.glyphPerPageElementsMap.forEach(function(t,i){m._renderGlyphRange(e,t,i,c,h,G,r,V*v,3)}),e.bindVAO()}}},e.prototype._renderGlyphRange=function(e,t,i,n,r,o,a,s,l){r.bind(e,9729,i,0);var u=n.getPaintValue("text-halo-color",a),d=n.getPaintValue("text-halo-width",a);if(u[3]>0&&d>0){var c=u[3]*s;this._haloColor[0]=c*u[0],this._haloColor[1]=c*u[1],this._haloColor[2]=c*u[2],this._haloColor[3]=c;var h=n.getPaintValue("text-halo-blur",a)*l,f=d*l;o.setUniform4fv("u_color",this._haloColor),o.setUniform1f("u_halo",1),o.setUniform1f("u_edgeDistance",f),o.setUniform1f("u_edgeBlur",h),e.drawElements(4,t[1],5125,12*t[0])}this._sdfColor[3]>0&&(o.setUniform4fv("u_color",this._sdfColor),o.setUniform1f("u_halo",0),o.setUniform1f("u_edgeDistance",0),o.setUniform1f("u_edgeBlur",0),e.drawElements(4,t[1],5125,12*t[0]))},e.prototype._initialize=function(e){return!!this._initialized||(this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]},this._initialized=!0,!0)},e.prototype._getSDFVAO=function(e,t,i){if(i){if(t.textDDVertexArrayObject)return t.textDDVertexArrayObject;var n=t.textDDVertexBuffer,r=t.textIndexBuffer;return n&&r?(t.textDDVertexArrayObject=new l(e,this._programCache.getProgramAttributes(6),this._vertexAttributesDD,{geometry:n},r),t.textDDVertexArrayObject):null}if(t.textVertexArrayObject)return t.textVertexArrayObject;n=t.textVertexBuffer,r=t.textIndexBuffer;return n&&r?(t.textVertexArrayObject=new l(e,this._programCache.getProgramAttributes(6),this._vertexAttributes,{geometry:n},r),t.textVertexArrayObject):null},e}()}.apply(null,n))||(e.exports=r)},1564:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(616),i(385),i(371),i(381)],void 0===(r=function(e,t,i,n,r,o){return function(){function e(e){this._initialized=!1,this._maxWidth=0,this._programOptions={id:!1,pattern:!1},this._programCache=e,this._color=new Float32Array([1,0,0,1])}return e.prototype.dispose=function(){this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null)},e.prototype.render=function(e,t){this._initialized||this._initialize(e);var i=this._programCache.getProgram(0,0,this._programOptions);if(i){e.bindVAO(this._outlineVertexArrayObject),e.bindProgram(i),i.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),i.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),i.setUniform1f("u_coord_range",t.coordRange),i.setUniform1f("u_depth",0),i.setUniform4fv("u_color",this._color),e.setLineWidth(2),e.drawArrays(3,0,4),e.bindVAO();var n=this._getTexture(e,t);if(n){var r=this._programCache.getProgram(7,0,null);r&&(e.bindVAO(this._tileInfoVertexArrayObject),e.bindProgram(r),e.bindTexture(n,0),r.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),r.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),r.setUniform1f("u_depth",0),r.setUniform1f("u_coord_ratio",t.coordRange/512),r.setUniform2f("u_delta",8,8),r.setUniform2f("u_dimensions",n.descriptor.width,n.descriptor.height),e.drawArrays(5,0,4),e.bindVAO())}}},e.prototype._initialize=function(e){if(this._initialized)return!0;var t={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},i=new Int8Array([0,0,1,0,1,1,0,1]),r=n.createVertex(e,35044,i),a=new o(e,this._programCache.getProgramAttributes(0),t,{geometry:r}),s=new Int8Array([0,0,1,0,0,1,1,1]),l=n.createVertex(e,35044,s),u=new o(e,this._programCache.getProgramAttributes(7),t,{geometry:l});return this._outlineVertexArrayObject=a,this._tileInfoVertexArrayObject=u,this._initialized=!0,!0},e.prototype._getTexture=function(e,t){if(t.texture)return t.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var n=t.key.id,o=this._canvas.getContext("2d");o.font="24px sans-serif",o.textAlign="left",o.textBaseline="middle";var a=o.measureText(n),s=Math.pow(2,Math.ceil(i.log2(a.width+2)));return s>this._maxWidth&&(this._maxWidth=s),o.clearRect(0,0,this._maxWidth,32),o.fillStyle=t.key.level>t.refKey.level?"red":"blue",o.fillText(n,0,16),t.texture=new r(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),t.texture},e}()}.apply(null,n))||(e.exports=r)},1565:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1566),i(417)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._cache=new Array(8);for(var e=0;e<8;e++)this._cache[e]={}}return e.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)},e.prototype.getProgram=function(e,t,i){var n=this._cache[e];if(!n[t]){var r=this._programRepo.getProgram(this._getProgramTemplate(e),i);n[t]=r}return n[t]},e.prototype.getProgramAttributes=function(e){switch(e){case 0:return i.background.attributes;case 5:return i.circle.attributes;case 1:return i.fill.attributes;case 4:return i.icon.attributes;case 3:return i.line.attributes;case 2:return i.outline.attributes;case 6:return i.text.attributes;case 7:return i.tileInfo.attributes}},e.prototype.initialize=function(e){this._programRepo||(this._programRepo=new n.ProgramCache(e))},e.prototype._getProgramTemplate=function(e){switch(e){case 0:return i.background;case 5:return i.circle;case 1:return i.fill;case 4:return i.icon;case 3:return i.line;case 2:return i.outline;case 6:return i.text;case 7:return i.tileInfo}},e}();t.default=r}.apply(null,n))||(e.exports=r)},1566:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1567),i(417)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return n.glslifyDefineMap({ID:e.id,PATTERN:e.pattern})};t.background={name:"background",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("background/background.vert"),fragmentShader:r(e)+i.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};var o=function(e){return n.glslifyDefineMap({ID:e.id})};t.circle={name:"circle",shaders:function(e){return{vertexShader:o(e)+i.resolveIncludes("circle/circle.vert"),fragmentShader:o(e)+i.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var a=function(e){return n.glslifyDefineMap({ID:e.id,DD:e.dd,PATTERN:e.pattern})};t.fill={name:"fill",shaders:function(e){return{vertexShader:a(e)+i.resolveIncludes("fill/fill.vert"),fragmentShader:a(e)+i.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};var s=function(e){return n.glslifyDefineMap({ID:e.id,DD:e.dd})};t.outline={name:"outline",shaders:function(e){return{vertexShader:s(e)+i.resolveIncludes("outline/outline.vert"),fragmentShader:s(e)+i.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};var l=function(e){return n.glslifyDefineMap({ID:e.id,DD:e.dd,SDF:e.sdf})};t.icon={name:"icon",shaders:function(e){return{vertexShader:l(e)+i.resolveIncludes("icon/icon.vert"),fragmentShader:l(e)+i.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var u=function(e){return n.glslifyDefineMap({ID:e.id,DD:e.dd,PATTERN:e.pattern})};t.line={name:"line",shaders:function(e){return{vertexShader:u(e)+i.resolveIncludes("line/line.vert"),fragmentShader:u(e)+i.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};var d=function(e){return n.glslifyDefineMap({ID:e.id,DD:e.dd})};t.text={name:"text",shaders:function(e){return{vertexShader:d(e)+i.resolveIncludes("text/text.vert"),fragmentShader:d(e)+i.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}},t.tileInfo={name:"tileInfo",shaders:{vertexShader:i.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:i.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1567:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1568),i(1276)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=new n(function(e){var t=i;return e.split("/").forEach(function(e){t&&(t=t[e])}),t});t.resolveIncludes=function(e){return r.resolveIncludes(e)}}.apply(null,n))||(e.exports=r)},1568:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\n\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif // PATTERN\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\nvoid main() {\n#ifdef PATTERN\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos = mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n\n  // sample the sprite mosaic\n  lowp vec4 color = texture2D(u_texture, samplePos);\n  gl_FragColor = u_opacity * color;\n#else\n  gl_FragColor = u_color;\n#endif // PATTERN\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","background.vert":"precision mediump float;\n\nattribute vec2 a_pos;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix; // can we use medium precision?\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\nvoid main() {\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n\n#ifdef PATTERN\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\n  v_tileTextureCoord = (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif // PATTERN\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n}\n"},circle:{"circle.frag":"precision lowp float;\n\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  mediump float dist = length(v_offset);\n\n  mediump float alpha = smoothstep(0.0, -v_blur, dist - 1.0);\n\n  lowp float color_mix_ratio = v_stroke_width < 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n\n  gl_FragColor = alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","circle.vert":"precision mediump float;\n\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\n\nconst float sizePrecision = 0.25; // 1/4\nconst float blurPrecision = 0.03125; // 1/32\n\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n\n// the opacity of the layer given by the painter\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\n\nuniform mediump float u_antialiasingWidth; // antialiasing (factors in the pixel_ratio for high res devices)\n\nvoid main()\n{\n  v_color = a_color * u_color;\n  v_stroke_color = a_stroke_color * u_stroke_color;\n  v_stroke_width = a_data[1] * sizePrecision * u_stroke_width;\n  v_radius = a_data[2] * u_radius;\n  v_blur = max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n\n  mediump vec2 offset = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset = offset;\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos * 0.5, 0.0, 1.0) + u_extrudeMatrix * (v_radius + v_stroke_width) * vec4(offset, 0.0, 0.0);\n}\n"},fill:{"fill.frag":"precision lowp float;\n\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\nvarying lowp vec4 v_color;\n\nvec4 mixColors(vec4 color1, vec4 color2) {\n  // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Alpha_blending)\n  // we use pre-multiplied colors hence the need for this kind of mixing. At lease we save ourselves an extra division...\n  float compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\n\n  return vec4(compositeColor, compositeAlpha);\n}\n\nvoid main()\n{\n#ifdef PATTERN\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos = mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n\n  // sample the sprite mosaic\n  lowp vec4 color = texture2D(u_texture, samplePos);\n  gl_FragColor = v_color[3] * color;\n#else\n  gl_FragColor = v_color;\n#endif // PATTERN\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","fill.vert":"precision mediump float;\n\nattribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\n\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\n#ifdef DD\nattribute vec4 a_color;\n#endif // DD\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n\nvoid main()\n{\n#ifdef DD\n  v_color = a_color * u_color;\n#else\n  v_color = u_color;\n#endif // DD\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n\n#ifdef PATTERN\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\n  // (-4k to 8k -1) to texture coordinates.\n  v_tileTextureCoord = (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif // PATTERN\n\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n}\n"},icon:{"icon.frag":"precision mediump float;\n\nuniform lowp sampler2D u_texture; // SDF texture\n#ifdef SDF\nuniform lowp vec4 u_color; // a color to override the one of the vertex\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif // SDF\n\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\nvarying mediump vec2 v_size;\n\nvarying lowp vec4 v_color;\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\n// we need the conversion function from RGBA to float\n#include <util/encoding.glsl>\n\nvec4 mixColors(vec4 color1, vec4 color2) {\n  // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Alpha_blending)\n  // we use pre-multiplied colors hence the need for this kind of mixing. At lease we save ourselves an extra division...\n  float compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\n\n  return vec4(compositeColor, compositeAlpha);\n}\n\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor = v_color;\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  float d = rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n\n  // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n  // 1 / 86 represents a single pixel given the size of the SDF is 128 and we add 4 pixels margins to deal with\n  // other non SDF types.\n  // The rasterized geometry takes only 86 pixels because of the extra 16 pixels margin for the outline.\n  const float sofetEdgeRatio = 0.248062016; // ==> (32.0 / 86.0) / 1.5;\n  float size = max(v_size.x, v_size.y);\n  float dist = d * sofetEdgeRatio * size;\n\n  // set the fragment's transparency according to the distance from the edge\n  fillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\n\n  // count for the outline\n  // therefore tint the entire icon area.\n  if (u_outlineSize > 0.25) {\n    lowp vec4 outlinePixelColor = u_outlineColor;\n    // the outline limit ratio is derived from the 16 pixels allocated for the outline and the fact that 1/86 represents\n    // a single pixel.\n    const float outlineLimitRatio = (16.0 / 86.0);\n    float clampedOutlineSize = sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n\n    outlinePixelColor *= clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n\n    // finally combine the outline and the fill colors\n    gl_FragColor = v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor = v_transparency * fillPixelColor;\n  }\n#else // not an SDF\n  lowp vec4 texColor = texture2D(u_texture, v_tex);\n  gl_FragColor = v_transparency * texColor;\n#endif // SDF\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif // DD\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\nvarying lowp vec4 v_color;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\nvarying mediump vec2 v_size;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precision we multiply the values\n// by 8 and then at the shader devide by the same number\nconst float C_OFFSET_PRECISION = 1.0 / 8.0;\n\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float tileCoordRatio = 1.0 / 8.0;\n\nvoid main()\n{\n  mediump float a_labelMinLevel = a_levelInfo[0];\n  mediump float a_angle         = a_levelInfo[1];\n  mediump float a_minLevel      = a_levelInfo[2];\n  mediump float a_maxLevel      = a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z = 0.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated = mod(a_angle + u_mapRotation, 256.0);\n  delta_z += (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated)); //ie. z += (flip > 0) && (64 <= rotated) && (rotated < 192)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z += 1.0 - step(a_minLevel, u_level); // Test if (level < minLevel)\n  delta_z += step(a_maxLevel, u_level); // Test if (maxLevel <= level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha = clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency = (u_fadeSpeed >= 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel < a_labelMinLevel)\n  {\n    v_transparency = 0.0;\n  }\n  if (u_minfadeLevel >= a_labelMinLevel)\n  {\n    v_transparency = 1.0;\n  }\n\n  // if label had been faded out, clip it\n  delta_z += step(v_transparency, 0.0);\n\n  vec2 offset = C_OFFSET_PRECISION * a_vertexOffset;\n\n  v_size = abs(offset);\n\n#ifdef SDF\n  offset = (120.0 / 86.0) * offset;\n#endif // SDF\n\n#ifdef DD\n  mediump float icon_size = a_size * u_size;\n#else\n  mediump float icon_size = u_size;\n#endif // DD\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * icon_size * vec4(offset, delta_z, 0.0);\n\n#ifdef DD\n  v_color = a_color * u_color;\n#else\n  v_color = u_color;\n#endif // DD\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n\n  v_tex = a_tex.xy / u_mosaicSize;\n  v_transparency *= v_color.w;\n}\n"},line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\n\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\n\nvarying mediump float v_blur;\n\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\n\n// Horizontal scale is used to scale the horizontal texture coordinate v_normal.x before adding it as an offset to the\n// accumulated distance. Most vertices will have v_normal.x == 0, because the pattern must be sampled only depending on\n// the v_accumulatedDistance value. But tessellation at caps can have vertices with v_normal.x != 0, thus allowing to\n// \"keep moving\" for a few more pixel even when the line has ended or has not started yet.\nconst mediump float tileCoordRatio = 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist = length(v_normal) * v_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // We need to count for both sides of the line.\n  lowp float alpha = clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n\n#ifdef PATTERN\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX = mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n\n  // in order to calculate the texture coordinates perpendicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value should be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolated normal is 1.0\n  //              | -> line-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -> line-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolated normal is -1.0\n\n  mediump float relativeTexY = 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color = texture2D(u_texture, texCoord);\n\n  // finally write the fragment value\n  gl_FragColor = alpha * v_color[3] * color;\n#else\n  // now calculate the dashes given the accumulated distance of the line:\n  // start with calculating a normalized position along the line\n  lowp float dashPos =  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\n  //   | <--- pos along the dash part\n  // -------_______-------_______\n  // when the dashPos is over the 'gap' part of the dash dasharray.x - dashPos is negative and therefore the alpha will\n  // get clamped to zero.\n  // when dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\n  // along the direction of the line.\n  lowp float dashAlpha = clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n\n  // if we don't have a no-data part to the dash then it is a solid line\n  dashAlpha = max(sign(-v_dasharray.y), dashAlpha);\n  // finally multiply the fragment's alpha by the calculated dash-alpha\n  alpha *= dashAlpha;\n\n  // output the fragment color\n  gl_FragColor = alpha * v_color;\n#endif // PATTERN\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","line.vert":"/* The implementation of the renderer is based on the article and implementation of MB described here:\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\n*/\n\nattribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing; // the feather distance at which the line edge fades out\n\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\nvarying mediump vec2 v_normal;\n\n// the accumulated distance along the line. We need this information in order to render the dashes.\nvarying highp float v_accumulatedDistance;\n\nconst float scale = 1.0 / 31.0;\n\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif // DD\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth; // the inset and outset of the line\nvarying mediump float v_blur;\n\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\n\nvoid main()\n{\n  v_normal = a_offsetAndNormal.zw * scale;\n\n#ifdef DD\n  v_lineHalfWidth = a_width * u_width;\n#else\n  v_lineHalfWidth = u_width;\n#endif // DD\n\n  v_lineHalfWidth += u_antialiasing;\n  v_lineHalfWidth *= 0.5;\n\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray = u_dasharray * a_width;\n#else\n  v_dasharray = u_dasharray * u_width;\n#endif // DD\n#endif\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec2 dist = v_lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n  // transform the vertex\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\n  v_accumulatedDistance = a_accumulatedDistance.x;\n\n  v_blur = u_blur + u_antialiasing;\n\n  #ifdef DD\n    v_color = a_color * u_color;\n  #else\n    v_color = u_color;\n  #endif // DD\n\n  #ifdef ID\n    v_id = u_id / 255.0;\n  #endif // ID\n}\n"},outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  // Calculate the distance of the pixel from the line in pixels.\n  lowp float dist = abs(v_normal.y);\n\n  lowp float alpha = smoothstep(1.0, 0.0, dist);\n  gl_FragColor = alpha * v_color;\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n\n#ifdef DD\nattribute vec4 a_color;\n#endif // DD\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\nuniform highp mat4 u_transformMatrix;\nuniform highp mat4 u_extrudeMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\n\nvarying lowp vec2 v_normal;\n\nconst float scale = 1.0 / 15.0;\n\nvoid main()\n{\n#ifdef DD\n  v_color = a_color * u_color;\n#else\n  v_color = u_color;\n#endif // DD\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n\n  v_normal = a_xnormal;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec4 dist = vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\n\n  // Remove the texture normal bit of the position before scaling it with the\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\n  // because we're extruding the line in pixel space, regardless of the current\n  // tile's zoom level.\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\n}\n"},text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif // ID\n\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  mediump float alpha = smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n\n  gl_FragColor = alpha * v_color;\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\nuniform lowp vec4 u_color; // always defined as halo does not support data driven but text does\n#ifdef DD\nattribute vec4 a_color;\n#endif // DD\nvarying lowp vec4 v_color;\n\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif // DD\nvarying mediump float v_size;\n\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif // ID\n\n\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying lowp vec2 v_tex;\n\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precision we multiply the values\n// by 8 and then at the shader divide by the same number\nconst float offsetPrecision = 1.0 / 8.0;\n\n// outline position and appearance\nconst mediump float edgePos = 0.75; // defined by the SDF encoding\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth; // antialiasing (factors in the pixel_ratio for high res devices)\n\nvarying mediump float v_edgeDistance; // will factor in the size\nvarying mediump float v_edgeWidth; // will factor in the size\n\nuniform lowp float u_halo; // needed to avoid using the color attribute for halo\n\nvoid main()\n{\n  mediump float a_labelMinLevel = a_levelInfo[0];\n  mediump float a_angle        = a_levelInfo[1];\n  mediump float a_minLevel    = a_levelInfo[2];\n  mediump float a_maxLevel    = a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z = 0.0;\n\n  // TODO: force clipping the vertex in case that the vertex isn't visible\n  //delta_z += a_visible ? 0.0 : 1.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated = mod(a_angle + u_mapRotation, 256.0);\n  delta_z += (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated)); //ie. z += (flip > 0) && (64 <= rotated) && (rotated < 192)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z += 1.0 - step(a_minLevel, u_level); // Test if (level < minLevel)\n  delta_z += step(a_maxLevel, u_level); // Test if (maxLevel <= level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha = clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency = (u_fadeSpeed >= 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel < a_labelMinLevel)\n  {\n    v_transparency = 0.0;\n  }\n  if (u_minfadeLevel >= a_labelMinLevel)\n  {\n    v_transparency = 1.0;\n  }\n\n  // if label has been faded out, clip it\n  delta_z += step(v_transparency, 0.0);\n\n  v_tex = a_tex.xy / u_mosaicSize;\n\n#ifdef DD\n  if (u_halo > 0.5)\n  {\n    v_color = u_color;\n  }\n  else\n  {\n    v_color = a_color * u_color;\n    // opacity already factored in a_color\n  }\n#else\n  v_color = u_color;\n#endif // DD\n\n#ifdef DD\n  v_size = a_size * u_size;\n#else\n  v_size = u_size;\n#endif // DD\n\n#ifdef ID\n  v_id = u_id / 255.0;\n#endif // ID\n\n  v_edgeDistance = edgePos - u_edgeDistance / v_size;\n  v_edgeWidth = (u_antialiasingWidth + u_edgeBlur) / v_size;\n\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * v_size * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n}\n"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color = texture2D(u_texture, v_tex);\n  gl_FragColor = 0.75 * color;\n}\n","tileInfo.vert":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex = a_pos;\n}\n"},util:{"encoding.glsl":"// Factors to convert rgba back to float\nconst vec4 rgba2float_factors = vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\n\nfloat rgba2float(vec4 rgba) {\n  // Convert components from 0->1 back to 0->255 and then\n  // add the components together with their corresponding\n  // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n  return dot(rgba, rgba2float_factors);\n}\n"}}}.apply(null,n))||(e.exports=r)},2345:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336),i(450),i(766),i(456)],void 0===(r=function(e,t,i,n,r,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._fullCacheLodInfos=null,t._levelByScale={},t}return i(t,e),t.prototype.getTileParentId=function(e){var t=a.pool.acquire(e),i=0===t.level?null:a.getId(t.level-1,t.row>>1,t.col>>1,t.world);return a.pool.release(t),i},t.prototype.getTileIdAtParent=function(e,t){var i=a.pool.acquire(t),n=this._infoByLevel[i.level];if(e.resolution<n.resolution)throw a.pool.release(i),new Error("Cannot calculate parent tile. destination LOD's resolution "+e.resolution+" is not a parent resolution of "+n.resolution);if(e.resolution===n.resolution){var r=i.id;return a.pool.release(i),r}var o=i.level-e.level;if(o<0)throw a.pool.release(i),new Error("Wrong way...!");var s=a.getId(e.level,i.row>>o,i.col>>o,i.world);return a.pool.release(i),s},t.prototype.getTileCoverage=function(t){var i=e.prototype.getTileCoverage.call(this,t);if(!i)return i;var n=1<<i.lodInfo.level;return i.spans=i.spans.filter(function(e){return e.row>=0&&e.row<n}),i},t.prototype.scaleToLevel=function(e){if(this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos),this._levelByScale[e])return this._levelByScale[e];var t=this._fullCacheLodInfos;if(e>t[0].scale)return t[0].level;for(var i=void 0,n=void 0,r=0;r<t.length-1;r++)if(e>(n=t[r+1]).scale)return(i=t[r]).level+(i.scale-e)/(i.scale-n.scale);return t[t.length-1].level},t.prototype._initializeFullCacheLODs=function(e){var t;if(0===e[0].level)t=e.map(function(e){return{level:e.level,resolution:e.resolution,scale:e.scale}});else{var i=this.tileInfo.size[0],n=this.tileInfo.spatialReference;t=r.create({size:i,spatialReference:n}).lods.map(function(e){return{level:e.level,resolution:e.resolution,scale:e.scale}})}for(var o=0;o<t.length;o++)this._levelByScale[t[o].scale]=t[o].level;this._fullCacheLodInfos=t},t}(o)}.apply(null,n))||(e.exports=r)},2346:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(354),i(340),i(759),i(903),i(716),i(623),i(1386),i(616),i(1555)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c){return function(e){function t(){var t=e.call(this)||this;return t.isInitialized=!1,t._renderer=new c,t._displayWidth=0,t._displayHeight=0,t._pointToCallbacks=new Map,t._tileCoordinateScale=a.create(),t._orientationVec=a.create(),t._displayScale=a.create(),t._orientationVec.set([0,0,1]),t._defaultTransform=o.create(),t}return i(t,e),t.prototype.initialize=function(e,t,i,n){this._renderer.initialize(e,t),this._tileInfoView=n,this._tileInfo=i,this.isInitialized=!0},t.prototype.destroy=function(){this._renderer&&(this._renderer.dispose(),this._renderer=null)},t.prototype.hittest=function(e,t){var i=this,n=[e,t];return r.create(function(e,t){i._pointToCallbacks.set(n,{resolve:e,reject:t}),i.requestRender()},function(){i._pointToCallbacks.has(n)&&i._pointToCallbacks.delete(n)})},t.prototype.prepareChildrenRenderParameters=function(e){var t=e.state;if(!t||!this._tileInfo||!this.isInitialized)return e;var i=e;return i.displayLevel=this._tileInfoView.scaleToLevel(t.scale),i.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,i.renderer=this._renderer,i},t.prototype.beforeRenderChildren=function(e,t){this._renderer.initializeProgramCache(e.context)},t.prototype.renderChildren=function(t){var i=this;if(0!==this.children.length&&this.isInitialized&&t&&t.state){var r=u.default.toWGLDrawPhases(t.drawPhase);if(!(r.length>0)||r[0]!==l.WGLDrawPhase.LABEL&&r[0]!==l.WGLDrawPhase.LABEL_ALPHA){this.sortChildren(function(e,t){return e.key.level-t.key.level});for(var o=this.children.length,a=1;a<=o;a++){var s=this.children[a-1];s.attached&&(s.stencilData.reference=a,s.stencilData.mask=255)}this._updateTilesTransform(t.state,t.requiredLevel,this.children);var d=t.context;if(d.setDepthWriteEnabled(!0),this._renderer.setStateParams(t.state,t.pixelRatio,t.displayLevel),this._renderer.drawClippingMasks(d,this.children),d.setStencilWriteMask(0),d.setBlendFunctionSeparate(1,771,1,771),d.setStencilOp(7680,7680,7681),d.setDepthFunction(515),d.setBlendingEnabled(!1),d.setStencilTestEnabled(!0),d.setDepthTestEnabled(!0),d.setDepthWriteEnabled(!0),t.drawphase=0,e.prototype.renderChildren.call(this,t),d.setDepthWriteEnabled(!1),d.setBlendingEnabled(!0),t.drawphase=1,e.prototype.renderChildren.call(this,t),t.drawphase=2,e.prototype.renderChildren.call(this,t),d.setStencilTestEnabled(!1),d.setDepthTestEnabled(!1),n("esri-vector-tiles-debug"))for(var c=0,h=this.children;c<h.length;c++){var f=h[c];f.attached&&f.visible&&this._renderer.renderTileInfo(d,f)}this._pointToCallbacks.size>0&&(this._pointToCallbacks.forEach(function(e,n){e.resolve(i._hitTest(t,n[0],n[1]))}),this._pointToCallbacks.clear()),this._renderer.needsRedraw()&&this.requestRender()}}},t.prototype.removeAllChildren=function(){for(var t=0;t<this.children.length;t++)this.children[t].dispose();e.prototype.removeAllChildren.call(this)},t.prototype._hitTest=function(e,t,i){var n=this._tileInfoView.getClosestInfoForScale(e.state.scale).level,r=[0,0];e.state.toMap(r,[t,i]);var o=e.state.clone(),a=o.viewpoint.clone(),s=a.targetGeometry;s.x=r[0],s.y=r[1],a.targetGeometry=s,o.viewpoint=a,o.size=[3,3],this._renderer.setStateParams(o,e.pixelRatio,e.displayLevel);var l={drawPhase:0,pixelRatio:e.pixelRatio,stationary:e.stationary,opacity:e.opacity,context:e.context,displayLevel:e.displayLevel,requiredLevel:e.requiredLevel,renderer:e.renderer,layerOpacity:e.layerOpacity,state:o,drawphase:3,painter:null},u=this._renderer.hitTest(l,t,i,this.children,n,3,this._updateTilesTransform.bind(this));return u&&0!==u.length?u[0]:null},t.prototype._updateTilesTransform=function(e,t,i){var n=1/e.width,r=1/e.height,o=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lodAt(t).resolution,e.resolution,e.rotation,this._tileInfo.size[1],4096,e.width,e.height,this._defaultTransform);for(var a=0,s=i;a<s.length;a++){var l=s[a];e.toScreen(o,l.coords),o[1]=e.height-o[1],l.tileTransform.displayCoord[0]=2*o[0]*n-1,l.tileTransform.displayCoord[1]=2*o[1]*r-1,l.key.level===t&&4096===l.coordRange?l.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lodAt(l.key.level).resolution,e.resolution,e.rotation,this._tileInfo.size[1],l.coordRange,e.width,e.height,l.tileTransform.transform)}},t.prototype._calculateRelativeViewProjMat=function(e,t,i,n,r,a,s,l){var u=.125;512!==n&&4096!==r&&(u=n/r);var c=u*(e/t);this._tileCoordinateScale.set([c,c,1]),a===this._displayWidth&&s===this._displayHeight||(this._displayScale.set([2/a,-2/s,1]),this._displayWidth=a,this._displayHeight=s),o.identity(l),o.scale(l,l,this._tileCoordinateScale),o.rotate(l,l,-i*d.C_DEG_TO_RAD,this._orientationVec),o.scale(l,l,this._displayScale),o.transpose(l,l)},t}(s)}.apply(null,n))||(e.exports=r)},357:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e){return e?72*e/t.DPI:0}Object.defineProperty(t,"__esModule",{value:!0});var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,r="screenUtils.toPt: input not recognized!";t.DPI=96,t.pt2px=function(e){return e?e/72*t.DPI:0},t.px2pt=i,t.toPt=function(e){if("string"==typeof e){if(n.test(e)){var t=e.match(n),o=Number(t[1]),a=t[3]&&t[3].toLowerCase(),s="-"===e.charAt(0),l="px"===a?i(o):o;return s?-l:l}return console.warn(r),null}return e}}.apply(null,n))||(e.exports=r)},373:function(e,t,i){var n,r;n=[i(348),i(341),i(362)],void 0===(r=function(e,t,i){var n=e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),r=0;return t.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:function(){this.id="sym"+r++},properties:{type:{type:String,value:null,json:{read:n.read,write:{ignoreOrigin:!0,writer:n.write}}},color:{type:i,value:new i([0,0,0,1]),json:{read:function(e){return e&&null!=e[0]?[e[0],e[1],e[2],e[3]/255]:e},write:{allowNull:!0}}}}})}.apply(null,n))||(e.exports=r)},379:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(356)],void 0===(r=function(e,t,i){function n(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}function r(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.CONFIGURE=1]="CONFIGURE",e[e.CONFIGURED=2]="CONFIGURED",e[e.OPEN=3]="OPEN",e[e.OPENED=4]="OPENED",e[e.RESPONSE=5]="RESPONSE",e[e.INVOKE=6]="INVOKE",e[e.CANCEL=7]="CANCEL",e[e.CLOSE=8]="CLOSE",e[e.OPEN_PORT=9]="OPEN_PORT"}(t.MessageType||(t.MessageType={}));var o=0;t.newJobId=function(){return o++},t.isTranferableResult=n,t.toInvokeError=function(e){return e?e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details,stack:e.stack}):null},t.postMessage=function(e,t,o,a){2===arguments.length||void 0===o&&void 0===a?e.postMessage(t):(i("esri-workers-arraybuffer-transfer")||(a?(a=a.filter(function(e){return!r(e)})).length||(a=null):n(o)&&o.transferList&&(o.transferList=o.transferList.filter(function(e){return!r(e)}),o.transferList.length||(o.transferList=null))),a?(t.data=o,e.postMessage(t,a)):n(o)?(t.data=o.result,o.transferList?e.postMessage(t,o.transferList):e.postMessage(t)):(t.data=o,e.postMessage(t)))},t.receiveMessage=function(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}}.apply(null,n))||(e.exports=r)},391:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(342),i(340),i(379)],void 0===(r=function(e,t,i,n,r){function o(e,t){e.delete(t)}var a=r.MessageType.CLOSE,s=r.MessageType.CANCEL,l=r.MessageType.INVOKE,u=r.MessageType.RESPONSE,d=r.MessageType.OPEN_PORT,c=function(){function e(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e){e.type===r.MessageType.CANCEL?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))},e.prototype.clear=function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null},e.prototype._process=function(){this._timer=null;for(var e=0,t=this._invokeMessages;e<t.length;e++){var i=t[e];this._cancelledJobIds.has(i.jobId)||this._invoke(i)}this._cancelledJobIds.clear(),this._invokeMessages.length=0},e}();return function(){function e(e,t,i){this._outJobs=new Map,this._inJobs=new Map,this._queue=new c(this._onInvoke.bind(this)),this._onMessage=this._onMessage.bind(this),this._client=t,this._port=e,this._port.addEventListener("message",this._onMessage),this._port.start(),this._channel=i}return e.connect=function(t){var i,n=new MessageChannel;return(i="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t).remoteClient=new e(n.port1,i,n),n.port2},e.prototype.close=function(){this._post({type:a}),this._close()},e.prototype.isBusy=function(){return this._outJobs.size>0},e.prototype.invoke=function(e,t,a){var u=this;if(!this._port)return n.reject(new i("remote-client:port-closed","Can't invoke(), port is closed"));var d=r.newJobId(),c=function(){o(u._outJobs,d),u._post({type:s,jobId:d})};return n.create(function(i,n){var r={resolve:i,reject:n,cancel:c};u._outJobs.set(d,r),u._post({type:l,jobId:d,methodName:e},t,a)},c)},e.prototype.openPort=function(){var e=this,t=r.newJobId(),i=function(){o(e._outJobs,t),e._post({type:s,jobId:t})};return n.create(function(n,r){var o={resolve:n,reject:r,cancel:i};e._outJobs.set(t,o),e._post({type:d,jobId:t})},i)},e.prototype._close=function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(function(e){e.cancel()}),this._inJobs.clear(),this._outJobs.clear(),this._queue.clear(),this._port=this._client=null},e.prototype._onMessage=function(e){var t=r.receiveMessage(e);if(t)switch(t.type){case u:this._onResponse(t);break;case l:this._queue.push(t);break;case s:this._onCancel(t);break;case a:this._close();break;case d:this._onOpenPort(t)}},e.prototype._onCancel=function(e){var t=this._inJobs,i=e.jobId,n=t.get(i);this._queue.push(e),n&&(o(t,i),n.cancel())},e.prototype._onInvoke=function(e){var t,i=this,a=e.methodName,s=e.jobId,l=e.data,d=this._inJobs,c=this._client,h=c[a];try{if(!h&&a&&-1!==a.indexOf("."))for(var f=a.split("."),p=0;p<f.length-1;p++)h=(c=c[f[p]])[f[p+1]];if("function"!=typeof h)throw new TypeError(a+" is not a function");t=h.call(c,l,this)}catch(e){return void this._post({type:u,jobId:s,error:r.toInvokeError(e)})}n.isThenable(t)?(d.set(s,t),t.then(function(e){d.has(s)&&(o(d,s),i._post({type:u,jobId:s},e))}).catch(function(e){d.has(s)&&(o(d,s),e&&"cancel"===e.dojoType||i._post({type:u,jobId:s,error:r.toInvokeError(e||{message:"Error encountered at method "+a})}))})):this._post({type:u,jobId:s},t)},e.prototype._onOpenPort=function(t){var i=new MessageChannel;new e(i.port1,this._client),this._post({type:u,jobId:t.jobId},i.port2,[i.port2])},e.prototype._onResponse=function(e){var t=e.jobId,n=e.error,r=e.data,a=this._outJobs;if(a.has(t)){var s=a.get(t);o(a,t),n?s.reject(i.fromJSON(JSON.parse(n))):s.resolve(r)}},e.prototype._post=function(e,t,i){return r.postMessage(this._port,e,t,i)},e}()}.apply(null,n))||(e.exports=r)},407:function(e,t,i){var n,r;n=[i(353),i(339),i(357),i(593)],void 0===(r=function(e,t,i,n){var r={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},o={color:[0,0,0,1],style:r.STYLE_SOLID,width:.75,cap:r.CAP_ROUND,join:r.JOIN_ROUND,miterLimit:7.5},a=e(n,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line",style:{value:r.STYLE_SOLID,json:{read:function(e,i){return t.valueOf(this._jsonStyles,e)||void 0},write:function(e,t){t.style=this._jsonStyles[e]}}},cap:{value:r.CAP_ROUND,json:{write:{overridePolicy:function(e,t,i){return{enabled:"round"!==e&&(null==i||null==i.origin)}}}}},join:{value:r.JOIN_ROUND,json:{write:{overridePolicy:function(e,t,i){return{enabled:"round"!==e&&(null==i||null==i.origin)}}}}},miterLimit:{value:7.5,cast:i.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash","short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash","long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return t.mixin(this.inherited(arguments),o)},normalizeCtorArgs:function(e,t,n,r,o,a){if(e&&"string"!=typeof e)return e;var s={};return null!=e&&(s.style=e),null!=t&&(s.color=t),null!=n&&(s.width=i.toPt(n)),null!=r&&(s.cap=r),null!=o&&(s.join=o),null!=a&&(s.miterLimit=i.toPt(a)),s},clone:function(){return new a({color:t.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});return t.mixin(a,r),a.defaultProps=o,a}.apply(null,n))||(e.exports=r)},443:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(609)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)}.apply(null,n))||(e.exports=r)},454:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(340)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.when=function e(t,n){return Array.isArray(n)?i.create(function(e){t(n,function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e(t)})}):e(t,[n]).then(function(e){return e[0]})},t.getAbsMid=function(e,t,i){return t.toAbsMid?t.toAbsMid(e):i.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,n))||(e.exports=r)},456:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(412)],void 0===(r=function(e,t,i){return function(){function e(e,t,i,n){this.set(e,t,i,n)}return e.from=function(t,i,n,r){return e.pool.acquire(t,i,n,r)},e.getId=function(e,t,i,n){return"object"==typeof e?e.level+"/"+e.row+"/"+e.col+"/"+e.world:e+"/"+t+"/"+i+"/"+n},Object.defineProperty(e.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world},e.prototype.release=function(){this.level=0,this.row=0,this.col=0,this.world=0},e.prototype.set=function(e,t,i,n){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){var r=e.split("/"),o=r[0],a=r[1],s=r[2],l=r[3];this.level=parseFloat(o),this.row=parseFloat(a),this.col=parseFloat(s),this.world=parseFloat(l)}else this.level=+e,this.row=+t,this.col=+i,this.world=+n||0;return this},e.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world},e.prototype.getChildKeys=function(){var t=this.level+1,i=this.row<<1,n=this.col<<1,r=this.world;return[e.pool.acquire(t,i,n,r),e.pool.acquire(t,i,n+1,r),e.pool.acquire(t,i+1,n,r),e.pool.acquire(t,i+1,n+1,r)]},e.prototype._compare=function(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0},e.sort=function(t){return t.map(function(t){return e.from(t)}).sort(function(e,t){return e._compare(t)}).map(function(e){return e.id})},e.pool=new i(e,!0,null,25,50),e}()}.apply(null,n))||(e.exports=r)},464:function(e,t,i){var n,r;n=[i(373),i(407)],void 0===(r=function(e,t){return e.createSubclass({declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:t,json:{read:{default:null},write:!0}},type:null}})}.apply(null,n))||(e.exports=r)},465:function(e,t,i){var n,r;n=[i(353),i(357),i(373)],void 0===(r=function(e,t,i){return e(i,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(e){return e&&-1*e},write:function(e,t){t.angle=e&&-1*e}}},type:{},xoffset:{value:0,cast:t.toPt,json:{write:!0}},yoffset:{value:0,cast:t.toPt,json:{write:!0}},size:{value:9,cast:function(e){return"auto"===e?e:t.toPt(e)},json:{write:!0}}}})}.apply(null,n))||(e.exports=r)},591:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(350)],void 0===(r=function(e,t,i){function n(e,t,n){return t.imageData?i.makeData({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):r(t.url,n)}function r(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!i.isAbsolute(e)&&t.layer.parsedUrl?i.join(t.layer.parsedUrl.path,"images",e):i.read(e,t)}function o(e,t,n,r){if(i.isDataProtocol(e)){var o=i.dataComponents(e);t.contentType=o.mediaType,t.imageData=o.data,n&&n.imageData===t.imageData&&n.url&&(t.url=a(n.url,r))}else t.url=a(e,r)}function a(e,t){return i.write(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.readImageDataOrUrl=n,t.read=r,t.writeImageDataAndUrl=o,t.write=a,t.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:n},write:{writer:function(e,t,i,n){o(e,t,this.source,n)}}}},t.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(e,t,i){var n={};return t.imageData&&(n.imageData=t.imageData),t.contentType&&(n.contentType=t.contentType),t.url&&(n.url=r(t.url,i)),n}}}}}.apply(null,n))||(e.exports=r)},593:function(e,t,i){var n,r;n=[i(353),i(357),i(373)],void 0===(r=function(e,t,i){return e(i,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line",width:{value:.75,cast:t.toPt,json:{write:!0}}}})}.apply(null,n))||(e.exports=r)},594:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=i||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),i},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),i},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,i=this._toString(this._data,t,t+e);return this._skip(e),i},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,i=this._toBytes(this._data,t,t+e);return this._skip(e),i},e.prototype.getMessage=function(){var t=this._getLength(),i=this._pos,n=new e(this._data,this._dataView,i,i+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,i=this._pos,n=0;if(this._end-i>=10)do{if(n|=127&(e=t[i++]),0==(128&e))break;if(n|=(127&(e=t[i++]))<<7,0==(128&e))break;if(n|=(127&(e=t[i++]))<<14,0==(128&e))break;if(n|=(127&(e=t[i++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[i++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[i++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[i++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[i++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[i++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[i++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var r=1;i!==this._end&&0!=(128&(e=t[i]));)++i,n+=(127&e)*r,r*=128;if(i===this._end)throw new Error("Varint overrun!");++i,n+=e*r}return this._pos=i,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,i){var n="",r="";i=Math.min(this._end,i);for(var o=t;o<i;++o){var a=e[o];128&a?r+="%"+a.toString(16):(n+=decodeURIComponent(r)+String.fromCharCode(a),r="")}return r.length&&(n+=decodeURIComponent(r)),n},e.prototype._toBytes=function(e,t,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,t,i-t)},e}()}.apply(null,n))||(e.exports=r)},609:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(378),i(433),i(343),i(340),i(610),i(391),i(611)],void 0===(r=function(e,t,n,r,o,a,s,l,u){function d(){if(m)return m;for(var e=h+f,t=[],i=0;i<e;i++)!function(e){var i=u.create(e).then(function(t){return v[e]=t,t});t.push(i)}(i);return m=r(t).then(function(){})}Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=s,t.RemoteClient=l;var c=n("host-browser")?navigator.hardwareConcurrency:0;c||(c=n("safari")&&n("mac")||n("trident")?8:2);var h=n("esri-workers-debug")?1:Math.max(1,Math.ceil(c/2)),f=n("esri-workers-debug")?1:Math.max(1,Math.floor(c/2)),p=o.getLogger("esri.core.workers"),_=0,v=[];t.initialize=function(){d()},t.open=function(n,r,o){if(void 0===r&&(r={}),Array.isArray(n))return new t.Connection(n.map(function(e){return new t.RemoteClient(e,r.client)}));if("string"!=typeof n){p.warn("workers-open:signature-deprecated","DEPRECATED: workers.open() changed signature.");var s=n;n=r,r={client:s,strategy:o?"dedicated":"distributed"}}var l=r.strategy||"distributed";return"local"===l?a.create(function(r){Promise.resolve().then(function(){var i=[e(n,null,!1)];(function(e){r(t.RemoteClient.connect(e))}).apply(null,i)}).catch(i.oe)}).then(function(e){return new t.Connection([new t.RemoteClient(e,r.client)])}):d().then(function(){if("dedicated"===l){var e=h+_++;return _%=f,v[e].open(n).then(function(e){return new t.Connection([new t.RemoteClient(e,r.client)])})}return a.all(v.map(function(e){return e.open(n)})).then(function(e){return new t.Connection(e.map(function(e){return new t.RemoteClient(e,r.client)}))})})},t.terminate=function(){m&&(m.cancel(),m=null);for(var e=0;e<v.length;e++)v[e]&&v[e].terminate();v.length=0};var m=null}.apply(null,n))||(e.exports=r)},610:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(340)],void 0===(r=function(e,t,i){return function(){function e(e){this._clientIdx=0,this._clients=e}return e.prototype.broadcast=function(e,t){for(var i=[],n=0,r=this._clients;n<r.length;n++){var o=r[n];i.push(o.invoke(e,t))}return i},e.prototype.close=function(){for(var e=0,t=this._clients;e<t.length;e++)t[e].close();this._clients=[]},e.prototype.invoke=function(e,t,n,r){var o=r&&r.client;if(!this._clients||!this._clients.length)return i.reject(new Error("Connection closed"));null!=o&&-1!==this._clients.indexOf(o)||this._clients.some(function(e){return!e.isBusy()&&(o=e,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,o=this._clients[this._clientIdx]);var a=o.invoke(e,t,n);return r&&(r.client=o),a},e.prototype.openPorts=function(){return i.all(this._clients.map(function(e){return e.openPort()}))},e}()}.apply(null,n))||(e.exports=r)},611:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(605),i(342),i(343),i(340),i(379),i(612)],void 0===(r=function(e,t,i,n,r,o,a,s){function l(e,t){e.delete(t)}var u=r.getLogger("esri.core.workers"),d=a.MessageType.CANCEL,c=a.MessageType.INVOKE,h=a.MessageType.OPEN,f=a.MessageType.OPENED,p=a.MessageType.RESPONSE;return function(){function e(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",function(e){e.preventDefault(),u.error(e)})}return e.create=function(t){return s.createWorker().then(function(i){return new e(i,t)})},e.prototype.terminate=function(){this.worker.terminate()},e.prototype.open=function(e){var t=this,i=a.newJobId(),n=function(){l(t._outJobs,i),t._post({type:d,jobId:i})};return o.create(function(r,o){var a={resolve:r,reject:o,cancel:n};t._outJobs.set(i,a),t._post({type:h,jobId:i,modulePath:e})},n)},e.prototype._onMessage=function(e){var t=a.receiveMessage(e);if(t)switch(t.type){case f:case p:this._onResponse(t);break;case d:this._onCancel(t);break;case c:this._onInvoke(t)}},e.prototype._onCancel=function(e){var t=this._inJobs.get(e.jobId);t&&t.cancel()},e.prototype._onInvoke=function(e){var t,n=this,r=e.methodName,s=e.jobId,u=e.data,d=this._inJobs,c=i.workerMessages[r];try{if("function"!=typeof c)throw new TypeError(r+" is not a function");t=c.call(null,u)}catch(e){return void this._post({type:p,jobId:s,error:a.toInvokeError(e)})}o.isThenable(t)?(d.set(s,t),t.then(function(e){l(d,s),n._post({type:p,jobId:s},e)}).catch(function(e){l(d,s),e||(e={message:"Error encountered at method"+r}),e.dojoType&&"cancel"===e.dojoType||n._post({type:p,jobId:s,error:a.toInvokeError(e)})})):this._post({type:p,jobId:s},t)},e.prototype._onResponse=function(e){var t=e.jobId,i=e.error,r=e.data,o=this._outJobs.get(t);o&&(l(this._outJobs,t),i?o.reject(n.fromJSON(JSON.parse(i))):o.resolve(r))},e.prototype._post=function(e,t,i){return a.postMessage(this.worker,e,t,i)},e}()}.apply(null,n))||(e.exports=r)},612:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(345),i(355),i(124),i(351),i(354),i(343),i(340),i(350),i(613),i(379),i(614)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c,h){function f(e){return l.create(function(t){function i(r){var o=c.receiveMessage(r);if(o)switch(o.type){case b:p(e);break;case y:e.removeEventListener("message",i),e.removeEventListener("error",n),t(e)}}function n(t){t.preventDefault(),e.removeEventListener("message",i),e.removeEventListener("error",n),m.warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new h).addEventListener("message",i),e.addEventListener("error",n)}e.addEventListener("message",i),e.addEventListener("error",n)})}function p(e){var t,o=r.workers.loaderUrl||d.DEFAULT_LOADER_URL;if(null!=r.default){var s=i({},r);delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(r));var l=r.workers.loaderConfig,u=d.default({baseUrl:l.baseUrl,locale:n.locale,has:i({"config-deferredInstrumentation":0,"dojo-test-sniff":0,"esri-secure-context":a("esri-secure-context"),"esri-workers-arraybuffer-transfer":a("esri-workers-arraybuffer-transfer"),"events-keypress-typed":0,"host-webworker":1},l.has),map:i({},l.map),paths:i({},l.paths),packages:l.packages||[]});e.postMessage({type:x,configure:{esriConfig:t,loaderUrl:o,loaderConfig:u}})}Object.defineProperty(t,"__esModule",{value:!0});var _=u.normalize(e.toUrl("./worker.js")),v=!u.hasSameOrigin(_,location.href),m=s.getLogger("esri.core.workers"),g=null;a.add("esri-workers-arraybuffer-transfer",!a("safari")||a("safari")>=12);var y=c.MessageType.CONFIGURED,x=c.MessageType.CONFIGURE,b=c.MessageType.HANDSHAKE;t.createWorker=function(){if(!a("esri-workers"))return f(new h);if(!v){var e=void 0;try{e=new Worker(_)}catch(t){m.warn("Failed to create Worker. Fallback to execute module in main thread",event),e=new h}return f(e)}return g||(g=o(_,{responseType:"text"})),g.then(function(e){return new Worker(URL.createObjectURL(new Blob([e.data],{type:"text/javascript"})))}).catch(function(e){return m.warn("Failed to create Worker. Fallback to execute module in main thread",e),new h}).then(function(e){return f(e)})}}.apply(null,n))||(e.exports=r)},613:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(345),i(356),i(350)],void 0===(r=function(e,t,i,n,r){function o(t){return r.removeQueryParameters(e.toUrl(t))}function a(e,t){for(var n=0,a=e;n<a.length;n++)if(a[n].name===t.name)return;var s=i({},t),l=o(s.name+"/x.js"),u=l.slice(0,l.length-5);s.location=r.makeAbsolute(u),e.push(s)}Object.defineProperty(t,"__esModule",{value:!0});var s=n("esri-built")?"dojo/dojo-lite.js":"dojo/dojo.js";t.DEFAULT_LOADER_URL=r.makeAbsolute(o(s)),t.DEFAULT_CONFIG={baseUrl:function(){var e=o("dojo/x.js");return r.makeAbsolute(e.slice(0,e.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette",main:"dist/maquette.umd"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}},t.default=function(e){var n={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:i({},e.has),map:i({},e.map),packages:e.packages&&e.packages.concat()||[],paths:i({},e.paths)};e.hasOwnProperty("async")||(n.async=!0),e.hasOwnProperty("isDebug")||(n.isDebug=!1),e.baseUrl||(n.baseUrl=t.DEFAULT_CONFIG.baseUrl),t.DEFAULT_CONFIG.packages.forEach(function(e){a(n.packages,e)});for(var r=n.map=n.map||{},o=0,s=Object.keys(t.DEFAULT_CONFIG.map);o<s.length;o++){var l=s[o];r[l]||(r[l]=t.DEFAULT_CONFIG.map[l])}return n}}.apply(null,n))||(e.exports=r)},614:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(356),i(438),i(379)],void 0===(r=function(e,t,n,r,o){var a=function(){return function(){var e=this,t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(i){e[i]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t[i].apply(t,e)}})}}(),s=r.MutationObserver||r.WebKitMutationObserver,l=function(){var e;if(r.process&&r.process.nextTick)e=function(e){r.process.nextTick(e)};else if(r.Promise)e=function(e){r.Promise.resolve().then(e)};else if(s){var t=[],i=document.createElement("div");new s(function(){for(;t.length>0;)t.shift()()}).observe(i,{attributes:!0}),e=function(e){t.push(e),i.setAttribute("queueStatus","1")}}return e}();return function(){function t(){this._dispatcher=new a,this._isInitialized=!1,this._workerPostMessage({type:o.MessageType.HANDSHAKE})}return t.prototype.terminate=function(){},Object.defineProperty(t.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)},enumerable:!0,configurable:!0}),t.prototype.postMessage=function(e,t){var i=this;l(function(){i._workerMessageHandler(new MessageEvent("message",{data:e}))})},t.prototype.dispatchEvent=function(e){return this._dispatcher.dispatchEvent(e)},t.prototype.addEventListener=function(e,t,i){this._dispatcher.addEventListener(e,t,i)},t.prototype.removeEventListener=function(e,t,i){this._dispatcher.removeEventListener(e,t,i)},t.prototype._workerPostMessage=function(e,t){var i=this;l(function(){i.dispatchEvent(new MessageEvent("message",{data:e}))})},t.prototype._workerMessageHandler=function(t){var r=this,a=o.receiveMessage(t);if(a){var s=a.jobId;switch(a.type){case o.MessageType.CONFIGURE:this._isInitialized||this._workerPostMessage({type:o.MessageType.CONFIGURED});break;case o.MessageType.OPEN:var l=a.modulePath;n("esri-webpack")?Promise.all([i.e(3),i.e(2),i.e(5),i.e(7),i.e(68)]).then(function(){var t=[i(391),i(756),i(757),i(740),i(726),i(758),i(686),e(l,null,!1)];(function(e,t,i,n,a,l,u,d){var c;switch(d){case"esri/views/vectorTiles/WorkerTileHandler":c=t;break;case"esri/views/2d/layers/features/Pipeline":c=i;break;case"esri/views/3d/layers/PointCloudWorker":c=n;break;case"esri/views/3d/layers/SceneLayerWorker":c=a;break;case"esri/layers/graphics/sources/support/CSVSourceWorker":c=l;break;case"esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker":c=u;break;default:c=d}var h=e.connect(c);r._workerPostMessage({type:o.MessageType.OPENED,jobId:s,data:h})}).apply(null,t)}).catch(i.oe):Promise.resolve().then(function(){var t=[i(391),e(l,null,!1)];(function(e,t){var i=e.connect(t);r._workerPostMessage({type:o.MessageType.OPENED,jobId:s,data:i})}).apply(null,t)}).catch(i.oe)}}},t}()}.apply(null,n))||(e.exports=r)},623:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL",e[e.NONE=5]="NONE",e[e.UNKNOWN=6]="UNKNOWN",e[e.COUNT=7]="COUNT"}(t.WGLGeometryType||(t.WGLGeometryType={})),function(e){e[e.SUCCEEDED=0]="SUCCEEDED",e[e.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(t.WGLGeometryTransactionStatus||(t.WGLGeometryTransactionStatus={})),function(e){e[e.NONE=0]="NONE",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.MARKER=4]="MARKER",e[e.TEXT=8]="TEXT",e[e.LABEL=16]="LABEL",e[e.LABEL_ALPHA=32]="LABEL_ALPHA",e[e.HITTEST=64]="HITTEST",e[e.HIGHLIGHT=128]="HIGHLIGHT",e[e.CLIP=256]="CLIP",e[e.DEBUG=512]="DEBUG",e[e.NUM_DRAW_PHASES=12]="NUM_DRAW_PHASES"}(t.WGLDrawPhase||(t.WGLDrawPhase={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(t.VVType||(t.VVType={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(t.WGLVVFlag||(t.WGLVVFlag={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(t.WGLVVTarget||(t.WGLVVTarget={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.BUTT=1]="BUTT",e[e.ROUND=2]="ROUND",e[e.SQUARE=3]="SQUARE"}(t.CapType||(t.CapType={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.MITER=1]="MITER",e[e.BEVEL=2]="BEVEL",e[e.ROUND=3]="ROUND"}(t.JoinType||(t.JoinType={})),function(e){e.SIMPLE_MARKER="esriSMS",e.SIMPLE_LINE="esriSLS",e.SIMPLE_FILL="esriSFS",e.PICTURE_MARKER="esriPMS",e.PICTURE_FILL="esriPFS",e.TEXT="esriTS"}(t.EsriSymbolType||(t.EsriSymbolType={})),function(e){e.SIMPLE_MARKER="simple-marker",e.SIMPLE_LINE="simple-line",e.SIMPLE_FILL="simple-fill",e.PICTURE_MARKER="picture-marker",e.PICTURE_FILL="picture-fill",e.TEXT="text"}(t.EsriSymbolTypeKebab||(t.EsriSymbolTypeKebab={}))}.apply(null,n))||(e.exports=r)},664:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(338),i(336),i(346),i(446),i(366),i(689),i(343),i(624),i(340),i(337)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d,c){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handles=new a,t.layer=null,t.parent=null,t.view=null,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";return l.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+n+"', id: '"+i+"')",t),d.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},n([c.property()],t.prototype,"layer",void 0),n([c.property()],t.prototype,"parent",void 0),n([c.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),n([c.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),n([c.property()],t.prototype,"view",void 0),n([c.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),n([c.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),n([c.subclass("esri.views.layers.LayerView")],t)}(c.declared(r,o,s,u))}.apply(null,n))||(e.exports=r)},671:function(e,t,i){var n;void 0===(n=function(){if(!e)var e=1e-6;if(!t)var t="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var n={GLMAT_EPSILON:e,GLMAT_ARRAY_TYPE:t,GLMAT_RANDOM:i,setMatrixArrayType:function(e){n.GLMAT_ARRAY_TYPE=e}},r=Math.PI/180,o=180/Math.PI;return n.toRadian=function(e){return e*r},n.toDegree=function(e){return e*o},n.setMatrixArrayType(Array),n}.apply(null,[]))||(e.exports=n)},675:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1258),i(723),i(342),i(343),i(357),i(393),i(1027),i(623),i(1534)],void 0===(r=function(e,t,i,n,r,o,a,s,l,u,d){function c(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i];t[r.name]=r.strideInBytes}return t}function h(e){switch(e){case u.WGLGeometryType.MARKER:return w;case u.WGLGeometryType.FILL:return M;case u.WGLGeometryType.LINE:return V;case u.WGLGeometryType.TEXT:return D;case u.WGLGeometryType.LABEL:return T}return null}function f(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function p(e){switch(e){case"esriSMS":return"simple-marker";case"esriPMS":return"picture-marker";case"esriSLS":return"simple-line";case"esriPLS":return"picture-line";case"esriSFS":return"simple-fill";case"esriPFS":return"picture-fill";case"esriTS":return"text"}return e}function _(e){var t=p(e.type);if(t){switch(t){case"simple-marker":case"picture-marker":case"CIMPointSymbol":return!0}return!1}}function v(e){var t=p(e.type);if(t){switch(t){case"simple-fill":case"picture-fill":case"CIMPolygonSymbol":return!0}return!1}}function m(e){var t=p(e.type);if(t){switch(t){case"simple-line":case"picture-line":case"CIMLineSymbol":return!0}return!1}}function g(e){var t=p(e.type);if(t){switch(t){case"text":case"CIMTextSymbol":return!0}return!1}}function y(e,t){return!1}function x(e){return e&&e.length||0}function b(e){return"string"==typeof e}Object.defineProperty(t,"__esModule",{value:!0});var S,I=o.getLogger("esri.views.2d.engine.webgl.Utils");t.C_HITTEST_SEARCH_SIZE=4,t.C_VBO_GEOMETRY="geometry",t.C_VBO_PERINSTANCE="per_instance",t.C_VBO_PERINSTANCE_VV="per_instance_vv",t.C_VBO_VISIBILITY="visibility",t.C_VBO_VISIBILITY_RANGE="visibilityRange",t.C_ICON_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:24,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_ICON_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:40,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_ICON_HEATMAP=[{name:t.C_VBO_GEOMETRY,strideInBytes:28,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_FILL_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:24,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_FILL_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:32,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_LINE_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:32,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_LINE_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:44,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_TEXT_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_TEXT_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:36,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_LABEL_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0},{name:t.C_VBO_VISIBILITY_RANGE,strideInBytes:2,divisor:0}],t.C_ICON_STRIDE_SPEC=c(t.C_ICON_VERTEX_DEF),t.C_ICON_STRIDE_SPEC_VV=c(t.C_ICON_VERTEX_DEF_VV),t.C_ICON_STRIDE_SPEC_HEATMAP=c(t.C_ICON_HEATMAP),t.C_FILL_STRIDE_SPEC=c(t.C_FILL_VERTEX_DEF),t.C_FILL_STRIDE_SPEC_VV=c(t.C_FILL_VERTEX_DEF_VV),t.C_LINE_STRIDE_SPEC=c(t.C_LINE_VERTEX_DEF),t.C_LINE_STRIDE_SPEC_VV=c(t.C_LINE_VERTEX_DEF_VV),t.C_TEXT_STRIDE_SPEC=c(t.C_TEXT_VERTEX_DEF),t.C_TEXT_STRIDE_SPEC_VV=c(t.C_TEXT_VERTEX_DEF_VV),t.C_LABEL_STRIDE_SPEC=c(t.C_LABEL_VERTEX_DEF),t.getStrides=function(e,i,n){switch(void 0===n&&(n=!1),e){case u.WGLGeometryType.MARKER:return i?t.C_ICON_STRIDE_SPEC_VV:n?t.C_ICON_STRIDE_SPEC_HEATMAP:t.C_ICON_STRIDE_SPEC;case u.WGLGeometryType.FILL:return i?t.C_FILL_STRIDE_SPEC_VV:t.C_FILL_STRIDE_SPEC;case u.WGLGeometryType.LINE:return i?t.C_LINE_STRIDE_SPEC_VV:t.C_LINE_STRIDE_SPEC;case u.WGLGeometryType.TEXT:return i?t.C_TEXT_STRIDE_SPEC_VV:t.C_TEXT_STRIDE_SPEC;case u.WGLGeometryType.LABEL:return t.C_LABEL_STRIDE_SPEC}return null};var w=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY],M=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY],V=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY],D=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY],T=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY,t.C_VBO_VISIBILITY_RANGE];t.getNamedBuffers=h,t.strideToPackingFactor=f,t.allocateTypedArrayBuffer=function(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}},t.allocateTypedArrayBufferwithData=function(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}},t.getSymbolGeometryType=function(e){return _(e)?u.WGLGeometryType.MARKER:m(e)?u.WGLGeometryType.LINE:v(e)?u.WGLGeometryType.FILL:g(e)?u.WGLGeometryType.TEXT:u.WGLGeometryType.UNKNOWN},t.normalizeSymbolType=p,t.isMarkerSymbol=_,t.isFillSymbol=v,t.isLineSymbol=m,t.isPictureSymbol=function(e){var t=p(e.type);if(t){switch(t){case"picture-marker":case"picture-line":case"picture-fill":return!0}return!1}return!1},t.isTextSymbol=g,t.getTextProperties=function(e){return d.TextProperties.pool.acquire(e.color?l.copyAndPremultiply(e.color):[255,255,255,255],e.haloColor?l.copyAndPremultiply(e.haloColor):[255,255,255,255],a.pt2px(e.haloSize),a.pt2px(e.font.size),e.angle*Math.PI/180,e.xoffset/e.font.size,e.yoffset/e.font.size,"left"===e.horizontalAlignment?0:"right"===e.horizontalAlignment?1:.5,"top"===e.verticalAlignment?0:"bottom"===e.verticalAlignment?1:.5)},t.isSameUniformValue=y,t.isSameMaterialInfo=function(e,t){if(e.materialKey!==t.materialKey)return!1;if(x(e.texBindingInfo)!==x(t.texBindingInfo))return!1;if(x(e.materialParams)!==x(t.materialParams))return!1;for(var i=e.texBindingInfo.length,n=0;n<i;++n){var r=e.texBindingInfo[n],o=t.texBindingInfo[n];if(r.unit!==o.unit||r.pageId!==o.pageId||r.semantic!==o.semantic)return!1}var a=e.materialParams.length;for(n=0;n<a;++n){var s=e.materialParams[n],l=t.materialParams[n];if(s.name!==l.name||(s.value,l.value,1))return!1}return!0},t.serializeString=function(e,t,i){for(var n=0,r=e.length,o=0;o<r;++o)t&&(t[i+n]=e.charCodeAt(o)),++n;return t&&(t[i+n]=0),++n},t.deserializeString=function(e,t,i){var n=0;e.s="";for(var r=!0;r;){var o=t[i+n];++n,0!==o?e.s+=String.fromCharCode(o):r=!1}return n},t.isDefined=function(e){return null!=e},t.isNumber=function(e){return"number"==typeof e},t.isString=b,t.isStringOrNull=function(e){return null==e||b(e)},t.lerp=function(e,t,i){return e+(t-e)*i};var C=function(){function e(){this._arr=[],this._push=this._push.bind(this)}return e.prototype._push=function(e,t){this._arr.push(t)},e.prototype.getKeys=function(e){return this._arr.length=0,e&&e.forEach(this._push),this._arr},e}();t.KeysGetter=C;var E=function(){function e(){this._arr=[],this._push=this._push.bind(this)}return e.prototype._push=function(e,t){this._arr.push(e)},e.prototype.getValues=function(e){return this._arr.length=0,e&&e.forEach(this._push),this._arr},e}();t.ValuesGetter=E,t.getCapType=function(e){switch(e){case"butt":return u.CapType.BUTT;case"round":return u.CapType.ROUND;case"square":return u.CapType.SQUARE;default:return I.error(new r("mapview-invalid-type","Cap type "+e+" is not a valid option. Defaulting to round")),u.CapType.ROUND}},t.getJoinType=function(e){switch(e){case"miter":return u.JoinType.MITER;case"bevel":return u.JoinType.BEVEL;case"round":return u.JoinType.ROUND;default:return I.error(new r("mapview-invalid-type","Join type "+e+" is not a valid option. Defaulting to round")),u.JoinType.ROUND}},t.getVVType=function(e){switch(e){case"opacity":return u.VVType.OPACITY;case"color":return u.VVType.COLOR;case"rotation":return u.VVType.ROTATION;case"size":return u.VVType.SIZE;default:return I.error("Cannot interpret unknown vv: "+e),null}},t.createArcadeFunction=function(e,t){var r=e.valueExpression,o=e.spatialReference,a=e.layer,l=s.createFunction(r),u=new n,d=new i({viewingMode:null,scale:null}),c={},h={vars:{$feature:u,$view:null},spatialReference:o};return function(e,i){u.repurposeFromGraphicLikeObject(e.geometry,e.attributes,a),i?(h.vars.$view=d,d.attributes.viewingMode=i.viewingMode,d.attributes.scale=i.scale):h.vars.$view=c;var n=s.executeFunction(l,h);return t?t(n):n}},t.copyMeshData=function(e,t,i,n,r,o,a){for(var s in o)for(var l=o[s].stride,u=f(l),d=o[s].data,c=i[s].data,h=l*r.vertexCount/u,p=l*e/u,_=l*r.vertexFrom/u,v=0;v<h;++v)c[v+p]=d[v+_];var m=r.indexCount;for(v=0;v<m;++v)n[v+t]=a[v+r.indexFrom]-r.vertexFrom+e},t.C_VBO_INFO=((S={})[t.C_VBO_GEOMETRY]=35044,S[t.C_VBO_VISIBILITY]=35044,S[t.C_VBO_VISIBILITY_RANGE]=35048,S),t.createGeometryData=function(e,t){for(var i=[],n=0;n<5;++n){for(var r={},o=0,a=h(n);o<a.length;o++){var s=a[o];r[s]={data:t(n,s)}}i.push({data:e(n),buffers:r})}return i},t.resampleHermite=function(e,t,i,n,r,o,a){void 0===a&&(a=!0);for(var s=t/r,l=i/o,u=Math.ceil(s/2),d=Math.ceil(l/2),c=0;c<o;c++)for(var h=0;h<r;h++){for(var f=4*(h+(a?o-c-1:c)*r),p=0,_=0,v=0,m=0,g=0,y=0,x=0,b=(c+.5)*l,S=Math.floor(c*l);S<(c+1)*l;S++)for(var I=Math.abs(b-(S+.5))/d,w=(h+.5)*s,M=I*I,V=Math.floor(h*s);V<(h+1)*s;V++){var D=Math.abs(w-(V+.5))/u,T=Math.sqrt(M+D*D);T>=-1&&T<=1&&(p=2*T*T*T-3*T*T+1)>0&&(x+=p*e[3+(D=4*(V+S*t))],v+=p,e[D+3]<255&&(p=p*e[D+3]/250),m+=p*e[D],g+=p*e[D+1],y+=p*e[D+2],_+=p)}n[f]=m/_,n[f+1]=g/_,n[f+2]=y/_,n[f+3]=x/v}}}.apply(null,n))||(e.exports=r)},698:function(e,t,i){var n,r;n=[i(671)],void 0===(r=function(e){var t=e.GLMAT_ARRAY_TYPE,i=e.GLMAT_RANDOM,n={create:function(){var e=new t(2);return e[0]=0,e[1]=0,e},clone:function(e){var i=new t(2);return i[0]=e[0],i[1]=e[1],i},fromValues:function(e,i){var n=new t(2);return n[0]=e,n[1]=i,n},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,i){return e[0]=t,e[1]=i,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}};return n.sub=n.subtract,n.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},n.mul=n.multiply,n.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},n.div=n.divide,n.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},n.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},n.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},n.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e},n.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(i*i+n*n)},n.dist=n.distance,n.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n},n.sqrDist=n.squaredDistance,n.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},n.len=n.length,n.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},n.sqrLen=n.squaredLength,n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},n.normalize=function(e,t){var i=t[0],n=t[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},n.cross=function(e,t,i){var n=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=n,e},n.lerp=function(e,t,i,n){var r=t[0],o=t[1];return e[0]=r+n*(i[0]-r),e[1]=o+n*(i[1]-o),e},n.random=function(e,t){t=t||1;var n=2*i()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},n.transformMat2=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r,e[1]=i[1]*n+i[3]*r,e},n.transformMat2d=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r+i[4],e[1]=i[1]*n+i[3]*r+i[5],e},n.transformMat3=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[3]*r+i[6],e[1]=i[1]*n+i[4]*r+i[7],e},n.transformMat4=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e},n.forEach=function(){var e=n.create();return function(t,i,n,r,o,a){var s,l;for(i||(i=2),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),n.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},n}.apply(null,n))||(e.exports=r)},713:function(e,t,i){var n,r;n=[i(353),i(339),i(357),i(465),i(591)],void 0===(r=function(e,t,i,n,r){var o={width:12,height:12,angle:0,xoffset:0,yoffset:0},a=e(n,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker",url:r.urlPropertyDefinition,source:r.sourcePropertyDefinition,height:{json:{read:{source:["height","size"],reader:function(e,t){return t.size||e}},write:!0},cast:i.toPt},width:{json:{read:{source:["width","size"],reader:function(e,t){return t.size||e}},write:!0},cast:i.toPt},size:{json:{write:!1}}},getDefaults:function(){return t.mixin(this.inherited(arguments),o)},normalizeCtorArgs:function(e,t,n){if(e&&"string"!=typeof e&&null==e.imageData)return e;var r={};return e&&(r.url=e),null!=t&&(r.width=i.toPt(t)),null!=n&&(r.height=i.toPt(n)),r},clone:function(){var e=new a({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",t.clone(this.source)),e}});return a.defaultProps=o,a}.apply(null,n))||(e.exports=r)},714:function(e,t,i){var n,r;n=[i(353),i(339),i(464),i(407)],void 0===(r=function(e,t,i,n){var r={style:"solid",outline:new n,color:[0,0,0,.25]},o=e(i,{declaredClass:"esri.symbols.SimpleFillSymbol",properties:{color:{},type:"simple-fill",style:{value:"solid",type:String,json:{read:function(e){return t.valueOf(this._styles,e)||void 0},write:function(e,t){t.style=this._styles[e]}}}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal","backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return t.mixin(this.inherited(arguments),r)},normalizeCtorArgs:function(e,t,i){if(e&&"string"!=typeof e)return e;var n={};return e&&(n.style=e),t&&(n.outline=t),i&&(n.color=i),n},clone:function(){return new o({color:t.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}});return t.mixin(o,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"}),o.defaultProps=r,o}.apply(null,n))||(e.exports=r)},716:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(728)],void 0===(r=function(e,t,i,n){var r;return function(e){e[e.BEFORE=0]="BEFORE",e[e.ATTACHING=1]="ATTACHING",e[e.DETACHING=2]="DETACHING",e[e.RENDERING=3]="RENDERING",e[e.AFTER=4]="AFTER",e[e.DONE=5]="DONE"}(r||(r={})),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenSet=new Set,t._childrenToAttach=[],t._childrenToDetach=[],t._renderPhase=r.DONE,t.children=[],t}return i(t,e),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(e){for(var t=this.children.concat(this._childrenToDetach),i=this.prepareChildrenRenderParameters(e),n=0,r=t;n<r.length;n++){var o=r[n];o.attached&&(this.detachChild(o,i),o.attached=!1,o.parent=null)}},t.prototype.doRender=function(e){var t=this.prepareChildrenRenderParameters(e);this._renderPhase=r.BEFORE,this.beforeRenderChildren(e,t),this._renderPhase=r.ATTACHING,this.attachChildren(t),this._renderPhase=r.DETACHING;for(var i=this._childrenToDetach;i.length>0;){var n=i.shift();this.detachChild(n,t),n.attached=!1,n.parent=null}this._renderPhase=r.RENDERING,this.renderChildren(t),this._renderPhase=r.AFTER,this.afterRenderChildren(e,t),this._renderPhase=r.DONE},t.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.prototype.addChildAt=function(e,t){if(void 0===t&&(t=this.numChildren),!e)return e;if(this.contains(e))return e;var i=e.parent;i&&i!==this&&i.removeChild(e),t>=this.numChildren?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e);var n=this._childrenToDetach.indexOf(e);return n>-1&&this._childrenToDetach.splice(n,1),this._childrenToAttach.push(e),this._renderPhase>=r.RENDERING&&this.requestRender(),e},t.prototype.contains=function(e){return this._childrenSet.has(e)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.getChildAt=function(e){return e<0||e>this.children.length?null:this.children[e]},t.prototype.removeAllChildren=function(){for(var e=this.numChildren;e--;)this.removeChildAt(0)},t.prototype.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.getChildIndex(e)):e},t.prototype.removeChildAt=function(e){var t;if(e<0||e>=this.children.length)return null;if(t=this.children.splice(e,1)[0],function(e,t){e.delete(t)}(this._childrenSet,t),t.attached)this._childrenToDetach.push(t),this._renderPhase>=r.RENDERING&&this.requestRender();else{var i=this._childrenToAttach.indexOf(t);i>-1&&this._childrenToAttach.splice(i,1)}return t},t.prototype.requestChildRender=function(e){e&&e.parent===this&&this._renderPhase>=r.RENDERING&&this.requestRender()},t.prototype.setChildIndex=function(e,t){var i=this.getChildIndex(e);i>-1&&(this.children.splice(i,1),this.children.splice(t,0,e),this._renderPhase>=r.RENDERING&&this.requestRender())},t.prototype.sortChildren=function(e){return this._renderPhase>r.RENDERING&&this.requestRender(),this.children.sort(e)},t.prototype.attachChildren=function(e){var t=this._childrenToAttach;if(0!==t.length)for(var i=0,n=!1;!n;){var r=t[i];this.attachChild(r,e)?(r.attached=!0,r.parent=this,t.splice(i,1)):++i,n=t.length===i}},t.prototype.renderChildren=function(e){for(var t=this.children,i=t.length,n=0;n<i;n++){var r=t[n];r.attached&&this.renderChild(r,e)}},t.prototype.beforeRenderChildren=function(e,t){},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){e.detach(t)},t.prototype.renderChild=function(e,t){e.processRender(t)},t.prototype.afterRenderChildren=function(e,t){},t}(n)}.apply(null,n))||(e.exports=r)},725:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,n))||(e.exports=r)},728:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(787)],void 0===(r=function(e,t,i,n){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderRequestedCalled=!1,t._attached=!1,t._opacity=1,t.renderRequested=!1,t._visible=!0,t}return i(t,e),Object.defineProperty(t.prototype,"attached",{get:function(){return this._attached},set:function(e){this._attached!==e&&(this._attached=e,e?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=e,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())},enumerable:!0,configurable:!0}),t.prototype.attach=function(e){return!0},t.prototype.detach=function(e){},t.prototype.processRender=function(e){this._renderRequestedCalled=!1,this.doRender(e),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render")},t.prototype.requestRender=function(){var e=this.renderRequested;this._renderRequestedCalled=!0,this.renderRequested=!0,this.parent&&this.parent.requestChildRender(this),e!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")},t.prototype.dispose=function(){},t}(n.Evented)}.apply(null,n))||(e.exports=r)},731:function(e,t,i){var n={"./af":468,"./af.js":468,"./ar":469,"./ar-dz":470,"./ar-dz.js":470,"./ar-kw":471,"./ar-kw.js":471,"./ar-ly":472,"./ar-ly.js":472,"./ar-ma":473,"./ar-ma.js":473,"./ar-sa":474,"./ar-sa.js":474,"./ar-tn":475,"./ar-tn.js":475,"./ar.js":469,"./az":476,"./az.js":476,"./be":477,"./be.js":477,"./bg":478,"./bg.js":478,"./bm":479,"./bm.js":479,"./bn":480,"./bn.js":480,"./bo":481,"./bo.js":481,"./br":482,"./br.js":482,"./bs":483,"./bs.js":483,"./ca":484,"./ca.js":484,"./cs":485,"./cs.js":485,"./cv":486,"./cv.js":486,"./cy":487,"./cy.js":487,"./da":488,"./da.js":488,"./de":489,"./de-at":490,"./de-at.js":490,"./de-ch":491,"./de-ch.js":491,"./de.js":489,"./dv":492,"./dv.js":492,"./el":493,"./el.js":493,"./en-au":494,"./en-au.js":494,"./en-ca":495,"./en-ca.js":495,"./en-gb":496,"./en-gb.js":496,"./en-ie":497,"./en-ie.js":497,"./en-il":498,"./en-il.js":498,"./en-nz":499,"./en-nz.js":499,"./eo":500,"./eo.js":500,"./es":501,"./es-do":502,"./es-do.js":502,"./es-us":503,"./es-us.js":503,"./es.js":501,"./et":504,"./et.js":504,"./eu":505,"./eu.js":505,"./fa":506,"./fa.js":506,"./fi":507,"./fi.js":507,"./fo":508,"./fo.js":508,"./fr":509,"./fr-ca":510,"./fr-ca.js":510,"./fr-ch":511,"./fr-ch.js":511,"./fr.js":509,"./fy":512,"./fy.js":512,"./gd":513,"./gd.js":513,"./gl":514,"./gl.js":514,"./gom-latn":515,"./gom-latn.js":515,"./gu":516,"./gu.js":516,"./he":517,"./he.js":517,"./hi":518,"./hi.js":518,"./hr":519,"./hr.js":519,"./hu":520,"./hu.js":520,"./hy-am":521,"./hy-am.js":521,"./id":522,"./id.js":522,"./is":523,"./is.js":523,"./it":524,"./it.js":524,"./ja":525,"./ja.js":525,"./jv":526,"./jv.js":526,"./ka":527,"./ka.js":527,"./kk":528,"./kk.js":528,"./km":529,"./km.js":529,"./kn":530,"./kn.js":530,"./ko":531,"./ko.js":531,"./ky":532,"./ky.js":532,"./lb":533,"./lb.js":533,"./lo":534,"./lo.js":534,"./lt":535,"./lt.js":535,"./lv":536,"./lv.js":536,"./me":537,"./me.js":537,"./mi":538,"./mi.js":538,"./mk":539,"./mk.js":539,"./ml":540,"./ml.js":540,"./mn":541,"./mn.js":541,"./mr":542,"./mr.js":542,"./ms":543,"./ms-my":544,"./ms-my.js":544,"./ms.js":543,"./mt":545,"./mt.js":545,"./my":546,"./my.js":546,"./nb":547,"./nb.js":547,"./ne":548,"./ne.js":548,"./nl":549,"./nl-be":550,"./nl-be.js":550,"./nl.js":549,"./nn":551,"./nn.js":551,"./pa-in":552,"./pa-in.js":552,"./pl":553,"./pl.js":553,"./pt":554,"./pt-br":555,"./pt-br.js":555,"./pt.js":554,"./ro":556,"./ro.js":556,"./ru":557,"./ru.js":557,"./sd":558,"./sd.js":558,"./se":559,"./se.js":559,"./si":560,"./si.js":560,"./sk":561,"./sk.js":561,"./sl":562,"./sl.js":562,"./sq":563,"./sq.js":563,"./sr":564,"./sr-cyrl":565,"./sr-cyrl.js":565,"./sr.js":564,"./ss":566,"./ss.js":566,"./sv":567,"./sv.js":567,"./sw":568,"./sw.js":568,"./ta":569,"./ta.js":569,"./te":570,"./te.js":570,"./tet":571,"./tet.js":571,"./tg":572,"./tg.js":572,"./th":573,"./th.js":573,"./tl-ph":574,"./tl-ph.js":574,"./tlh":575,"./tlh.js":575,"./tr":576,"./tr.js":576,"./tzl":577,"./tzl.js":577,"./tzm":578,"./tzm-latn":579,"./tzm-latn.js":579,"./tzm.js":578,"./ug-cn":580,"./ug-cn.js":580,"./uk":581,"./uk.js":581,"./ur":582,"./ur.js":582,"./uz":583,"./uz-latn":584,"./uz-latn.js":584,"./uz.js":583,"./vi":585,"./vi.js":585,"./x-pseudo":586,"./x-pseudo.js":586,"./yo":587,"./yo.js":587,"./zh-cn":588,"./zh-cn.js":588,"./zh-hk":589,"./zh-hk.js":589,"./zh-tw":590,"./zh-tw.js":590};function r(e){var t=o(e);return i(t)}function o(e){var t=n[e];if(!(t+1)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return t}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=731},733:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(412)],void 0===(r=function(e,t,i){return function(){function e(e,t,i){this.row=e,this.colFrom=t,this.colTo=i}return e.pool=new i(e,!0),e}()}.apply(null,n))||(e.exports=r)},745:function(e,t,i){var n,r;n=[i(671)],void 0===(r=function(e){var t=e.GLMAT_ARRAY_TYPE,i={create:function(){var e=new t(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},clone:function(e){var i=new t(6);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},invert:function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=i*o-n*r;return l?(l=1/l,e[0]=o*l,e[1]=-n*l,e[2]=-r*l,e[3]=i*l,e[4]=(r*s-o*a)*l,e[5]=(n*a-i*s)*l,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=i[0],d=i[1],c=i[2],h=i[3],f=i[4],p=i[5];return e[0]=n*u+o*d,e[1]=r*u+a*d,e[2]=n*c+o*h,e[3]=r*c+a*h,e[4]=n*f+o*p+s,e[5]=r*f+a*p+l,e}};return i.mul=i.multiply,i.rotate=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=Math.sin(i),d=Math.cos(i);return e[0]=n*d+o*u,e[1]=r*d+a*u,e[2]=n*-u+o*d,e[3]=r*-u+a*d,e[4]=s,e[5]=l,e},i.scale=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=i[0],d=i[1];return e[0]=n*u,e[1]=r*u,e[2]=o*d,e[3]=a*d,e[4]=s,e[5]=l,e},i.translate=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=i[0],d=i[1];return e[0]=n,e[1]=r,e[2]=o,e[3]=a,e[4]=n*u+o*d+s,e[5]=r*u+a*d+l,e},i.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=-i,e[3]=n,e[4]=0,e[5]=0,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},i.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},i}.apply(null,n))||(e.exports=r)},759:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={scalar:{},SIMD:{},create:function(){var t=new e.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var i=new e.ARRAY_TYPE(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v){var m=new e.ARRAY_TYPE(16);return m[0]=t,m[1]=i,m[2]=n,m[3]=r,m[4]=o,m[5]=a,m[6]=s,m[7]=l,m[8]=u,m[9]=d,m[10]=c,m[11]=h,m[12]=f,m[13]=p,m[14]=_,m[15]=v,m},set:function(e,t,i,n,r,o,a,s,l,u,d,c,h,f,p,_,v){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=d,e[10]=c,e[11]=h,e[12]=f,e[13]=p,e[14]=_,e[15]=v,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}};return t.scalar.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=r,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.SIMD.transpose=function(e,t){var i,n,r,o,a,s,l,u,d,c;return i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),r=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),a=SIMD.Float32x4.shuffle(i,n,0,1,4,5),s=SIMD.Float32x4.shuffle(r,o,0,1,4,5),l=SIMD.Float32x4.shuffle(a,s,0,2,4,6),u=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(e,0,l),SIMD.Float32x4.store(e,4,u),a=SIMD.Float32x4.shuffle(i,n,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),d=SIMD.Float32x4.shuffle(a,s,0,2,4,6),c=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(e,8,d),SIMD.Float32x4.store(e,12,c),e},t.transpose=e.USE_SIMD?t.SIMD.transpose:t.scalar.transpose,t.scalar.invert=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],d=t[8],c=t[9],h=t[10],f=t[11],p=t[12],_=t[13],v=t[14],m=t[15],g=i*s-n*a,y=i*l-r*a,x=i*u-o*a,b=n*l-r*s,S=n*u-o*s,I=r*u-o*l,w=d*_-c*p,M=d*v-h*p,V=d*m-f*p,D=c*v-h*_,T=c*m-f*_,C=h*m-f*v,E=g*C-y*T+x*D+b*V-S*M+I*w;return E?(E=1/E,e[0]=(s*C-l*T+u*D)*E,e[1]=(r*T-n*C-o*D)*E,e[2]=(_*I-v*S+m*b)*E,e[3]=(h*S-c*I-f*b)*E,e[4]=(l*V-a*C-u*M)*E,e[5]=(i*C-r*V+o*M)*E,e[6]=(v*x-p*I-m*y)*E,e[7]=(d*I-h*x+f*y)*E,e[8]=(a*T-s*V+u*w)*E,e[9]=(n*V-i*T-o*w)*E,e[10]=(p*S-_*x+m*g)*E,e[11]=(c*x-d*S-f*g)*E,e[12]=(s*M-a*D-l*w)*E,e[13]=(i*D-n*M+r*w)*E,e[14]=(_*y-p*b-v*g)*E,e[15]=(d*b-c*y+h*g)*E,e):null},t.SIMD.invert=function(e,t){var i,n,r,o,a,s,l,u,d,c,h=SIMD.Float32x4.load(t,0),f=SIMD.Float32x4.load(t,4),p=SIMD.Float32x4.load(t,8),_=SIMD.Float32x4.load(t,12);return a=SIMD.Float32x4.shuffle(h,f,0,1,4,5),n=SIMD.Float32x4.shuffle(p,_,0,1,4,5),i=SIMD.Float32x4.shuffle(a,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,a,1,3,5,7),a=SIMD.Float32x4.shuffle(h,f,2,3,6,7),o=SIMD.Float32x4.shuffle(p,_,2,3,6,7),r=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(r,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(n,a),l=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),d=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),s),u=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(i,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),d),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),u),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,a)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),d),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),a=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(a,a))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(c,d)),e):null},t.invert=e.USE_SIMD?t.SIMD.invert:t.scalar.invert,t.scalar.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],d=t[8],c=t[9],h=t[10],f=t[11],p=t[12],_=t[13],v=t[14],m=t[15];return e[0]=s*(h*m-f*v)-c*(l*m-u*v)+_*(l*f-u*h),e[1]=-(n*(h*m-f*v)-c*(r*m-o*v)+_*(r*f-o*h)),e[2]=n*(l*m-u*v)-s*(r*m-o*v)+_*(r*u-o*l),e[3]=-(n*(l*f-u*h)-s*(r*f-o*h)+c*(r*u-o*l)),e[4]=-(a*(h*m-f*v)-d*(l*m-u*v)+p*(l*f-u*h)),e[5]=i*(h*m-f*v)-d*(r*m-o*v)+p*(r*f-o*h),e[6]=-(i*(l*m-u*v)-a*(r*m-o*v)+p*(r*u-o*l)),e[7]=i*(l*f-u*h)-a*(r*f-o*h)+d*(r*u-o*l),e[8]=a*(c*m-f*_)-d*(s*m-u*_)+p*(s*f-u*c),e[9]=-(i*(c*m-f*_)-d*(n*m-o*_)+p*(n*f-o*c)),e[10]=i*(s*m-u*_)-a*(n*m-o*_)+p*(n*u-o*s),e[11]=-(i*(s*f-u*c)-a*(n*f-o*c)+d*(n*u-o*s)),e[12]=-(a*(c*v-h*_)-d*(s*v-l*_)+p*(s*h-l*c)),e[13]=i*(c*v-h*_)-d*(n*v-r*_)+p*(n*h-r*c),e[14]=-(i*(s*v-l*_)-a*(n*v-r*_)+p*(n*l-r*s)),e[15]=i*(s*h-l*c)-a*(n*h-r*c)+d*(n*l-r*s),e},t.SIMD.adjoint=function(e,t){var i,n,r,o,a,s,l,u,d,c=SIMD.Float32x4.load(t,0),h=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return a=SIMD.Float32x4.shuffle(c,h,0,1,4,5),n=SIMD.Float32x4.shuffle(f,p,0,1,4,5),i=SIMD.Float32x4.shuffle(a,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,a,1,3,5,7),a=SIMD.Float32x4.shuffle(c,h,2,3,6,7),o=SIMD.Float32x4.shuffle(f,p,2,3,6,7),r=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(r,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(n,a),l=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),d=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),s),u=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(i,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),d),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),u),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,a)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),d),SIMD.Float32x4.store(e,0,s),SIMD.Float32x4.store(e,4,l),SIMD.Float32x4.store(e,8,u),SIMD.Float32x4.store(e,12,d),e},t.adjoint=e.USE_SIMD?t.SIMD.adjoint:t.scalar.adjoint,t.determinant=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],d=e[9],c=e[10],h=e[11],f=e[12],p=e[13],_=e[14],v=e[15];return(t*a-i*o)*(c*v-h*_)-(t*s-n*o)*(d*v-h*p)+(t*l-r*o)*(d*_-c*p)+(i*s-n*a)*(u*v-h*f)-(i*l-r*a)*(u*_-c*f)+(n*l-r*s)*(u*p-d*f)},t.SIMD.multiply=function(e,t,i){var n=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(i,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(e,0,l);var u=SIMD.Float32x4.load(i,4),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),a))));SIMD.Float32x4.store(e,4,d);var c=SIMD.Float32x4.load(i,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),a))));SIMD.Float32x4.store(e,8,h);var f=SIMD.Float32x4.load(i,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),a))));return SIMD.Float32x4.store(e,12,p),e},t.scalar.multiply=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=t[9],f=t[10],p=t[11],_=t[12],v=t[13],m=t[14],g=t[15],y=i[0],x=i[1],b=i[2],S=i[3];return e[0]=y*n+x*s+b*c+S*_,e[1]=y*r+x*l+b*h+S*v,e[2]=y*o+x*u+b*f+S*m,e[3]=y*a+x*d+b*p+S*g,y=i[4],x=i[5],b=i[6],S=i[7],e[4]=y*n+x*s+b*c+S*_,e[5]=y*r+x*l+b*h+S*v,e[6]=y*o+x*u+b*f+S*m,e[7]=y*a+x*d+b*p+S*g,y=i[8],x=i[9],b=i[10],S=i[11],e[8]=y*n+x*s+b*c+S*_,e[9]=y*r+x*l+b*h+S*v,e[10]=y*o+x*u+b*f+S*m,e[11]=y*a+x*d+b*p+S*g,y=i[12],x=i[13],b=i[14],S=i[15],e[12]=y*n+x*s+b*c+S*_,e[13]=y*r+x*l+b*h+S*v,e[14]=y*o+x*u+b*f+S*m,e[15]=y*a+x*d+b*p+S*g,e},t.multiply=e.USE_SIMD?t.SIMD.multiply:t.scalar.multiply,t.mul=t.multiply,t.scalar.translate=function(e,t,i){var n,r,o,a,s,l,u,d,c,h,f,p,_=i[0],v=i[1],m=i[2];return t===e?(e[12]=t[0]*_+t[4]*v+t[8]*m+t[12],e[13]=t[1]*_+t[5]*v+t[9]*m+t[13],e[14]=t[2]*_+t[6]*v+t[10]*m+t[14],e[15]=t[3]*_+t[7]*v+t[11]*m+t[15]):(n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=t[9],f=t[10],p=t[11],e[0]=n,e[1]=r,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=d,e[8]=c,e[9]=h,e[10]=f,e[11]=p,e[12]=n*_+s*v+c*m+t[12],e[13]=r*_+l*v+h*m+t[13],e[14]=o*_+u*v+f*m+t[14],e[15]=a*_+d*v+p*m+t[15]),e},t.SIMD.translate=function(e,t,i){var n=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(i[0],i[1],i[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(e,12,l),e},t.translate=e.USE_SIMD?t.SIMD.translate:t.scalar.translate,t.scalar.scale=function(e,t,i){var n=i[0],r=i[1],o=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.SIMD.scale=function(e,t,i){var n,r,o,a=SIMD.Float32x4(i[0],i[1],i[2],0);return n=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(a,0,0,0,0))),r=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.scale=e.USE_SIMD?t.SIMD.scale:t.scalar.scale,t.rotate=function(t,i,n,r){var o,a,s,l,u,d,c,h,f,p,_,v,m,g,y,x,b,S,I,w,M,V,D,T,C=r[0],E=r[1],O=r[2],z=Math.sqrt(C*C+E*E+O*O);return Math.abs(z)<e.EPSILON?null:(C*=z=1/z,E*=z,O*=z,o=Math.sin(n),s=1-(a=Math.cos(n)),l=i[0],u=i[1],d=i[2],c=i[3],h=i[4],f=i[5],p=i[6],_=i[7],v=i[8],m=i[9],g=i[10],y=i[11],x=C*C*s+a,b=E*C*s+O*o,S=O*C*s-E*o,I=C*E*s-O*o,w=E*E*s+a,M=O*E*s+C*o,V=C*O*s+E*o,D=E*O*s-C*o,T=O*O*s+a,t[0]=l*x+h*b+v*S,t[1]=u*x+f*b+m*S,t[2]=d*x+p*b+g*S,t[3]=c*x+_*b+y*S,t[4]=l*I+h*w+v*M,t[5]=u*I+f*w+m*M,t[6]=d*I+p*w+g*M,t[7]=c*I+_*w+y*M,t[8]=l*V+h*D+v*T,t[9]=u*V+f*D+m*T,t[10]=d*V+p*D+g*T,t[11]=c*V+_*D+y*T,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},t.scalar.rotateX=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],d=t[9],c=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+u*n,e[5]=a*r+d*n,e[6]=s*r+c*n,e[7]=l*r+h*n,e[8]=u*r-o*n,e[9]=d*r-a*n,e[10]=c*r-s*n,e[11]=h*r-l*n,e},t.SIMD.rotateX=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,n))),e},t.rotateX=e.USE_SIMD?t.SIMD.rotateX:t.scalar.rotateX,t.scalar.rotateY=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],d=t[9],c=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-u*n,e[1]=a*r-d*n,e[2]=s*r-c*n,e[3]=l*r-h*n,e[8]=o*n+u*r,e[9]=a*n+d*r,e[10]=s*n+c*r,e[11]=l*n+h*r,e},t.SIMD.rotateY=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,r))),e},t.rotateY=e.USE_SIMD?t.SIMD.rotateY:t.scalar.rotateY,t.scalar.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],d=t[5],c=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+u*n,e[1]=a*r+d*n,e[2]=s*r+c*n,e[3]=l*r+h*n,e[4]=u*r-o*n,e[5]=d*r-a*n,e[6]=c*r-s*n,e[7]=h*r-l*n,e},t.SIMD.rotateZ=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,n))),e},t.rotateZ=e.USE_SIMD?t.SIMD.rotateZ:t.scalar.rotateZ,t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(t,i,n){var r,o,a,s=n[0],l=n[1],u=n[2],d=Math.sqrt(s*s+l*l+u*u);return Math.abs(d)<e.EPSILON?null:(s*=d=1/d,l*=d,u*=d,r=Math.sin(i),a=1-(o=Math.cos(i)),t[0]=s*s*a+o,t[1]=l*s*a+u*r,t[2]=u*s*a-l*r,t[3]=0,t[4]=s*l*a-u*r,t[5]=l*l*a+o,t[6]=u*l*a+s*r,t[7]=0,t[8]=s*u*a+l*r,t[9]=l*u*a-s*r,t[10]=u*u*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},t.fromXRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=n+n,l=r+r,u=o+o,d=n*s,c=n*l,h=n*u,f=r*l,p=r*u,_=o*u,v=a*s,m=a*l,g=a*u;return e[0]=1-(f+_),e[1]=c+g,e[2]=h-m,e[3]=0,e[4]=c-g,e[5]=1-(d+_),e[6]=p+v,e[7]=0,e[8]=h+m,e[9]=p-v,e[10]=1-(d+f),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getRotation=function(e,t){var i=t[0]+t[5]+t[10],n=0;return i>0?(n=2*Math.sqrt(i+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,i,n){var r=t[0],o=t[1],a=t[2],s=t[3],l=r+r,u=o+o,d=a+a,c=r*l,h=r*u,f=r*d,p=o*u,_=o*d,v=a*d,m=s*l,g=s*u,y=s*d,x=n[0],b=n[1],S=n[2];return e[0]=(1-(p+v))*x,e[1]=(h+y)*x,e[2]=(f-g)*x,e[3]=0,e[4]=(h-y)*b,e[5]=(1-(c+v))*b,e[6]=(_+m)*b,e[7]=0,e[8]=(f+g)*S,e[9]=(_-m)*S,e[10]=(1-(c+p))*S,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,i,n,r){var o=t[0],a=t[1],s=t[2],l=t[3],u=o+o,d=a+a,c=s+s,h=o*u,f=o*d,p=o*c,_=a*d,v=a*c,m=s*c,g=l*u,y=l*d,x=l*c,b=n[0],S=n[1],I=n[2],w=r[0],M=r[1],V=r[2];return e[0]=(1-(_+m))*b,e[1]=(f+x)*b,e[2]=(p-y)*b,e[3]=0,e[4]=(f-x)*S,e[5]=(1-(h+m))*S,e[6]=(v+g)*S,e[7]=0,e[8]=(p+y)*I,e[9]=(v-g)*I,e[10]=(1-(h+_))*I,e[11]=0,e[12]=i[0]+w-(e[0]*w+e[4]*M+e[8]*V),e[13]=i[1]+M-(e[1]*w+e[5]*M+e[9]*V),e[14]=i[2]+V-(e[2]*w+e[6]*M+e[10]*V),e[15]=1,e},t.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=i+i,s=n+n,l=r+r,u=i*a,d=n*a,c=n*s,h=r*a,f=r*s,p=r*l,_=o*a,v=o*s,m=o*l;return e[0]=1-c-p,e[1]=d+m,e[2]=h-v,e[3]=0,e[4]=d-m,e[5]=1-u-p,e[6]=f+_,e[7]=0,e[8]=h+v,e[9]=f-_,e[10]=1-u-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,i,n,r,o,a){var s=1/(i-t),l=1/(r-n),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(r+n)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},t.perspective=function(e,t,i,n,r){var o=1/Math.tan(t/2),a=1/(n-r);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*n*a,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,i,n){var r=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(r+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(a-s)*l*.5,e[9]=(r-o)*u*.5,e[10]=n/(i-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*i/(i-n),e[15]=0,e},t.ortho=function(e,t,i,n,r,o,a){var s=1/(t-i),l=1/(n-r),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*s,e[13]=(r+n)*l,e[14]=(a+o)*u,e[15]=1,e},t.lookAt=function(i,n,r,o){var a,s,l,u,d,c,h,f,p,_,v=n[0],m=n[1],g=n[2],y=o[0],x=o[1],b=o[2],S=r[0],I=r[1],w=r[2];return Math.abs(v-S)<e.EPSILON&&Math.abs(m-I)<e.EPSILON&&Math.abs(g-w)<e.EPSILON?t.identity(i):(h=v-S,f=m-I,p=g-w,a=x*(p*=_=1/Math.sqrt(h*h+f*f+p*p))-b*(f*=_),s=b*(h*=_)-y*p,l=y*f-x*h,(_=Math.sqrt(a*a+s*s+l*l))?(a*=_=1/_,s*=_,l*=_):(a=0,s=0,l=0),u=f*l-p*s,d=p*a-h*l,c=h*s-f*a,(_=Math.sqrt(u*u+d*d+c*c))?(u*=_=1/_,d*=_,c*=_):(u=0,d=0,c=0),i[0]=a,i[1]=u,i[2]=h,i[3]=0,i[4]=s,i[5]=d,i[6]=f,i[7]=0,i[8]=l,i[9]=c,i[10]=p,i[11]=0,i[12]=-(a*v+s*m+l*g),i[13]=-(u*v+d*m+c*g),i[14]=-(h*v+f*m+p*g),i[15]=1,i)},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},t.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e},t.sub=t.subtract,t.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},t.multiplyScalarAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e[4]=t[4]+i[4]*n,e[5]=t[5]+i[5]*n,e[6]=t[6]+i[6]*n,e[7]=t[7]+i[7]*n,e[8]=t[8]+i[8]*n,e[9]=t[9]+i[9]*n,e[10]=t[10]+i[10]*n,e[11]=t[11]+i[11]*n,e[12]=t[12]+i[12]*n,e[13]=t[13]+i[13]*n,e[14]=t[14]+i[14]*n,e[15]=t[15]+i[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],d=t[7],c=t[8],h=t[9],f=t[10],p=t[11],_=t[12],v=t[13],m=t[14],g=t[15],y=i[0],x=i[1],b=i[2],S=i[3],I=i[4],w=i[5],M=i[6],V=i[7],D=i[8],T=i[9],C=i[10],E=i[11],O=i[12],z=i[13],A=i[14],P=i[15];return Math.abs(n-y)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-x)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(o-b)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-S)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-I)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(l-w)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-M)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(d-V)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(c-D)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(h-T)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(f-C)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-E)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(_-O)<=e.EPSILON*Math.max(1,Math.abs(_),Math.abs(O))&&Math.abs(v-z)<=e.EPSILON*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(m-A)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(g-P)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},t}.apply(null,n))||(e.exports=r)},765:function(e,t,i){var n;void 0===(n=function(){var e={EPSILON:1e-6};e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random,e.ENABLE_SIMD=!1,e.SIMD_AVAILABLE=e.ARRAY_TYPE===Float32Array&&"SIMD"in this,e.USE_SIMD=e.ENABLE_SIMD&&e.SIMD_AVAILABLE,e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t};var t=Math.PI/180;return e.toRadian=function(e){return e*t},e.equals=function(t,i){return Math.abs(t-i)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(i))},e}.apply(null,[]))||(e.exports=n)},766:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(410),i(834),i(835),i(456),i(733)],void 0===(r=function(e,t,i,n,r,o,a){var s=new o("0/0/0/0"),l=function(){function e(e,t,i,n,r,o,a,s){this.x=e,this.ymin=t,this.ymax=i,this.invM=n,this.leftAdjust=r,this.rightAdjust=o,this.leftBound=a,this.rightBound=s}return e.create=function(t,i){var n;t[1]>i[1]&&(t=(n=[i,t])[0],i=n[1]);var r=t[0],o=t[1],a=i[0],s=i[1],l=a-r,u=s-o,d=0!==u?l/u:0,c=(Math.ceil(o)-o)*d,h=(Math.floor(o)-o)*d;return new e(r,Math.floor(o),Math.ceil(s),d,l<0?c:h,l<0?h:c,l<0?a:r,l<0?r:a)},e.prototype.incrRow=function(){this.x+=this.invM},e.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},e.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},e}(),u=[[0,0],[0,0],[0,0],[0,0]];return function(){function e(e,t){var i=this;this.tileInfo=e,this.fullExtent=t,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};var r=e.lods.slice();r.sort(function(e,t){return t.scale-e.scale});var o=this._lodInfos=r.map(function(i){return n.create(e,i,t)});r.forEach(function(e,t){i._infoByLevel[e.level]=o[t],i._infoByScale[e.scale]=o[t],i.scales[t]=e.scale},this),this._wrap=e.isWrappable}return e.prototype.getLODInfoAt=function(e){return this._infoByLevel[e.level]},e.prototype.getTileBounds=function(e,t,i){void 0===i&&(i=!1),s.set(t);var n=this._infoByLevel[s.level];return n?n.getTileBounds(e,s,i):e},e.prototype.getTileCoords=function(e,t,i){void 0===i&&(i=!1),s.set(t);var n=this._infoByLevel[s.level];return n?n.getTileCoords(e,s,i):e},e.prototype.getTileCoverage=function(e,t){void 0===t&&(t=192);var i,n,o,s=this.getClosestInfoForScale(e.scale),d=r.pool.acquire(s),c=this._wrap,h=1/0,f=-1/0,p=d.spans;u[0][0]=u[0][1]=u[1][1]=u[3][0]=-t,u[1][0]=u[2][0]=e.size[0]+t,u[2][1]=u[3][1]=e.size[1]+t;for(var _=0,v=u;_<v.length;_++){var m=v[_];e.toMap(m,m),m[0]=s.getColumnForX(m[0]),m[1]=s.getRowForY(m[1])}for(var g=[],y=3,x=0;x<4;x++)if(u[x][1]!==u[y][1]){var b=l.create(u[x],u[y]);h=Math.min(b.ymin,h),f=Math.max(b.ymax,f),void 0===g[b.ymin]&&(g[b.ymin]=[]),g[b.ymin].push(b),y=x}else y=x;if(null==h||null==f||f-h>100)return null;var S=[];for(i=h;i<f;){null!=g[i]&&(S=S.concat(g[i])),n=1/0,o=-1/0;for(x=S.length-1;x>=0;x--){b=S[x];n=Math.min(n,b.getLeftCol()),o=Math.max(o,b.getRightCol())}if(n=Math.floor(n),o=Math.floor(o),i>=s.first[1]&&i<=s.last[1])if(c)if(s.size[0]<s.worldSize[0]){var I=Math.floor(o/s.worldSize[0]);for(x=Math.floor(n/s.worldSize[0]);x<=I;x++)p.push(new a(i,Math.max(s.getFirstColumnForWorld(x),n),Math.min(s.getLastColumnForWorld(x),o)))}else p.push(new a(i,n,o));else n>s.last[0]||o<s.first[0]||(n=Math.max(n,s.first[0]),o=Math.min(o,s.last[0]),p.push(new a(i,n,o)));i+=1;for(x=S.length-1;x>=0;x--){(b=S[x]).ymax>=i?b.incrRow():S.splice(x,1)}}return d},e.prototype.getTileIdAtParent=function(e,t){var i=o.pool.acquire(t),n=this._infoByLevel[i.level];if(e.resolution<n.resolution)throw new Error("Cannot calculate parent tile. destination LOD's resolution "+e.resolution+" is not a parent resolution of "+n.resolution);if(e.resolution===n.resolution)return i.id;var r=Math.floor(i.col*n.resolution/e.resolution+.01),a=Math.floor(i.row*n.resolution/e.resolution+.01);return o.getId(e.level,a,r,i.world)},e.prototype.getTileParentId=function(e){var t=o.pool.acquire(e),i=this._infoByLevel[t.level],n=this._lodInfos.indexOf(i)-1;if(n<0)return o.pool.release(t),null;var r=this._lodInfos[n],a=this.getTileIdAtParent(r,t);return o.pool.release(t),a},e.prototype.getTileResolution=function(e){var t=this._infoByLevel["object"==typeof e?e.level:e];return t?t.resolution:-1},e.prototype.getTileScale=function(e){var t=this._infoByLevel[e.level];return t?t.scale:-1},e.prototype.intersects=function(e,t){var i=o.pool.acquire(t),n=this._infoByLevel[i.level],r=e.lodInfo;if(r.resolution>n.resolution){var a=o.pool.acquire(this.getTileIdAtParent(r,i)),s=r.denormalizeCol(a.col,a.world),l=e.spans.some(function(e){return e.row===a.row&&e.colFrom<=s&&e.colTo>=s});return o.pool.release(i),o.pool.release(a),l}if(r.resolution<n.resolution){var u=e.spans.reduce(function(e,t){return e[0]=Math.min(e[0],t.row),e[1]=Math.max(e[1],t.row),e[2]=Math.min(e[2],t.colFrom),e[3]=Math.max(e[3],t.colTo),e},[1/0,-1/0,1/0,-1/0]),d=u[0],c=u[1],h=u[2],f=u[3],p=n.denormalizeCol(i.col,i.world),_=r.getColumnForX(n.getXForColumn(p)),v=r.getRowForY(n.getYForRow(i.row)),m=r.getColumnForX(n.getXForColumn(p+1))-1,g=r.getRowForY(n.getYForRow(i.row+1))-1;return o.pool.release(i),!(_>f||m<h||v>c||g<d)}var y=r.denormalizeCol(i.col,i.world),x=e.spans.some(function(e){return e.row===i.row&&e.colFrom<=y&&e.colTo>=y});return o.pool.release(i),x},e.prototype.normalizeBounds=function(e,t,n){if(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._wrap){var r=i.getInfo(this.tileInfo.spatialReference),o=-n*(r.valid[1]-r.valid[0]);e[0]+=o,e[2]+=o}return e},e.prototype.getClosestInfoForScale=function(e){var t=this.scales;return this._infoByScale[e]?this._infoByScale[e]:(e=t.reduce(function(t,i,n,r){return Math.abs(i-e)<Math.abs(t-e)?i:t},t[0]),this._infoByScale[e])},e.prototype.scaleToLevel=function(e){var t=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(var i=t.length-1;i>=0;i--)if(e<t[i]){return i===t.length-1?this._infoByScale[t[t.length-1]].level:this._infoByScale[t[i]].level+(t[i]-e)/(t[i]-t[i+1])}return this._infoByScale[t[0]].level},e}()}.apply(null,n))||(e.exports=r)},774:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_MAX_ZOOM_DELTA=4,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=32}.apply(null,n))||(e.exports=r)},787:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(436),i(409)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.on=function(e,t){return n.after(this,"on"+e,t,!0)},e.prototype.once=function(e,t){return r.once(this,e,t)},e.prototype.emit=function(e){r.emit(this,e,this)},e.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},e}();t.Evented=o,t.EventedMixin=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.on=function(e,t){return n.after(this,"on"+e,t,!0)},t.prototype.once=function(e,t){return r.once(this,e,t)},t.prototype.emit=function(e,t){r.emit(this,e,t)},t.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},t}(e)}}.apply(null,n))||(e.exports=r)},790:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336),i(374),i(337),i(664)],void 0===(r=function(e,t,i,n,r,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t.lastUpdateId=-1,t.moving=!1,t.updateRequested=!1,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.when(function(){e.requestUpdate()}),r.init(this,"suspended",function(t){e.container.visible=!t,!t&&e.updateRequested&&e.view.requestLayerViewUpdate(e)},!0),r.init(this,"fullOpacity",function(t){e.container.opacity=t},!0);var t=function(){this.notifyChange("rendering")}.bind(this);this.container.on("post-render",t),this.container.on("will-render",t)},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.updateRequested=!1,this.layer=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.isRendering()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return this.attached&&(this.moving||this.container.renderRequested)},t.prototype.canResume=function(){var e=this.inherited(arguments),t=this.layer;if(e&&null!=t.minScale&&null!=t.minScale){var i=this.view.scale,n=t.minScale,r=t.maxScale,o=!n,a=!r;!o&&i<=n&&(o=!0),!a&&i>=r&&(a=!0),e=o&&a}return e},n([o.property()],t.prototype,"attached",void 0),n([o.property()],t.prototype,"container",void 0),n([o.property()],t.prototype,"moving",void 0),n([o.property({dependsOn:["moving"]})],t.prototype,"rendering",null),n([o.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),n([o.property({readOnly:!0})],t.prototype,"updateParameters",void 0),n([o.property()],t.prototype,"updateRequested",void 0),n([o.property({dependsOn:["updateRequested","attached"]})],t.prototype,"updating",null),n([o.property()],t.prototype,"view",void 0),n([o.subclass("esri.views.2d.layers.LayerView2D")],t)}(o.declared(a))}.apply(null,n))||(e.exports=r)},815:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(380),i(839),i(460)],void 0===(r=function(e,t,i,n,r){return function(){function e(e){this._apiPromises=new Map,this._processingItems=new Map,this._isPaused=!1,this._scheduledNextHandle=null,this.concurrency=1,this.ordered=!1,e.concurrency&&(this.concurrency=e.concurrency),this.ordered=!!e.ordered,this._queue=new n(e.peeker?{peeker:e.peeker}:void 0),this.process=e.process}return Object.defineProperty(e.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._queue.clear();var e=[];this._processingItems.forEach(function(t){return e.push(t.resultPromise)}),this._processingItems.clear(),e.forEach(function(e){return e.cancel()}),e.length=0,this._apiPromises.forEach(function(t){return e.push(t)}),this._apiPromises.clear(),e.forEach(function(e){return e.cancel()}),this._cancelNext()},e.prototype.find=function(e,t){var i=this,n=void 0;return this._apiPromises.forEach(function(r,o){e.call(t,o)&&(n=i._apiPromises.get(o).promise)}),n},e.prototype.get=function(e){var t=this._apiPromises.get(e);return t&&t.promise||void 0},e.prototype.isOngoing=function(e){return this._processingItems.has(e)},e.prototype.has=function(e){return this._apiPromises.has(e)},e.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},e.prototype.push=function(e){var t=this;if(this._apiPromises.has(e))return this._apiPromises.get(e).promise;var n=new i(function(i){var n=t._processingItems.get(e);n?n.resultPromise.cancel(i):(t._remove(e),t._scheduleNext())});return this._add(e,n),this._scheduleNext(),n.promise},e.prototype.reset=function(){var e=[];this._processingItems.forEach(function(t){return e.push(t)}),this._processingItems.clear();for(var t=0,i=e;t<i.length;t++){var n=i[t];n.resultPromise.isFulfilled()?this._processReset(n):(n.isReset=!0,n.resultPromise.cancel())}},e.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())},e.prototype._scheduleNext=function(){var e=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=r.schedule(function(){e._scheduledNextHandle=null,e._next()}))},e.prototype._next=function(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())},e.prototype._processResult=function(e,t){this._remove(e.item),this._scheduleNext(),e.dfd.resolve(t)},e.prototype._processError=function(e,t){e.isReset?this._processReset(e):(this._remove(e.item),this._scheduleNext(),e.dfd.reject(t))},e.prototype._processReset=function(e){this._remove(e.item),this._add(e.item,e.dfd),this._scheduleNext()},e.prototype._processOrdered=function(e,t){var i=this,n=!1;if(e.isReset)this._processReset(e);else{e.result=t,this._itemsToProcess||(this._itemsToProcess=[]),this._processingItems.forEach(function(e){n||(e.result?i._itemsToProcess.push(e):n=!0)});for(var r=0,o=this._itemsToProcess;r<o.length;r++){var a=o[r];!1===a.result.ok?this._processError(a,a.result.error):this._processResult(a,a.result.value)}this._itemsToProcess.length=0}},e.prototype._process=function(e){var t=this;if(null!=e){var i=this._apiPromises.get(e),n=this.process(e);if(function(e){return e&&"function"==typeof e.then}(n)){var r={item:e,resultPromise:n,result:null,dfd:i,isReset:!1};this._processingItems.set(e,r),this.ordered?n.then(function(e){return t._processOrdered(r,{ok:!0,value:e})},function(e){return t._processOrdered(r,{ok:!1,error:e})}):n.then(function(e){return t._processResult(r,e)},function(e){return t._processError(r,e)})}else i.resolve(n),this._remove(e)}},e.prototype._add=function(e,t){this._apiPromises.set(e,t),this._queue.push(e)},e.prototype._remove=function(e){this._queue.remove(e),this._apiPromises.delete(e),this._processingItems.delete(e)},e.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},e}()}.apply(null,n))||(e.exports=r)},820:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(4);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},fromValues:function(t,i,n,r){var o=new e.ARRAY_TYPE(4);return o[0]=t,o[1]=i,o[2]=n,o[3]=r,o},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},set:function(e,t,i,n,r){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e},t.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(i*i+n*n+r*r+o*o)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],o=t[3]-e[3];return i*i+n*n+r*r+o*o},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return Math.sqrt(t*t+i*i+n*n+r*r)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return t*t+i*i+n*n+r*r},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=t[2],o=t[3],a=i*i+n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=i*a,e[1]=n*a,e[2]=r*a,e[3]=o*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,i,n){var r=t[0],o=t[1],a=t[2],s=t[3];return e[0]=r+n*(i[0]-r),e[1]=o+n*(i[1]-o),e[2]=a+n*(i[2]-a),e[3]=s+n*(i[3]-s),e},t.random=function(i,n){return n=n||1,i[0]=e.RANDOM(),i[1]=e.RANDOM(),i[2]=e.RANDOM(),i[3]=e.RANDOM(),t.normalize(i,i),t.scale(i,i,n),i},t.transformMat4=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*a,e[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*a,e[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*a,e[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*a,e},t.transformQuat=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=i[0],s=i[1],l=i[2],u=i[3],d=u*n+s*o-l*r,c=u*r+l*n-a*o,h=u*o+a*r-s*n,f=-a*n-s*r-l*o;return e[0]=d*u+f*-a+c*-l-h*-s,e[1]=c*u+f*-s+h*-a-d*-l,e[2]=h*u+f*-l+d*-s-c*-a,e[3]=t[3],e},t.forEach=function(){var e=t.create();return function(t,i,n,r,o,a){var s,l;for(i||(i=4),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(t,i){var n=t[0],r=t[1],o=t[2],a=t[3],s=i[0],l=i[1],u=i[2],d=i[3];return Math.abs(n-s)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-l)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-d)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))},t}.apply(null,n))||(e.exports=r)},834:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(410),i(456)],void 0===(r=function(e,t,i,n){function r(e,t){return[e,t]}function o(e,t,i){return e[0]=t,e[1]=i,e}var a=new n("0/0/0/0");return function(){function e(e,t,i,n,r,o,a,s,l,u,d,c){this.level=e,this.resolution=t,this.scale=i,this.origin=n,this.first=r,this.last=o,this.size=a,this.norm=s,this.worldStart=l,this.worldEnd=u,this.worldSize=d,this.wrap=c}return e.create=function(t,n,a){var s,l,u,d,c=i.getInfo(t.spatialReference),h=r(t.origin.x,t.origin.y),f=r(t.size[0]*n.resolution,t.size[1]*n.resolution),p=r(-1/0,-1/0),_=r(1/0,1/0),v=r(1/0,1/0);return a&&(o(p,Math.max(0,Math.floor((a.xmin-h[0])/f[0])),Math.max(0,Math.floor((h[1]-a.ymax)/f[1]))),o(_,Math.max(0,Math.floor((a.xmax-h[0])/f[0])),Math.max(0,Math.floor((h[1]-a.ymin)/f[1]))),o(v,_[0]-p[0]+1,_[1]-p[1]+1)),t.isWrappable?(s=r(Math.ceil(Math.round(2*c.origin[1]/n.resolution)/t.size[0]),v[1]),l=r(Math.floor((c.origin[0]-h[0])/f[0]),p[1]),u=r(s[0]+l[0]-1,_[1]),d=!0):(l=p,u=_,s=v,d=!1),new e(n.level,n.resolution,n.scale,h,p,_,v,f,l,u,s,d)},e.prototype.normalizeCol=function(e){if(!this.wrap)return e;var t=this.worldSize[0];return e<0?t-1-Math.abs((e+1)%t):e%t},e.prototype.denormalizeCol=function(e,t){return this.wrap?this.worldSize[0]*t+e:e},e.prototype.getWorldForColumn=function(e){return this.wrap?Math.floor(e/this.worldSize[0]):0},e.prototype.getFirstColumnForWorld=function(e){return e*this.worldSize[0]+this.first[0]},e.prototype.getLastColumnForWorld=function(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1},e.prototype.getColumnForX=function(e){return(e-this.origin[0])/this.norm[0]},e.prototype.getXForColumn=function(e){return this.origin[0]+e*this.norm[0]},e.prototype.getRowForY=function(e){return(this.origin[1]-e)/this.norm[1]},e.prototype.getYForRow=function(e){return this.origin[1]-e*this.norm[1]},e.prototype.getTileBounds=function(e,t,i){void 0===i&&(i=!1),a.set(t);var n=i?a.col:this.denormalizeCol(a.col,a.world),r=a.row;return function(e,t,i,n,r){e[0]=t,e[1]=i,e[2]=n,e[3]=r}(e,this.getXForColumn(n),this.getYForRow(r+1),this.getXForColumn(n+1),this.getYForRow(r)),e},e.prototype.getTileCoords=function(e,t,i){void 0===i&&(i=!1),a.set(t);var n=i?a.col:this.denormalizeCol(a.col,a.world);return Array.isArray(e)?o(e,this.getXForColumn(n),this.getYForRow(a.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(a.row)),e},e}()}.apply(null,n))||(e.exports=r)},835:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(718),i(412),i(733)],void 0===(r=function(e,t,i,n,r){return function(){function e(e){this.lodInfo=e,this.spans=i.acquire()}return e.prototype.release=function(){for(var e=0,t=this.spans;e<t.length;e++){var n=t[e];r.pool.release(n)}i.release(this.spans)},e.prototype.forEach=function(e,t){var i=this.spans,n=this.lodInfo,r=n.level;if(0!==i.length)for(var o=0,a=i;o<a.length;o++)for(var s=a[o],l=s.row,u=s.colFrom,d=s.colTo,c=u;c<=d;c++)e.call(t,r,l,n.normalizeCol(c),n.getWorldForColumn(c))},e.pool=new n(e,!0),e}()}.apply(null,n))||(e.exports=r)},838:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(338),i(336),i(346),i(815),i(337),i(698)],void 0===(r=function(e,t,i,n,r,o,a,s){var l=new Set,u=[],d=new Map,c=[0,0];return function(e){function t(t){var i=e.call(this,t)||this;return i._keysToRequests=new Map,i.concurrency=6,i.process=null,i.strategy="scale-first",i.tileInfoView=null,i.tileServers=null,i}return i(t,e),t.prototype.initialize=function(){var e=this,t="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this),i=this,n=i.tileServers,r=i.concurrency,a=i.process;n&&n.length>0?this._queues=n.map(function(i){return new o({concurrency:r,process:function(t){var n=e._keysToRequests.get(t);return a(n,i)},peeker:t})}):this._queues=[new o({concurrency:r,process:function(t){var i=e._keysToRequests.get(t);return a(i)},peeker:t})]},Object.defineProperty(t.prototype,"length",{get:function(){return this._queues.reduce(function(e,t){return e+t.length},0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onGoingCount",{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this.length>0||this.onGoingCount>0},enumerable:!0,configurable:!0}),t.prototype.clear=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].clear();this._keysToRequests.clear(),this.notifyChange("updating")},t.prototype.find=function(e,t){for(var i=this,n=0,r=this._queues;n<r.length;n++){var o=r[n].find(function(t){return e(i._keysToRequests.get(t).key)});if(o)return o}},t.prototype.getPromise=function(e){for(var t="string"==typeof e?e:e.id,i=0,n=this._queues;i<n.length;i++){var r=n[i].get(t);if(r)return r}},t.prototype.getRequest=function(e){var t="string"==typeof e?e:e.id;return this._keysToRequests.get(t)},t.prototype.has=function(e){return"string"==typeof e?this._keysToRequests.has(e):this._keysToRequests.has(e.id)},t.prototype.isOngoing=function(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queues.some(function(e){return e.isOngoing(t)})},t.prototype.pause=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].pause()},t.prototype.push=function(e){var t=this,i=e.key.id;if(this.has(i))return this.getPromise(i);var n=this._queues[e.key.row%this._queues.length].push(i),r=function(){t._keysToRequests.delete(i),t.notifyChange("updating")};return this._keysToRequests.set(i,e),n.then(r,r),this.notifyChange("updating"),n},t.prototype.reset=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].reset();this.notifyChange("updating")},t.prototype.resume=function(){for(var e=0,t=this._queues;e<t.length;e++)t[e].resume()},t.prototype._peekByScaleFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=0,o=e;r<o.length;r++){var a=o[r],s=this._keysToRequests.get(a),c=this.tileInfoView.getTileScale(s.key);d.has(c)||(d.set(c,[]),i=Math.max(c,i),n=Math.min(c,n)),d.get(c).push(s.key),l.add(c)}var h=this.state.scale;d.has(h)||(function(e,t){e.length=0,t.forEach(function(t){return e.push(t)})}(u,l),u.sort(),h=u.reduce(function(e,t,i,n){return Math.abs(t-h)<Math.abs(e-h)?t:e},u[0])),h=Math.min(h,i),h=Math.max(h,n);var f=d.get(h),p=t.getClosestInfoForScale(h),_=p.getColumnForX(this.state.center[0]),v=p.getRowForY(this.state.center[1]);return f.sort(function(e,t){var i=p.denormalizeCol(e.col,e.world),n=p.denormalizeCol(t.col,t.world);return Math.sqrt((_-i)*(_-i)+(v-e.row)*(v-e.row))-Math.sqrt((_-n)*(_-n)+(v-t.row)*(v-t.row))}),l.clear(),d.clear(),f[0].id},t.prototype._peekByCenterFirst=function(e){if(!this.state)return e[0];for(var t=this.tileInfoView,i=this.state.center,n=Number.POSITIVE_INFINITY,r=null,o=0,a=e;o<a.length;o++){var l=a[o],u=this._keysToRequests.get(l);t.getTileCoords(c,u.key);var d=s.distance(c,i);d<n&&(n=d,r=u.key)}return r.id},n([a.property({constructOnly:!0})],t.prototype,"concurrency",void 0),n([a.property({constructOnly:!0})],t.prototype,"process",void 0),n([a.property()],t.prototype,"state",void 0),n([a.property({constructOnly:!0})],t.prototype,"strategy",void 0),n([a.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),n([a.property({constructOnly:!0})],t.prototype,"tileServers",void 0),n([a.property({readOnly:!0})],t.prototype,"updating",null),n([a.subclass()],t)}(a.declared(r))}.apply(null,n))||(e.exports=r)},839:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e){this._items=[],this._itemSet=new Set,this._peeker=function(e){return e[0]},this._length=0,e&&e.peeker&&(this._peeker=e.peeker)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._itemSet.clear(),this._items.length=0,this._length=0},e.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)},e.prototype.push=function(e){this.contains(e)||this._add(e)},e.prototype.contains=function(e){return this._length>0&&this._itemSet.has(e)},e.prototype.pop=function(){if(0!==this._length){var e=this.peek();return this._remove(e),e}},e.prototype.remove=function(e){this.contains(e)&&this._remove(e)},e.prototype._add=function(e){this._items.push(e),this._itemSet.add(e),this._length++},e.prototype._remove=function(e){this._itemSet.delete(e),this._items.splice(this._items.indexOf(e),1),this._length--},e}()}.apply(null,n))||(e.exports=r)},900:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(456)],void 0===(r=function(e,t,i,n){function r(e,t){e.delete(t)}var o=new n(0,0,0,0),a=new Map,s=[],l=[];return function(){function e(e){this._previousResolution=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),null!=e.buffer&&(this.buffer=e.buffer)}return e.prototype.destroy=function(){this.tileIndex.clear()},e.prototype.update=function(e){var t=this,i=this.tileIndex,n=this.tileInfoView.getTileCoverage(e.state,this.buffer);if(n){var u=n.spans,d=n.lodInfo,c=d.level,h=e.state.resolution,f=!e.stationary&&h>this._previousResolution;this._previousResolution=h,i.forEach(function(e){return e.visible=!0}),this.tiles.length=0,a.clear();var p=0,_=0;if(u.length>0)for(var v=0,m=u;v<m.length;v++)for(var g=m[v],y=g.row,x=g.colFrom,b=g.colTo,S=x;S<=b;S++){p++;var I=o.set(c,y,d.normalizeCol(S),d.getWorldForColumn(S)).id;if(i.has(I)){if((w=i.get(I)).attached){a.set(I,w),_++;continue}w.attached||f||this._addParentTile(I,a)}else{var w=this.acquireTile(o);this.tileIndex.set(I,w),f||this._addParentTile(I,a)}}var M=_===p;l.length=0,s.length=0,i.forEach(function(e,i){if(o.set(i),!a.has(i)){var r=t.tileInfoView.intersects(n,o);if(!r||!f&&M)if("purge"===t.cachePolicy){!(o.level!==c)&&r||s.push(i)}else(o.level>c||!r)&&s.push(i);else e.attached?l.push(i):o.level>c&&s.push(i)}});for(var V=0,D=l;V<D.length;V++){I=D[V];(w=i.get(I))&&w.attached&&a.set(I,w)}for(var T=0,C=s;T<C.length;T++){I=C[T],w=i.get(I);this.releaseTile(w),r(i,I)}return a.forEach(function(e){return t.tiles.push(e)}),i.forEach(function(e){a.has(e.key.id)||(e.visible=!1)}),l.length=0,s.length=0,a.clear(),M}},e.prototype.clear=function(){var e=this,t=this.tileIndex;t.forEach(function(t){e.releaseTile(t)}),t.clear()},e.prototype._addParentTile=function(e,t){for(var i=e,n=null;i=this.tileInfoView.getTileParentId(i);)if(this.tileIndex.has(i)&&(n=this.tileIndex.get(i))&&n.attached){t.has(n.key.id)||t.set(n.key.id,n);break}},e}()}.apply(null,n))||(e.exports=r)},903:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},fromValues:function(t,i,n){var r=new e.ARRAY_TYPE(3);return r[0]=t,r[1]=i,r[2]=n,r},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e},t.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(i*i+n*n+r*r)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return i*i+n*n+r*r},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=t[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},t.cross=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=i[0],s=i[1],l=i[2];return e[0]=r*l-o*s,e[1]=o*a-n*l,e[2]=n*s-r*a,e},t.lerp=function(e,t,i,n){var r=t[0],o=t[1],a=t[2];return e[0]=r+n*(i[0]-r),e[1]=o+n*(i[1]-o),e[2]=a+n*(i[2]-a),e},t.hermite=function(e,t,i,n,r,o){var a=o*o,s=a*(2*o-3)+1,l=a*(o-2)+o,u=a*(o-1),d=a*(3-2*o);return e[0]=t[0]*s+i[0]*l+n[0]*u+r[0]*d,e[1]=t[1]*s+i[1]*l+n[1]*u+r[1]*d,e[2]=t[2]*s+i[2]*l+n[2]*u+r[2]*d,e},t.bezier=function(e,t,i,n,r,o){var a=1-o,s=a*a,l=o*o,u=s*a,d=3*o*s,c=3*l*a,h=l*o;return e[0]=t[0]*u+i[0]*d+n[0]*c+r[0]*h,e[1]=t[1]*u+i[1]*d+n[1]*c+r[1]*h,e[2]=t[2]*u+i[2]*d+n[2]*c+r[2]*h,e},t.random=function(t,i){i=i||1;var n=2*e.RANDOM()*Math.PI,r=2*e.RANDOM()-1,o=Math.sqrt(1-r*r)*i;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*i,t},t.transformMat4=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=i[3]*n+i[7]*r+i[11]*o+i[15];return a=a||1,e[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/a,e[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/a,e[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/a,e},t.transformMat3=function(e,t,i){var n=t[0],r=t[1],o=t[2];return e[0]=n*i[0]+r*i[3]+o*i[6],e[1]=n*i[1]+r*i[4]+o*i[7],e[2]=n*i[2]+r*i[5]+o*i[8],e},t.transformQuat=function(e,t,i){var n=t[0],r=t[1],o=t[2],a=i[0],s=i[1],l=i[2],u=i[3],d=u*n+s*o-l*r,c=u*r+l*n-a*o,h=u*o+a*r-s*n,f=-a*n-s*r-l*o;return e[0]=d*u+f*-a+c*-l-h*-s,e[1]=c*u+f*-s+h*-a-d*-l,e[2]=h*u+f*-l+d*-s-c*-a,e},t.rotateX=function(e,t,i,n){var r=[],o=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.rotateY=function(e,t,i,n){var r=[],o=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.rotateZ=function(e,t,i,n){var r=[],o=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.forEach=function(){var e=t.create();return function(t,i,n,r,o,a){var s,l;for(i||(i=3),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),t.angle=function(e,i){var n=t.fromValues(e[0],e[1],e[2]),r=t.fromValues(i[0],i[1],i[2]);t.normalize(n,n),t.normalize(r,r);var o=t.dot(n,r);return o>1?0:Math.acos(o)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(t,i){var n=t[0],r=t[1],o=t[2],a=i[0],s=i[1],l=i[2];return Math.abs(n-a)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t}.apply(null,n))||(e.exports=r)},961:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(2);return i[0]=t[0],i[1]=t[1],i},fromValues:function(t,i){var n=new e.ARRAY_TYPE(2);return n[0]=t,n[1]=i,n},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,i){return e[0]=t,e[1]=i,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e},t.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(i*i+n*n)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,i){var n=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=n,e},t.lerp=function(e,t,i,n){var r=t[0],o=t[1];return e[0]=r+n*(i[0]-r),e[1]=o+n*(i[1]-o),e},t.random=function(t,i){i=i||1;var n=2*e.RANDOM()*Math.PI;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t},t.transformMat2=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r,e[1]=i[1]*n+i[3]*r,e},t.transformMat2d=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r+i[4],e[1]=i[1]*n+i[3]*r+i[5],e},t.transformMat3=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[3]*r+i[6],e[1]=i[1]*n+i[4]*r+i[7],e},t.transformMat4=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e},t.forEach=function(){var e=t.create();return function(t,i,n,r,o,a){var s,l;for(i||(i=2),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(t,i){var n=t[0],r=t[1],o=i[0],a=i[1];return Math.abs(n-o)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))},t}.apply(null,n))||(e.exports=r)},968:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1530),i(1276)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=new n(function(e){var t=i;return e.split("/").forEach(function(e){t&&(t=t[e])}),t});t.resolveIncludes=function(e){return r.resolveIncludes(e)}}.apply(null,n))||(e.exports=r)},969:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968),i(417)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return n.glslifyDefineMap({ID:e.id,HIGHLIGHT:e.highlight,SDF:e.isSDF,VV_SIZE_MIN_MAX_VALUE:e.vvSizeMinMaxValue,VV_SIZE_SCALE_STOPS:e.vvSizeScaleStops,VV_SIZE_FIELD_STOPS:e.vvSizeFieldStops,VV_SIZE_UNIT_VALUE:e.vvSizeUnitValue,VV_COLOR:e.vvColor,VV_ROTATION:e.vvRotation,VV_OPACITY:e.vvOpacity,VERTEX_VISIBILITY:e.visibility,PATTERN:e.pattern,HEATMAP:e.heatmap})};t.fill={name:"fill",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/fill/fill.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/fill/fill.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5,a_visible:6}},t.icon={name:"icon",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/icon/icon.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_vv:6,a_weight:7,a_visible:8}},t.label={name:"label",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/label/label.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/label/label.frag")}},attributes:{a_pos:0,a_color:1,a_vertexOffset:2,a_texAndSize:3,a_refSymbolAndPlacementOffset:4,a_visible:5,a_visibilityRange:6}},t.line={name:"line",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/line/line.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/line/line.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7,a_visible:8}},t.text={name:"text",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/text/text.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/text/text.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5,a_vv:6}}}.apply(null,n))||(e.exports=r)},970:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=new Uint32Array(1),n=new Uint8Array(i.buffer);t.int32To4Bytes=function(e){return i[0]=0|e,[n[0],n[1],n[2],n[3]]}}.apply(null,n))||(e.exports=r)}}]);