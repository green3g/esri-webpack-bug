(function(){(this||window).webpackJsonp.registerAbsMids({"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/webgl-engine/lib/Util":349,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/geometry/support/aaBoundingBox":389,"esri/core/tsSupport/generatorHelper":398,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/tsSupport/generatorHelper":398,"esri/core/pbf":594,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/pbf":594,"esri/views/vectorTiles/GeometryUtils":616,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/vectorTiles/GeometryUtils":616,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/support/geometryUtils":622,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/support/imageUtils":640,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/common":671,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/vec2":698,"esri/views/2d/tiling/enums":725,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/tiling/enums":725,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/libs/gl-matrix/mat2d":745,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/mat4":759,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/geometry/support/quantizationUtils":773,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/vec4":820,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/core/libs/gl-matrix/vec3":903,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/sources/resolver":968,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/MaterialPrograms":969,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/support/geometryUtils/lineSegment":1007,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrush":1013,"esri/views/2d/engine/webgl/GeometryUtils":1022,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/GeometryUtils":1022,"esri/views/2d/engine/webgl/Geometry":1052,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/Geometry":1052,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/support/geometryUtils/plane":1274,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/3d/support/geometryUtils/triangle":1275,"esri/views/2d/engine/webgl/Rect":1277,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/Rect":1277,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrush":1281,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/util/iterator":1304,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLPainter":1386,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/BackgroundPrograms":1390,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/StageGL":1527,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/BitBlitRenderer":1528,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/BitBlitPrograms":1529,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/sources/shaderRepository":1530,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/Fader":1531,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MaterialManager":1532,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrushInfo":1535,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/TileInfoPrograms":1536,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLBrushStencil":1537,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":1538,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":1539,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":1540,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":1541,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/brushes/WGLGeometryBrushText":1542,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/WGLHighlightPainter":1543,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/highlight/HighlightRenderer":1544,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/HighlightPrograms":1545,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":1546,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/shaders/StencilPrograms":1547,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/SDFHelper":1581,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLDisplayList":1582,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/features/tileRenderers/BaseTileRenderer":1587,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/RectangleBinPack":1663,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/layers/features/tileRenderers/SymbolTileRenderer":2411,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLFeatureView":2412,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/TextureManager":2413,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/CIMSymbolHelper":2414,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/CIMSymbolDrawHelper":2415,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/GlyphMosaic":2416,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/GlyphSource":2417,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/SDFConverter":2418,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/SpriteMosaic":2419,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLRendererInfo":2420,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLTile":2421,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/DirtyMap":2422,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/DisplayRecordStore":2423,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/FreeList":2424,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/TileData":2425,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/MemoryRequirements":2426,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/TileBufferData":2427,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/TileDisplayData":2428,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/mesh/VertexBuffer":2431,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/util/Reader":2432,"C:/Users/roemh/web/datafi/node_modules/arcgis-js-api/views/2d/engine/webgl/WGLBuffers":2433})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1007:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(344),i(364)],void 0===(r=function(e,t,i,n){function r(e,t){return void 0===e&&(e=i.vec3d.create()),void 0===t&&(t=i.vec3d.create()),{origin:e,vector:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,t.fromOriginAndVector=function(e,t,n){return void 0===n&&(n=r()),i.vec3d.set(e,n.origin),i.vec3d.set(t,n.vector),n},t.distance2=function(e,t){var r=i.vec3d.subtract(t,e.origin),o=i.vec3d.dot(e.vector,r),s=i.vec3d.dot(e.vector,e.vector),l=n.clamp(o/s,0,1),u=i.vec3d.subtract(i.vec3d.scale(e.vector,l,a),r,a);return i.vec3d.dot(u,u)};var a=i.vec3d.create()}.apply(null,n))||(e.exports=r)},1013:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(1281),i(1304)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.draw=function(e,t){var i=this;if(t.canDisplay){var n=this.getGeometryType(),a=t.getDisplayList(e.drawPhase),o=t.getGeometry(n);o&&r.forEachIter(a.ofType(n),function(n){return i.drawGeometry(e,t,n,o)})}},t}(n.default);t.default=a}.apply(null,n))||(e.exports=r)},1022:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,n))||(e.exports=r)},1052:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var i=this.x,n=this.y;this.x=i*e-n*t,this.y=i*t+n*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},e.add=function(t,i){return new e(t.x+i.x,t.y+i.y)},e.sub=function(t,i){return new e(t.x-i.x,t.y-i.y)},e}();t.Point=i}.apply(null,n))||(e.exports=r)},1274:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(344)],void 0===(r=function(e,t,i){function n(e){return void 0===e&&(e=t.UP),[e[0],e[1],e[2],e[3]]}function r(e,t,r){return void 0===r&&(r=n()),i.vec3d.set(t,r),r[3]=-i.vec3d.dot(t,e),r}function a(e,t,a,o){return void 0===o&&(o=n()),i.vec3d.cross(t,e,l),r(a,i.vec3d.normalize(l),o)}Object.defineProperty(t,"__esModule",{value:!0}),t.create=n,t.fromValues=function(e,t,i,r,a){return void 0===a&&(a=n()),a[0]=e,a[1]=t,a[2]=i,a[3]=r,a},t.fromNormalAndOffset=function(e,t,r){return void 0===r&&(r=n()),i.vec3d.set(e,r),r[3]=t,r},t.fromPositionAndNormal=r,t.projectVector=function(e,t,n){return void 0===n&&(n=t),i.vec3d.cross(e,i.vec3d.cross(t,e,s),n)},t.distance=function(e,t){return i.vec3d.dot(e,t)+e[3]},t.fromPoints=function(e,t,r,l){return void 0===l&&(l=n()),a(i.vec3d.subtract(e,t,o),i.vec3d.subtract(r,t,s),e,l)},t.set=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.negate=function(e,t){return void 0===t&&(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},t.fromVectorsAndPoint=a,t.intersectRay=function(e,t,n,r){var a=i.vec3d.dot(e,n);if(0===a)return!1;var o=-(i.vec3d.dot(e,t)+e[3])/a;return!(o<0||(i.vec3d.add(t,i.vec3d.scale(n,o,r),r),0))},t.UP=[0,0,1,0];var o=i.vec3d.create(),s=i.vec3d.create(),l=i.vec3d.create()}.apply(null,n))||(e.exports=r)},1275:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(344),i(1007)],void 0===(r=function(e,t,i,n){function r(e,t,n){var r=i.vec2d.dist(e,t),a=i.vec2d.dist(t,n),o=i.vec2d.dist(n,e),s=(r+a+o)/2;return Math.sqrt(s*(s-r)*(s-a)*(s-o))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e,t,n){return void 0===e&&(e=i.vec3d.create()),void 0===t&&(t=i.vec3d.create()),void 0===n&&(n=i.vec3d.create()),{p0:e,p1:t,p2:n}},t.distance2=function(e,t){var r=e.p0,c=e.p1,p=e.p2,v=i.vec3d.subtract(c,r,a),_=i.vec3d.subtract(p,c,o),m=i.vec3d.subtract(r,p,s),g=i.vec3d.subtract(t,r,l),y=i.vec3d.subtract(t,c,u),x=i.vec3d.subtract(t,p,d),b=i.vec3d.cross(v,m),S=i.vec3d.dot(i.vec3d.cross(v,b,f),g),M=i.vec3d.dot(i.vec3d.cross(_,b,f),y),I=i.vec3d.dot(i.vec3d.cross(m,b,f),x);if(S>0&&M>0&&I>0){var w=i.vec3d.dot(b,g);return w*w/i.vec3d.dot(b,b)}var V=n.distance2(n.fromOriginAndVector(r,v,h),t),D=n.distance2(n.fromOriginAndVector(c,_,h),t),z=n.distance2(n.fromOriginAndVector(p,m,h),t);return Math.min(V,D,z)},t.areaPoints2d=r,t.area2d=function(e){return r(e.p0,e.p1,e.p2)};var a=i.vec3d.create(),o=i.vec3d.create(),s=i.vec3d.create(),l=i.vec3d.create(),u=i.vec3d.create(),d=i.vec3d.create(),f=i.vec3d.create(),h=n.create()}.apply(null,n))||(e.exports=r)},1277:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=r)},1281:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){}}();t.default=i}.apply(null,n))||(e.exports=r)},1304:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEachIter=function(e,t){for(;;){var i=e.next(),n=i.value;if(i.done)return;t(n)}}}.apply(null,n))||(e.exports=r)},1386:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(345),i(354),i(759),i(623),i(1022),i(1532),i(675),i(1535),i(1537),i(1538),i(1539),i(1540),i(1541),i(1542),i(1543),i(377)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_,m){Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){this._initialized=!1}return e.prototype.registerPass=function(e,t){this._initialize();for(var i=0,n=t;i<n.length;i++){var r=n[i];this._passMap.set(r,e)}return this},e.prototype.getPaintPassTs=function(e){return this._initialize(),this._passMap.has(e)?[this._passMap.get(e)]:[]},e.prototype._initialize=function(){this._initialized||(this._passMap=new Map,this._initialized=!0)},e}();t.WGLPainterOptions=g;var y=new Uint8Array(4*l.C_HITTEST_SEARCH_SIZE*l.C_HITTEST_SEARCH_SIZE),x=new Uint32Array(y.buffer),b=function(){function e(){this._hlPainter=new _,this._extrudeMatrix=new Float32Array(16),this._extrudeNoRotationMatrix=new Float32Array(16),this._extrudeRotateVector=new Float32Array([0,0,1]),this._extrudeScaleVector=new Float32Array([1,1,1]),this._state={rotation:0,width:0,height:0},this._cachedWidth=0,this._cachedHeight=0,this._cachedRotation=0,this.materialManager=new s}return e.allGeometryPhases=function(){return[a.WGLDrawPhase.FILL,a.WGLDrawPhase.LINE,a.WGLDrawPhase.MARKER,a.WGLDrawPhase.TEXT]},e.toWGLDrawPhases=function(e){for(var t,i=[],n=0;n<a.WGLDrawPhase.NUM_DRAW_PHASES;n++)(t=1<<n)&e&&i.push(t);return i},Object.defineProperty(e.prototype,"extrudeMatrix",{get:function(){return this._extrudeMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extrudeNoRotationMatrix",{get:function(){return this._extrudeNoRotationMatrix},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.materialManager.dispose(),this.textureManager=null,this._hlPainter&&(this._hlPainter.dispose(),this._hlPainter=null),this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null),this._passes&&(this._passes.forEach(function(e){return e.dispose()}),this._passes.clear()),this._brushes&&(this._brushes.forEach(function(e){return e.forEach(function(e){return e.dispose()})}),this._brushes.clear())},e.prototype.initialize=function(e){this.materialManager.initialize(e)},e.prototype.update=function(e,t){this._state=e,this._state.width===this._cachedWidth&&this._state.height===this._cachedHeight&&this._state.rotation===this._cachedRotation||(this._extrudeScaleVector[0]=2/e.width,this._extrudeScaleVector[1]=-2/e.height,r.identity(this._extrudeMatrix),r.rotate(this._extrudeMatrix,this._extrudeMatrix,-e.rotation*o.C_DEG_TO_RAD,this._extrudeRotateVector),r.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),r.transpose(this._extrudeMatrix,this._extrudeMatrix),r.identity(this._extrudeNoRotationMatrix),r.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),r.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},e.prototype.getBrushes=function(e){if(!this._brushes){var t=new f.default,i=new p.default,n=new c.default,r=new v.default,o=new h.default,s=new u.default,l=new d.default;this._brushes=new Map,this._brushes.set(a.WGLDrawPhase.FILL,[t]),this._brushes.set(a.WGLDrawPhase.MARKER,[i]),this._brushes.set(a.WGLDrawPhase.LINE,[n]),this._brushes.set(a.WGLDrawPhase.TEXT,[r]),this._brushes.set(a.WGLDrawPhase.LABEL,[o]),this._brushes.set(a.WGLDrawPhase.LABEL_ALPHA,[o]),this._brushes.set(a.WGLDrawPhase.HITTEST,[t,i,n,r]),this._brushes.set(a.WGLDrawPhase.HIGHLIGHT,[t,i,n,r]),this._brushes.set(a.WGLDrawPhase.CLIP,[l]),this._brushes.set(a.WGLDrawPhase.DEBUG,[s])}if(!this._brushes.has(e))throw new Error("WGLPainter: Tried to get brush for unknown phase: "+e);return this._brushes.get(e)},e.prototype.bindTextureManager=function(e){this.textureManager=e},e.prototype.draw=function(e,t,i,n){i[0]===a.WGLDrawPhase.LABEL_ALPHA&&i[0]===a.WGLDrawPhase.LABEL||this._drawClippingRects(e,t);var r=e.context;r.setBlendingEnabled(!0),r.setStencilWriteMask(0),r.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,i,n),this._debugTiles(e,t)},e.prototype.setHighlightOptions=function(e){this._hlPainter.setHighlightOptions(e)},e.prototype.highlight=function(e,t){var i=e.context,n=i.getViewport();this._hlPainter.setup(i,n.width,n.height),this._hlPainter.startMaskDraw(i),this._drawClippingRects(e,t),i.setBlendingEnabled(!0),i.setStencilWriteMask(0),i.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,[a.WGLDrawPhase.HIGHLIGHT]),this._hlPainter.draw(i)},e.prototype.hitTest=function(e,t){var i=l.C_HITTEST_SEARCH_SIZE,n=[0,0],r=[0,0],o=e.state;if(o.toMap(n,[0,0]),o.toMap(r,[i,i]),0===t.filter(function(e){return!(n[0]>e.bounds[2]||r[0]<e.bounds[0]||n[1]<e.bounds[1]||r[1]>e.bounds[3])}).length)return[];var s=e.context;this._hittestFBO||(this._hittestFBO=m.create(s,{colorTarget:0,depthStencilTarget:3,width:i,height:i}));var u=s.getViewport(),d=s.getBoundFramebufferObject();s.bindFramebuffer(this._hittestFBO),s.setViewport(0,0,i,i),this._drawClippingRects(e,t);var f=s.gl;s.setClearColor(1,1,1,1),s.clear(f.COLOR_BUFFER_BIT),s.setBlendingEnabled(!1),s.setStencilWriteMask(0),this._drawPhases(e,t,[a.WGLDrawPhase.HITTEST]),s.setBlendingEnabled(!0),this._hittestFBO.readPixels(0,0,i,i,6408,5121,y);for(var h=i*i,c=new Set,p=0;p<h;p++){var v=x[p];4294967295!==v&&c.add(v)}s.bindFramebuffer(d),s.setViewport(u.x,u.y,u.width,u.height);var _=[];return c.forEach(function(e){_.push(e)}),_},e.prototype._getPaintPass=function(e){if(this._passes||(this._passes=new Map),!this._passes.has(e))try{this._passes.set(e,new e)}catch(t){throw new Error("Tried to instantiate WGLPaintPass with unknown constructor: "+e+",\n"+t)}return this._passes.get(e)},e.prototype._getPaintPasses=function(e,t){var i=this;return t.getPaintPassTs(e).map(function(e){return i._getPaintPass(e)})},e.prototype._drawPhases=function(e,t,n,r){e.context.setStencilTestEnabled(!0);for(var a=0,o=n;a<o.length;a++){var s=o[a],l=r?this._getPaintPasses(s,r):[],u=i({},e,{drawPhase:s});l.forEach(function(t){return t.preRender(e,e.rendererInfo)});for(var d=0,f=t;d<f.length;d++)f[d].doRender(u);l.reverse().forEach(function(t){return t.postRender(e,e.rendererInfo)})}e.context.setStencilTestEnabled(!1)},e.prototype._debugTiles=function(e,t){n("esri-feature-tiles-debug")&&this._drawPhases(e,t,[a.WGLDrawPhase.DEBUG])},e.prototype._drawClippingRects=function(e,t){if(0!==t.length){var i=e.context;i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setClearStencil(0),i.clear(i.gl.STENCIL_BUFFER_BIT),i.setStencilWriteMask(255);for(var n=0,r=t.length;n<t.length;n++,r--){var o=t[n];o.attached&&(o.stencilRef=r)}this._drawPhases(e,t,[a.WGLDrawPhase.CLIP]),e.context.setColorMask(!0,!0,!0,!0)}},e}();t.default=b}.apply(null,n))||(e.exports=r)},1390:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.background={name:"background",shaders:{vertexShader:i.resolveIncludes("background/background.vert"),fragmentShader:i.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1527:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(354),i(340),i(716),i(1528),i(623),i(1531),i(1386),i(1547),i(671),i(745),i(698),i(711),i(385),i(796),i(377),i(417),i(1010),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_,m,g,y,x){function b(e){return{state:e.state,pixelRatio:e.pixelRatio,stationary:e.stationary}}return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._clipData=new Float32Array(8),t._upperLeft=c.create(),t._upperRight=c.create(),t._lowerLeft=c.create(),t._lowerRight=c.create(),t._mat2=h.create(),t._clipRendererInitialized=!1,t._contextVersion=null,t._labelFader=new l.default(t),t}return i(t,e),Object.defineProperty(t.prototype,"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0}),t.prototype.fadeInLabels=function(){this._labelFader.reset(),this.requestRender()},t.prototype.createElement=function(){var e=document.createElement("canvas");return e.setAttribute("class","esri-display-object"),e},t.prototype.setElement=function(e){this.element=e},t.prototype.useContextVersion=function(e){this._renderingContext||(this._contextVersion=e)},t.prototype.attach=function(t){if(this.attached)return!0;this._resizeCanvas(t);var i=_.createContextOrErrorHTML(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0},this._contextVersion);return this._renderingContext=new y(i),this._contextVersion=this._renderingContext.contextVersion,this.attached=!0,this._cachedRenderParams=b(t),this._painter||(this._painter=new u.default,this._painter.initialize(this._renderingContext)),e.prototype.attach.call(this,t)},t.prototype.detach=function(t){e.prototype.detach.call(this,t),this._boundFBO=null,this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null),this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO1=null),this._labelsFBO2&&(this._labelsFBO2.dispose(),this._labelsFBO2=null),this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null),this._clipVAO&&(this._clipVAO.dispose(),this._clipVAO=null,this._clipVBO=null),this._painter&&(this._painter.dispose(),this._painter=null),this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null),this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null),this._cachedRenderParams=null},t.prototype.renderChildren=function(e){var t=this.children;e.drawPhase=s.WGLDrawPhase.FILL|s.WGLDrawPhase.LINE|s.WGLDrawPhase.MARKER|s.WGLDrawPhase.TEXT;for(var i=t.length,r=0;r<i;r++){(u=t[r]).attached&&this.renderChild(u,e)}if(n("esri-featurelayer-webgl-labeling")){var a=e.context,o=a.getBoundFramebufferObject();a.bindFramebuffer(this._labelsFBO2);var l=e.stationary;if(a.setClearColor(0,0,0,l?0:1),a.clear(a.gl.COLOR_BUFFER_BIT),l){e.drawPhase=s.WGLDrawPhase.LABEL_ALPHA,e.labelFBO=this._labelsFBO1,e.labelStep=this._labelFader.step();for(r=0;r<i;r++){(u=t[r]).attached&&this.renderChild(u,e)}}else this._labelFader.reset();a.bindFramebuffer(o),e.labelFBO=this._labelsFBO2,e.drawPhase=s.WGLDrawPhase.LABEL;for(r=0;r<i;r++){var u;(u=t[r]).attached&&this.renderChild(u,e)}var d=this._labelsFBO2;this._labelsFBO2=this._labelsFBO1,this._labelsFBO1=d}},t.prototype.beforeRenderChildren=function(e,t){var i=t.context,r=t.state,a=t.pixelRatio,o=this._painter;if(o){i.enforceState(),o.update(r,a);var s=r.width,l=r.height,u=r.rotation;if(s=Math.round(s*a),l=Math.round(l*a),this._boundFBO=i.getBoundFramebufferObject(),!n("esri-featurelayer-webgl-labeling")||this._labelsFBO1&&this._labelsFBO1.width===s&&this._labelsFBO1.height===l||(this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO2.dispose()),this._labelsFBO1=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0}),i.bindFramebuffer(this._labelsFBO1),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),i.bindFramebuffer(this._boundFBO),this._labelsFBO2=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0})),!(r.spatialReference&&(r.spatialReference._isWrappable?r.spatialReference._isWrappable():r.spatialReference.isWrappable)))return void(this._clipFrame=!1);var d=f.toRadian(u),p=Math.abs(Math.cos(d)),v=Math.abs(Math.sin(d)),_=Math.round(s*p+l*v),g=Math.round(r.worldScreenWidth);if(_<=g)return void(this._clipFrame=!1);this._clipFBO&&this._clipFBO.width===s&&this._clipFBO.height===l||(this._clipFBO=new m(i,{colorTarget:0,depthStencilTarget:3,width:s,height:l}));var y=.5*s,x=.5*l,b=1/s,S=1/l,M=.5*g*a,I=.5*(s*v+l*p),w=this._upperLeft,V=this._upperRight,D=this._lowerLeft,z=this._lowerRight;c.set(w,-M,-I),c.set(V,M,-I),c.set(D,-M,I),c.set(z,M,I),h.identity(this._mat2),h.translate(this._mat2,this._mat2,[y,x]),0!==u&&h.rotate(this._mat2,this._mat2,d),c.transformMat2d(w,w,this._mat2),c.transformMat2d(V,V,this._mat2),c.transformMat2d(D,D,this._mat2),c.transformMat2d(z,z,this._mat2);var F=this._clipData;F.set([2*D[0]*b-1,2*(l-D[1])*S-1,2*z[0]*b-1,2*(l-z[1])*S-1,2*w[0]*b-1,2*(l-w[1])*S-1,2*V[0]*b-1,2*(l-V[1])*S-1]),this._clipRendererInitialized||this._initializeClipRenderer(i),this._clipVBO.setData(F),this._boundFBO=i.getBoundFramebufferObject(),i.bindFramebuffer(this._clipFBO),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),this._clipFrame=!0}},t.prototype.afterRenderChildren=function(e,t){var i=this._renderingContext;i.logIno(),this._clipFrame&&this._clipRendererInitialized&&(i.bindFramebuffer(this._boundFBO),this._boundFBO=null,i.bindVAO(this._clipVAO),i.bindProgram(this._clipStencilProgram),i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setStencilWriteMask(255),i.setStencilFunction(519,1,255),i.drawElements(4,6,5123,0),i.bindVAO(),i.setColorMask(!0,!0,!0,!0),i.setBlendingEnabled(!0),i.setStencilFunction(514,1,255),this._blitRenderer.render(i,this._clipFBO.colorTexture,9728,1),i.setStencilTestEnabled(!1))},t.prototype.doRender=function(t){var i=this.element.style;this.visible?(i.display="block",i.opacity=""+this.opacity,this._resizeCanvas(t),e.prototype.doRender.call(this,t),this._cachedRenderParams=b(t)):i.display="none"},t.prototype.takeScreenshot=function(e){if(!this._cachedRenderParams)return r.reject();this._cachedRenderParams.pixelRatio=e.pixelRatio;var t=e.framebufferWidth,i=e.framebufferHeight,n=e.region,a=document.createElement("canvas");a.width=t,a.height=i;var o=p.createEmptyImageData(n.width,n.height,a),s=this._renderingContext,l=m.create(s,{colorTarget:0,depthStencilTarget:3,width:t,height:i});s.bindFramebuffer(l),s.setViewport(0,0,t,i);var u=this._cachedRenderParams,d=this._renderingContext.gl;if(this._renderingContext.setClearColor(0,0,0,0),this._renderingContext.setClearDepth(1),this._renderingContext.setClearStencil(0),this._renderingContext.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT),u.context=this._renderingContext,u.painter=this._painter,this.beforeRenderChildren(u,u),null!=e.rotation){var f=u.state,h=f.clone();h.viewpoint.rotation=e.rotation,u.state=h,this.renderChildren(u),u.state=f}else this.renderChildren(u);this.afterRenderChildren(u,u),l.readPixels(n.x,i-(n.y+n.height),n.width,n.height,6408,5121,new Uint8Array(o.data.buffer)),s.bindFramebuffer();var c=p.encodeResult(o,e,a,{flipY:!0,premultipliedAlpha:!0});return r.resolve(c)},t.prototype.prepareChildrenRenderParameters=function(e){if(!this.attached||!this._renderingContext)return null;var t=b(e),i=this._renderingContext,n=i.gl;return i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT),i.setViewport(0,0,this.element.width,this.element.height),i.setDepthWriteEnabled(!1),t.context=i,t.painter=this._painter,t},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){return e.detach(t)},t.prototype.renderChild=function(e,t){return e.processRender(t)},t.prototype._resizeCanvas=function(e){var t=this.element,i=t.style,n=e.state,r=e.pixelRatio,a=Math.round(n.width*r),o=Math.round(n.height*r);t.width===a&&t.height===o||(t.width=a,t.height=o),i.width=n.width+"px",i.height=n.height+"px"},t.prototype._initializeClipRenderer=function(e){if(this._clipRendererInitialized)return!0;this._blitRenderer=new o;var t=d.stencil.attributes,i=g.createProgram(e,d.stencil);if(!i)return!1;var n=v.createVertex(e,35040,32),r=new Uint16Array([0,1,2,2,1,3]),a=v.createIndex(e,35044,r),s=new x(e,t,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:n},a);return this._clipStencilProgram=i,this._clipVBO=n,this._clipVAO=s,this._clipRendererInitialized=!0,!0},t}(a)}.apply(null,n))||(e.exports=r)},1528:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1529),i(385),i(417),i(381)],void 0===(r=function(e,t,i,n,r,a){return function(){function e(){this._initialized=!1}return e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},e.prototype.render=function(e,t,i,n){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(1,771,1,771),e.bindVAO(this._vertexArrayObject),e.bindProgram(this._program),t.setSamplingMode(i),e.bindTexture(t,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",n),e.drawArrays(5,0,4),e.bindVAO())},e.prototype._initialize=function(e){if(this._initialized)return!0;var t=i.bitBlit.attributes,o=r.createProgram(e,i.bitBlit);if(!o)return!1;var s=new Int8Array(16);s[0]=-1,s[1]=-1,s[2]=0,s[3]=0,s[4]=1,s[5]=-1,s[6]=1,s[7]=0,s[8]=-1,s[9]=1,s[10]=0,s[11]=1,s[12]=1,s[13]=1,s[14]=1,s[15]=1;var l=new a(e,t,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:n.createVertex(e,35044,s)});return this._program=o,this._vertexArrayObject=l,this._initialized=!0,!0},e}()}.apply(null,n))||(e.exports=r)},1529:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.bitBlit={name:"bitBlit",shaders:{vertexShader:i.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:i.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}}.apply(null,n))||(e.exports=r)},1530:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor = u_color;\n}\n","background.vert":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n}\n"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\n\nvarying mediump vec2 v_uv;\n\nvoid main() {\n  lowp vec4 color = texture2D(u_tex, v_uv);\n\n  // Note: output in pre-multiplied alpha for correct alpha compositing\n  gl_FragColor = color *  u_opacity;\n}\n","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_tex;\n}\n"},heatmap:{"heatmap.frag":"precision mediump float;\n\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nuniform mediump vec2 u_minmax;\nuniform lowp sampler2D u_gradient;\n\nvarying mediump vec2 v_uv;\nvarying mediump float v_slope;\n\nvec4 getColor(float intensity) {\n  float normalizedIntensity = clamp((intensity - u_minmax.x) * v_slope, 0.0, 1.0);\n\n  return texture2D(u_gradient, vec2(0.5, normalizedIntensity));\n}\n\nvoid main() {\n  // sample the intensity value\n  lowp vec4 color = texture2D(u_texture, v_uv);\n\n  // interpolate the color from the ramp using the intensity value\n  gl_FragColor = getColor(color.r) *  u_opacity;\n}\n","heatmap.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nuniform mediump vec2 u_minmax;\n\nvarying mediump vec2 v_uv;\nvarying mediump float v_slope;\n\nvoid main(void) {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_tex;\n  v_slope = 1.0 / (u_minmax.y - u_minmax.x);\n}\n"},highlight:{"blur.frag":"// A gaussian blur shader. It blurs the alpha channel of its input\n// according to 4 different sigma and stores the results into the\n// four channel of the target framebuffer.\n\n// It is intended to be called twice; the first time to perform an\n// horizontal blur, and a second time to perform a vertical blur.\n\n// This shader is used to turn the highlight mask into a highlight\n// map. The highlight map is an approximation of the signed distance\n// field of the mask.\n\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// Blur direction information. There are two possible\n// configurations that the host code can use.\n//  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\n//    case u_direction[0] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[2] = 1/WIDTH is in texel units\n//    and is used to sample the right texel from the texture map.\n//  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\n//    case u_direction[1] = 1 is expressed in pixel and is fed to\n//    the gauss function to produce the value of the gaussian weight\n//    for that pixel, while u_direction[3] = 1/HEIGHT is in texel units\n//    and is used to sample the right texel from the texture map.\nuniform mediump vec4 u_direction;\n\n// Source to destination channel selection matrix.\nuniform mediump mat4 u_channelSelector;\n\n// The highlight map is obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// This is the highlight mask if we have not blurred horizontally yet, otherwise\n// it is the horizontally blurred highlight map and blurring it one more time\n// vertically will complete the process.\nuniform sampler2D u_texture;\n\n// The gaussian kernel. Note that it lacks the normalization constant, because\n// we want to store it unnormalized in the highlight map (i.e. having a peak\n// value of 1). Note also that we are using the SIMD (single instruction, multiple\n// data) capabilities of the GPU to compute four different gaussian kernels, one\n// for each sigma.\nmediump vec4 gauss(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\n\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\n\n// Sample the input texture and accumulated its gaussian weighted value and the\n// total weight.\nvoid accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  // Computes the gaussian weights, one for each sigma.\n  // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n  mediump vec4 w = gauss(i * u_direction.xy);\n\n  // Accumumates the values.\n  // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n  tot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n\n  // Accumulates the weights.\n  weight += w;\n}\n\nvoid main(void) {\n  // Initialize accumulated values and weights to zero.\n  mediump vec4 tot = vec4(0.0, 0.0, 0.0, 0.0);\n  mediump vec4 weight = vec4(0.0, 0.0, 0.0, 0.0);\n\n  // Accumulates enough samples. These will be taken\n  // horizontally or vertically depending on the value\n  // of u_direction.\n  accumGauss(-5.0, tot, weight);\n  accumGauss(-4.0, tot, weight);\n  accumGauss(-3.0, tot, weight);\n  accumGauss(-2.0, tot, weight);\n  accumGauss(-1.0, tot, weight);\n  accumGauss(0.0, tot, weight);\n  accumGauss(1.0, tot, weight);\n  accumGauss(2.0, tot, weight);\n  accumGauss(3.0, tot, weight);\n  accumGauss(4.0, tot, weight);\n  accumGauss(5.0, tot, weight);\n\n  // Compute blurred values.\n  mediump vec4 rgba = tot / weight;\n\n  // Return the values. Note that each channel will contain\n  // the result of a different blur operation, one for each\n  // of the four chosen sigma.\n  gl_FragColor = vec4(rgba);\n}\n","highlight.frag":"// Takes as input the highlight map, estimated the signed distance field,\n// and shades the fragments according to their estimated distance from the\n// edge of the highlighted feature.\n\n// A shade texture is used to turn distance values into colors; the shade\n// texture is basically a color gradient and is recomputed on the host\n// every time that the user alters the highlight options.\n\n// Interpolated texture coordinates.\nvarying mediump vec2 v_texcoord;\n\n// The highlight map. Each channel is a blurred\n// version of the alpha channel of the highlight mask.\n//  - Channel 0 (red) corresponds to a gaussian blur with sigma = u_sigmas[0];\n//  - Channel 1 (green) corresponds to a gaussian blur with sigma = u_sigmas[1];\n//  - Channel 2 (blue) corresponds to a gaussian blur with sigma = u_sigmas[2];\n//  - Channel 3 (alpha) corresponds to a gaussian blur with sigma = u_sigmas[3];\n// As of today, only channel 3 is used for distance estimation.\n// But the availability of different amounts of blur leaves the\n// door open to multi-scale approaches.\nuniform sampler2D u_texture;\n\n// The highlight map was obtained by blurring the alpha channel of the highlight\n// mask accroding to these 4 values of the gaussian's sigma parameter.\nuniform mediump vec4 u_sigmas;\n\n// A 1-D texture used to shade the highlight.\nuniform sampler2D u_shade;\n\n// The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\nuniform mediump vec2 u_minMaxDistance;\n\n// Signed distance estimation.\nmediump float estimateDistance() {\n  // Use the largest sigma and the corresponding distance value stored in the\n  // last channel of the highlight map.\n  mediump float sigma = u_sigmas[3];\n  mediump float y = texture2D(u_texture, v_texcoord)[3];\n\n  // Estimates the distance by linearization and local inversion around\n  // the inflection point. The inflection point is in x = 0.\n  const mediump float y0 = 0.5;                           // Value of the convolution at the inflection point.\n  mediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\n  mediump float d = (y - y0) / m0;                        // Inversion of a local linearization.\n\n  // Return the estimated distance.\n  return d;\n}\n\n// Shading based on estimated distance.\nmediump vec4 shade(mediump float d) {\n  // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\n  mediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n\n  // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\n  // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\n  // banding artifacts.\n  // We don't really know if we need this or not.\n  mappedDistance = clamp(mappedDistance, 0.0, 1.0);\n\n  // Sample the 1-D shade texture on its center line (i.e. on t=0.5).\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\n\nvoid main(void) {\n  // Estimate the distance.\n  mediump float d = estimateDistance();\n\n  // Shade the distance.\n  gl_FragColor = shade(d);\n}\n","textured.vert":"// Identity vertex shader that outputs an untransformed 2-D vertex\n// and passes its texture coordinates unchanged to the interpolator.\n\n// Vertex position.\nattribute mediump vec2 a_position;\n\n// Texture coordinates.\nattribute mediump vec2 a_texcoord;\n\n// Texture coordinates to be interpolated.\nvarying mediump vec2 v_texcoord;\n\nvoid main(void) {\n  // Pass the position unchanged.\n  gl_Position = vec4(a_position, 0.0, 1.0);\n\n  // Pass the texture coordinates unchanged.\n  v_texcoord = a_texcoord;\n}\n"},materials:{fill:{"fill.frag":"precision lowp float;\nuniform lowp float u_opacity;\n\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\nvoid main()\n{\n#ifdef PATTERN\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  // sample the sprite mosaic\n  lowp vec4 color = texture2D(u_texture, samplePos);\n  gl_FragColor = u_opacity * v_opacity * v_color * color;\n#else\n  gl_FragColor = u_opacity * v_opacity * v_color;\n#endif // PATTERN\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  //if (gl_FragColor.a < 1.0 / 255.0) {\n  //  discard;\n  //}\n  gl_FragColor = v_id;\n#endif // ID\n}\n","fill.vert":"precision mediump float;\n\nattribute vec2 a_pos;\nattribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux;\n\nattribute float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\n\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/fill/vvUniforms.glsl>\n#include <materials/fill/vvFunctions.glsl>\n\n#ifdef PATTERN\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif // PATTERN\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n#ifdef VV_OPACITY\n  v_opacity = getVVOpacity(a_vv.y);\n#else\n  v_opacity = 1.0;\n#endif\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.x, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n\n#ifdef PATTERN\n  // calculate the pattern matrix\n  mat3 patternMatrix = mat3(1.0, 0.0, 0.0,\n                            0.0, 1.0, 0.0,\n                            0.0, 0.0, 1.0);\n  patternMatrix[0][0] = 1.0 / (u_zoomFactor * a_aux.x);\n  patternMatrix[1][1] = 1.0 / (u_zoomFactor * a_aux.y);\n\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from\n  // tile coordinates to texture coordinates.\n  v_tileTextureCoord = (patternMatrix * vec3(a_pos, 1.0)).xy;\n  v_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n#endif // PATTERN\n\n  float z = 2.0 * (1.0 - a_visible); // clip the vertex if the geometry isn't visible\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0);\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\n\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR)|| defined(VV_OPACITY)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_OPACITY\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n"},icon:{"icon.frag":"precision mediump float;\n\nuniform lowp sampler2D u_texture;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\n\n// we need the conversion function from RGBA to float\n#include <util/encoding.glsl>\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n#ifdef HEATMAP\nvarying mediump float v_heatmapWeight;\n#endif // HEATMAP\n\nconst float softEdgeRatio = 1.0; // use blur here if needed\n\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor = v_color;\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  float d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\n\n  // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n  float size = max(v_size.x, v_size.y);\n  float dist = d * size * softEdgeRatio;\n\n  // set the fragment's transparency according to the distance from the edge\n  fillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\n\n  // count for the outline\n  // therefore tint the entire icon area.\n  if (v_outlineWidth > 0.25) {\n    lowp vec4 outlinePixelColor = v_outlineColor;\n\n    // outlines can't be larger than the size of the symbol\n    float clampedOutlineSize = min(v_outlineWidth, size);\n\n    outlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n\n    // finally combine the outline and the fill colors (outline draws on top of fill)\n    gl_FragColor = v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor = v_transparency * fillPixelColor;\n  }\n#else // not an SDF\n  lowp vec4 texColor = texture2D(u_texture, v_tex);\n\n#ifdef HEATMAP\n  texColor.r *= v_heatmapWeight;\n#endif // HEATMAP\n\n  gl_FragColor = v_transparency * texColor;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","icon.vert":"precision mediump float;\n\n//const float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst vec2 SIGNED_BYTE_TO_UNSIGNED = vec2(128.0);\n\n// per quad (instance) attributes (20 bytes ==> equivalent of 5 bytes per vertex)\nattribute vec2 a_pos;\nattribute vec4 a_vertexOffsetAndTex;\nattribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\n\nattribute float a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n// the of the icon given in pixels\nvarying mediump vec2 v_size;\n\n// icon color. If is a picture-marker it is used to tint the texture color\nvarying lowp vec4 v_color;\n\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n#ifdef HEATMAP\nattribute float a_heatmapWeight;\nvarying mediump float v_heatmapWeight;\n#endif // HEATMAP\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/icon/vvUniforms.glsl>\n#include <materials/icon/vvFunctions.glsl>\n\nvoid main()\n{\n  vec2 a_offset = a_vertexOffsetAndTex.xy;\n  vec2 a_tex = a_vertexOffsetAndTex.zw + SIGNED_BYTE_TO_UNSIGNED; // offset to change from signed to unsigned byte\n  vec2 a_size = a_sizeAndOutlineWidth.xy;\n\n  // default values (we need them for the variations to come)\n  float a_angle = 0.0;\n  float delta_z = 2.0 * (1.0 - a_visible);\n  float depth = 0.0;\n  v_transparency = 1.0;\n\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  // vv size override the original symbol's size\n  float h = getVVMinMaxSize(a_vv.x, a_size.y);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  float h = u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  float h = getVVStopsSize(a_vv.x, a_size.y);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  float h = getVVUnitValue(a_vv.x, a_size.y);\n#endif // VV_SIZE_UNIT_VALUE\n\n  // make sure to preserve the aspect ratio of the symbol\n  vec2 size = vec2(h * a_size.x / a_size.y, h);\n  vec2 offset = a_offset * size / a_size;\n  v_size = size;\n#else\n#ifdef HEATMAP\n  // reconstruct the kernel size\n  a_size = 9.0 * a_size + 1.0;\n#endif // HEATMAP\n\n  vec2 offset = a_offset;\n  v_size = a_size;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef SDF\n  offset *= 2.0;\n#endif // SDF\n\n#ifdef VV_ROTATION\n  gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, delta_z, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, 0.0, 0.0);\n#else\n  gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, delta_z, 1.0) + u_extrudeMatrix * vec4(offset, 0.0, 0.0);\n#endif // VV_ROTATION\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#else\n  v_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\n  v_color = getVVColor(a_vv.y, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n  // output the texture coordinates and the transparency\n  v_tex = a_tex / u_mosaicSize;\n\n#ifdef SDF\n  v_outlineColor = a_outlineColor;\n  v_outlineWidth = a_sizeAndOutlineWidth.z;\n#endif // SDF\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n\n#ifdef HEATMAP\n  v_heatmapWeight = a_heatmapWeight;\n#endif // HEATMAP\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  // we need to multiply by 8 in order to translate to tile coordinates\n  float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\n#endif // VV_ROTATION\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif // VV_ROTATION\n"},label:{"label.frag":"precision lowp float;\n\nuniform mediump sampler2D u_referenceTex;\nuniform mediump vec2 u_screenSize;\nuniform mediump float u_pixelRatio;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying mediump float v_fadeStep;\n#else\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_color;\n#endif // ID\n\nconst vec3 epsilon = vec3(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n\nvoid main()\n{\n  mediump vec2 refTextPos = gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  mediump vec4 referenceFragment = texture2D(u_referenceTex, refTextPos);\n#ifdef ID\n  mediump float alpha = clamp(referenceFragment.a + v_fadeStep, 0.0, 1.0);\n  // fill the whole quad\n  gl_FragColor = vec4(alpha);\n#else\n  // read the fade alpha\n  lowp float fadeAlpha = referenceFragment.a;\n\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float sdfAlpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n  gl_FragColor = fadeAlpha * sdfAlpha * v_transparency * v_color;\n#endif\n}\n","label.vert":"precision mediump float;\n\nattribute vec2 a_pos;                  // 2 * 2 (2 x signed 16)\nattribute vec4 a_color;                // 4 (4 x unsigned byte)\nattribute vec2 a_vertexOffset;         // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\nattribute vec4 a_texAndSize;          // 4 (4 x unsigned byte) texture coordinatesm and font size. w is for the halo size\nattribute vec4 a_refSymbolAndPlacementOffset; // 4 (4 x unsigned byte) the offset of the reference symbol of the feature (x,y) and the placement offset (z, w) all given in pixels\n\nattribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\nattribute mediump vec2 a_visibilityRange; // 2 x unsigned byte;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\n\n// the opacity of the layer\nuniform mediump float u_opacity;\n\n// the curent zoom\nuniform mediump float u_zoomLevel; // the current zoom level X 10\nuniform lowp float u_mapRotation;\nuniform lowp float u_mapAligned;\n\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n#ifdef ID\nuniform mediump float u_fadeStep;\nvarying mediump float v_fadeStep;\n#else\nvarying mediump vec4 v_color;\n#endif // ID\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision = 1.0 / 8.0;\nconst float outlineScale = 1.0 / 10.0;\nconst float sdfFontSize = 24.0;\n\n// maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n// 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\nconst float maxSdfDistance = 8.0;\n\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\nvoid main()\n{\n  // make sure to clip the vertices in case that given record is marked as invisible\n  float z = 2.0 * (1.0 - a_visible);\n\n  // clip the vertex if we are beyond the visibility range of the vertex\n  // please note: min value of 0 is regarded infinity. max value of 255 is regarded infinity\n  z += 1.0 + sign(a_visibilityRange.x - u_zoomLevel);\n  z += 1.0 + sign(u_zoomLevel - a_visibilityRange.y);\n\n  // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n  mediump float halo = mod(a_pos, 2.0).x;\n\n  float fontSize = a_texAndSize.z;\n\n  float fontScale = fontSize / sdfFontSize;\n  // we need to scale the extrude matrix by the font-scale in order to get the right text size\n  mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n  float mapRotation = u_mapAligned * C_DEG_TO_RAD * -u_mapRotation;\n  float sinA = sin(mapRotation);\n  float cosA = cos(mapRotation);\n\n  mat4 mapRotationMat = mat4(cosA, sinA, 0.0, 0.0,\n                            -sinA, cosA, 0.0, 0.0,\n                              0.0,  0.0, 1.0, 0.0,\n                              0.0,  0.0, 0.0, 1.0);\n\n  vec4 refSymbolOffset = mapRotationMat *  vec4(a_refSymbolAndPlacementOffset.xy, 0.0, 0.0);\n\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) +\n                u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) +\n                u_extrudeMatrix * vec4(refSymbolOffset.xy + a_refSymbolAndPlacementOffset.zw, 0.0, 0.0) +\n                extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n  v_tex = a_texAndSize.xy / u_mosaicSize;\n  v_antialiasingWidth = 0.106 * sdfFontSize / fontSize / u_pixelRatio;\n  // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = halo * outlineScale * a_texAndSize.w / fontScale / maxSdfDistance;\n\n  v_transparency = u_opacity;\n\n#ifdef ID\n  v_fadeStep = u_fadeStep;\n#else\n  v_color = a_color;\n#endif // ID\n}\n"},line:{"constants.glsl":"const float thinLineHalfWidth = 1.0; // meaning that a 2 pixels line width is considered a thin line\nconst float thinLineWidthFactor = 1.1;\n","line.frag":"precision lowp float;\n\nuniform lowp float u_blur;\nuniform mediump float u_antialiasing;\n\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform mediump float u_zoomFactor;\n\nvarying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\nvarying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef SDF\nconst float sdfPatternHalfWidth = 15.5; // YF: assumed that the width will be set to 31\nconst float widthFactor = 2.0;\n\n// we need the conversion function from RGBA to float\n#include <util/encoding.glsl>\n#endif // SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n#include <materials/line/constants.glsl>\n\nvoid main()\n{\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n  mediump float thinLineFactor = max(thinLineWidthFactor * step(v_lineHalfWidth, thinLineHalfWidth), 1.0);\n\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist = length(v_normal) * v_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // when it is a thin line then use a slightly shallower slope in order to add more feathering\n  lowp float alpha = clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n\n#if defined(SDF)\n  mediump float lineHalfWidth = widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio = lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY = 0.5 + 0.5 * v_normal.y;\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // calculate the distance from the edge [-0.5, 0.5]\n  mediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n\n  // the distance is a proportional to the line width\n  float dist = d * lineHalfWidth;\n\n  lowp vec4 fillPixelColor = v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor = fillPixelColor;\n#elif defined(PATTERN)\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n  //              | -> line-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -> line-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n  mediump float relativeTexY = 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color = texture2D(u_texture, texCoord);\n\n  gl_FragColor = v_transparency * alpha * v_color * color;\n#else // solid line (no texture, no pattern)\n  // output the fragment color\n  gl_FragColor = v_transparency * alpha * v_color;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n  gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","line.vert":"precision mediump float;\n\nattribute vec2 a_pos;\nattribute vec4 a_id;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\n\nattribute float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\nuniform lowp float u_opacity; // the layer's opacity\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\n\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying lowp float v_transparency;\n\nconst float scale = 1.0 / 31.0;\n#ifdef SDF\nconst float widthFactor = 2.0;\n#else\nconst float widthFactor = 1.0;\n#endif\n\n\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n\nvarying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\nvarying mediump vec2 v_patternSize;\n#endif // PATTERN\n\n// we need to accumulated distance only if it is a pattern or an SDF line\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/line/vvUniforms.glsl>\n#include <materials/line/vvFunctions.glsl>\n\n// include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n#include <materials/line/constants.glsl>\n\nvoid main()\n{\n// size VV block\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  mediump float lineHalfWidth = 0.5 * getVVMinMaxSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  mediump float lineHalfWidth = 0.5 * u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  mediump float lineHalfWidth = 0.5 * getVVStopsSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  mediump float lineHalfWidth = 0.5 * getVVUnitValue(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_UNIT_VALUE\n\n#else // no VV\n  mediump float lineHalfWidth = a_accumulatedDistanceAndHalfWidth.y * scale;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_OPACITY\nv_transparency = u_opacity * getVVOpacity(a_vv.z);\n#else\nv_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nv_color = getVVColor(a_vv.y, a_color);\n#else\nv_color = a_color;\n#endif // VV_COLOR\n\n  // make sure to clip the vertices in case that the width of the line is 0 (or negative), or in case that the line is not visible\n  float z = 2.0 * (step(lineHalfWidth, 0.0) + (1.0 - a_visible));\n\n  // add an antialiasing distance. We use 0.2 rather than 0.5 in order to match the SVG renderer\n  // also limit the total line width to 1.3 pixels. Below this value lines don't look good compared to the SVG renderer\n  lineHalfWidth = max(lineHalfWidth, 0.45) + 0.2 * u_antialiasing;\n\n  // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n  // in practice, a thin line is a line who's half width vary from 0.45px to the value of thinLineHalfWidth, as the value\n  // is claped in line 221 above\n  mediump float thinLineFactor = max(thinLineWidthFactor * step(lineHalfWidth, thinLineHalfWidth), 1.0);\n\n  v_lineHalfWidth = lineHalfWidth;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ [0, 1])\n  // in a case of a thin line we move each vertex twice as far\n  mediump vec2 dist = thinLineFactor * widthFactor * lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n  // transform the vertex\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n  v_normal = a_offsetAndNormal.zw * scale;\n\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance = a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif // PATTERN || SDF\n\n#ifdef PATTERN\nv_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\nv_patternSize = vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif // PATTERN\n\n#ifdef ID\nv_id = a_id;\n#endif // ID\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  float f = (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\nattribute vec3 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n"},text:{"text.frag":"precision lowp float;\n\nuniform lowp sampler2D u_texture;\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist = texture2D(u_texture, v_tex).a;\n\n  // the edge distance if a factor of the outline width\n  float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  lowp float alpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n  gl_FragColor = alpha * v_color;\n\n#ifdef ID\n  if (gl_FragColor.a < 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor = v_id;\n#endif // ID\n}\n","text.vert":"precision mediump float;\n\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\nattribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\nattribute vec4 a_id;            // 4 (4 x unsigned byte)\nattribute vec4 a_color;         // 4 (4 x unsigned byte)\nattribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\nattribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\n\nattribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\nuniform float u_pixelRatio;\n\n// the opacity of the layer\nuniform mediump float u_opacity;\n\nvarying mediump vec4 v_color;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\n\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying mediump vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision = 1.0 / 8.0;\nconst float outlineScale = 1.0 / 10.0;\nconst float sdfFontSize = 24.0;\n\n// maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n// 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\nconst float maxSdfDistance = 8.0;\n\n#ifdef ID\nvarying highp vec4 v_id;\n#endif // ID\n\n// import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n#include <materials/text/vvUniforms.glsl>\n#include <materials/text/vvFunctions.glsl>\n\nvoid main()\n{\n  // make sure to clip the vertices in case that given record is marked as invisible\n  float z = 2.0 * (1.0 - a_visible);\n\n  // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n  mediump float halo = mod(a_pos, 2.0).x;\n\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  // vv size override the original symbol's size\n  vec2 size = vec2(getVVMinMaxSize(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n  vec2 size = vec2(u_vvSizeScaleStopsValue);\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n  vec2 size = vec2(getVVStopsSize(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  vec2 size = vec2(getVVUnitValue(a_vv.x, a_texFontSize.z));\n#endif // VV_SIZE_UNIT_VALUE\n\n  float fontSize = size.x;\n#else // this generic case, no VV\n  float fontSize = a_texFontSize.z;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  float fontScale = fontSize / sdfFontSize;\n  // we need to scale the extrude matrix by the font-scale in order to get the right text size\n  mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  //gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n#ifdef VV_ROTATION\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * getVVRotation(a_vv.w) * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n#else\n  gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n#endif // VV_ROTATION\n\n  v_tex = a_texFontSize.xy / u_mosaicSize;\n  v_antialiasingWidth = 0.105 * sdfFontSize / fontSize / u_pixelRatio;\n  // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n  v_edgeDistanceOffset = halo * outlineScale * a_texFontSize.w / fontScale / maxSdfDistance;\n\n#ifdef VV_OPACITY\n  v_transparency = getVVOpacity(a_vv.z);\n#else\n  v_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\n  // we don't want to override the halo color\n  v_color = halo * a_color + (1.0 - halo) * getVVColor(a_vv.y, a_color);\n#else\n  v_color = a_color;\n#endif // VV_COLOR\n\n#ifdef ID\n  v_id = a_id;\n#endif // ID\n}\n","vvFunctions.glsl":"bool isNan(float val) {\n  return !( val < 0.0 || 0.0 < val || val == 0.0 );\n}\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  // we need to multiply by 8 in order to translate to tile coordinates\n  float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n}\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n\n  for (int i = 1; i < VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n      float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n\n  if (opacityValue <= u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n\n  for (int i = 1; i < VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] >= opacityValue) {\n      float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  // YF TODO: if the symbol has rotation we need to combine the symbo's rotation with the VV one\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n\n  float rotation = rotationValue;\n  if (u_vvRotationType == 1.0) {\n    rotation = 90.0 - rotation;\n  }\n\n  float angle = C_DEG_TO_RAD * rotation;\n\n  float sinA = sin(angle);\n  float cosA = cos(angle);\n\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\n#endif // VV_ROTATION\n\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\n\nvec4 getVVColor(float colorValue, vec4 fallback) {\n  if (isNan(colorValue)) {\n    return fallback;\n  }\n\n  if (colorValue <= u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n\n  for (int i = 1; i < VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] >= colorValue) {\n      float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif // VV_COLOR\n","vvUniforms.glsl":"#if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\nattribute vec4 a_vv;\n#endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n#ifdef VV_COLOR\nuniform float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif // VV_COLOR\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform vec4 u_vvSizeMinMaxValue;\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\nuniform float u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\nuniform float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\nuniform float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif // VV_SIZE_UNIT_VALUE\n\n#ifdef VV_OPACITY\nuniform float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif // VV_OPACITY\n\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif // VV_ROTATION\n"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}\n","stencil.vert":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n}\n"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color = texture2D(u_texture, v_tex);\n  gl_FragColor = 0.75 * color;\n}\n","tileInfo.vert":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex = a_pos;\n}\n"},util:{"encoding.glsl":"// Factors to convert rgba back to float\nconst vec4 rgba2float_factors = vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\n\nfloat rgba2float(vec4 rgba) {\n  // Convert components from 0->1 back to 0->255 and then\n  // add the components together with their corresponding\n  // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n  return dot(rgba, rgba2float_factors);\n}\n"}}}.apply(null,n))||(e.exports=r)},1531:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===t&&(t=250),this.duration=t,this._lastTime=0,this._startTime=0,this._parent=e}return e.prototype.reset=function(){this._lastTime,this._startTime=performance.now()},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,this._parent.requestRender(),0;var t=e-this._lastTime;this._lastTime=e;var i=2*this.duration;return e-this._startTime<i&&this._parent.requestRender(),t/this.duration},e}();t.default=i}.apply(null,n))||(e.exports=r)},1532:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(623),i(1387),i(969),i(417)],void 0===(r=function(e,t,i,n,r,a){return function(){function e(){this._programByKey=new Map,this.isInitialize=!1}return e.prototype.dispose=function(){this._programCache&&this._programCache.dispose()},e.prototype.initialize=function(e){this.isInitialize||(this._programCache=new a.ProgramCache(e),this.isInitialize=!0)},e.prototype.getProgram=function(e,t){if(e|=t===i.WGLDrawPhase.HITTEST?8:0,e|=t===i.WGLDrawPhase.HIGHLIGHT?16:0,this._programByKey[e])return this._programByKey[e];var a=n.getMaterialVariations(e),o=null;switch(a.geometryType){case i.WGLGeometryType.MARKER:o=this._programCache.getProgram(r.icon,a.programOptions);break;case i.WGLGeometryType.TEXT:o=this._programCache.getProgram(r.text,a.programOptions);break;case i.WGLGeometryType.LABEL:o=this._programCache.getProgram(r.label,a.programOptions);break;case i.WGLGeometryType.FILL:o=this._programCache.getProgram(r.fill,a.programOptions);break;case i.WGLGeometryType.LINE:o=this._programCache.getProgram(r.line,a.programOptions)}return o&&(this._programByKey[e]=o),o},e}()}.apply(null,n))||(e.exports=r)},1535:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(774),i(1022),i(1281),i(1390),i(1536),i(725),i(385),i(417),i(371),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){var t=e.call(this)||this;return t._initialized=!1,t._maxWidth=0,t._color=new Float32Array([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null),this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null),this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null),this._canvas=null},t.prototype.draw=function(e,t){var i=e.context;if(t.status!==l.TileStatus.INITIALIZED){this._initialized||this._initialize(i),i.bindVAO(this._outlineVertexArrayObject),i.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._outlineProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_coord_range",n.TILE_SIZE),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),i.setLineWidth(2),i.drawArrays(3,0,4),i.bindVAO();var r=this._getTexture(i,t);r&&(i.bindVAO(this._tileInfoVertexArrayObject),i.bindProgram(this._tileInfoProgram),i.bindTexture(r,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",r.descriptor.width,r.descriptor.height),i.drawArrays(5,0,4),i.bindVAO())}},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=d.createProgram(e,o.background),i=d.createProgram(e,s.tileInfo),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},r=new Int8Array([0,0,1,0,1,1,0,1]),a=u.createVertex(e,35044,r),l=new h(e,o.background.attributes,n,{geometry:a}),f=new Int8Array([0,0,1,0,0,1,1,1]),c=u.createVertex(e,35044,f),p=new h(e,s.tileInfo.attributes,n,{geometry:c});return this._outlineProgram=t,this._tileInfoProgram=i,this._outlineVertexArrayObject=l,this._tileInfoVertexArrayObject=p,this._initialized=!0,!0},t.prototype._getTexture=function(e,t){if(t.texture)return t.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var i=t.key.id,n=this._canvas.getContext("2d");n.font="24px sans-serif",n.textAlign="left",n.textBaseline="middle";var a=n.measureText(i),o=Math.pow(2,Math.ceil(r.log2(a.width+2)));return o>this._maxWidth&&(this._maxWidth=o),n.clearRect(0,0,this._maxWidth,32),n.fillStyle="blue",n.fillText(i,0,16),t.texture=new f(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),t.texture},t}(a.default);t.default=c}.apply(null,n))||(e.exports=r)},1536:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.tileInfo={name:"tileInfo",shaders:{vertexShader:i.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:i.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1537:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(820),i(774),i(1281),i(1390),i(385),i(417),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=e.call(this)||this;return t._color=n.create(),t._initialized=!1,t._color.set([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)},t.prototype.draw=function(e,t){var i=e.context;this._initialized||this._initialize(i),i.setStencilFunctionSeparate(1032,519,t.stencilRef,255),i.bindVAO(this._solidVertexArrayObject),i.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",r.TILE_SIZE),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),i.drawArrays(5,0,4),i.bindVAO()},t.prototype._initialize=function(e){if(this._initialized)return!0;var t=l.createProgram(e,o.background);if(!t)return!1;var i=new Int8Array([0,0,1,0,0,1,1,1]),n=s.createVertex(e,35044,i),r=new u(e,o.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:n});return this._solidProgram=t,this._solidVertexArrayObject=r,this._initialized=!0,!0},t}(a.default);t.default=d}.apply(null,n))||(e.exports=r)},1538:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isInitialized=!1,t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.FILL},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,a=e.painter,o=e.rendererInfo,s=e.requiredLevel,l=e.stationary,u=i.indexCount,d=i.indexFrom;this._initialize();var f=i.materialInfo.materialKeyInfo,h=e.painter.materialManager.getProgram(i.materialInfo.materialKey,e.drawPhase);if(h){r.bindProgram(h);var c=this._getVAO(r,t,f.hasVV());if(r.bindVAO(c),i.materialInfo.texBindingInfo.length>0){var p=i.materialInfo.texBindingInfo[0],v=p.pageId,_=e.painter.textureManager.sprites;this._spritesTextureSize[0]=_.getWidth(v),this._spritesTextureSize[1]=_.getHeight(v);var m=1/Math.pow(2,s-t.key.level)/e.pixelRatio;h.setUniform1f("u_zoomFactor",m);var g=l?9728:9729;a.textureManager.bindSpritePage(r,v,p.unit,g),h.setUniform1i(p.semantic,p.unit),h.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}h.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),h.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),h.setUniform1f("u_opacity",1),f.vvColor&&(h.setUniform1fv("u_vvColorValues",o.vvColorValues),h.setUniform4fv("u_vvColors",o.vvColors)),f.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",o.vvOpacityValues),h.setUniform1fv("u_vvOpacities",o.vvOpacities)),r.drawElements(4,u,5125,4*d),r.bindVAO(null)}},t.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},this._isInitialized=!0},t.prototype._getVAO=function(e,t,i){if(t.fillGeometry.vao)return t.fillGeometry.vao;var n=t.fillGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],a=t.fillGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],l=t.fillGeometry.indexBuffer;return n&&l?(t.fillGeometry.vao=new s(e,o.fill.attributes,i?this._fillVertexAttributeLayoutVV:this._fillVertexAttributeLayout,{geometry:n,visibility:a},l),t.fillGeometry.vao):null},t}(a.default);t.default=l}.apply(null,n))||(e.exports=r)},1539:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_texAndSize",count:4,type:5121,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_refSymbolAndPlacementOffset",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}],visibilityRange:[{name:"a_visibilityRange",count:2,type:5121,offset:0,stride:2,normalized:!1,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.drawGeometry=function(e,t,i,r){if(e.requiredLevel===t.key.level){var a=e.context,o=e.painter,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,d=i.indexFrom,f=e.drawPhase===n.WGLDrawPhase.LABEL_ALPHA,h=l.materialKey;f&&(h|=8);var c=o.materialManager.getProgram(h,s);if(c){a.setStencilTestEnabled(!1),a.bindProgram(c);var p=this._getVAO(a,t);if(a.bindVAO(p),f)a.setBlendingEnabled(!1),c.setUniform1f("u_fadeStep",e.labelStep);else{var v=l.texBindingInfo[0],_=v.pageId;o.textureManager.bindGlyphsPage(a,_,v.unit),c.setUniform1i(v.semantic,v.unit)}var m=o.textureManager.glyphs;this._glyphsTextureSize[0]=m.width/4,this._glyphsTextureSize[1]=m.height/4;var g=o.extrudeNoRotationMatrix;a.bindTexture(e.labelFBO.colorTexture,3),c.setUniform1i("u_referenceTex",3),c.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),c.setUniformMatrix4fv("u_extrudeMatrix",g),c.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),c.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),c.setUniform1f("u_pixelRatio",e.pixelRatio),c.setUniform1f("u_opacity",1),c.setUniform1f("u_zoomLevel",10*e.displayLevel),c.setUniform1f("u_mapRotation",e.state.rotation),c.setUniform1f("u_mapAligned",0),c.setUniform2fv("u_screenSize",e.state.size),a.drawElements(4,u,5125,4*d),a.bindVAO(null),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!0)}}},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LABEL},t.prototype._getVAO=function(e,t){var i=t.labelGeometry;if(i&&i.vao)return i.vao;var n=i.vertexBufferMap[r.C_VBO_GEOMETRY],a=i.vertexBufferMap[r.C_VBO_VISIBILITY],l=i.vertexBufferMap[r.C_VBO_VISIBILITY_RANGE],u=i.indexBuffer;return n&&u&&l?(i.vao=new s(e,o.label.attributes,this._vertexAttributeLayout,{geometry:n,visibility:a,visibilityRange:l},u),i.vao):null},t}(a.default);t.default=l}.apply(null,n))||(e.exports=r)},1540:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.LINE},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,a=e.painter,o=e.rendererInfo,s=e.requiredLevel,l=e.drawPhase,u=i.indexFrom,d=i.indexCount,f=i.materialInfo,h=f.materialKeyInfo,c=a.materialManager.getProgram(f.materialKey,l);if(c){r.bindProgram(c);var p=this._getVAO(r,t,h.hasVV());r.bindVAO(p);var v=1/e.pixelRatio;if(f.texBindingInfo.length>0){var _=f.texBindingInfo[0],m=_.pageId,g=a.textureManager.sprites;this._spritesTextureSize[0]=g.getWidth(m),this._spritesTextureSize[1]=g.getHeight(m),a.textureManager.bindSpritePage(r,m,_.unit),c.setUniform1i(_.semantic,_.unit),c.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}var y=Math.pow(2,s-t.key.level)/e.pixelRatio;c.setUniform1f("u_zoomFactor",y),c.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),c.setUniformMatrix4fv("u_extrudeMatrix",a.extrudeMatrix),c.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),c.setUniform1f("u_opacity",1),c.setUniform1f("u_blur",0+v),c.setUniform1f("u_antialiasing",v),c.setUniform1f("u_zoomFactor",y),h.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",o.vvSizeMinMaxValue),h.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",o.vvSizeScaleStopsValue),h.vvSizeFieldStops&&(c.setUniform1fv("u_vvSizeFieldStopsValues",o.vvSizeFieldStopsValues),c.setUniform1fv("u_vvSizeFieldStopsSizes",o.vvSizeFieldStopsSizes)),h.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",o.vvSizeUnitValueToPixelsRatio),h.vvColor&&(c.setUniform1fv("u_vvColorValues",o.vvColorValues),c.setUniform4fv("u_vvColors",o.vvColors)),h.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",o.vvOpacityValues),c.setUniform1fv("u_vvOpacities",o.vvOpacities)),r.setFaceCullingEnabled(!0),r.setFrontFace(2305),r.setCullFace(1029),r.drawElements(4,d,5125,4*u),r.setFaceCullingEnabled(!1),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i){if(t.lineGeometry.vao)return t.lineGeometry.vao;var n=t.lineGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],a=t.lineGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],l=t.lineGeometry.indexBuffer;return n&&l?(t.lineGeometry.vao=new s(e,o.line.attributes,i?this._lineVertexAttributeLayoutVV:this._lineVertexAttributeLayout,{geometry:n,visibility:a},l),t.lineGeometry.vao):null},t}(a.default);t.default=l}.apply(null,n))||(e.exports=r)},1541:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(371),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:24,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:40,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:40,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:40,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:40,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:40,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:40,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:24,stride:40,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:28,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.MARKER},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,a=e.painter,o=e.rendererInfo,s=e.drawPhase,l=i.indexCount,u=i.indexFrom,d=i.materialInfo,f=d.materialKeyInfo,h=f.heatmap,c=a.materialManager.getProgram(d.materialKey,s);if(c){r.bindProgram(c);var p=this._getVAO(r,t,f.hasVV(),h);if(r.bindVAO(p),h){var v=this._getIntensityTexture(r,o.heatmapParameters);r.bindTexture(v,1),c.setUniform1i("u_texture",1),this._spritesTextureSize[0]=Math.round(o.heatmapParameters.radius),this._spritesTextureSize[1]=Math.round(o.heatmapParameters.radius)}else{var _=d.texBindingInfo[0],m=_.pageId;a.textureManager.bindSpritePage(r,m,_.unit),c.setUniform1i(_.semantic,_.unit);var g=a.textureManager.sprites;this._spritesTextureSize[0]=g.getWidth(m)/4,this._spritesTextureSize[1]=g.getHeight(m)/4}var y=o.vvMaterialParameters.vvRotationEnabled&&"geographic"===o.vvMaterialParameters.vvRotationType?a.extrudeMatrix:a.extrudeNoRotationMatrix;c.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),c.setUniformMatrix4fv("u_extrudeMatrix",y),c.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),c.setUniform2fv("u_mosaicSize",this._spritesTextureSize),c.setUniform1f("u_opacity",1),f.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",o.vvSizeMinMaxValue),f.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",o.vvSizeScaleStopsValue),f.vvSizeFieldStops&&(c.setUniform1fv("u_vvSizeFieldStopsValues",o.vvSizeFieldStopsValues),c.setUniform1fv("u_vvSizeFieldStopsSizes",o.vvSizeFieldStopsSizes)),f.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",o.vvSizeUnitValueToPixelsRatio),f.vvColor&&(c.setUniform1fv("u_vvColorValues",o.vvColorValues),c.setUniform4fv("u_vvColors",o.vvColors)),f.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",o.vvOpacityValues),c.setUniform1fv("u_vvOpacities",o.vvOpacities)),f.vvRotation&&c.setUniform1f("u_vvRotationType","geographic"===o.vvMaterialParameters.vvRotationType?0:1),r.drawElements(4,l,5125,4*u),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,n){if(t.iconGeometry.vao)return t.iconGeometry.vao;var a=t.iconGeometry.vertexBufferMap[r.C_VBO_GEOMETRY],s=t.iconGeometry.vertexBufferMap[r.C_VBO_VISIBILITY],u=t.iconGeometry.indexBuffer;return a&&u?(t.iconGeometry.vao=new l(e,o.icon.attributes,i?this._iconVertexAttributesWithVV:n?this._iconVertexAttributesWithHeatmap:this._iconVertexAttributes,{geometry:a,visibility:s},u),t.iconGeometry.vao):null},t.prototype._getIntensityTexture=function(e,t){if(t.intensityKernel&&!t.refreshIntensityKernel)return t.intensityKernel;t.intensityKernel&&(t.intensityKernel.dispose(),t.intensityKernel=null);for(var i=t.radius,n=t.kernelSize,r=t.blurRadius,a=i*i,o=[],l=-1;++l<n;)o[l]=Math.exp(-Math.pow(l-r,2)/(2*a))/(Math.sqrt(2*Math.PI)*(i/2));for(var u,d,f,h=[],c=0;c<n;c++)for(d=o[c],l=0;l<n;l++)f=c*n+l,u=o[l],h[4*f+0]=d*u,h[4*f+1]=0,h[4*f+2]=0,h[4*f+3]=1;var p=new s(e,{target:3553,pixelFormat:6408,internalFormat:e.capabilities.colorBufferFloat.RGBA32F,dataType:5126,samplingMode:e.capabilities.textureFloatLinear?9729:9728,wrapMode:33071,width:n,height:n},new Float32Array(h));return t.intensityKernel=p,t.refreshIntensityKernel=!1,p},t}(a.default);t.default=u}.apply(null,n))||(e.exports=r)},1542:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(623),i(675),i(1013),i(969),i(381)],void 0===(r=function(e,t,i,n,r,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return n.WGLGeometryType.TEXT},t.prototype.drawGeometry=function(e,t,i,n){var r=e.context,a=e.painter,o=e.rendererInfo,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,d=i.indexFrom,f=l.materialKeyInfo,h=f.vvSizeMinMaxValue||f.vvSizeScaleStops||f.vvSizeFieldStops||f.vvSizeUnitValue||f.vvColor||f.vvRotation||f.vvOpacity,c=a.materialManager.getProgram(l.materialKey,s);if(c){r.bindProgram(c);var p=this._getVAO(r,t,h,this.getGeometryType());r.bindVAO(p);var v=l.texBindingInfo[0],_=v.pageId;a.textureManager.bindGlyphsPage(r,_,v.unit),c.setUniform1i(v.semantic,v.unit);var m=a.textureManager.glyphs;this._glyphsTextureSize[0]=m.width/4,this._glyphsTextureSize[1]=m.height/4;var g=o.vvMaterialParameters.vvRotationEnabled&&"geographic"===o.vvMaterialParameters.vvRotationType?a.extrudeMatrix:a.extrudeNoRotationMatrix;c.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),c.setUniformMatrix4fv("u_extrudeMatrix",g),c.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),c.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),c.setUniform1f("u_pixelRatio",1),c.setUniform1f("u_opacity",1),f.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",o.vvSizeMinMaxValue),f.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",o.vvSizeScaleStopsValue),f.vvSizeFieldStops&&(c.setUniform1fv("u_vvSizeFieldStopsValues",o.vvSizeFieldStopsValues),c.setUniform1fv("u_vvSizeFieldStopsSizes",o.vvSizeFieldStopsSizes)),f.vvSizeUnitValue&&c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",o.vvSizeUnitValueToPixelsRatio),f.vvColor&&(c.setUniform1fv("u_vvColorValues",o.vvColorValues),c.setUniform4fv("u_vvColors",o.vvColors)),f.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",o.vvOpacityValues),c.setUniform1fv("u_vvOpacities",o.vvOpacities)),f.vvRotation&&c.setUniform1f("u_vvRotationType","geographic"===o.vvMaterialParameters.vvRotationType?0:1),r.drawElements(4,u,5125,4*d),r.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,n){var a=t.getGeometry(n);if(a&&a.vao)return a.vao;var l=a.vertexBufferMap[r.C_VBO_GEOMETRY],u=a.vertexBufferMap[r.C_VBO_VISIBILITY],d=a.indexBuffer;return l&&d?(a.vao=new s(e,o.text.attributes,i?this._vertexAttributeLayoutVV:this._vertexAttributeLayout,{geometry:l,visibility:u},d),a.vao):null},t}(a.default);t.default=l}.apply(null,n))||(e.exports=r)},1543:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(354),i(1544),i(1546)],void 0===(r=function(e,t,i,n,r){return function(){function e(){this._hlRenderer=new n,this._hlSurfaces=new r,this._width=void 0,this._height=void 0,this._adjustedWidth=void 0,this._adjustedHeight=void 0}return e.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose(),this._hlRenderer&&this._hlRenderer.dispose(),this._boundFBO=null},e.prototype.setup=function(e,t,i){this._width=t,this._height=i;var n=t%4,r=i%4;t+=n<2?-n:4-n,i+=r<2?-r:4-r,this._adjustedWidth=t,this._adjustedHeight=i,this._boundFBO=e.getBoundFramebufferObject();var a=Math.round(.75*t),o=Math.round(.75*i);this._hlRenderer.setup(e,a,o),this._hlSurfaces.setup(e,a,o)},e.prototype.setHighlightOptions=function(e){this._hlRenderer.setHighlightOptions({fillColor:e.fillColor,outlineColor:e.outlineColor,outlineWidth:.75*e.outlineWidth,outerHaloWidth:.75*e.outerHaloWidth,innerHaloWidth:.75*e.innerHaloWidth,outlinePosition:.75*e.outlinePosition})},e.prototype.startMaskDraw=function(e){e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.setClearStencil(0),e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.STENCIL_BUFFER_BIT),e.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight)},e.prototype.draw=function(e){e.setStencilTestEnabled(!1),e.setBlendingEnabled(!1),e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex),i("esri-feature-highlight-debug")?(e.bindFramebuffer(null),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex)):(e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex),e.bindFramebuffer(this._boundFBO),e.setBlendingEnabled(!0),e.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex),this._boundFBO=null)},e}()}.apply(null,n))||(e.exports=r)},1544:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1545),i(385),i(417),i(371),i(381)],void 0===(r=function(e,t,i,n,r,a,o){var s=[void 0,void 0,void 0,1],l=[3,4],u=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function e(){this._width=void 0,this._height=void 0,this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3},this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources.shadeTex.dispose(),this._resources=null)},e.prototype.preBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",u),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.finalBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",d),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.renderHighlight=function(e,t){e.bindTexture(t,l[0]),e.bindTexture(this._resources.shadeTex,l[1]),e.bindProgram(this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype._initialize=function(e,t,u){this._width=t,this._height=u;var d=new n(e,34962,35044,new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]).buffer),f=new o(e,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d}),h=r.createProgram(e,i.highlight),c=r.createProgram(e,i.blur);h.setUniform1i("u_texture",l[0]),h.setUniform1i("u_shade",l[1]),h.setUniform4fv("u_sigmas",s),c.setUniform1i("u_texture",l[0]),c.setUniform4fv("u_sigmas",s);var p=new a(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:d,quadVAO:f,highlightProgram:h,blurProgram:c,shadeTex:p}},e.prototype.setHighlightOptions=function(e){function t(e,t,i){h[0]=(1-i)*e[0]+i*t[0],h[1]=(1-i)*e[1]+i*t[1],h[2]=(1-i)*e[2]+i*t[2],h[3]=(1-i)*e[3]+i*t[3]}if(this._highlightOptions=e,this._resources){var i=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth,n=e.outlinePosition-e.outlineWidth/2,r=e.outlinePosition+e.outlineWidth/2,a=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth,o=Math.sqrt(Math.PI/2)*s[3],l=Math.abs(i)>o?Math.round(10*(Math.abs(i)-o))/10:0,u=Math.abs(a)>o?Math.round(10*(Math.abs(a)-o))/10:0;l&&!u?console.warn("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&u?console.warn("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&u&&console.warn("The highlight is "+Math.max(l,u)+"px away from the edge of the feature; consider reducing some width values.");for(var d,f=new Uint8Array(1024),h=[void 0,void 0,void 0,void 0],c=0;c<256;++c)(d=i+c/255*(a-i))<i?(f[4*c+0]=0,f[4*c+1]=0,f[4*c+2]=0,f[4*c+3]=0):d<n?t([0,0,0,0],e.outlineColor,(d-i)/(n-i)):d<r?(h[0]=e.outlineColor[0],h[1]=e.outlineColor[1],h[2]=e.outlineColor[2],h[3]=e.outlineColor[3]):d<a?t(e.outlineColor,e.fillColor,(d-r)/(a-r)):(f[4*c+0]=e.fillColor[0],f[4*c+1]=e.fillColor[1],f[4*c+2]=e.fillColor[2],f[4*c+3]=e.fillColor[3]),f[4*c+0]=255*h[0]*h[3],f[4*c+1]=255*h[1]*h[3],f[4*c+2]=255*h[2]*h[3],f[4*c+3]=255*h[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[i,a]),this._resources.shadeTex.updateData(0,0,0,256,1,f)}},e.prototype.setup=function(e,t,i){this._resources?(this._width=t,this._height=i):(this._initialize(e,t,i),this.setHighlightOptions(this._highlightOptions))},e}()}.apply(null,n))||(e.exports=r)},1545:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.highlight={name:"highlight",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}},t.blur={name:"blur",shaders:{vertexShader:i.resolveIncludes("highlight/textured.vert"),fragmentShader:i.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}}.apply(null,n))||(e.exports=r)},1546:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(377),i(371)],void 0===(r=function(e,t,i,n){function r(e,t,r){var a=new n(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:t,height:r,samplingMode:9729});return[a,i.createWithAttachments(e,a,{colorTarget:0,depthStencilTarget:2})]}return function(){function e(){this._width=void 0,this._height=void 0,this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)},e.prototype._initialize=function(e,t,i){this._width=t,this._height=i;var n=r(e,t,i),a=n[0],o=n[1],s=r(e,t,i),l=s[0],u=s[1];this._resources={sharedBlur1Tex:a,sharedBlur1Fbo:o,sharedBlur2Tex:l,sharedBlur2Fbo:u}},e.prototype.setup=function(e,t,i){!this._resources||this._width===t&&this._height===i||this.dispose(),this._resources||this._initialize(e,t,i)},Object.defineProperty(e.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=r)},1547:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.stencil={name:"stencil",shaders:{vertexShader:i.resolveIncludes("stencil/stencil.vert"),fragmentShader:i.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}}.apply(null,n))||(e.exports=r)},1581:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1052),i(1277),i(349)],void 0===(r=function(e,t,i,n,r){function a(e,t,i){r.packFloatRGBA(e,t,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.packFloat=a;var o=function(){function e(){}return e.checkSDF=function(e){return!0},e.prototype._extractGeometry=function(e){if(!e)return null;var t=e.symbolLayers;if(!t||1!==t.length)return null;var n=t[0];if(!n)return null;var r=n.markerGraphics;if(!r||1!==r.length)return null;var a=r[0];if(!a)return null;var o=a.geometry;if(!o||!o.rings)return null;for(var s=[],l=0,u=o.rings;l<u.length;l++){for(var d=[],f=0,h=u[l];f<h.length;f++){var c=h[f];d.push(new i.Point(c[0],c[1]))}s.push(d)}return s},e.prototype._getEnvelope=function(e){for(var t=1/0,i=-1/0,r=1/0,a=-1/0,o=0,s=e;o<s.length;o++)for(var l=0,u=s[o];l<u.length;l++){var d=u[l];d.x<t&&(t=d.x),d.x>i&&(i=d.x),d.y<r&&(r=d.y),d.y>a&&(a=d.y)}return new n(t,r,i-t,a-r)},e.prototype.buildSDF=function(e){var t=this._extractGeometry(e);if(!t)return null;var i=this._getEnvelope(t);if(i.width<=0||i.height<=0)return null;for(var n=Math.floor(31.5),r=(128-2*(n+0+1))/Math.max(i.width,i.height),a=Math.round(i.width*r),o=Math.round(i.height*r),s=a+2*n,l=o+2*n,u=0,d=t;u<d.length;u++)for(var f=0,h=d[u];f<h.length;f++){var c=h[f];c.x-=i.x,c.y-=i.y,c.x*=r,c.y*=r,c.x+=n-.5,c.y+=n-.5}var p=this._dist_map(t,s,l,n);return this._sign_dist_map(t,s,l,n,p),[this._encodeDistMap(p,n),s,l,a,o,r]},e.prototype._dist_map=function(e,t,i,n){for(var r=t*i,a=new Float32Array(r),o=n*n+1,s=0;s<r;++s)a[s]=o;for(var l=0,u=e;l<u.length;l++){var d=u[l],f=d.length;for(s=1;s<f;++s){var h=d[s-1],c=d[s],p=void 0,v=void 0;h.x<c.x?(p=h.x,v=c.x):(p=c.x,v=h.x);var _=void 0,m=void 0;h.y<c.y?(_=h.y,m=c.y):(_=c.y,m=h.y);var g=Math.floor(p)-n,y=Math.floor(v)+n,x=Math.floor(_)-n,b=Math.floor(m)+n;g<0&&(g=0),y>t&&(y=t),x<0&&(x=0),b>i&&(b=i);for(var S=c.x-h.x,M=c.y-h.y,I=S*S+M*M,w=g;w<y;w++)for(var V=x;V<b;V++){var D=(w-h.x)*S+(V-h.y)*M,z=void 0,F=void 0;D<0?(z=h.x,F=h.y):D>I?(z=c.x,F=c.y):(D/=I,z=h.x+D*S,F=h.y+D*M);var T=(w-z)*(w-z)+(V-F)*(V-F),O=(i-V-1)*t+w;T<a[O]&&(a[O]=T)}}}for(s=0;s<r;++s)a[s]=Math.sqrt(a[s]);return a},e.prototype._sign_dist_map=function(e,t,i,n,r){for(var a=0,o=e;a<o.length;a++)for(var s=o[a],l=s.length,u=1;u<l;++u){var d=s[u-1],f=s[u],h=void 0,c=void 0;d.x<f.x?(h=d.x,c=f.x):(h=f.x,c=d.x);var p=void 0,v=void 0;d.y<f.y?(p=d.y,v=f.y):(p=f.y,v=d.y);var _=Math.floor(h),m=Math.floor(c)+1,g=Math.floor(p),y=Math.floor(v)+1;_<n&&(_=n),m>t-n&&(m=t-n),g<n&&(g=n),y>i-n&&(y=i-n);for(var x=g;x<y;++x)if(d.y>x!=f.y>x){for(var b=(i-x-1)*t,S=_;S<m;++S)S<(f.x-d.x)*(x-d.y)/(f.y-d.y)+d.x&&(r[b+S]=-r[b+S]);for(S=n;S<_;++S)r[b+S]=-r[b+S]}}},e.prototype._encodeDistMap=function(e,t){for(var i=2*t,n=e.length,r=new Uint8Array(4*n),o=0;o<n;++o)a(.5-e[o]/i,r,4*o);return r},e}();t.SDFHelper=o}.apply(null,n))||(e.exports=r)},1582:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(398),i(343),i(623),i(1388),i(675),i(1060)],void 0===(r=function(e,t,i,n,r,a,o,s){function l(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];t<e.length?e.splice.apply(e,[t,i].concat(n)):e.push.apply(e,n)}var u=n.getLogger("esri.views.2d.engine.webgl.WGLDisplayList"),d=function(){function e(){this.symbolLevels=[]}return Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r=n[i];this._addToList(r,t)}else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,i=0,n=e;i<n.length;i++){var r=n[i];t=this._removeFromList(r)}return t},e.prototype.ofType=function(e){var t,n,r,a,o,s,l,u,d,f;return i(this,function(i){switch(i.label){case 0:t=0,n=this.symbolLevels,i.label=1;case 1:if(!(t<n.length))return[3,8];r=n[t],a=0,o=r.zLevels,i.label=2;case 2:if(!(a<o.length))return[3,7];if(s=o[a],l=s.geometryDPInfo,u=this._getDPInfoType(e),!l[u])return[3,6];d=0,f=l[u],i.label=3;case 3:return d<f.length?[4,f[d]]:[3,6];case 4:i.sent(),i.label=5;case 5:return d++,[3,3];case 6:return a++,[3,2];case 7:return t++,[3,1];case 8:return[2]}})},e.prototype.clone=function(){for(var t=new e,i=0,n=this.symbolLevels;i<n.length;i++){var r=n[i];t.symbolLevels.push(r.clone())}return t},e.prototype._addToList=function(e,t){var i=e.symbolLevel,n=e.zOrder,r=this._getDisplayList(i,n,e.geometryType),a=null!=t?t:r.length-1,s=a>=0&&a<r.length?r[a]:null;if(null!==s&&o.isSameMaterialInfo(s.materialInfo,e.materialInfo)&&s.indexFrom+s.indexCount===e.indexFrom)s.indexCount+=e.indexCount;else{var u=new f;u.indexFrom=e.indexFrom,u.indexCount=e.indexCount,u.materialInfo=e.materialInfo,u.geometryType=e.geometryType,l(r,a+1,0,u)}},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,i=e.zOrder,n=this._getDisplayList(t,i,e.geometryType),r=n.length,o=void 0,s=0;s<r;++s){var u=n[s];e.indexFrom+e.indexCount>u.indexFrom&&e.indexFrom<u.indexFrom+u.indexCount&&(o=s)}if(void 0!==o){u=n[o];if(e.indexFrom===u.indexFrom)return u.indexCount-=e.indexCount,u.indexFrom+=e.indexCount,0===u.indexCount&&l(n,o,1),o-1;if(e.indexFrom+e.indexCount===u.indexFrom+u.indexCount)return u.indexCount-=e.indexCount,0===u.indexCount?(l(n,o,1),o-1):o;var d=u.indexFrom,h=e.indexFrom-u.indexFrom,c=e.indexCount,p=u.indexFrom+u.indexCount-(e.indexFrom+e.indexCount);u.indexCount=h;var v=new f;return v.geometryType=u.geometryType,v.materialInfo=new a.default,v.materialInfo.copy(u.materialInfo),v.indexFrom=d+h+c,v.indexCount=p,l(n,o+1,0,v),o}return null},e.prototype._getDisplayList=function(e,t,i){for(var n,a=this.symbolLevels.length,o=0;o<a;o++)if(this.symbolLevels[o].symbolLevel===e){n=this.symbolLevels[o];break}n||((n=new p).symbolLevel=e,this.symbolLevels.push(n));for(var s,l=n.zLevels.length,u=0;u<l;u++)if(n.zLevels[u].zLevel===t){s=n.zLevels[u];break}var d;switch(s||((s=new c).geometryDPInfo=new h,s.zLevel=t,n.zLevels.push(s)),i){case r.WGLGeometryType.FILL:s.geometryDPInfo.fill||(s.geometryDPInfo.fill=[]),d=s.geometryDPInfo.fill;break;case r.WGLGeometryType.LINE:s.geometryDPInfo.line||(s.geometryDPInfo.line=[]),d=s.geometryDPInfo.line;break;case r.WGLGeometryType.MARKER:s.geometryDPInfo.marker||(s.geometryDPInfo.marker=[]),d=s.geometryDPInfo.marker;break;case r.WGLGeometryType.TEXT:s.geometryDPInfo.text||(s.geometryDPInfo.text=[]),d=s.geometryDPInfo.text;break;case r.WGLGeometryType.LABEL:s.geometryDPInfo.label||(s.geometryDPInfo.label=[]),d=s.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+i+"'.")}return d},e.prototype.serialize=function(e){return s.serializeList(e,this.symbolLevels),e},e.deserialize=function(t){var i=new e;return i.symbolLevels=s.deserializeList(t,p),i},e.prototype._getDPInfoType=function(e){switch(e){case r.WGLGeometryType.FILL:return"fill";case r.WGLGeometryType.LINE:return"line";case r.WGLGeometryType.MARKER:return"marker";case r.WGLGeometryType.TEXT:return"text";case r.WGLGeometryType.LABEL:return"label";default:u.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),f=function(){function e(){this.materialInfo=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialInfo=new a.default,t.materialInfo.copy(this.materialInfo),t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e.prototype.serialize=function(e){return this.materialInfo.serialize(e),e.push(this.indexFrom),e.push(this.indexCount),e},e.deserialize=function(t,i){var n=new e;return n.geometryType=i.geometryType,n.materialInfo=a.default.deserialize(t),n.indexFrom=t.readInt32(),n.indexCount=t.readInt32(),n},e}(),h=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t},e.prototype.serialize=function(e){return s.serializeList(e,this.fill),s.serializeList(e,this.line),s.serializeList(e,this.marker),s.serializeList(e,this.text),s.serializeList(e,this.label),e},e.deserialize=function(t){var i=new e,n={geometryType:r.WGLGeometryType.FILL},a=s.deserializeList(t,f,n);a.length&&(i.fill=a),n.geometryType=r.WGLGeometryType.LINE;var o=s.deserializeList(t,f,n);o.length&&(i.line=o),n.geometryType=r.WGLGeometryType.MARKER;var l=s.deserializeList(t,f,n);l.length&&(i.marker=l),n.geometryType=r.WGLGeometryType.TEXT;var u=s.deserializeList(t,f,n);u.length&&(i.text=u),n.geometryType=r.WGLGeometryType.LABEL;var d=s.deserializeList(t,f,n);return d.length&&(i.label=d),i},e}(),c=function(){function e(){this.geometryDPInfo=new h}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e.prototype.serialize=function(e){return e.push(this.zLevel),this.geometryDPInfo.serialize(e),e},e.deserialize=function(t){var i=new e;return i.zLevel=t.readInt32(),i.geometryDPInfo=h.deserialize(t),i},e}(),p=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var i=0,n=this.zLevels;i<n.length;i++){var r=n[i];t.zLevels.push(r.clone())}return t},e.prototype.serialize=function(e){return e.push(this.symbolLevel),s.serializeList(e,this.zLevels),e},e.deserialize=function(t){var i=new e;return i.symbolLevel=t.readInt32(),i.zLevels=s.deserializeList(t,c),i},e}();return d}.apply(null,n))||(e.exports=r)},1587:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(338),i(336),i(346),i(981),i(337),i(725)],void 0===(r=function(e,t,i,n,r,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this)||this;return i.tiles=new Map,i.layer=null,i}return i(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.highlightOptions=this.configuration=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("attach",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,i),i},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.status!==s.TileStatus.INITIALIZED}),!e},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},n([o.property()],t.prototype,"configuration",void 0),n([o.property()],t.prototype,"highlightOptions",void 0),n([o.property()],t.prototype,"layer",void 0),n([o.property()],t.prototype,"layerView",void 0),n([o.property()],t.prototype,"tileInfoView",void 0),n([o.property()],t.prototype,"updating",null),n([o.subclass()],t)}(o.declared(r,a));t.default=l}.apply(null,n))||(e.exports=r)},1663:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1277)],void 0===(r=function(e,t,i){return function(){function e(e,t){this._width=0,this._height=0,this._free=[],this._width=e,this._height=t,this._free.push(new i(0,0,e,t))}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.allocate=function(e,t){if(e>this._width||t>this._height)return new i;for(var n=null,r=-1,a=0;a<this._free.length;++a){var o=this._free[a];e<=o.width&&t<=o.height&&(null===n||o.y<=n.y&&o.x<=n.x)&&(n=o,r=a)}return null===n?new i:(this._free.splice(r,1),n.width<n.height?(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,t)),n.height>t&&this._free.push(new i(n.x,n.y+t,n.width,n.height-t))):(n.width>e&&this._free.push(new i(n.x+e,n.y,n.width-e,n.height)),n.height>t&&this._free.push(new i(n.x,n.y+t,e,n.height-t))),new i(n.x,n.y,e,t))},e.prototype.release=function(e){for(var t=0;t<this._free.length;++t){var i=this._free[t];if(i.y===e.y&&i.height===e.height&&i.x+i.width===e.x)i.width+=e.width;else if(i.x===e.x&&i.width===e.width&&i.y+i.height===e.y)i.height+=e.height;else if(e.y===i.y&&e.height===i.height&&e.x+e.width===i.x)i.x=e.x,i.width+=e.width;else{if(e.x!==i.x||e.width!==i.width||e.y+e.height!==i.y)continue;i.y=e.y,i.height+=e.height}this._free.splice(t,1),this.release(e)}this._free.push(e)},e}()}.apply(null,n))||(e.exports=r)},2411:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(338),i(336),i(345),i(638),i(346),i(343),i(357),i(337),i(367),i(620),i(1661),i(1437),i(2412),i(2421),i(1587)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_){function m(e){if(!e.visualVariables||!e.visualVariables.length)return e;var t=e.clone(),i=t.visualVariables.map(function(e){return function(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}(e)?function(e){return e.stops=function(e,t){return t.length<=x?t:(y.warn("Found "+t.length+" Visual Variable stops, but MapView only supports "+x+". Displayed stops will be simplified."),t.length>2*x?function(e,t){for(var i=t[0],n=t.slice(1),r=n.pop(),a=n[0].value,o=n[n.length-1].value,s=(o-a)/b,u=[],d=a;d<o;d+=s){for(var f=0;d>=n[f].value;)f++;var h=n[f],c=t[f-1],p=d-c.value,v=h.value===c.value?1:p/(h.value-c.value);if("color"===e){var _=n[f],m=t[f-1],y=_.color.clone();y.r=g(m.color.r,y.r,v),y.g=g(m.color.g,y.g,v),y.b=g(m.color.b,y.b,v),y.a=g(m.color.a,y.a,v),u.push({value:d,color:y,label:_.label})}else if("size"===e){var x=n[f],S=t[f-1],M=l.toPt(x.size),I=l.toPt(S.size),w=g(I,M,v);u.push({value:d,size:w,label:x.label})}else{var V=n[f],D=t[f-1],z=g(D.opacity,V.opacity,v);u.push({value:d,opacity:z,label:V.label})}}return[i].concat(u,[r])}(e,t):function(e){for(var t=e[0],i=e.slice(1),n=i.pop();i.length>b;){for(var r=0,a=0,o=1;o<i.length;o++){var s=i[o-1],l=i[o],u=Math.abs(l.value-s.value);u>a&&(a=u,r=o)}i.splice(r,1)}return[t].concat(i,[n])}(t))}(e.type,e.stops),e}(e):e});return t.visualVariables=i,t}function g(e,t,i){return(1-i)*e+i*t}Object.defineProperty(t,"__esModule",{value:!0});var y=s.getLogger("esri.views.2d.layers.features.tileRenderer.SymbolTileRenderer"),x=8,b=x-2,S=function(e){function t(t){return e.call(this)||this}return i(t,e),t.prototype.initialize=function(){},t.prototype.createTile=function(e){var t=d.create();return this.tileInfoView.getTileBounds(t,e),new v(e,t)},t.prototype.disposeTile=function(e){this.featuresView.removeChild(e)},t.prototype.highlight=function(e){return this.featuresView.highlight(e)},t.prototype.hitTest=function(e,t){return this.featuresView.hitTest(e,t)},t.prototype.supportsRenderer=function(e){return null!=e&&h.isRendererWebGLCompatible(e)&&-1!==["simple","class-breaks","unique-value"].indexOf(e.type)},t.prototype.getProcessorConfiguration=function(){var e=this.layer;return{type:"symbol",renderer:m(e.renderer).toJSON(),devicePixelRatio:window.devicePixelRatio||1,definitionExpression:e.definitionExpression,outFields:e.outFields.slice().sort(),gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),labelingInfo:e.labelingInfo&&e.labelingInfo.map(function(e){return e.toJSON()})}},t.prototype.needsProcessorReconfiguration=function(e){var t=this.wouldClear(e),i=this.configuration;return this.configuration=e,t||i.definitionExpression!==e.definitionExpression},t.prototype.wouldClear=function(e){var t=this.configuration;if(!t||t.outFields.join()!==e.outFields.join()||f.diff(t.labelingInfo,e.labelingInfo))return!0;var i=this.configuration&&a.fromJSON(this.configuration.renderer)||null,n=e&&a.fromJSON(e.renderer)||null,r=f.diff(i,n);if(!r)return!1;switch(r.type){case"complete":return!0;case"partial":if(function(e){for(var t in e.diff){var i=e.diff[t];if("collection"===i.type){if(0!==i.changed.length||0!==i.added.length||0!==i.removed.length)return!0}else if("visualVariables"!==t&&"authoringInfo"!==t)return!0}return!1}(r))return!0;if(r.diff.visualVariables){var o=this.featuresView.visualVariablesInfo,s=this.tileInfoView.tileInfo.spatialReference,l={fields:this.layer.fields.map(function(e){return e.toJSON()})},u=h.getNormalizedRenderer(n,s,l),d=c.convertVisualVariables(u.visualVariables).vvFields;return!!f.diff(o.vvFields,d)}}},t.prototype.clear=function(){this.featuresView.disposeWebGLResources()},t.prototype.applyConfiguration=function(e){var t=a.fromJSON(e.renderer),i={fields:this.layer.fields.map(function(e){return e.toJSON()})},n=h.getNormalizedRenderer(t,this.tileInfoView.tileInfo.spatialReference,i);this.configuration=e,this.featuresView.visualVariablesInfo=c.convertVisualVariables(n.visualVariables)},t.prototype.install=function(e){var t=new p.default({highlightOptions:this.highlightOptions,tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this.featuresView=t,t.install(e)},t.prototype.uninstall=function(e){this.featuresView.uninstall(e)},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileData(t,e.data)},t.prototype.onTileError=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)},t.prototype.getMaterialItems=function(e){return this.featuresView.getMaterialItems(e)},n([u.subclass()],t)}(u.declared(o,_.default));t.default=S}.apply(null,n))||(e.exports=r)},2412:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(345),i(347),i(340),i(340),i(759),i(903),i(400),i(716),i(1527),i(623),i(1022),i(2413),i(675),i(1386),i(2420)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_){Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t){var i=e.call(this)||this;return i._rendererInfo=new _,i._stage=new d,i._container=null,i._tileCoordinateScale=s.create(),i._orientationVec=s.fromValues(0,0,1),i._displayScale=s.create(),i._defaultTransform=o.create(),i._pointToCallbacks=new Map,i._highlightIDs=new Set,i._invisibleFeatures=new Set,i._displayWidth=0,i._displayHeight=0,i._highlightOptionsUpToDate=!1,i.layer=null,i.textureManager=new c,i.highlightOptions=t.highlightOptions,i.tileInfoView=t.tileInfoView,i._stage.useContextVersion("webgl"),i.layer=t.layer,i._layerView=t.layerView,i}return n(t,e),t.prototype.fadeInLabels=function(){this._stage.fadeInLabels()},t.prototype.dispose=function(){this.textureManager&&(this.textureManager.dispose(),this.textureManager=null),this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(e){this._highlightOptions=e,this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},set:function(e){this._visualVariablesInfo=e,this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.install=function(e){e.addChild(this._stage),this._stage.addChild(this),this._container=e},t.prototype.uninstall=function(e){e.removeChild(this._stage),this._stage.removeChild(this),this.dispose(),this._container=null},t.prototype.hitTest=function(e,t){var i=this,n=[e,t];return r.create(function(e,t){i._pointToCallbacks.set(n,{resolve:e,reject:t}),i.requestRender()},function(){i._pointToCallbacks.has(n)&&i._pointToCallbacks.delete(n)})},t.prototype.highlight=function(e){var t=this;return t.addHighlight(e),{remove:function(){t.removeHighlight(e)}}},t.prototype.setHighlight=function(e){this._highlightIDs.clear(),this.addHighlight(e)},t.prototype.setVisibility=function(e,t){e||(e=[]),t||(t=[]);for(var i=this._invisibleFeatures,n=0,r=e;n<r.length;n++){var a=r[n];i.has(a)&&i.delete(a)}for(var o=0,s=t;o<s.length;o++){var l=s[o];i.add(l)}for(var u=0,d=this.children;u<d.length;u++){var f=d[u];f.data&&f.setVisibility(e,t)}},t.prototype.setVisibilityRange=function(e,t,i,n){for(var r=0,a=this.children;r<a.length;r++){var o=a[r];o.data&&o.data.tileDisplayData.displayObjectRegistry.has(e)&&o.setVisibilityRange(e,t,i,n)}},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this._highlightIDs.add(n)}this._buildHLList()},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this._highlightIDs.delete(n)}this._buildHLList()},t.prototype.getMaterialItems=function(e){var t=e;if(t&&0!==t.length){for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];i.push(this.textureManager.rasterizeItem(o.symbol,o.glyphIds))}return a.all(i).then(function(e){return e.map(function(e,t){return{id:t,mosaicItem:e}})})}},t.prototype.onTileData=function(e,t){var i=!(!this.layer.labelingInfo||!this.layer.labelingInfo.length);e.setData(t,i,this.layer.labelsVisible),e.resetVisibility(this._invisibleFeatures),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.fadeInLabels(),this.requestRender(),this._layerView&&this._layerView.view.labelManager.requestUpdate()},t.prototype.onTileError=function(e){e.clear(),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.addChild=function(t){var i=e.prototype.addChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.addTile(this.layer.uid,t),this._buildHLList(),i},t.prototype.removeChild=function(t){var i=e.prototype.removeChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.removeTile(this.layer.uid,t.key.id),this._buildHLList(),i},t.prototype.prepareChildrenRenderParameters=function(e){this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,e.state);var t=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,n=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale);return i({},e,{rendererInfo:this._rendererInfo,requiredLevel:t,displayLevel:n})},t.prototype.renderChildren=function(e){var t=this,i=e.painter;i.bindTextureManager(this.textureManager),this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,e.state),this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var n=v.default.toWGLDrawPhases(e.drawPhase);if(n.length>0&&n[0]===f.WGLDrawPhase.LABEL||n[0]===f.WGLDrawPhase.LABEL_ALPHA){var r=this.layer;if(!(r.labelsVisible&&r.labelingInfo&&r.labelingInfo.length>0))return;this._updateTilesTransform(e.state,e.requiredLevel),i.update(e.state,e.pixelRatio)}i.draw(e,this.children,n,this._painterOptions),this._highlightIDs.size>0&&i.highlight(e,this.children),0!==this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(i,n){i.resolve(t._hitTest(e,n[0],n[1]))}),this._pointToCallbacks.clear())},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){e.detach(t)},t.prototype.renderChild=function(e,t){e.doRender(t)},t.prototype.beforeRenderChildren=function(e,t){this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),this._updateHighlightOptions(),this._stage.opacity=this._container.opacity},t.prototype._hitTest=function(e,t,i){var n=e.painter,r=e.requiredLevel,a=[0,0];e.state.toMap(a,[t,i]);var o=e.state.clone(),s=o.viewpoint.clone();return s.targetGeometry=new l(a[0],a[1],e.state.spatialReference),o.viewpoint=s,o.size=[p.C_HITTEST_SEARCH_SIZE,p.C_HITTEST_SEARCH_SIZE],this._updateTilesTransform(o,r),n.update(o,e.pixelRatio),n.hitTest({context:e.context,drawPhase:f.WGLDrawPhase.HITTEST,painter:n,pixelRatio:e.pixelRatio,displayLevel:e.displayLevel,rendererInfo:this._rendererInfo,requiredLevel:r,state:o,stationary:e.stationary},this.children)},t.prototype._updateTilesTransform=function(e,t){var i=1/e.width,n=1/e.height,r=[0,0];this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[t].resolution,e.resolution,e.rotation,this.tileInfoView.tileInfo.size[0],e.width,e.height,this._defaultTransform);for(var a=0,o=this.children;a<o.length;a++){var s=o[a];e.toScreen(r,s.coords),r[1]=e.height-r[1],s.tileTransform.displayCoord[0]=2*r[0]*i-1,s.tileTransform.displayCoord[1]=2*r[1]*n-1,s.key.level===t?s.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[s.key.level].resolution,e.resolution,e.rotation,this.tileInfoView.tileInfo.size[0],e.width,e.height,s.tileTransform.transform)}},t.prototype._calculateRelativeViewProjMat=function(e,t,i,n,r,a,s){var l=e/t;this._tileCoordinateScale.set([l,l,1]),r===this._displayWidth&&a===this._displayHeight||(this._displayScale.set([2/r,-2/a,1]),this._displayWidth=r,this._displayHeight=a),o.identity(s),o.scale(s,s,this._tileCoordinateScale),o.rotate(s,s,-i*h.C_DEG_TO_RAD,this._orientationVec),o.scale(s,s,this._displayScale),o.transpose(s,s)},t.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&this.parent){var e=this.parent.glPainter,t=this._highlightOptions;if(e){var i=t.color.toRgba();i[0]/=255,i[1]/=255,i[2]/=255;var n=i.slice();i[3]*=t.fillOpacity,n[3]*=t.haloOpacity,e.setHighlightOptions({fillColor:i,outlineColor:n,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0})}}},t.prototype._buildHLList=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].buildHLList(this._highlightIDs);this.requestRender()},t}(u);t.default=m}.apply(null,n))||(e.exports=r)},2413:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(124),i(342),i(343),i(340),i(2414),i(1662),i(2416),i(2417),i(2418),i(1581),i(2419),i(675),i(640)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p){var v=126,_=r.getLogger("esri.views.2d.engine.webgl.TextureManager");return function(){function e(){this._invalidFontsMap=new Map,this._sdfConverter=new d.default(v),this._spriteMosaic=new h(1024,1024,250),this._glyphSource=new u(i.fontsUrl+"/{fontstack}/{range}.pbf"),this._glyphMosaic=new l(1024,1024,this._glyphSource)}return Object.defineProperty(e.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizationCanvas=null},e.prototype.rasterizeItem=function(e,t){return void 0===t&&(t=null),e?e.type&&-1!==e.type.toLowerCase().indexOf("3d")?(_.error(new n("mapview-invalid-type","MapView does not support 3d symbol type: "+e.type,e)),a.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!e.type||"text"!==e.type&&"esriTS"!==e.type?this._rasterizeSpriteSymbol(e).then(function(e){return{spriteMosaicItem:e}}):this._rasterizeTextSymbol(e,t).then(function(e){return{glyphMosaicItems:e}}):(_.error(new n("mapview-null-resource","Unable to rasterize null resource")),a.resolve(null))},e.prototype.bindSpritePage=function(e,t,i,n){n||(n=9729),this._spriteMosaic.bind(e,n,t,i)},e.prototype.bindGlyphsPage=function(e,t,i){this._glyphMosaic.bind(e,9729,t,i)},e.prototype._rasterizeTextSymbol=function(e,t){var i=this,r=s.getFullyQualifiedFontName(e.font),a=this._invalidFontsMap.has(r);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":r,t).catch(function(e){return _.error(new n("mapview-invalid-resource","Couldn't find font "+r+". Falling back to Arial Unicode MS Regular")),i._invalidFontsMap.set(r,!0),i._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",t)})},e.prototype._rasterizeSpriteSymbol=function(e){var t=this;if(e&&(c.isFillSymbol(e)||c.isLineSymbol(e))&&"style"in e&&("solid"===e.style||"esriSFSSolid"===e.style||"esriSLSSolid"===e.style||"none"===e.style||"esriSFSNull"===e.style||"esriSLSNull"===e.style))return a.resolve(null);var i=function(e){if(e.type){switch(c.normalizeSymbolType(e.type)){case"simple-marker":return e.path?"simple-marker"+e.style+e.path:"simple-marker"+e.style;case"simple-line":return"simple-line"+e.style}if(c.isPictureSymbol(e))return e.url?e.url:e.imageData+""+e.width+e.height}return JSON.stringify(e)}(e);if(this._spriteMosaic.has(i))return a.resolve(this._spriteMosaic.getSpriteItem(i));if("simple-marker"!==e.type&&"esriSMS"!==e.type||!e.path){if(e.url||e.imageData){var n=e.imageData?"data:"+e.contentType+";base64,"+e.imageData:e.url;return p.requestImage(n).then(function(n){var r=t._rasterizeResource(n);return t._addItemToMosaic(i,r.size,r.anchor,r.image,!c.isMarkerSymbol(e),r.sdf)})}var r=this._rasterizeResource(e);return a.resolve(this._addItemToMosaic(i,r.size,r.anchor,r.image,!c.isMarkerSymbol(e),r.sdf))}var o=[v,v];return this._sdfConverter.draw(e.path).then(function(e){return t._addItemToMosaic(i,o,[0,0],new Uint32Array(e.buffer),!1,!0)})},e.prototype._rasterizeResource=function(e){if(e instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var t=e;this._rasterizationCanvas.width=t.width,this._rasterizationCanvas.height=t.height;var i=this._rasterizationCanvas.getContext("2d");i.drawImage(t,0,0,t.width,t.height);for(var n=i.getImageData(0,0,t.width,t.height),r=new Uint8Array(n.data),a=void 0,o=0;o<r.length;o+=4)a=r[o+3]/255,r[o]=r[o]*a,r[o+1]=r[o+1]*a,r[o+2]=r[o+2]*a;var s=t.width,l=t.height,u=r;if(s>=512||l>=512){var d=t.width/t.height;d>1?(s=512,l=Math.round(512/d)):(l=512,s=Math.round(512*d)),u=new Uint8Array(4*s*l),c.resampleHermite(r,t.width,t.height,new Uint8ClampedArray(u.buffer),s,l,!1)}return{size:[s,l],anchor:[0,0],image:new Uint32Array(u.buffer),sdf:!1}}return this._rasterizeJSON(e)},e.prototype._addItemToMosaic=function(e,t,i,n,r,a){return this._spriteMosaic.addSpriteItem(e,t,i,n,r,a)},e.prototype._rasterizeJSON=function(e){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){var t=o.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,e.style),i=t[0];return{size:[t[1],t[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!1}}if("simple-line"===e.type||"esriSLS"===e.type){var n=o.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,e.style);i=n[0];return{size:[n[1],n[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!0}}var r,a;if("simple-marker"===e.type||"esriSMS"===e.type?(r=o.CIMSymbolHelper.fromSimpleMarker(e),a=!0):(r=e,a=f.SDFHelper.checkSDF(r)),a){var s=(new f.SDFHelper).buildSDF(r);i=s[0];return{size:[s[1],s[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!0}}var l=o.CIMSymbolHelper.rasterize(this._rasterizationCanvas,r);i=l[0];return{size:[l[1],l[2]],anchor:[l[3],l[4]],image:new Uint32Array(i.buffer),sdf:!1}},e}()}.apply(null,n))||(e.exports=r)},2414:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(343),i(2415),i(1581),i(616)],void 0===(r=function(e,t,i,n,r,a){Object.defineProperty(t,"__esModule",{value:!0});var o=i.getLogger("esri/views/2d/engine/webgl/CIMSymbolHelper"),s=function(){function e(){}return e.getEnvelope=function(e){if("CIMPointSymbol"!==e.type)return null;var t=new n.EnvDrawHelper;return t.drawSymbol(e,{type:"point",x:0,y:0}),t.envelope()},e.rasterize=function(e,t){var i=this.getEnvelope(t);if(!i||i.width<=0||i.height<=0)return[null,0,0,0,0];var r=(i.x+.5*i.width)*(96/72),a=-(i.y+.5*i.height)*(96/72);e.width=i.width*(96/72)+2,e.height=i.height*(96/72)+2;var o=e.getContext("2d"),s=n.Transformation.createScale(96/72,-96/72);s.translate(.5*e.width-r,.5*e.height-a);new n.CanvasDrawHelper(o,s).drawSymbol(t,{type:"point",x:0,y:0});for(var l,u=o.getImageData(0,0,e.width,e.height),d=new Uint8Array(u.data),f=0;f<d.length;f+=4)l=d[f+3]/255,d[f]=d[f]*l,d[f+1]=d[f+1]*l,d[f+2]=d[f+2]*l;return[d,e.width,e.height,r/e.width,a/e.height]},e.fromSimpleMarker=function(e){var t,i,n,r=e.style;if("circle"===r||"esriSMSCircle"===r){var o=Math.acos(.995),s=Math.ceil(a.C_PI/o/4);0===s&&(s=1),o=a.C_PI_BY_2/s,s*=4;var l=[];l.push([50,0]);for(var u=1;u<s;u++)l.push([50*Math.cos(u*o),-50*Math.sin(u*o)]);l.push([50,0]),t={rings:[l]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===r||"esriSMSCross"===r){t={rings:[[[d=0,50],[d,d],[50,d],[50,-d],[d,-d],[d,-50],[-d,-50],[-d,-d],[-50,-d],[-50,d],[-d,d],[-d,50],[d,50]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("diamond"===r||"esriSMSDiamond"===r)t={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===r||"esriSMSSquare"===r)t={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===r||"esriSMSX"===r){var d;t={rings:[[[0,d=0],[50-d,50],[50,50-d],[d,0],[50,d-50],[50-d,-50],[0,-d],[d-50,-50],[-50,d-50],[-d,0],[-50,50-d],[d-50,50],[0,d]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("triangle"===r||"esriSMSTriangle"===r){var f=57.735026918962575,h=-f,c=2/3*100-100;t={rings:[[[h,c],[0,2/3*100],[f,c],[h,c]]]},i={xmin:h,ymin:c,xmax:f,ymax:2/3*100}}if(t&&i){var p=[{type:"CIMSolidFill",enable:!0,color:e.color}];e.outline&&p.push({type:"CIMSolidStroke",enable:!0,width:e.outline.width,color:e.outline.color});var v={type:"CIMPolygonSymbol",symbolLayers:p};n={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:e.angle,size:e.size,offsetX:e.xoffset,offsetY:e.yoffset,frame:i,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t,symbol:v}]}]}}return n},e}();t.CIMSymbolHelper=s;var l=function(){function e(){}return e.rasterizeSimpleFill=function(e,t){"solid"!==t&&"none"!==t&&"esriSFSSolid"!==t&&"esriSFSNull"!==t||console.error("Unexpected: style does not require rasterization"),e.width=8,e.height=8;var i=e.getContext("2d");i.strokeStyle="#FFFFFF",i.beginPath(),"vertical"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSVertical"!==t||(i.moveTo(0,0),i.lineTo(0,8)),"horizontal"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSHorizontal"!==t||(i.moveTo(0,0),i.lineTo(8,0)),"forward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSDiagonalCross"!==t&&"esriSFSForwardDiagonal"!==t||(i.moveTo(0,0),i.lineTo(8,8)),"backward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSBackwardDiagonal"!==t&&"esriSFSDiagonalCross"!==t||(i.moveTo(8,0),i.lineTo(0,8)),i.stroke();for(var n,r=i.getImageData(0,0,e.width,e.height),a=new Uint8Array(r.data),o=0;o<a.length;o+=4)n=a[o+3]/255,a[o]=a[o]*n,a[o+1]=a[o+1]*n,a[o+2]=a[o+2]*n;return[a,e.width,e.height]},e.rasterizeSimpleLine=function(e,t){var i;switch(t){case"dash":case"esriSLSDash":i=[3,2];break;case"dash-dot":case"esriSLSDashDot":i=[2,2,0,2];break;case"dot":case"esriSLSDot":i=[0,3];break;case"long-dash":case"esriSLSLongDash":i=[6,3];break;case"long-dash-dot":case"esriSLSLongDashDot":i=[6,3,0,3];break;case"long-dash-dot-dot":case"esriSLSDashDotDot":i=[2,2,0,2,0,2];break;case"short-dash":case"esriSLSShortDash":i=[2,2];break;case"short-dash-dot":case"esriSLSShortDashDot":i=[2,2,0,2];break;case"short-dash-dot-dot":case"esriSLSShortDashDotDot":i=[2,2,0,2,0,2];break;case"short-dot":case"esriSLSShortDot":i=[0,2];break;case"solid":case"esriSLSSolid":case"none":o.error("Unexpected: style does not require rasterization"),i=[0,0];break;default:o.error("Tried to rasterize SLS, but found an unexpected style: "+t+"!"),i=[0,0]}for(var n=0,a=0,s=i;a<s.length;a++){n+=s[a]}for(var l=16*n,u=31*l,d=new Float32Array(u),f=0;f<u;++f)d[f]=257;for(var h=.5,c=.5,p=!0,v=0,_=i;v<_.length;v++){h=c,c+=16*_[v];for(var m=h;m<c;){for(var g=.5;g<31;){var y=(g-15.5)*(g-15.5);d[f=(31-g+.5+1)*l+m-.5]=p?y:Math.min((m-h)*(m-h)+y,(m-c)*(m-c)+y),g++}m++}p=!p}var x=d.length,b=new Uint8Array(4*x);for(f=0;f<x;++f){var S=Math.sqrt(d[f])/15;r.packFloat(S,b,4*f)}return[b,l,31]},e}();t.SymbolHelper=l}.apply(null,n))||(e.exports=r)},2415:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(336),i(1022),i(1277)],void 0===(r=function(e,t,i,n,r,a){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._t=e}return e.createIdentity=function(){return new e([1,0,0,0,1,0])},e.prototype.clone=function(){return new e(this._t.slice())},e.prototype.transform=function(e){var t=this._t;return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]},e.createScale=function(t,i){return new e([t,0,0,0,i,0])},e.prototype.scale=function(e,t){var i=this._t;return i[0]*=e,i[1]*=e,i[2]*=e,i[3]*=t,i[4]*=t,i[5]*=t,this},e.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])},e.createTranslate=function(t,i){return new e([0,0,t,0,0,i])},e.prototype.translate=function(e,t){var i=this._t;return i[2]+=e,i[5]+=t,this},e.createRotate=function(t){var i=Math.cos(t),n=Math.sin(t);return new e([i,-n,0,n,i,0])},e.prototype.rotate=function(t){return this.multiply(e.createRotate(t))},e.prototype.multiply=function(e){var t=this._t,i=e._t,n=t[0]*i[0]+t[3]*i[1],r=t[1]*i[0]+t[4]*i[1],a=t[2]*i[0]+t[5]*i[1]+i[2],o=t[0]*i[3]+t[3]*i[4],s=t[1]*i[3]+t[4]*i[4],l=t[2]*i[3]+t[5]*i[4]+i[5];return t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,this},e}();t.Transformation=o;var s=function(){function e(e){this._transfos=[],this._sizeTransfos=[],this._transfos.push(e||o.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1)}return e.prototype.transformPt=function(e){return this._transfos[this._transfos.length-1].transform(e)},e.prototype.transformSize=function(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]},e.prototype.back=function(){return this._transfos[this._transfos.length-1]},e.prototype.push=function(e){var t=e.scaleRatio();e.multiply(this.back()),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*t)},e.prototype.pop=function(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)},e.prototype.drawSolidFill=function(e,t){},e.prototype.drawSolidStroke=function(e,t,i){},e.prototype.drawSymbol=function(e,t){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,t)}},e.prototype.drawMultiLayerSymbol=function(e,t){if(e){var i=e.symbolLayers;if(i)for(var n=i.length;n--;){var r=i[n];if(r&&r.enable)switch(r.type){case"CIMSolidFill":this.drawSolidFill(t,r.color);break;case"CIMSolidStroke":this.drawSolidStroke(t,r.color,r.width);break;case"CIMVectorMarker":this.drawVectorMarker(r,t)}}}},e.prototype.drawVectorMarker=function(e,t){if(e){var i=e.markerGraphics;if(i){var n=e.size,a=e.frame,s=a?a.ymax-a.ymin:0,l=n&&s?n/s:1,u=o.createIdentity();a&&u.translate(.5*-(a.xmax+a.xmin),.5*-(a.ymax+a.ymin));var d=e.anchorPt;if(d){var f=d.x,h=d.y;"relative"===e.anchorPtUnits&&a&&(f*=(a.xmax-a.xmin)*l,h*=n),u.translate(-f,-h)}1!==l&&u.scale(l,l),e.rotation&&u.rotate(e.rotation*r.C_DEG_TO_RAD),u.translate(e.offsetX||0,e.offsetY||0),u.translate(t.x,t.y),this.push(u);for(var c=0,p=i;c<p.length;c++){var v=p[c];v&&this.drawSymbol(v.symbol,v.geometry)}this.pop()}}},e}();t.CIMSymbolDrawHelper=s;var l=function(e){function t(){var t=e.call(this)||this;return t._xmin=t._ymin=1/0,t._xmax=t._ymax=-1/0,t}return i(t,e),t.prototype.envelope=function(){return new a(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)},t.prototype._merge=function(e,t){e[0]-t<this._xmin&&(this._xmin=e[0]-t),e[0]+t>this._xmax&&(this._xmax=e[0]+t),e[1]-t<this._ymin&&(this._ymin=e[1]-t),e[1]+t>this._ymax&&(this._ymax=e[1]+t)},t.prototype.drawSolidFill=function(e,t){for(var i=0,n=e.rings;i<n.length;i++){var r=n[i],a=r?r.length:0;if(a>2){this._merge(this.transformPt(r[0]),0);for(var o=1;o<a;++o)this._merge(this.transformPt(r[o]),0)}}},t.prototype.drawSolidStroke=function(e,t,i){for(var n=.5*this.transformSize(i),r=0,a=e.rings||e.paths;r<a.length;r++){var o=a[r],s=o?o.length:0;if(s>1){this._merge(this.transformPt(o[0]),n);for(var l=1;l<s;++l)this._merge(this.transformPt(o[l]),n)}}},t}(s);t.EnvDrawHelper=l;var u=function(e){function t(t,i){var n=e.call(this,i)||this;return n._ctx=t,n}return i(t,e),t.prototype.drawSolidFill=function(e,t){var i=this._ctx;i.fillStyle="rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",i.beginPath();for(var n=0,r=e.rings;n<r.length;n++){var a=r[n],o=a?a.length:0;if(o>2){var s=this.transformPt(a[0]);i.moveTo(s[0],s[1]);for(var l=1;l<o;++l)s=this.transformPt(a[l]),i.lineTo(s[0],s[1]);i.closePath()}}i.fill("evenodd")},t.prototype.drawSolidStroke=function(e,t,i){var n=this._ctx;n.strokeStyle="rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",n.lineWidth=this.transformSize(i)+.5,n.beginPath();for(var r=!!e.rings,a=0,o=e.rings||e.paths;a<o.length;a++){var s=o[a],l=s?s.length:0;if(l>1){var u=this.transformPt(s[0]);n.moveTo(u[0],u[1]);for(var d=1;d<l;++d)u=this.transformPt(s[d]),n.lineTo(u[0],u[1]);r&&n.closePath()}}n.stroke()},t}(s);t.CanvasDrawHelper=u}.apply(null,n))||(e.exports=r)},2416:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(433),i(354),i(1277),i(1663),i(371)],void 0===(r=function(e,t,i,n,r,a,o){var s;return n("stable-symbol-rendering")&&(s=new Set),function(){function e(e,t,i){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphIndex={},this._textures=[],this._rangePromises=new Map,(e<=0||t<=0)&&console.error("Glyph mosaic width and height must be greater than zero!"),this.width=e,this.height=t,this._glyphSource=i,this._binPack=new a(e-4,t-4),this._glyphData.push(new Uint8Array(e*t)),this._dirties.push(!0),this._textures.push(void 0),this._addDecorationGlyph()}return e.prototype.getGlyphItems=function(e,t){for(var r=this,a=[],o=this._glyphSource,l=new Set,u=0,d=t;u<d.length;u++){var f=d[u],h=Math.floor(f*(1/256));l.add(h)}var c=[];return l.forEach(function(t){if(t<=256){var i=e+t;if(r._rangePromises.has(i))c.push(r._rangePromises.get(i));else{var n=o.getRange(e,t).then(function(){r._rangePromises.delete(i)}).catch(function(){throw r._rangePromises.delete(i),Error("Unable to query resource")});r._rangePromises.set(i,n),c.push(n)}}}),i(c).then(function(i){var u,d=r._glyphIndex[e];if(d||(d={},r._glyphIndex[e]=d),n("stable-symbol-rendering")){s.clear();for(var f=0,h=t;f<h.length;f++){var c=h[f];s.add(c)}var p=[];l.forEach(function(e){p.push(e)}),p.sort(),u=[];for(var v=0,_=p;v<_.length;v++)for(var m=_[v],g=0;g<256;++g)u.push(256*m+g)}else u=t;for(var y=0,x=u;y<x.length;y++){var b=d[c=x[y]];if(b)n("stable-symbol-rendering")&&!s.has(c)||(a[c]={rect:b.rect,metrics:b.metrics,page:b.page});else{var S=o.getGlyph(e,c);if(S&&S.metrics){var M=r._recordGlyph(S,c);d[c]={rect:M,metrics:S.metrics,tileIDs:null,page:r._currentPage},n("stable-symbol-rendering")&&!s.has(c)||(a[c]={rect:M,metrics:S.metrics,page:r._currentPage}),r._dirties[r._currentPage]=!0}}}return a})},e.prototype._recordGlyph=function(e,t){var i,n=e.metrics;if(0===n.width)i=new r(0,0,0,0);else{var o=n.width+6,s=n.height+6,l=o%4?4-o%4:4,u=s%4?4-s%4:4;1===l&&(l=5),1===u&&(u=5),(i=this._binPack.allocate(o+l,s+u)).isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new a(this.width-4,this.height-4),i=this._binPack.allocate(o+l,s+u));var d=this._glyphData[this._currentPage],f=e.bitmap,h=void 0,c=void 0;if(f)for(var p=0;p<s;p++){h=o*p,c=this.width*(i.y+p+1)+i.x;for(var v=0;v<o;v++)d[c+v+1]=f[h+v]}}return i},e.prototype._addDecorationGlyph=function(){for(var e=[117,149,181,207,207,181,149,117],t=[],i=0;i<e.length;i++)for(var n=e[i],r=0;r<11;r++)t.push(n);var a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(t)};this._recordGlyph(a,0)},e.prototype.bind=function(e,t,i,n){this._textures[i]||(this._textures[i]=new o(e,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&r.setData(this._glyphData[i]),e.bindTexture(r,n),this._dirties[i]=!1},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._glyphData.length=0},e}()}.apply(null,n))||(e.exports=r)},2417:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(351),i(594),i(340)],void 0===(r=function(e,t,i,n,r){var a=function(){function e(e){for(this._metrics=[],this._bitmaps=[];e.next();)switch(e.tag()){case 1:for(var t=e.getMessage();t.next();)switch(t.tag()){case 3:for(var i=t.getMessage(),n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0;i.next();)switch(i.tag()){case 1:n=i.getUInt32();break;case 2:r=i.getBytes();break;case 3:a=i.getUInt32();break;case 4:o=i.getUInt32();break;case 5:s=i.getSInt32();break;case 6:l=i.getSInt32();break;case 7:u=i.getUInt32();break;default:i.skip()}n&&(this._metrics[n]={width:a,height:o,left:s,top:l,advance:u},this._bitmaps[n]=r);break;default:t.skip()}break;default:e.skip()}}return e.prototype.getMetrics=function(e){return this._metrics[e]},e.prototype.getBitmap=function(e){return this._bitmaps[e]},e}(),o=function(){function e(){this._ranges=[]}return e.prototype.getRange=function(e){return this._ranges[e]},e.prototype.addRange=function(e,t){this._ranges[e]=t},e}();return function(){function e(e){this._glyphInfo={},this._baseURL=e}return e.prototype.getRange=function(e,t){var o=this._getFontStack(e);if(o.getRange(t))return r.resolve();var s=256*t,l=s+255,u=this._baseURL.replace("{fontstack}",e).replace("{range}",s+"-"+l);return i(u,{responseType:"array-buffer"}).then(function(e){o.addRange(t,new a(new n(new Uint8Array(e.data),new DataView(e.data))))})},e.prototype.getGlyph=function(e,t){var i=this._getFontStack(e);if(i){var n=Math.floor(t/256);if(!(n>256)){var r=i.getRange(n);if(r)return{metrics:r.getMetrics(t),bitmap:r.getBitmap(t)}}}},e.prototype._getFontStack=function(e){var t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new o),t},e}()}.apply(null,n))||(e.exports=r)},2418:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(340),i(1581)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.size=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=e,this.context=this.canvas.getContext("2d"),this._gridOuter=new Float64Array(e*e),this._gridInner=new Float64Array(e*e),this._f=new Float64Array(e),this._d=new Float64Array(e),this._z=new Float64Array(e+1),this._v=new Int16Array(e);var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),document.body.appendChild(t),this._svg=t}return e.prototype.draw=function(e,t){var r=this;void 0===t&&(t=31);var a=this._createSVGString(e);return i.create(function(e){var i=new Image;i.src="data:image/svg+xml; charset=utf8, "+encodeURIComponent(a),i.onload=function(){r.context.clearRect(0,0,r.size,r.size),r.context.drawImage(i,0,0,r.size,r.size);for(var a=r.context.getImageData(0,0,r.size,r.size),o=new Uint8Array(r.size*r.size*4),s=0;s<r.size*r.size;s++){var l=a.data[4*s+3]/255;r._gridOuter[s]=1===l?0:0===l?1e20:Math.pow(Math.max(0,.5-l),2),r._gridInner[s]=1===l?1e20:0===l?0:Math.pow(Math.max(0,l-.5),2)}r._edt(r._gridOuter,r.size,r.size),r._edt(r._gridInner,r.size,r.size);for(s=0;s<r.size*r.size;s++){var u=.5-(r._gridOuter[s]-r._gridInner[s])/(2*t);n.packFloat(u,o,4*s)}e(o)}})},e.prototype._createSVGString=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",e),this._svg.appendChild(t);var i,n,r,a,o=t.getBBox(),s=o.width/o.height,l=this.size/2;s>1?(n=i=l/o.width,a=(r=this.size/4)*s):(i=n=l/o.height,r=(a=this.size/4)/s);var u=-o.x+r,d=-o.y+a;t.setAttribute("style","transform: matrix("+i+", 0, 0, "+n+", "+u+", "+d+")");var f='<svg style="fill:red;" height="'+this.size+'" width="'+this.size+'" xmlns="http://www.w3.org/2000/svg">'+this._svg.innerHTML+"</svg>";return this._svg.removeChild(t),f},e.prototype._edt=function(e,t,i){for(var n=this._f,r=this._d,a=this._v,o=this._z,s=0;s<t;s++){for(var l=0;l<i;l++)n[l]=e[l*t+s];this._edt1d(n,r,a,o,i);for(l=0;l<i;l++)e[l*t+s]=r[l]}for(l=0;l<i;l++){for(s=0;s<t;s++)n[s]=e[l*t+s];this._edt1d(n,r,a,o,t);for(s=0;s<t;s++)e[l*t+s]=Math.sqrt(r[s])}},e.prototype._edt1d=function(e,t,i,n,r){i[0]=0,n[0]=-1e20,n[1]=1e20;for(var a=1,o=0;a<r;a++){for(var s=(e[a]+a*a-(e[i[o]]+i[o]*i[o]))/(2*a-2*i[o]);s<=n[o];)o--,s=(e[a]+a*a-(e[i[o]]+i[o]*i[o]))/(2*a-2*i[o]);i[++o]=a,n[o]=s,n[o+1]=1e20}for(a=0,o=0;a<r;a++){for(;n[o+1]<a;)o++;t[a]=(a-i[o])*(a-i[o])+e[i[o]]}},e}();t.default=r}.apply(null,n))||(e.exports=r)},2419:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1022),i(1277),i(1663),i(371)],void 0===(r=function(e,t,i,n,r,a){return function(){function e(e,t,i){void 0===i&&(i=0),this._size=[],this._mosaicsData=[],this._textures=[],this._dirties=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects=new Map,this._spriteCopyQueue=[],this.pixelRatio=1,(e<=0||t<=0)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!"),this._pageWidth=e,this._pageHeight=t,i>0&&(this._maxItemSize=i),this.pixelRatio=1|window.devicePixelRatio,this._binPack=new r(this._pageWidth,this._pageHeight);var n=Math.floor(this._pageWidth),a=Math.floor(this._pageHeight);this._mosaicsData[0]=new Uint32Array(n*a),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0)}return e.prototype.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]},e.prototype.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]},e.prototype.getPage=function(e){return e<this._textures.length?this._textures[e]:null},e.prototype.has=function(e){return this._mosaicRects.has(e)},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0}),e.prototype.getSpriteItem=function(e){return this._mosaicRects.get(e)},e.prototype.addSpriteItem=function(e,t,i,n,r,a){if(this._mosaicRects.has(e))return this._mosaicRects.get(e);var o=this._allocateImage(t[0],t[1]),s=o[0],l=o[1],u=o[2];if(s.width<=0||s.height<=0)return null;var d={rect:s,width:t[0],height:t[1],anchorX:i[0],anchorY:i[1],sdf:a,pixelRatio:1,page:l};return this._mosaicRects.set(e,d),this._copy({rect:s,spriteSize:t,spriteData:n,page:l,pageSize:u,repeat:r,sdf:a}),d},e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length},e.prototype.processNextItem=function(){var e=this._spriteCopyQueue.pop();e&&this._copy(e)},e.prototype.getSpriteItems=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i];t[r]=this.getSpriteItem(r)}return t},e.prototype.getMosaicItemPosition=function(e,t){var i=this.getSpriteItem(e),n=i&&i.rect;if(!n)return null;n.width=i.width,n.height=i.height;var r=i.width,a=i.height;return{size:[i.width,i.height],tl:[(n.x+1)/this._size[i.page][0],(n.y+1)/this._size[i.page][1]],br:[(n.x+1+r)/this._size[i.page][0],(n.y+1+a)/this._size[i.page][1]],page:i.page}},e.prototype.bind=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this._textures[i]||(this._textures[i]=new a(e,{pixelFormat:6408,dataType:5121,width:this._size[i][0],height:this._size[i][1]},new Uint8Array(this._mosaicsData[i].buffer)));var r=this._textures[i];r.setSamplingMode(t),this._dirties[i]&&(r.setData(new Uint8Array(this._mosaicsData[i].buffer)),r.generateMipmap()),e.bindTexture(r,n),this._dirties[i]=!1},e._copyBits=function(e,t,i,n,r,a,o,s,l,u,d){var f=n*t+i,h=s*a+o;if(d){h-=a;for(var c=-1;c<=u;f=((++c+u)%u+n)*t+i,h+=a)for(var p=-1;p<=l;p++)r[h+p]=e[f+(p+l)%l]}else for(c=0;c<u;c++){for(p=0;p<l;p++)r[h+p]=e[f+p];f+=t,h+=a}},e.prototype._copy=function(t){if(!(t.page>=this._mosaicsData.length)){var i=t.spriteData,n=this._mosaicsData[t.page];n&&i||console.error("Source or target images are uninitialized!"),e._copyBits(i,t.spriteSize[0],0,0,n,t.pageSize[0],t.rect.x+1,t.rect.y+1,t.spriteSize[0],t.spriteSize[1],t.repeat),this._dirties[t.page]=!0}},e.prototype._allocateImage=function(e,t){e+=2,t+=2;var a=Math.max(e,t);if(this._maxItemSize&&this._maxItemSize<a){var o=Math.pow(2,Math.ceil(i.log2(e))),s=Math.pow(2,Math.ceil(i.log2(t))),l=new n(0,0,e,t);return this._mosaicsData.push(new Uint32Array(o*s)),this._dirties.push(!0),this._size.push([o,s]),this._textures.push(void 0),[l,this._mosaicsData.length-1,[o,s]]}var u=e%4?4-e%4:0,d=t%4?4-t%4:0,f=this._binPack.allocate(e+u,t+d);return f.width<=0?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new r(this._pageWidth,this._pageHeight),this._allocateImage(e,t)):[f,this._currentPage,[this._pageWidth,this._pageHeight]]},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._mosaicsData.length=0,this._mosaicRects.clear()},e}()}.apply(null,n))||(e.exports=r)},2420:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(357),i(442),i(727),i(1027),i(675)],void 0===(r=function(e,t,i,n,r,a,o){function s(e,t){var i=t.length;if(e<t[0].value||1===i)return t[0].size;for(var n=1;n<i;n++)if(e<t[n].value){var r=(e-t[n-1].value)/(t[n].value-t[n-1].value);return t[n-1].size+r*(t[n].size-t[n-1].size)}return t[i-1].size}return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0}),e.prototype.updateHeatmapParameters=function(e){var t=e.blurRadius,i=Math.round(4.5*e.blurRadius),n=2*i+1;this._heatmapParameters||(this._heatmapParameters={radius:t,blurRadius:i,kernelSize:n,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:e.maxPixelIntensity,minPixelIntensity:e.minPixelIntensity});var r=this._heatmapParameters;r.color=function(e){for(var t,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<16;r++){var o=e[Math.min(r,e.length-1)];i[r]=o.ratio,n[0+(t=4*r)]=o.color[0]/255,n[t+1]=o.color[1]/255,n[t+2]=o.color[2]/255,n[t+3]=o.color[3]>1?o.color[3]/255:o.color[3],a.premultiplyAlpha(n,t,!0)}return{values:i,colors:n,refreshColorRamp:!0}}(e.colorStops),Math.abs(r.radius-e.radius)>1e-6&&(r.radius=t,r.blurRadius=i,r.kernelSize=n,r.refreshIntensityKernel=!0),r.maxPixelIntensity=e.maxPixelIntensity,r.minPixelIntensity=e.minPixelIntensity},e.prototype.updateVisualVariables=function(e,t){var a=this._vvMaterialParameters;if(a.vvOpacityEnabled=!1,a.vvSizeEnabled=!1,a.vvColorEnabled=!1,a.vvRotationEnabled=!1,e){var l=e.size;if(l){if(a.vvSizeEnabled=!0,l.minMaxValue){var u=l.minMaxValue,d=void 0,f=void 0;if(o.isDefined(u.minSize)&&o.isDefined(u.maxSize))if(o.isNumber(u.minSize)&&o.isNumber(u.maxSize))d=i.pt2px(u.minSize),f=i.pt2px(u.maxSize);else{var h=t.scale;d=i.pt2px(s(h,u.minSize.stops)),f=i.pt2px(s(h,u.maxSize.stops))}this.vvSizeMinMaxValue.set([u.minDataValue,u.maxDataValue,d,f])}if(l.scaleStops&&(this.vvSizeScaleStopsValue=i.pt2px(s(t.scale,l.scaleStops.stops))),l.unitValue){var c=n.getMetersPerUnitForSR(t.spatialReference)/r.meterIn[l.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=c/t.resolution}l.fieldStops&&(this.vvSizeFieldStopsValues.set(l.fieldStops.values),this.vvSizeFieldStopsSizes.set(l.fieldStops.sizes))}var p=e.color;p&&(a.vvColorEnabled=!0,this.vvColorValues.set(p.values),this.vvColors.set(p.colors));var v=e.opacity;v&&(a.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities));var _=e.rotation;_&&(a.vvRotationEnabled=!0,a.vvRotationType=_.type)}},e}()}.apply(null,n))||(e.exports=r)},2421:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(347),i(1303),i(759),i(961),i(728),i(774),i(2422),i(2423),i(623),i(1061),i(2425),i(675),i(2433),i(1582),i(725),i(456)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_,m){function g(e,t){return e.sortKey-t.sortKey}return function(e){function t(t,i){var o=e.call(this)||this;return o.status=_.TileStatus.INITIALIZED,o._data=null,o.hlDisplayList=null,o._displayList=null,o._wglBuffers=null,o._dirtyMap=new l.default,o.coords=[0,0],o.bounds=[0,0,0,0],o.tileTransform={transform:Float32Array[16],screenTransform:Float32Array[16],displayCoord:Float32Array[2],screenCoord:Float32Array[2]},o._labelIndex=null,o.tileTransform.screenTransform=n.create(),o.tileTransform.transform=r.create(),o.tileTransform.displayCoord=a.create(),o.tileTransform.screenCoord=a.create(),o.key=m.pool.acquire(t),o.coords[0]=i[0],o.coords[1]=i[3],o.bounds=i,o}return i(t,e),Object.defineProperty(t.prototype,"iconGeometry",{get:function(){return this.getGeometry(d.WGLGeometryType.MARKER)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textGeometry",{get:function(){return this.getGeometry(d.WGLGeometryType.TEXT)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillGeometry",{get:function(){return this.getGeometry(d.WGLGeometryType.FILL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineGeometry",{get:function(){return this.getGeometry(d.WGLGeometryType.LINE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelGeometry",{get:function(){return this.getGeometry(d.WGLGeometryType.LABEL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this.status===_.TileStatus.MODIFIED},set:function(e){this.hasData&&(e&&this.status===_.TileStatus.READY?this.setStatus(_.TileStatus.MODIFIED):e||this.status!==_.TileStatus.MODIFIED||this.setStatus(_.TileStatus.READY),this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case d.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t,i){var n=e.addOrUpdate&&h.decode(e.addOrUpdate),r=e.remove;if((e.clear||!this.hasData)&&!e.addOrUpdate)return this.clear(),void this.setStatus(_.TileStatus.NO_DATA);!e.clear&&this.hasData||!e.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:n,remove:r},t,i):(this._dirtyMap=new l.default,this._dispRecStore=u.default.fromTileData(n,this._dirtyMap),this._data=n,this._readyTileIfNoLabels(t,i),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=n.tileDisplayData.displayList.clone()))},t.prototype.commitChanges=function(e){this._data&&(this.status===_.TileStatus.READY||this.status===_.TileStatus.MODIFIED&&!this._wglBuffers)&&(this._wglBuffers||(this._wglBuffers=new p.default(e.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.resetVisibility=function(e){var t=this,i=new Array(0),n=new Array(1);e.forEach(function(e){n[0]=e,t.setVisibility(i,n)})},t.prototype.setVisibility=function(e,t){for(var i=this._data.tileBufferData.geometries.map(function(e){return{vertexFrom:void 0,vertexTo:void 0,geometry:e}}),n=0,r=e;n<r.length;n++){var a=r[n];if(p=this._data.tileDisplayData.displayObjectRegistry.get(a))for(var o=0,s=p.displayRecords;o<s.length;o++){if(y=(S=i[(g=s[o]).geometryType]).geometry.vertexBuffer[c.C_VBO_VISIBILITY]){S.vertexFrom=null==S.vertexFrom?g.vertexFrom:Math.min(S.vertexFrom,g.vertexFrom),S.vertexTo=null==S.vertexTo?g.vertexFrom+g.vertexCount:Math.max(S.vertexTo,g.vertexFrom+g.vertexCount);for(var l=g.vertexFrom,u=g.vertexCount,d=0;d<u;++d)y.data[l+d]=255}}}for(var f=0,h=t;f<h.length;f++){var p,v=h[f];if(p=this._data.tileDisplayData.displayObjectRegistry.get(v))for(var _=0,m=p.displayRecords;_<m.length;_++){var g,y;if(y=(S=i[(g=m[_]).geometryType]).geometry.vertexBuffer[c.C_VBO_VISIBILITY]){S.vertexFrom=null==S.vertexFrom?g.vertexFrom:Math.min(S.vertexFrom,g.vertexFrom),S.vertexTo=null==S.vertexTo?g.vertexFrom+g.vertexCount:Math.max(S.vertexTo,g.vertexFrom+g.vertexCount);for(l=g.vertexFrom,u=g.vertexCount,d=0;d<u;++d)y.data[l+d]=0}}}for(var x=!1,b=0;b<i.length;++b){var S;if(null!=(S=i[b]).vertexFrom&&null!=S.vertexTo){var M=S.vertexTo?S.vertexTo-S.vertexFrom:0;this._dirtyMap.markDirtyVertices(b,c.C_VBO_VISIBILITY,S.vertexFrom,M),x=!0}}x&&this.requestRender()},t.prototype.setVisibilityRange=function(e,t,i,n){for(var r=f.i8888to32(i,n,i,n),a=void 0,o=void 0,s=this._data.tileBufferData.geometries[d.WGLGeometryType.LABEL].vertexBuffer[c.C_VBO_VISIBILITY_RANGE],l=this._data.tileDisplayData.displayObjectRegistry.get(e),u=l.metrics[t],h=u.range.from,p=h+u.range.count,v=h;v<p;++v){var _=l.displayRecords[v];if(_.geometryType===d.WGLGeometryType.LABEL){a=null==a?_.vertexFrom:Math.min(a,_.vertexFrom),o=null==o?_.vertexFrom+_.vertexCount:Math.max(o,_.vertexFrom+_.vertexCount);for(var m=_.vertexFrom*s.stride/4,g=_.vertexCount*s.stride/4,y=0;y<g;++y)s.data[m+y]=r}}var x=o?o-a:0;this._dirtyMap.markDirtyVertices(d.WGLGeometryType.LABEL,c.C_VBO_VISIBILITY_RANGE,a,x)},t.prototype.setStatus=function(e){this.status=e,e!==_.TileStatus.READY&&e!==_.TileStatus.NO_DATA||(this.attached=!0)},t.prototype.clear=function(){this.attached=!1,this._data=null,this._displayList=null,this._dispRecStore=null,this.setStatus(_.TileStatus.INITIALIZED),this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.dispose=function(){this.clear()},t.prototype.attach=function(e){return this.canDisplay},t.prototype.detach=function(t){e.prototype.detach.call(this,t)},t.prototype.doRender=function(e){var t=this;this.attached&&this.hasData&&(this.commitChanges(e),e.context.setStencilFunction(514,this.stencilRef,255),e.painter.getBrushes(e.drawPhase).forEach(function(i){return i.draw(e,t)}))},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new v;e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var i=this._data.tileDisplayData.displayObjectRegistry.get(t);if(i){for(var n=[],r=0,a=i.displayRecords;r<a.length;r++){var o=a[r].copy();o.meshData=null,o.symbolLevel=0,o.zOrder=0,n.push(o)}n.sort(g),e.addToList(n)}}},t.prototype._readyTileIfNoLabels=function(e,t){e?(this.setStatus(t?_.TileStatus.MODIFIED:_.TileStatus.READY),this._rebuildLabelIndex()):this.setStatus(_.TileStatus.READY)},t.prototype._doPatchData=function(e,t,i){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=u.default.fromTileData(this._data,this._dirtyMap)),this._readyTileIfNoLabels(t,i),this.requestRender()},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._insertIntoLabelIndex(i)}},t.prototype._insertIntoLabelIndex=function(e){var t=e.anchor;-1!==e.xBucket&&t&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<s.TILE_SIZE/s.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var i=0;i<s.TILE_SIZE/s.COLLISION_BUCKET_SIZE;i++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,i=0,n=e.remove||[];i<n.length;i++){var r=n[i];if(f=this._data.tileDisplayData.displayObjectRegistry.get(r)){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);for(var a=0,o=f.displayRecords;a<o.length;a++){var s=o[a];this._dispRecStore.delete(s)}this._data.tileDisplayData.displayObjectRegistry.delete(r);var l=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(l,1)}}for(var u=0,d=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[];u<d.length;u++){var f,h=d[u];if(f=this._data.tileDisplayData.displayObjectRegistry.get(h.id)){var c=f.displayRecords;f.set(h),f.displayRecords=c;for(var p=f.displayRecords.length,v=0;v<p;++v){var _=f.displayRecords[v],m=h.displayRecords[v];(v>=h.displayRecords.length||_.geometryType!==m.geometryType||_.symbolLevel!==m.symbolLevel||_.zOrder!==m.zOrder||_.materialInfo.materialKey!==m.materialInfo.materialKey)&&(this._dispRecStore.delete(f.displayRecords[v]),v<h.displayRecords.length&&(f.displayRecords[v]=void 0))}f.displayRecords.length=h.displayRecords.length,f.anchor=h.anchor,f.metrics=h.metrics}else(f=h.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(h.id,f),this._data.tileDisplayData.displayObjects.push(f);var g=h.displayRecords.length;for(v=0;v<g;++v){m=h.displayRecords[v];(_=f.displayRecords[v])?(_.meshData=m.meshData,_.materialInfo=m.materialInfo):((_=m.copy()).vertexFrom=void 0,_.indexFrom=void 0,f.displayRecords[v]=_);var y=m.geometryType,x=e.addOrUpdate.tileBufferData.geometries[y],b=x.vertexBuffer,S=x.indexBuffer;t=this._dispRecStore.setMeshData(_,m,b,S)&&t}}return t},t}(o)}.apply(null,n))||(e.exports=r)},2422:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(675)],void 0===(r=function(e,t,i){function n(e,t,i){if(!e.allDirty)if(null!=e.from&&null!=e.count){var n=Math.min(e.from,t),r=Math.max(e.from+e.count,t+i)-n;e.from=n,e.count=r}else e.from=t,e.count=i}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._dirties=i.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var n in i.data.indices.from=null,i.data.indices.count=null,i.data.indices.allDirty=!1,i.buffers)i.buffers[n].data.vertices.from=null,i.buffers[n].data.vertices.count=null,i.buffers[n].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var n in i.data.indices.allDirty=!0,i.buffers)i.buffers[n].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=new Map,i=0;i<this._dirties.length;++i){var n=this._dirties[i],r=new Map;for(var a in n.buffers){var o=n.buffers[a].data.vertices;(o.allDirty||null!=o.from&&null!=o.count)&&r.set(a,o)}var s,l=n.data.indices;((s=l.allDirty||null!=l.from&&null!=l.count?{indices:l,vertices:r}:{indices:void 0,vertices:r}).indices||s.vertices.size>0)&&t.set(i,s)}t.forEach(function(t,i){e({indices:t.indices||null,vertices:t.vertices.size>0?t.vertices:null},i)})},e.prototype.markDirtyIndices=function(e,t,i){n(this._dirties[e].data.indices,t,i)},e.prototype.markDirtyVertices=function(e,t,i,r){n(this._dirties[e].buffers[t].data.vertices,i,r)},e}();t.default=r}.apply(null,n))||(e.exports=r)},2423:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(354),i(2424),i(675)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var a=["FILL","LINE","MARKER","TEXT","LABEL"],o=function(){function e(e,t,i,a){for(var o in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=i,e)for(var s in this._freeListsAndStorage[o]={vtxFreeList:a?new n.FreeList(a):null,idxFreeList:a?new n.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null},e[o])this._freeListsAndStorage[o].vertexBuffers[s]={data:a?r.allocateTypedArrayBuffer(a,e[o][s]):null,stride:e[o][s]}}return e.fromTileData=function(t,i){var o=function(e){var t=e.getStrides(),i={};for(var n in t)i[a[n]]=t[n];return i}(t),s=[0,0,0,0,0],l=[0,0,0,0,0],u=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){u.push(e)});for(var d=0,f=u;d<f.length;d++)for(var h=0,c=f[d].displayRecords;h<c.length;h++){var p=c[h];s[p.geometryType]=Math.max(s[p.geometryType],p.vertexFrom+p.vertexCount),l[p.geometryType]=Math.max(l[p.geometryType],p.indexFrom+p.indexCount)}for(var v=new e(o,t.tileDisplayData.displayList,i,null),_=0;_<t.tileBufferData.geometries.length;++_){var m=s[_],g=l[_],y=t.tileBufferData.geometries[_],x=a[_],b=v._storageFor(x),S=t.tileBufferData.geometries[_].indexBuffer;b.indexBuffer=S,b.idxFreeList=new n.FreeList(S.length),b.idxFreeList.allocate(g);var M=void 0;for(var I in y.vertexBuffer){var w=t.tileBufferData.geometries[_].vertexBuffer[I];b.vertexBuffers[I].data=w.data,b.vertexBuffers[I].stride=w.stride;var V=r.strideToPackingFactor(w.stride),D=w.data.length*V/w.stride;M||(M=D)}b.vtxFreeList=new n.FreeList(M),b.vtxFreeList.allocate(m)}return v},e.prototype.delete=function(e){var t=a[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,i,n){var o=a[e.geometryType];e.meshData=null;var s=void 0,l=void 0;void 0===e.vertexFrom?(l=t.vertexCount,s=this._allocateVertices(o,l)):t.vertexCount>e.vertexCount?(this._freeVertices(o,e.vertexFrom,e.vertexCount),l=t.vertexCount,s=this._allocateVertices(o,l)):t.vertexCount===e.vertexCount?(s=e.vertexFrom,l=e.vertexCount):(this._freeVertices(o,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),s=e.vertexFrom,l=t.vertexCount);var u=!0,d=void 0,f=void 0,h=void 0;if(void 0===e.indexFrom?(h=t.indexCount,f=this._allocateIndices(o,h)):t.indexCount>e.indexCount?(d=this._displayList.removeFromList(e),this._freeIndices(o,e.indexFrom,e.indexCount),h=t.indexCount,f=this._allocateIndices(o,h)):t.indexCount===e.indexCount?(u=!1,f=e.indexFrom,h=e.indexCount):(d=this._displayList.removeFromList(e),this._freeIndices(o,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),f=e.indexFrom,h=t.indexCount),-1!==s&&-1!==f){var c=this._storageFor(o);if(r.copyMeshData(s,f,c.vertexBuffers,c.indexBuffer,t,i,n),e.vertexFrom=s,e.indexFrom=f,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var p in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),i)this._dirtyMap.markDirtyVertices(e.geometryType,p,e.vertexFrom,e.vertexCount);return u&&this._displayList.addToList(e,d),!0}return-1!==s&&this._freeVertices(o,s,l),-1!==f&&this._freeIndices(o,f,h),e.setMeshDataFromBuffers(t,i,n),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1},e.prototype._allocateVertices=function(e,t){var i=this._storageFor(e),n=i.vtxFreeList.allocate(t);return-1===n?-1:i.vtxFreeList.fragmentation>.5?-1:n},e.prototype._freeVertices=function(e,t,n){var a=this._storageFor(e);if(a.vtxFreeList.free(t,n),i("esri-feature-tiles-debug"))for(var o in a.vertexBuffers)for(var s=a.vertexBuffers[o].data,l=this._stridesFor(e,o),u=r.strideToPackingFactor(l),d=t*l/u,f=n*l/u,h=d;h<d+f;++h)s[h]=0},e.prototype._freeIndices=function(e,t,n){var r=this._storageFor(e);if(r.idxFreeList.free(t,n),i("esri-feature-tiles-debug"))for(var a=r.indexBuffer,o=t;o<t+n;++o)a[o]=0},e.prototype._allocateIndices=function(e,t){var i=this._storageFor(e),n=i.idxFreeList.allocate(t);return-1===n?-1:i.idxFreeList.fragmentation>.5?-1:n},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=o}.apply(null,n))||(e.exports=r)},2424:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,i){e===this._largestRange?e.count<i&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,i=null;null!==t;)t.count>=e&&(!i||t.count-e<i.count-e)&&(i=t),t=t.next;return i},e.prototype.findAdjacentRanges=function(e,t){for(var i=!0,n=!1,r=null,a=this._parent._freeHead;i&&!n;){var o=null!==r?r.from+r.count:0,s=null!==a?a.from:this._parent._size;e>=o&&e+t<=s?(i=!1,n=!0):null!==a?(r=a,a=a.next):i=!1}return[r,a]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),n=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=e>0?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new i(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var i=this._bookKeeper.findBestRange(t);if(null===i)return-1;var n=i.from,r=i.count;if(i.from+=t,i.count-=t,this._bookKeeper.rangeResized(i,n,r),this._allocated+=t,0===i.count){var a=null!==i.prev?this._freeHead:i.next;e._removeRange(i),this._freeHead=a}return n},e.prototype.free=function(t,i){var n=this._bookKeeper.findAdjacentRanges(t,i),r=n[0],a=n[1],o={from:t,count:i,prev:r,next:a};if(null!==r&&(r.next=o),null!==a&&(a.prev=o),this._bookKeeper.rangeCreated(o),this._allocated-=i,null!==a&&o.from+o.count===a.from){var s=o.from,l=o.count;e._fuse(o,a),e._removeRange(a),this._bookKeeper.rangeResized(o,s,l),this._bookKeeper.rangeResized(a,void 0,0)}if(null!==r&&r.from+r.count===o.from){s=r.from,l=r.count;e._fuse(r,o),e._removeRange(o),this._bookKeeper.rangeResized(r,s,l),this._bookKeeper.rangeResized(o,void 0,0)}this._freeHead=null!==o.prev?this._freeHead:o},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=n}.apply(null,n))||(e.exports=r)},2425:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(2426),i(2427),i(2428),i(675),i(675),i(1582),i(1583),i(1284),i(2431),i(1585),i(2432),i(1060),i(1586)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p){function v(e,t){var i={};for(var n in e){var r={data:o.allocateTypedArrayBuffer(t,e[n]),stride:e[n]};i[n]=r}return i}var _=new i.default,m=new i.default;return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){_.reset();var t=this._collectDisplayRecords();for(var i in t)for(var r=0,l=b=t[i];r<l.length;r++){var u=l[r];_.needMore(u.geometryType,u.meshData?u.meshData.vertexCount:u.vertexCount,u.meshData?u.meshData.indexData.length:u.indexCount)}var d=t.length,f=new n;for(i=0;i<d;++i){f.geometries[i].indexBuffer=new Uint32Array(Math.round(1.15*_.indicesFor(i)));var h=[];for(var c in this.tileBufferData.geometries[i].vertexBuffer)h.push(this.tileBufferData.geometries[i].vertexBuffer[c].stride);var p=e._computeVertexAlignment(h),v=Math.round(1.15*_.verticesFor(i)),g=e._align(v,p);for(var y in this.tileBufferData.geometries[i].vertexBuffer){var x=this.tileBufferData.geometries[i].vertexBuffer[y].stride;f.geometries[i].vertexBuffer[y]={stride:x,data:o.allocateTypedArrayBuffer(g,x)}}}m.reset(),this.tileDisplayData.displayList=new s;for(i=0;i<d;++i){for(var b,S=0,M=b=t[i];S<M.length;S++){if((u=M[S]).meshData)u.writeMeshDataToBuffers(m.verticesFor(i),f.geometries[i].vertexBuffer,m.indicesFor(i),f.geometries[i].indexBuffer),u.meshData=null;else{var I=this.tileBufferData.geometries[i].vertexBuffer,w=this.tileBufferData.geometries[i].indexBuffer,V=f.geometries[i].vertexBuffer,D=f.geometries[i].indexBuffer,z=m.verticesFor(i),F=m.indicesFor(i);a.copyMeshData(z,F,V,D,u,I,w),u.vertexFrom=z,u.indexFrom=F}m.needMore(i,u.vertexCount,u.indexCount)}this.tileDisplayData.displayList.addToList(b)}this.tileBufferData=f},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var i=this.tileBufferData.geometries[t];for(var n in e[t]={},i.vertexBuffer)e[t][n]=i.vertexBuffer[n].stride}return e},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),i=0,n=0;n<t;n++)i=Math.max(i,e[n].displayRecords.length);return 2*(12*e.length+e.length*i*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),i=this.tileDisplayData.serialize(new p.default(Int32Array,this._guessSize())).buffer();return t.push(i),{result:{displayData:i,bufferData:e},transferList:t}},e.decode=function(t){var i=f.default.deserialize(new h.default(t.materialStore)),a=c.deserializeList(new h.default(t.displayObjects),l,{store:i}),o={};for(var s in t.vertexBuffersMap)o[s]=d.VertexBuffers.decode(t.vertexBuffersMap[s]);var u=new e,p=new r,v=new n;for(var _ in p.displayObjects=a,o){var m=o[_];v.geometries[_].indexBuffer=m.indexBuffer,v.geometries[_].vertexBuffer=m.namedBuffers}return u.tileDisplayData=p,u.tileBufferData=v,u},e.bind=function(t,i){var n=new e;return n.tileDisplayData=t,n.tileBufferData=i,n},e.create=function(t,i){var a=new e;a.tileDisplayData=new r,a.tileDisplayData.displayObjects=t;for(var o=[0,0,0,0,0],s=[0,0,0,0,0],l=[[],[],[],[],[]],d=0,f=t;d<f.length;d++)for(var h=0,c=f[d].displayRecords;h<c.length;h++){var p=c[h];l[p.geometryType].push(p),o[p.geometryType]+=p.meshData.vertexCount,s[p.geometryType]+=p.meshData.indexData.length}for(var _=new n,m=function(e){return[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}]}(i),g=0;g<5;g++){var y=new Uint32Array(s[g]),x=v(m[g],o[g]);u.writeAllMeshDataToBuffers(l[g],x,y),_.geometries[g]={indexBuffer:y,vertexBuffer:x}}return a.tileBufferData=_,a},e._align=function(e,t){var i=e%t;return 0===i?e:e+(t-i)},e._computeVertexAlignment=function(e){for(var t=!1,i=!1,n=0,r=e;n<r.length;n++){var a=r[n];a%4==2?t=!0:a%4!=0&&(i=!0)}return i?4:t?2:1},e.prototype._collectDisplayRecords=function(){for(var e=[[],[],[],[],[]],t=0,i=this.tileDisplayData.displayObjects;t<i.length;t++)for(var n=0,r=i[t].displayRecords;n<r.length;n++){var a=r[n];e[a.geometryType].push(a)}return e},e}()}.apply(null,n))||(e.exports=r)},2426:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,i){if(t||i){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var n=this._byGeometryType[e];n.vertices+=t,n.indices+=i}},e}();t.default=i}.apply(null,n))||(e.exports=r)},2427:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(675)],void 0===(r=function(e,t,i){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.deserialize=function(t){for(var n=new e,r=0;r<5;++r)for(var a in n.geometries[r].indexBuffer=new Uint32Array(t.geometries[r].indexBuffer),n.geometries[r].vertexBuffer={},t.geometries[r].vertexBuffer)n.geometries[r].vertexBuffer[a]={data:i.allocateTypedArrayBufferwithData(t.geometries[r].vertexBuffer[a].data,t.geometries[r].vertexBuffer[a].stride),stride:t.geometries[r].vertexBuffer[a].stride};return n},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var i in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[i]={data:this.geometries[t].vertexBuffer[i].data.buffer,stride:this.geometries[t].vertexBuffer[i].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var i in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[i].data.buffer);return e},e}()}.apply(null,n))||(e.exports=r)},2428:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1582),i(1583),i(1585),i(1060)],void 0===(r=function(e,t,i,n,r,a){return function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._displayObjectRegistry.set(i.id,i)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){if(!this._displayList){this._displayList=new i;for(var e=0,t=this.displayObjects;e<t.length;e++)for(var n=0,r=t[e].displayRecords;n<r.length;n++){var a=r[n];this._displayList.addToList(a)}}return this._displayList},set:function(e){this._displayList=e},enumerable:!0,configurable:!0}),e.prototype.serialize=function(e){return this.materialStore.serialize(e),a.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),r=new Array(t),a=new i,o=new Map,s={store:this.materialStore},l=0;l<r.length;++l){var u=n.deserialize(e,s);r[l]=u,o.set(u.id,u);for(var d=0,f=u.displayRecords;d<f.length;d++){var h=f[d];a.addToList(h)}}this.displayObjects=r,this._displayList=a,this._displayObjectRegistry=o},e.deserialize=function(t){var i=new e;return i.materialStore=r.default.deserialize(t),i._deserializeObjects(t),i},e}()}.apply(null,n))||(e.exports=r)},2431:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(675)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.data=e,this.stride=t,this.vertexCount=i}return e.decode=function(t){return new e(i.allocateTypedArrayBufferwithData(t.data,t.stride),t.stride,t.vertexCount)},e}();t.default=n;var r=function(){function e(e,t,i){this.geometryType=e,this.indexBuffer=new Uint32Array(t),this.namedBuffers=i}return e.decode=function(t){var i=t.geometryType,r=t.indexBuffer,a={};for(var o in t.namedBuffers)a[o]=n.decode(t.namedBuffers[o]);return new e(i,r,a)},e}();t.VertexBuffers=r}.apply(null,n))||(e.exports=r)},2432:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=i}.apply(null,n))||(e.exports=r)},2433:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(675),i(385)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.geometryMap=i.createGeometryData(function(t){return{indexBuffer:n.createIndex(e,35044),vao:null}},function(t,r){return{vertexBuffer:n.createVertex(e,i.C_VBO_INFO[r])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var i in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[i]&&t.buffers[i].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],i={};for(var n in t.buffers)i[n]=t.buffers[n].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:i}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var i=this;t.forEach(function(t,n){t.indices&&(t.indices.allDirty?i._uploadIndices(e,n):null!=t.indices.from&&null!=t.indices.count&&i._uploadIndices(e,n,t.indices.from,t.indices.count)),t.vertices&&t.vertices.forEach(function(t,r){t.allDirty?i._uploadVertices(e,n,r):null!=t.from&&null!=t.count&&i._uploadVertices(e,n,r,t.from,t.count)})})},e.prototype._uploadVertices=function(e,t,i,n,r){var a=this.geometryMap[t];if(a){var o=e.geometries[t].vertexBuffer[i];if(o){var s=o.stride,l=o.data.buffer;a.buffers[i]&&l.byteLength>0&&(null!=n&&null!=r?a.buffers[i].data.vertexBuffer.setSubData(l,n*s,n*s,(n+r)*s):a.buffers[i].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,i,n){var r=this.geometryMap[t];if(r){var a=e.geometries[t].indexBuffer.buffer;r.data.indexBuffer&&a.byteLength>0&&(null!=i&&null!=n?r.data.indexBuffer.setSubData(a,4*i,4*i,4*(i+n)):r.data.indexBuffer.setData(a))}},e}();t.default=r}.apply(null,n))||(e.exports=r)},349:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(344),i(622),i(364)],void 0===(r=function(e,t,i,n,r){function a(e,t){if(!e){var i=new Error("dummy");throw i.stack&&console.log(i.stack),new F(t)}}function o(e,t,n){i.mat4d.multiply(t,e,h),i.mat4d.inverse(h);for(var r=0;r<8;++r)i.mat4d.multiplyVec4(h,c[r],p),i.vec3d.set3(p[0]/p[3],p[1]/p[3],p[2]/p[3],n[r])}function s(e,t){n.plane.fromPoints(e[4],e[0],e[3],t[0]),n.plane.fromPoints(e[1],e[5],e[6],t[1]),n.plane.fromPoints(e[4],e[5],e[1],t[2]),n.plane.fromPoints(e[3],e[2],e[6],t[3]),n.plane.fromPoints(e[0],e[1],e[2],t[4]),n.plane.fromPoints(e[5],e[4],e[7],t[5])}function l(e){for(var t in e)return t}function u(e,t){e[12]=t[0],e[13]=t[1],e[14]=t[2]}function d(e,t){void 0===t&&(t=0);for(var i=0,n=0;n<4;n++)i+=e[t+n]*O[n];return i}function f(e){return e-Math.floor(e)}Object.defineProperty(t,"__esModule",{value:!0});var h=i.mat4d.create(),c=[i.vec4d.createFrom(-1,-1,-1,1),i.vec4d.createFrom(1,-1,-1,1),i.vec4d.createFrom(1,1,-1,1),i.vec4d.createFrom(-1,1,-1,1),i.vec4d.createFrom(-1,-1,1,1),i.vec4d.createFrom(1,-1,1,1),i.vec4d.createFrom(1,1,1,1),i.vec4d.createFrom(-1,1,1,1)],p=i.vec4d.create(),v=[i.vec3d.create(),i.vec3d.create(),i.vec3d.create(),i.vec3d.create(),i.vec3d.create(),i.vec3d.create(),i.vec3d.create(),i.vec3d.create()],_=i.vec3d.create(),m=i.vec3d.create(),g=i.vec3d.create(),y=i.vec3d.create(),x=i.vec3d.create(),b=i.vec3d.create(),S=i.vec3d.create(),M=i.vec3d.create(),I=i.vec3d.create(),w=i.vec3d.create(),V=i.vec3d.create(),D=i.vec3d.create(),z=i.vec3d.createFrom(0,0,0),F=function(){function e(e){this.message=e}return e.prototype.toString=function(){return"AssertException: "+this.message},e}();t.AssertException=F,t.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex"},t.assert=a,t.verify=function(e,t){e||(console.log("Verify failed: "+t),console.log(new Error("dummy").stack))},t.encodeInt16=function(e){return r.clamp(Math.round(32767*e),-32767,32767)},t.encodeNormal=function(e,t){var i=Math.abs(e[0]),n=Math.abs(e[1]),r=1/(i+n+Math.abs(e[2])),a=i*r,o=n*r,s=Math.min(e[2]*r,0);t[0]=(e[0]<0?-1:1)*(a-s),t[1]=(e[1]<0?-1:1)*(o-s)},t.fallbackIfUndefined=function(e,t){return void 0===e?t:e},t.hex2rgb=function(e){return[((e=Math.floor(e))>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return"0x"+((r.clamp(Math.round(255*e[0]),0,255)<<16)+(r.clamp(Math.round(255*e[1]),0,255)<<8)+r.clamp(Math.round(255*e[2]),0,255)).toString(16)},t.dec2hex=function(e){var t=e.toString(16);return"00000000".substr(0,8-t.length)+t},t.raySphere=function(e,t,n,r,a){n=n||z;var o=i.vec3d.subtract(e,n,_),s=i.vec3d.dot(t,t),l=2*i.vec3d.dot(t,o),u=l*l-4*s*(i.vec3d.dot(o,o)-r*r);if(u<0)return!1;var d=Math.sqrt(u),f=(-l-d)/(2*s),h=(-l+d)/(2*s);return(f<0||h<f&&h>0)&&(f=h),f>0&&(a&&i.vec3d.add(e,i.vec3d.scale(t,f,D),a),!0)},t.rayTriangle3D=function(e,t,n,r,a,o,s,l,u){void 0===u&&(u=i.vec3d.create());var d=r[s]-n[o],f=r[s+1]-n[o+1],h=r[s+2]-n[o+2],c=a[l]-n[o],p=a[l+1]-n[o+1],v=a[l+2]-n[o+2],_=t[1]*v-p*t[2],m=t[2]*c-v*t[0],g=t[0]*p-c*t[1],y=d*_+f*m+h*g;if(y>-1e-5&&y<1e-5)return!1;var x=1/y,b=e[0]-n[o],S=e[1]-n[o+1],M=e[2]-n[o+2];if(u[1]=x*(b*_+S*m+M*g),u[1]<0||u[1]>1)return!1;var I=S*h-f*M,w=M*d-h*b,V=b*f-d*S;return u[2]=x*(t[0]*I+t[1]*w+t[2]*V),!(u[2]<0||u[1]+u[2]>1||(u[0]=x*(c*I+p*w+v*V),0))},t.rayBoxTest=function(e,t,i,n){var r,a=(i[0]-e[0])/t[0],o=(n[0]-e[0])/t[0];a>o&&(r=a,a=o,o=r);var s=(i[1]-e[1])/t[1],l=(n[1]-e[1])/t[1];if(s>l&&(r=s,s=l,l=r),a>l||s>o)return!1;s>a&&(a=s),l<o&&(o=l);var u=(i[2]-e[2])/t[2],d=(n[2]-e[2])/t[2];return u>d&&(r=u,u=d,d=r),!(a>d||u>o||(d<o&&(o=d),o<0))},t.rayRay2D=function(e,t,n,r,a,o){void 0===o&&(o=i.vec2d.create());var s=(r[a]-n[a])*(t[0]-e[0])-(r[0]-n[0])*(t[a]-e[a]),l=(r[0]-n[0])*(e[a]-n[a])-(r[a]-n[a])*(e[0]-n[0]);if(0===s)return!1;var u=l/s;return o[0]=e[0]+u*(t[0]-e[0]),o[1]=e[a]+u*(t[a]-e[a]),!0},t.matrixToFrustumPoints=o,t.matrixToFrustumPlanes=function(e,t,i,n){void 0===n&&(n=i,i=v),o(e,t,i),s(i,n)},t.frustumPointsToPlanes=s,t.project=function(e,t,n,r,o){o||(o=e),p[0]=e[0],p[1]=e[1],p[2]=e[2],p[3]=1,i.mat4d.multiplyVec4(t,p),o.length>2&&(o[2]=-p[2]),i.mat4d.multiplyVec4(n,p),a(0!==p[3]),o[0]=p[0]/p[3],o[1]=p[1]/p[3],o[2]=p[2]/p[3],o[0]=(.5*o[0]+.5)*r[2]+r[0],o[1]=(.5*o[1]+.5)*r[3]+r[1]},t.getFirstObjectKey=l,t.getFirstObjectValue=function(e){return e[l(e)]},t.objectEmpty=function(e){for(var t in e)return!1;return!0},t.logWithBase=function(e,t){return Math.log(e)/Math.log(t)},t.setMatrixTranslation=u,t.setMatrixTranslation3=function(e,t,i,n){e[12]=t,e[13]=i,e[14]=n},t.getMatrixTranslation=function(e,t){return void 0===t&&(t=i.vec3d.create()),t[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.createTranslationMatrix=function(e,t){return u(e=i.mat4d.identity(e),t),e},t.isTranslationMatrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]},t.fovx2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/t)},t.fovy2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/i)},t.fovx2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)},t.fovy2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)},t.fovd2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.fovd2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.lineLineDistanceSquared3D=function(e,t,n,a,o){var s=m,l=g;if(s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=a[0]-n[0],l[1]=a[1]-n[1],l[2]=a[2]-n[2],Math.abs(l[0])<1e-4&&Math.abs(l[1])<1e-4&&Math.abs(l[2])<1e-4)return o.success=!1,o;var u=y;if(u[0]=t[0]-e[0],u[1]=t[1]-e[1],u[2]=t[2]-e[2],Math.abs(u[0])<1e-4&&Math.abs(u[1])<1e-4&&Math.abs(u[2])<1e-4)return o.success=!1,o;var d=s[0]*l[0]+s[1]*l[1]+s[2]*l[2],f=l[0]*u[0]+l[1]*u[1]+l[2]*u[2],h=s[0]*u[0]+s[1]*u[1]+s[2]*u[2],c=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],p=(u[0]*u[0]+u[1]*u[1]+u[2]*u[2])*c-f*f;if(Math.abs(p)<1e-4)return o.success=!1,o;var v=d*f-h*c,_=r.clamp(v/p,0,1),S=r.clamp((d+f*_)/c,0,1),M=x,I=b;M[0]=e[0]+_*u[0],M[1]=e[1]+_*u[1],M[2]=e[2]+_*u[2],I[0]=n[0]+S*l[0],I[1]=n[1]+S*l[1],I[2]=n[2]+S*l[2];var w=i.vec3d.dist2(M,I);return o.success=!0,o.dist2=w,o.pa=M,o.pb=I,o},t.pointLineSegmentDistanceSquared2D=function(e,t,n){var a=w,o=V,s=D,l=I,u=S,d=M;a[0]=t[0]-e[0],a[1]=t[1]-e[1],a[2]=0,o[0]=n[0]-e[0],o[1]=n[1]-e[1],o[2]=0,s[0]=n[0],s[1]=n[1],s[2]=0;var f=i.vec2d.dot(o,a),h=i.vec2d.dot(a,a),c=r.clamp(f/h,0,1);l[0]=a[0]*c,l[1]=a[1]*c,u[0]=e[0]+l[0],u[1]=e[1]+l[1],i.vec2d.subtract(s,u,d);var p=i.vec2d.dot(d,d),v=i.vec2d.dot(o,o),_=i.vec2d.dot(a,a),m=i.vec2d.dot(l,l);return(m>v||m>_)&&(p=Number.MAX_VALUE),p},t.packFloatRGBA=function(e,t,i){void 0===i&&(i=0);for(var n=r.clamp(e,0,C),a=0;a<4;a++)t[i+a]=Math.floor(256*f(n*T[a]))},t.unpackFloatRGBA=d;var T=[1,256,65536,16777216],O=[1/256,1/65536,1/16777216,1/4294967296],C=d(new Uint8ClampedArray([255,255,255,255]));t.inverseProjectionInfo=function(e,t,n,r,a){var o=e;0===e[11]?(r[0]=2/(t*o[0]),r[1]=2/(n*o[5]),r[2]=(1+o[12])/o[0],r[3]=(1+o[13])/o[5],i.vec2d.set2(0,1,a)):(r[0]=-2/(t*o[0]),r[1]=-2/(n*o[5]),r[2]=(1-o[8])/o[0],r[3]=(1-o[9])/o[5],i.vec2d.set2(1,0,a))}}.apply(null,n))||(e.exports=r)},389:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(361),i(367)],void 0===(r=function(e,t,i,n){function r(e){return e}function a(e){return void 0===e&&(e=t.ZERO),r([e[0],e[1],e[2],e[3],e[4],e[5]])}function o(e){return e[0]>=e[3]?0:e[3]-e[0]}function s(e){return e[1]>=e[4]?0:e[4]-e[1]}function l(e){return e[2]>=e[5]?0:e[5]-e[2]}function u(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function d(e){return 6===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.fromValues=function(e,t,i,n,a,o){return r([e,t,i,n,a,o])},t.fromExtent=function(e,t){return void 0===t&&(t=a()),t[0]=e.xmin,t[1]=e.ymin,t[2]=e.zmin,t[3]=e.xmax,t[4]=e.ymax,t[5]=e.zmax,t},t.toExtent=function(e,t){var n=isFinite(e[2])||isFinite(e[5]);return new i(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})},t.fromMinMax=function(e,t,i){return void 0===i&&(i=a()),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=t[0],i[4]=t[1],i[5]=t[2],i},t.expandPointInPlace=function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[3]&&(e[3]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[4]&&(e[4]=t[1]),t[2]<e[2]&&(e[2]=t[2]),t[2]>e[5]&&(e[5]=t[2])},t.expand=function(e,t,i){return void 0===i&&(i=e),d(t)?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.max(e[3],t[3]),i[4]=Math.max(e[4],t[4]),i[5]=Math.max(e[5],t[5])):n.is(t)?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[3]=Math.max(e[3],t[2]),i[4]=Math.max(e[4],t[3])):2===t.length?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[3]=Math.max(e[3],t[0]),i[4]=Math.max(e[4],t[1])):3===t.length&&(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.max(e[3],t[0]),i[4]=Math.max(e[4],t[1]),i[5]=Math.max(e[5],t[2])),i},t.expandWithBuffer=function(e,t,i,n,r){void 0===r&&(r=e);for(var a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],d=e[5],f=0;f<n;f++)a=Math.min(a,t[i+3*f]),o=Math.min(o,t[i+3*f+1]),s=Math.min(s,t[i+3*f+2]),l=Math.max(l,t[i+3*f]),u=Math.max(u,t[i+3*f+1]),d=Math.max(d,t[i+3*f+2]);return r[0]=a,r[1]=o,r[2]=s,r[3]=l,r[4]=u,r[5]=d,r},t.expandWithNestedArray=function(e,t,i,n){void 0===n&&(n=e);var r=t.length,a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],d=e[5];if(i)for(var f=0;f<r;f++){var h=t[f];a=Math.min(a,h[0]),o=Math.min(o,h[1]),s=Math.min(s,h[2]),l=Math.max(l,h[0]),u=Math.max(u,h[1]),d=Math.max(d,h[2])}else for(f=0;f<r;f++)h=t[f],a=Math.min(a,h[0]),o=Math.min(o,h[1]),l=Math.max(l,h[0]),u=Math.max(u,h[1]);return n[0]=a,n[1]=o,n[2]=s,n[3]=l,n[4]=u,n[5]=d,n},t.allFinite=function(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0},t.width=o,t.depth=s,t.height=l,t.diameter=function(e){var t=o(e),i=l(e),n=s(e);return Math.sqrt(t*t+i*i+n*n)},t.center=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=e[0]+o(e)/2,t[1]=e[1]+s(e)/2,t[2]=e[2]+l(e)/2,t},t.size=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=o(e),t[1]=s(e),t[2]=l(e),t},t.maximumDimension=function(e){return Math.max(o(e),l(e),s(e))},t.containsPoint=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]},t.containsPointWithMargin=function(e,t,i){return t[0]>=e[0]-i&&t[1]>=e[1]-i&&t[2]>=e[2]-i&&t[0]<=e[3]+i&&t[1]<=e[4]+i&&t[2]<=e[5]+i},t.contains=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]},t.intersects=function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])},t.offset=function(e,t,i,n,r){return void 0===r&&(r=e),r[0]=e[0]+t,r[1]=e[1]+i,r[2]=e[2]+n,r[3]=e[3]+t,r[4]=e[4]+i,r[5]=e[5]+n,r},t.setMin=function(e,t,i){return void 0===i&&(i=e),i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i},t.setMax=function(e,t,i){return void 0===i&&(i=e),i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e},t.set=u,t.empty=function(e){return e?u(e,t.NEGATIVE_INFINITY):a(t.NEGATIVE_INFINITY)},t.toRect=function(e,t){return t||(t=n.create()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t},t.fromRect=function(e,t){return e[0]=t[0],e[1]=t[1],e[3]=t[2],e[4]=t[3],e},t.is=d,t.isPoint=function(e){return 0===o(e)&&0===s(e)&&0===l(e)},t.equals=function(e,t,i){if(null==e||null==t)return e===t;if(!d(e)||!d(t))return!1;if(i){for(var n=0;n<e.length;n++)if(!i(e[n],t[n]))return!1}else for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},t.POSITIVE_INFINITY=r([-1/0,-1/0,-1/0,1/0,1/0,1/0]),t.NEGATIVE_INFINITY=r([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t.ZERO=r([0,0,0,0,0,0])}.apply(null,n))||(e.exports=r)},398:function(e,t,i){var n;void 0===(n=function(){return function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(o=2&i[0]?a.return:i[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,a=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],a=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,a,o,s,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}}.apply(null,[]))||(e.exports=n)},594:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){return function(){function e(e,t,i,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=i||0,this._end=n||e.byteLength}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),i},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),i},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,i=this._toString(this._data,t,t+e);return this._skip(e),i},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,i=this._toBytes(this._data,t,t+e);return this._skip(e),i},e.prototype.getMessage=function(){var t=this._getLength(),i=this._pos,n=new e(this._data,this._dataView,i,i+t);return this._skip(t),n},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,i=this._pos,n=0;if(this._end-i>=10)do{if(n|=127&(e=t[i++]),0==(128&e))break;if(n|=(127&(e=t[i++]))<<7,0==(128&e))break;if(n|=(127&(e=t[i++]))<<14,0==(128&e))break;if(n|=(127&(e=t[i++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[i++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[i++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[i++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[i++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[i++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[i++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var r=1;i!==this._end&&0!=(128&(e=t[i]));)++i,n+=(127&e)*r,r*=128;if(i===this._end)throw new Error("Varint overrun!");++i,n+=e*r}return this._pos=i,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,i){var n="",r="";i=Math.min(this._end,i);for(var a=t;a<i;++a){var o=e[a];128&o?r+="%"+o.toString(16):(n+=decodeURIComponent(r)+String.fromCharCode(o),r="")}return r.length&&(n+=decodeURIComponent(r)),n},e.prototype._toBytes=function(e,t,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,t,i-t)},e}()}.apply(null,n))||(e.exports=r)},616:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,n))||(e.exports=r)},622:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1007),i(1274),i(1275)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0}),t.plane=n,t.triangle=r,t.lineSegment=i}.apply(null,n))||(e.exports=r)},640:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(351)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),r=new Uint8Array(n),a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return new Blob([n],{type:i})},t.requestImage=function(e){return i(e,{responseType:"image"}).then(function(e){return e.data})}}.apply(null,n))||(e.exports=r)},671:function(e,t,i){var n;void 0===(n=function(){if(!e)var e=1e-6;if(!t)var t="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var n={GLMAT_EPSILON:e,GLMAT_ARRAY_TYPE:t,GLMAT_RANDOM:i,setMatrixArrayType:function(e){n.GLMAT_ARRAY_TYPE=e}},r=Math.PI/180,a=180/Math.PI;return n.toRadian=function(e){return e*r},n.toDegree=function(e){return e*a},n.setMatrixArrayType(Array),n}.apply(null,[]))||(e.exports=n)},698:function(e,t,i){var n,r;n=[i(671)],void 0===(r=function(e){var t=e.GLMAT_ARRAY_TYPE,i=e.GLMAT_RANDOM,n={create:function(){var e=new t(2);return e[0]=0,e[1]=0,e},clone:function(e){var i=new t(2);return i[0]=e[0],i[1]=e[1],i},fromValues:function(e,i){var n=new t(2);return n[0]=e,n[1]=i,n},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,i){return e[0]=t,e[1]=i,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}};return n.sub=n.subtract,n.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},n.mul=n.multiply,n.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},n.div=n.divide,n.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},n.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},n.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},n.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e},n.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(i*i+n*n)},n.dist=n.distance,n.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n},n.sqrDist=n.squaredDistance,n.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},n.len=n.length,n.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},n.sqrLen=n.squaredLength,n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},n.normalize=function(e,t){var i=t[0],n=t[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},n.cross=function(e,t,i){var n=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=n,e},n.lerp=function(e,t,i,n){var r=t[0],a=t[1];return e[0]=r+n*(i[0]-r),e[1]=a+n*(i[1]-a),e},n.random=function(e,t){t=t||1;var n=2*i()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},n.transformMat2=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r,e[1]=i[1]*n+i[3]*r,e},n.transformMat2d=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[2]*r+i[4],e[1]=i[1]*n+i[3]*r+i[5],e},n.transformMat3=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[3]*r+i[6],e[1]=i[1]*n+i[4]*r+i[7],e},n.transformMat4=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e},n.forEach=function(){var e=n.create();return function(t,i,n,r,a,o){var s,l;for(i||(i=2),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}(),n.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},n}.apply(null,n))||(e.exports=r)},725:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,n))||(e.exports=r)},745:function(e,t,i){var n,r;n=[i(671)],void 0===(r=function(e){var t=e.GLMAT_ARRAY_TYPE,i={create:function(){var e=new t(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},clone:function(e){var i=new t(6);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},invert:function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=i*a-n*r;return l?(l=1/l,e[0]=a*l,e[1]=-n*l,e[2]=-r*l,e[3]=i*l,e[4]=(r*s-a*o)*l,e[5]=(n*o-i*s)*l,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=i[0],d=i[1],f=i[2],h=i[3],c=i[4],p=i[5];return e[0]=n*u+a*d,e[1]=r*u+o*d,e[2]=n*f+a*h,e[3]=r*f+o*h,e[4]=n*c+a*p+s,e[5]=r*c+o*p+l,e}};return i.mul=i.multiply,i.rotate=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=Math.sin(i),d=Math.cos(i);return e[0]=n*d+a*u,e[1]=r*d+o*u,e[2]=n*-u+a*d,e[3]=r*-u+o*d,e[4]=s,e[5]=l,e},i.scale=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=i[0],d=i[1];return e[0]=n*u,e[1]=r*u,e[2]=a*d,e[3]=o*d,e[4]=s,e[5]=l,e},i.translate=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=i[0],d=i[1];return e[0]=n,e[1]=r,e[2]=a,e[3]=o,e[4]=n*u+a*d+s,e[5]=r*u+o*d+l,e},i.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=-i,e[3]=n,e[4]=0,e[5]=0,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},i.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},i}.apply(null,n))||(e.exports=r)},759:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={scalar:{},SIMD:{},create:function(){var t=new e.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var i=new e.ARRAY_TYPE(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_){var m=new e.ARRAY_TYPE(16);return m[0]=t,m[1]=i,m[2]=n,m[3]=r,m[4]=a,m[5]=o,m[6]=s,m[7]=l,m[8]=u,m[9]=d,m[10]=f,m[11]=h,m[12]=c,m[13]=p,m[14]=v,m[15]=_,m},set:function(e,t,i,n,r,a,o,s,l,u,d,f,h,c,p,v,_){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=a,e[5]=o,e[6]=s,e[7]=l,e[8]=u,e[9]=d,e[10]=f,e[11]=h,e[12]=c,e[13]=p,e[14]=v,e[15]=_,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}};return t.scalar.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=r,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.SIMD.transpose=function(e,t){var i,n,r,a,o,s,l,u,d,f;return i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),r=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4.shuffle(i,n,0,1,4,5),s=SIMD.Float32x4.shuffle(r,a,0,1,4,5),l=SIMD.Float32x4.shuffle(o,s,0,2,4,6),u=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,0,l),SIMD.Float32x4.store(e,4,u),o=SIMD.Float32x4.shuffle(i,n,2,3,6,7),s=SIMD.Float32x4.shuffle(r,a,2,3,6,7),d=SIMD.Float32x4.shuffle(o,s,0,2,4,6),f=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,8,d),SIMD.Float32x4.store(e,12,f),e},t.transpose=e.USE_SIMD?t.SIMD.transpose:t.scalar.transpose,t.scalar.invert=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],d=t[8],f=t[9],h=t[10],c=t[11],p=t[12],v=t[13],_=t[14],m=t[15],g=i*s-n*o,y=i*l-r*o,x=i*u-a*o,b=n*l-r*s,S=n*u-a*s,M=r*u-a*l,I=d*v-f*p,w=d*_-h*p,V=d*m-c*p,D=f*_-h*v,z=f*m-c*v,F=h*m-c*_,T=g*F-y*z+x*D+b*V-S*w+M*I;return T?(T=1/T,e[0]=(s*F-l*z+u*D)*T,e[1]=(r*z-n*F-a*D)*T,e[2]=(v*M-_*S+m*b)*T,e[3]=(h*S-f*M-c*b)*T,e[4]=(l*V-o*F-u*w)*T,e[5]=(i*F-r*V+a*w)*T,e[6]=(_*x-p*M-m*y)*T,e[7]=(d*M-h*x+c*y)*T,e[8]=(o*z-s*V+u*I)*T,e[9]=(n*V-i*z-a*I)*T,e[10]=(p*S-v*x+m*g)*T,e[11]=(f*x-d*S-c*g)*T,e[12]=(s*w-o*D-l*I)*T,e[13]=(i*D-n*w+r*I)*T,e[14]=(v*y-p*b-_*g)*T,e[15]=(d*b-f*y+h*g)*T,e):null},t.SIMD.invert=function(e,t){var i,n,r,a,o,s,l,u,d,f,h=SIMD.Float32x4.load(t,0),c=SIMD.Float32x4.load(t,4),p=SIMD.Float32x4.load(t,8),v=SIMD.Float32x4.load(t,12);return o=SIMD.Float32x4.shuffle(h,c,0,1,4,5),n=SIMD.Float32x4.shuffle(p,v,0,1,4,5),i=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(h,c,2,3,6,7),a=SIMD.Float32x4.shuffle(p,v,2,3,6,7),r=SIMD.Float32x4.shuffle(o,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,o,1,3,5,7),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(n,o),l=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(n,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),d=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),s),u=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,o)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(i,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),d),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),u),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(i,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,o)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),u),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(i,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),d),f=SIMD.Float32x4.mul(i,s),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),o=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(o,o))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(f,d)),e):null},t.invert=e.USE_SIMD?t.SIMD.invert:t.scalar.invert,t.scalar.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],d=t[8],f=t[9],h=t[10],c=t[11],p=t[12],v=t[13],_=t[14],m=t[15];return e[0]=s*(h*m-c*_)-f*(l*m-u*_)+v*(l*c-u*h),e[1]=-(n*(h*m-c*_)-f*(r*m-a*_)+v*(r*c-a*h)),e[2]=n*(l*m-u*_)-s*(r*m-a*_)+v*(r*u-a*l),e[3]=-(n*(l*c-u*h)-s*(r*c-a*h)+f*(r*u-a*l)),e[4]=-(o*(h*m-c*_)-d*(l*m-u*_)+p*(l*c-u*h)),e[5]=i*(h*m-c*_)-d*(r*m-a*_)+p*(r*c-a*h),e[6]=-(i*(l*m-u*_)-o*(r*m-a*_)+p*(r*u-a*l)),e[7]=i*(l*c-u*h)-o*(r*c-a*h)+d*(r*u-a*l),e[8]=o*(f*m-c*v)-d*(s*m-u*v)+p*(s*c-u*f),e[9]=-(i*(f*m-c*v)-d*(n*m-a*v)+p*(n*c-a*f)),e[10]=i*(s*m-u*v)-o*(n*m-a*v)+p*(n*u-a*s),e[11]=-(i*(s*c-u*f)-o*(n*c-a*f)+d*(n*u-a*s)),e[12]=-(o*(f*_-h*v)-d*(s*_-l*v)+p*(s*h-l*f)),e[13]=i*(f*_-h*v)-d*(n*_-r*v)+p*(n*h-r*f),e[14]=-(i*(s*_-l*v)-o*(n*_-r*v)+p*(n*l-r*s)),e[15]=i*(s*h-l*f)-o*(n*h-r*f)+d*(n*l-r*s),e},t.SIMD.adjoint=function(e,t){var i,n,r,a,o,s,l,u,d,f=SIMD.Float32x4.load(t,0),h=SIMD.Float32x4.load(t,4),c=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return o=SIMD.Float32x4.shuffle(f,h,0,1,4,5),n=SIMD.Float32x4.shuffle(c,p,0,1,4,5),i=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(f,h,2,3,6,7),a=SIMD.Float32x4.shuffle(c,p,2,3,6,7),r=SIMD.Float32x4.shuffle(o,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,o,1,3,5,7),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(n,o),l=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(n,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),d=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),s),u=SIMD.Float32x4.mul(i,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,o)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(i,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),d),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),u),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(i,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,o)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),u),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(i,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),l),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),d),SIMD.Float32x4.store(e,0,s),SIMD.Float32x4.store(e,4,l),SIMD.Float32x4.store(e,8,u),SIMD.Float32x4.store(e,12,d),e},t.adjoint=e.USE_SIMD?t.SIMD.adjoint:t.scalar.adjoint,t.determinant=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],d=e[9],f=e[10],h=e[11],c=e[12],p=e[13],v=e[14],_=e[15];return(t*o-i*a)*(f*_-h*v)-(t*s-n*a)*(d*_-h*p)+(t*l-r*a)*(d*v-f*p)+(i*s-n*o)*(u*_-h*c)-(i*l-r*o)*(u*v-f*c)+(n*l-r*s)*(u*p-d*c)},t.SIMD.multiply=function(e,t,i){var n=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(i,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(e,0,l);var u=SIMD.Float32x4.load(i,4),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),o))));SIMD.Float32x4.store(e,4,d);var f=SIMD.Float32x4.load(i,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),o))));SIMD.Float32x4.store(e,8,h);var c=SIMD.Float32x4.load(i,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));return SIMD.Float32x4.store(e,12,p),e},t.scalar.multiply=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],d=t[7],f=t[8],h=t[9],c=t[10],p=t[11],v=t[12],_=t[13],m=t[14],g=t[15],y=i[0],x=i[1],b=i[2],S=i[3];return e[0]=y*n+x*s+b*f+S*v,e[1]=y*r+x*l+b*h+S*_,e[2]=y*a+x*u+b*c+S*m,e[3]=y*o+x*d+b*p+S*g,y=i[4],x=i[5],b=i[6],S=i[7],e[4]=y*n+x*s+b*f+S*v,e[5]=y*r+x*l+b*h+S*_,e[6]=y*a+x*u+b*c+S*m,e[7]=y*o+x*d+b*p+S*g,y=i[8],x=i[9],b=i[10],S=i[11],e[8]=y*n+x*s+b*f+S*v,e[9]=y*r+x*l+b*h+S*_,e[10]=y*a+x*u+b*c+S*m,e[11]=y*o+x*d+b*p+S*g,y=i[12],x=i[13],b=i[14],S=i[15],e[12]=y*n+x*s+b*f+S*v,e[13]=y*r+x*l+b*h+S*_,e[14]=y*a+x*u+b*c+S*m,e[15]=y*o+x*d+b*p+S*g,e},t.multiply=e.USE_SIMD?t.SIMD.multiply:t.scalar.multiply,t.mul=t.multiply,t.scalar.translate=function(e,t,i){var n,r,a,o,s,l,u,d,f,h,c,p,v=i[0],_=i[1],m=i[2];return t===e?(e[12]=t[0]*v+t[4]*_+t[8]*m+t[12],e[13]=t[1]*v+t[5]*_+t[9]*m+t[13],e[14]=t[2]*v+t[6]*_+t[10]*m+t[14],e[15]=t[3]*v+t[7]*_+t[11]*m+t[15]):(n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],d=t[7],f=t[8],h=t[9],c=t[10],p=t[11],e[0]=n,e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=d,e[8]=f,e[9]=h,e[10]=c,e[11]=p,e[12]=n*v+s*_+f*m+t[12],e[13]=r*v+l*_+h*m+t[13],e[14]=a*v+u*_+c*m+t[14],e[15]=o*v+d*_+p*m+t[15]),e},t.SIMD.translate=function(e,t,i){var n=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(i[0],i[1],i[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,1,1,1,1)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(r,SIMD.Float32x4.add(a,o)));return SIMD.Float32x4.store(e,12,l),e},t.translate=e.USE_SIMD?t.SIMD.translate:t.scalar.translate,t.scalar.scale=function(e,t,i){var n=i[0],r=i[1],a=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.SIMD.scale=function(e,t,i){var n,r,a,o=SIMD.Float32x4(i[0],i[1],i[2],0);return n=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,0,0,0,0))),r=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(o,1,1,1,1))),a=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.scale=e.USE_SIMD?t.SIMD.scale:t.scalar.scale,t.rotate=function(t,i,n,r){var a,o,s,l,u,d,f,h,c,p,v,_,m,g,y,x,b,S,M,I,w,V,D,z,F=r[0],T=r[1],O=r[2],C=Math.sqrt(F*F+T*T+O*O);return Math.abs(C)<e.EPSILON?null:(F*=C=1/C,T*=C,O*=C,a=Math.sin(n),s=1-(o=Math.cos(n)),l=i[0],u=i[1],d=i[2],f=i[3],h=i[4],c=i[5],p=i[6],v=i[7],_=i[8],m=i[9],g=i[10],y=i[11],x=F*F*s+o,b=T*F*s+O*a,S=O*F*s-T*a,M=F*T*s-O*a,I=T*T*s+o,w=O*T*s+F*a,V=F*O*s+T*a,D=T*O*s-F*a,z=O*O*s+o,t[0]=l*x+h*b+_*S,t[1]=u*x+c*b+m*S,t[2]=d*x+p*b+g*S,t[3]=f*x+v*b+y*S,t[4]=l*M+h*I+_*w,t[5]=u*M+c*I+m*w,t[6]=d*M+p*I+g*w,t[7]=f*M+v*I+y*w,t[8]=l*V+h*D+_*z,t[9]=u*V+c*D+m*z,t[10]=d*V+p*D+g*z,t[11]=f*V+v*D+y*z,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},t.scalar.rotateX=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],d=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+u*n,e[5]=o*r+d*n,e[6]=s*r+f*n,e[7]=l*r+h*n,e[8]=u*r-a*n,e[9]=d*r-o*n,e[10]=f*r-s*n,e[11]=h*r-l*n,e},t.SIMD.rotateX=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),e},t.rotateX=e.USE_SIMD?t.SIMD.rotateX:t.scalar.rotateX,t.scalar.rotateY=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],d=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r-u*n,e[1]=o*r-d*n,e[2]=s*r-f*n,e[3]=l*r-h*n,e[8]=a*n+u*r,e[9]=o*n+d*r,e[10]=s*n+f*r,e[11]=l*n+h*r,e},t.SIMD.rotateY=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,r))),e},t.rotateY=e.USE_SIMD?t.SIMD.rotateY:t.scalar.rotateY,t.scalar.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],d=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+u*n,e[1]=o*r+d*n,e[2]=s*r+f*n,e[3]=l*r+h*n,e[4]=u*r-a*n,e[5]=d*r-o*n,e[6]=f*r-s*n,e[7]=h*r-l*n,e},t.SIMD.rotateZ=function(e,t,i){var n=SIMD.Float32x4.splat(Math.sin(i)),r=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),e},t.rotateZ=e.USE_SIMD?t.SIMD.rotateZ:t.scalar.rotateZ,t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(t,i,n){var r,a,o,s=n[0],l=n[1],u=n[2],d=Math.sqrt(s*s+l*l+u*u);return Math.abs(d)<e.EPSILON?null:(s*=d=1/d,l*=d,u*=d,r=Math.sin(i),o=1-(a=Math.cos(i)),t[0]=s*s*o+a,t[1]=l*s*o+u*r,t[2]=u*s*o-l*r,t[3]=0,t[4]=s*l*o-u*r,t[5]=l*l*o+a,t[6]=u*l*o+s*r,t[7]=0,t[8]=s*u*o+l*r,t[9]=l*u*o-s*r,t[10]=u*u*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},t.fromXRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=n+n,l=r+r,u=a+a,d=n*s,f=n*l,h=n*u,c=r*l,p=r*u,v=a*u,_=o*s,m=o*l,g=o*u;return e[0]=1-(c+v),e[1]=f+g,e[2]=h-m,e[3]=0,e[4]=f-g,e[5]=1-(d+v),e[6]=p+_,e[7]=0,e[8]=h+m,e[9]=p-_,e[10]=1-(d+c),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getRotation=function(e,t){var i=t[0]+t[5]+t[10],n=0;return i>0?(n=2*Math.sqrt(i+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,i,n){var r=t[0],a=t[1],o=t[2],s=t[3],l=r+r,u=a+a,d=o+o,f=r*l,h=r*u,c=r*d,p=a*u,v=a*d,_=o*d,m=s*l,g=s*u,y=s*d,x=n[0],b=n[1],S=n[2];return e[0]=(1-(p+_))*x,e[1]=(h+y)*x,e[2]=(c-g)*x,e[3]=0,e[4]=(h-y)*b,e[5]=(1-(f+_))*b,e[6]=(v+m)*b,e[7]=0,e[8]=(c+g)*S,e[9]=(v-m)*S,e[10]=(1-(f+p))*S,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,i,n,r){var a=t[0],o=t[1],s=t[2],l=t[3],u=a+a,d=o+o,f=s+s,h=a*u,c=a*d,p=a*f,v=o*d,_=o*f,m=s*f,g=l*u,y=l*d,x=l*f,b=n[0],S=n[1],M=n[2],I=r[0],w=r[1],V=r[2];return e[0]=(1-(v+m))*b,e[1]=(c+x)*b,e[2]=(p-y)*b,e[3]=0,e[4]=(c-x)*S,e[5]=(1-(h+m))*S,e[6]=(_+g)*S,e[7]=0,e[8]=(p+y)*M,e[9]=(_-g)*M,e[10]=(1-(h+v))*M,e[11]=0,e[12]=i[0]+I-(e[0]*I+e[4]*w+e[8]*V),e[13]=i[1]+w-(e[1]*I+e[5]*w+e[9]*V),e[14]=i[2]+V-(e[2]*I+e[6]*w+e[10]*V),e[15]=1,e},t.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=i+i,s=n+n,l=r+r,u=i*o,d=n*o,f=n*s,h=r*o,c=r*s,p=r*l,v=a*o,_=a*s,m=a*l;return e[0]=1-f-p,e[1]=d+m,e[2]=h-_,e[3]=0,e[4]=d-m,e[5]=1-u-p,e[6]=c+v,e[7]=0,e[8]=h+_,e[9]=c-v,e[10]=1-u-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,i,n,r,a,o){var s=1/(i-t),l=1/(r-n),u=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*l,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(r+n)*l,e[10]=(o+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*u,e[15]=0,e},t.perspective=function(e,t,i,n,r){var a=1/Math.tan(t/2),o=1/(n-r);return e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,i,n){var r=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(r+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-s)*l*.5,e[9]=(r-a)*u*.5,e[10]=n/(i-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*i/(i-n),e[15]=0,e},t.ortho=function(e,t,i,n,r,a,o){var s=1/(t-i),l=1/(n-r),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*s,e[13]=(r+n)*l,e[14]=(o+a)*u,e[15]=1,e},t.lookAt=function(i,n,r,a){var o,s,l,u,d,f,h,c,p,v,_=n[0],m=n[1],g=n[2],y=a[0],x=a[1],b=a[2],S=r[0],M=r[1],I=r[2];return Math.abs(_-S)<e.EPSILON&&Math.abs(m-M)<e.EPSILON&&Math.abs(g-I)<e.EPSILON?t.identity(i):(h=_-S,c=m-M,p=g-I,o=x*(p*=v=1/Math.sqrt(h*h+c*c+p*p))-b*(c*=v),s=b*(h*=v)-y*p,l=y*c-x*h,(v=Math.sqrt(o*o+s*s+l*l))?(o*=v=1/v,s*=v,l*=v):(o=0,s=0,l=0),u=c*l-p*s,d=p*o-h*l,f=h*s-c*o,(v=Math.sqrt(u*u+d*d+f*f))?(u*=v=1/v,d*=v,f*=v):(u=0,d=0,f=0),i[0]=o,i[1]=u,i[2]=h,i[3]=0,i[4]=s,i[5]=d,i[6]=c,i[7]=0,i[8]=l,i[9]=f,i[10]=p,i[11]=0,i[12]=-(o*_+s*m+l*g),i[13]=-(u*_+d*m+f*g),i[14]=-(h*_+c*m+p*g),i[15]=1,i)},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},t.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e},t.sub=t.subtract,t.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},t.multiplyScalarAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e[4]=t[4]+i[4]*n,e[5]=t[5]+i[5]*n,e[6]=t[6]+i[6]*n,e[7]=t[7]+i[7]*n,e[8]=t[8]+i[8]*n,e[9]=t[9]+i[9]*n,e[10]=t[10]+i[10]*n,e[11]=t[11]+i[11]*n,e[12]=t[12]+i[12]*n,e[13]=t[13]+i[13]*n,e[14]=t[14]+i[14]*n,e[15]=t[15]+i[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],d=t[7],f=t[8],h=t[9],c=t[10],p=t[11],v=t[12],_=t[13],m=t[14],g=t[15],y=i[0],x=i[1],b=i[2],S=i[3],M=i[4],I=i[5],w=i[6],V=i[7],D=i[8],z=i[9],F=i[10],T=i[11],O=i[12],C=i[13],P=i[14],L=i[15];return Math.abs(n-y)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-x)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-b)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-S)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-M)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(l-I)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(u-w)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(d-V)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(f-D)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(h-z)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(c-F)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(p-T)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(v-O)<=e.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(_-C)<=e.EPSILON*Math.max(1,Math.abs(_),Math.abs(C))&&Math.abs(m-P)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(g-L)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(L))},t}.apply(null,n))||(e.exports=r)},773:function(e,t,i){var n,r;n=[i.dj.c(e.i),t],void 0===(r=function(e,t){function i(e){return e&&"upperLeft"===e.originPosition}function n(e,t){var i=e.scale,n=e.translate;return Math.round((t-n[0])/i[0])}function r(e,t){var i=e.scale,n=e.translate;return Math.round((n[1]-t)/i[1])}function a(e,t,i){for(var a,o,s,l,u=[],d=0;d<i.length;d++){var f=i[d];d>0?(s=n(e,f[0]),l=r(e,f[1]),s===a&&l===o||(u.push(t(f,s-a,l-o)),a=s,o=l)):(a=n(e,f[0]),o=r(e,f[1]),u.push(t(f,a,o)))}return u.length>0?u:null}function o(e,t,i,n){return a(e,i?n?x:y:n?y:g,t)}function s(e,t,i,n){for(var r=[],o=i?n?x:y:n?y:g,s=0;s<t.length;s++){var l=a(e,o,t[s]);l&&l.length>=3&&r.push(l)}return r.length?r:null}function l(e,t,i,n){for(var r=[],o=i?n?x:y:n?y:g,s=0;s<t.length;s++){var l=a(e,o,t[s]);l&&l.length>=2&&r.push(l)}return r.length?r:null}function u(e,t){var i=e.scale,n=e.translate;return t*i[0]+n[0]}function d(e,t){var i=e.scale;return e.translate[1]-t*i[1]}function f(e,t,i){var n=new Array(i.length);if(!i.length)return n;var r=e.scale,a=r[0],o=r[1],s=u(e,i[0][0]),l=d(e,i[0][1]);n[0]=t(i[0],s,l);for(var f=1;f<i.length;f++){var h=i[f];s+=h[0]*a,l-=h[1]*o,n[f]=t(h,s,l)}return n}function h(e,t,i){for(var n=new Array(i.length),r=0;r<i.length;r++)n[r]=f(e,t,i[r]);return n}function c(e,t,i,n){return f(e,i?n?x:y:n?y:g,t)}function p(e,t,i,n){return h(e,i?n?x:y:n?y:g,t)}function v(e,t,i,n){return h(e,i?n?x:y:n?y:g,t)}function _(e,t,i){for(var n=i[0],r=n[0],a=n[1],o=Math.min(r,t[0]),s=Math.min(a,t[1]),l=Math.max(r,t[2]),u=Math.max(a,t[3]),d=1;d<i.length;d++){var f=i[d],h=f[0],c=f[1];r+=h,a+=c,h<0&&(o=Math.min(o,r)),h>0&&(l=Math.max(l,r)),c<0?s=Math.min(s,a):c>0&&(u=Math.max(u,a))}return e[0]=o,e[1]=s,e[2]=l,e[3]=u,e}function m(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(var i=0;i<t.length;i++)_(e,e,t[i]);return e}Object.defineProperty(t,"__esModule",{value:!0});var g=function(e,t,i){return[t,i]},y=function(e,t,i){return[t,i,e[2]]},x=function(e,t,i){return[t,i,e[2],e[3]]};t.toTransform=function(e){return e?{originPosition:"upperLeft",scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.equals=function(e,t){return e===t||null==e&&null==t||null!=e&&null!=t&&(i(e)?(n=e.translate[0],r=e.translate[1],a=e.scale[0]):(n=e.extent.xmin,r=e.extent.ymax,a=e.tolerance),i(t)?(o=t.translate[0],s=t.translate[1],l=t.scale[0]):(o=t.extent.xmin,s=t.extent.ymax,l=t.tolerance),n===o&&r===s&&a===l);var n,r,a,o,s,l},t.quantizeX=n,t.quantizeY=r,t.quantizeBounds=function(e,t,i){return t[0]=n(e,i[0]),t[3]=r(e,i[1]),t[2]=n(e,i[2]),t[1]=r(e,i[3]),t},t.quantizePoints=o,t.quantizeRings=s,t.quantizePaths=l,t.hydrateX=u,t.hydrateY=d,t.hydrateCoordsArray=f,t.hydrateCoordsArrayArray=h,t.hydrateBounds=function(e,t,i){return i?(t[0]=u(e,i[0]),t[1]=d(e,i[3]),t[2]=u(e,i[2]),t[3]=d(e,i[1]),t):[u(e,t[0]),d(e,t[3]),u(e,t[2]),d(e,t[1])]},t.hydratePoints=c,t.hydratePaths=p,t.hydrateRings=v,t.getQuantizedBoundsCoordsArray=_,t.getQuantizedBoundsCoordsArrayArray=m,t.getQuantizedBoundsPoints=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return _(t,t,e)},t.getQuantizedBoundsPaths=function(e){return m([0,0,0,0],e)},t.getQuantizedBoundsRings=function(e){return m([0,0,0,0],e)},t.quantizeExtent=function(e,t,i,a,o){return t.xmin=n(e,i.xmin),t.ymin=r(e,i.ymin),t.xmax=n(e,i.xmax),t.ymax=r(e,i.ymax),t!==i&&(a&&(t.zmin=i.zmin,t.zmax=i.zmax),o&&(t.mmin=i.mmin,t.mmax=i.mmax)),t},t.quantizeMultipoint=function(e,t,i,n,r){return t.points=o(e,i.points,n,r),t},t.quantizePoint=function(e,t,i,a,o){return t.x=n(e,i.x),t.y=r(e,i.y),t!==i&&(a&&(t.z=i.z),o&&(t.m=i.m)),t},t.quantizePolygon=function(e,t,i,n,r){var a=s(e,i.rings,n,r);return a?(t.rings=a,t):null},t.quantizePolyline=function(e,t,i,n,r){var a=l(e,i.paths,n,r);return a?(t.paths=a,t):null},t.hydrateExtent=function(e,t,i,n,r){return t.xmin=u(e,i.xmin),t.ymin=d(e,i.ymin),t.xmax=u(e,i.xmax),t.ymax=d(e,i.ymax),t!==i&&(n&&(t.zmin=i.zmin,t.zmax=i.zmax),r&&(t.mmin=i.mmin,t.mmax=i.mmax)),t},t.hydrateMultipoint=function(e,t,i,n,r){return t.points=c(e,i.points,n,r),t},t.hydratePoint=function(e,t,i,n,r){return t.x=u(e,i.x),t.y=d(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m)),t},t.hydratePolygon=function(e,t,i,n,r){return t.rings=v(e,i.rings,n,r),t},t.hydratePolyline=function(e,t,i,n,r){return t.paths=p(e,i.paths,n,r),t}}.apply(null,n))||(e.exports=r)},820:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(4);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},fromValues:function(t,i,n,r){var a=new e.ARRAY_TYPE(4);return a[0]=t,a[1]=i,a[2]=n,a[3]=r,a},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},set:function(e,t,i,n,r){return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e[3]=t[3]+i[3]*n,e},t.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(i*i+n*n+r*r+a*a)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2],a=t[3]-e[3];return i*i+n*n+r*r+a*a},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return Math.sqrt(t*t+i*i+n*n+r*r)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return t*t+i*i+n*n+r*r},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],o=i*i+n*n+r*r+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=i*o,e[1]=n*o,e[2]=r*o,e[3]=a*o),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,i,n){var r=t[0],a=t[1],o=t[2],s=t[3];return e[0]=r+n*(i[0]-r),e[1]=a+n*(i[1]-a),e[2]=o+n*(i[2]-o),e[3]=s+n*(i[3]-s),e},t.random=function(i,n){return n=n||1,i[0]=e.RANDOM(),i[1]=e.RANDOM(),i[2]=e.RANDOM(),i[3]=e.RANDOM(),t.normalize(i,i),t.scale(i,i,n),i},t.transformMat4=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*a+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*a+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*a+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*a+i[15]*o,e},t.transformQuat=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[0],s=i[1],l=i[2],u=i[3],d=u*n+s*a-l*r,f=u*r+l*n-o*a,h=u*a+o*r-s*n,c=-o*n-s*r-l*a;return e[0]=d*u+c*-o+f*-l-h*-s,e[1]=f*u+c*-s+h*-o-d*-l,e[2]=h*u+c*-l+d*-s-f*-o,e[3]=t[3],e},t.forEach=function(){var e=t.create();return function(t,i,n,r,a,o){var s,l;for(i||(i=4),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=i[0],l=i[1],u=i[2],d=i[3];return Math.abs(n-s)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-l)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-u)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-d)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))},t}.apply(null,n))||(e.exports=r)},903:function(e,t,i){var n,r;n=[i(765)],void 0===(r=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},fromValues:function(t,i,n){var r=new e.ARRAY_TYPE(3);return r[0]=t,r[1]=i,r[2]=n,r},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},t.scaleAndAdd=function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e},t.distance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(i*i+n*n+r*r)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return i*i+n*n+r*r},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=function(e,t){var i=t[0],n=t[1],r=t[2],a=i*i+n*n+r*r;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},t.cross=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[0],s=i[1],l=i[2];return e[0]=r*l-a*s,e[1]=a*o-n*l,e[2]=n*s-r*o,e},t.lerp=function(e,t,i,n){var r=t[0],a=t[1],o=t[2];return e[0]=r+n*(i[0]-r),e[1]=a+n*(i[1]-a),e[2]=o+n*(i[2]-o),e},t.hermite=function(e,t,i,n,r,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),d=o*(3-2*a);return e[0]=t[0]*s+i[0]*l+n[0]*u+r[0]*d,e[1]=t[1]*s+i[1]*l+n[1]*u+r[1]*d,e[2]=t[2]*s+i[2]*l+n[2]*u+r[2]*d,e},t.bezier=function(e,t,i,n,r,a){var o=1-a,s=o*o,l=a*a,u=s*o,d=3*a*s,f=3*l*o,h=l*a;return e[0]=t[0]*u+i[0]*d+n[0]*f+r[0]*h,e[1]=t[1]*u+i[1]*d+n[1]*f+r[1]*h,e[2]=t[2]*u+i[2]*d+n[2]*f+r[2]*h,e},t.random=function(t,i){i=i||1;var n=2*e.RANDOM()*Math.PI,r=2*e.RANDOM()-1,a=Math.sqrt(1-r*r)*i;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=r*i,t},t.transformMat4=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[3]*n+i[7]*r+i[11]*a+i[15];return o=o||1,e[0]=(i[0]*n+i[4]*r+i[8]*a+i[12])/o,e[1]=(i[1]*n+i[5]*r+i[9]*a+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*a+i[14])/o,e},t.transformMat3=function(e,t,i){var n=t[0],r=t[1],a=t[2];return e[0]=n*i[0]+r*i[3]+a*i[6],e[1]=n*i[1]+r*i[4]+a*i[7],e[2]=n*i[2]+r*i[5]+a*i[8],e},t.transformQuat=function(e,t,i){var n=t[0],r=t[1],a=t[2],o=i[0],s=i[1],l=i[2],u=i[3],d=u*n+s*a-l*r,f=u*r+l*n-o*a,h=u*a+o*r-s*n,c=-o*n-s*r-l*a;return e[0]=d*u+c*-o+f*-l-h*-s,e[1]=f*u+c*-s+h*-o-d*-l,e[2]=h*u+c*-l+d*-s-f*-o,e},t.rotateX=function(e,t,i,n){var r=[],a=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],a[0]=r[0],a[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),a[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e},t.rotateY=function(e,t,i,n){var r=[],a=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],a[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),a[1]=r[1],a[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e},t.rotateZ=function(e,t,i,n){var r=[],a=[];return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],a[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),a[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),a[2]=r[2],e[0]=a[0]+i[0],e[1]=a[1]+i[1],e[2]=a[2]+i[2],e},t.forEach=function(){var e=t.create();return function(t,i,n,r,a,o){var s,l;for(i||(i=3),n||(n=0),l=r?Math.min(r*i+n,t.length):t.length,s=n;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),t.angle=function(e,i){var n=t.fromValues(e[0],e[1],e[2]),r=t.fromValues(i[0],i[1],i[2]);t.normalize(n,n),t.normalize(r,r);var a=t.dot(n,r);return a>1?0:Math.acos(a)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(t,i){var n=t[0],r=t[1],a=t[2],o=i[0],s=i[1],l=i[2];return Math.abs(n-o)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-l)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))},t}.apply(null,n))||(e.exports=r)},968:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1530),i(1276)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=new n(function(e){var t=i;return e.split("/").forEach(function(e){t&&(t=t[e])}),t});t.resolveIncludes=function(e){return r.resolveIncludes(e)}}.apply(null,n))||(e.exports=r)},969:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(968),i(417)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return n.glslifyDefineMap({ID:e.id,HIGHLIGHT:e.highlight,SDF:e.isSDF,VV_SIZE_MIN_MAX_VALUE:e.vvSizeMinMaxValue,VV_SIZE_SCALE_STOPS:e.vvSizeScaleStops,VV_SIZE_FIELD_STOPS:e.vvSizeFieldStops,VV_SIZE_UNIT_VALUE:e.vvSizeUnitValue,VV_COLOR:e.vvColor,VV_ROTATION:e.vvRotation,VV_OPACITY:e.vvOpacity,VERTEX_VISIBILITY:e.visibility,PATTERN:e.pattern,HEATMAP:e.heatmap})};t.fill={name:"fill",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/fill/fill.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/fill/fill.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5,a_visible:6}},t.icon={name:"icon",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/icon/icon.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_vv:6,a_weight:7,a_visible:8}},t.label={name:"label",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/label/label.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/label/label.frag")}},attributes:{a_pos:0,a_color:1,a_vertexOffset:2,a_texAndSize:3,a_refSymbolAndPlacementOffset:4,a_visible:5,a_visibilityRange:6}},t.line={name:"line",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/line/line.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/line/line.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7,a_visible:8}},t.text={name:"text",shaders:function(e){return{vertexShader:r(e)+i.resolveIncludes("materials/text/text.vert"),fragmentShader:r(e)+i.resolveIncludes("materials/text/text.frag")}},attributes:{a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5,a_vv:6}}}.apply(null,n))||(e.exports=r)}}]);